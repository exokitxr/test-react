{"ast":null,"code":"var __three_vrm__ =\n/******/\nfunction (modules) {\n  // webpackBootstrap\n\n  /******/\n  // The module cache\n\n  /******/\n  var installedModules = {};\n  /******/\n\n  /******/\n  // The require function\n\n  /******/\n\n  function __webpack_require__(moduleId) {\n    /******/\n\n    /******/\n    // Check if module is in cache\n\n    /******/\n    if (installedModules[moduleId]) {\n      /******/\n      return installedModules[moduleId].exports;\n      /******/\n    }\n    /******/\n    // Create a new module (and put it into the cache)\n\n    /******/\n\n\n    var module = installedModules[moduleId] = {\n      /******/\n      i: moduleId,\n\n      /******/\n      l: false,\n\n      /******/\n      exports: {}\n      /******/\n\n    };\n    /******/\n\n    /******/\n    // Execute the module function\n\n    /******/\n\n    modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n    /******/\n\n    /******/\n    // Flag the module as loaded\n\n    /******/\n\n    module.l = true;\n    /******/\n\n    /******/\n    // Return the exports of the module\n\n    /******/\n\n    return module.exports;\n    /******/\n  }\n  /******/\n\n  /******/\n\n  /******/\n  // expose the modules object (__webpack_modules__)\n\n  /******/\n\n\n  __webpack_require__.m = modules;\n  /******/\n\n  /******/\n  // expose the module cache\n\n  /******/\n\n  __webpack_require__.c = installedModules;\n  /******/\n\n  /******/\n  // define getter function for harmony exports\n\n  /******/\n\n  __webpack_require__.d = function (exports, name, getter) {\n    /******/\n    if (!__webpack_require__.o(exports, name)) {\n      /******/\n      Object.defineProperty(exports, name, {\n        enumerable: true,\n        get: getter\n      });\n      /******/\n    }\n    /******/\n\n  };\n  /******/\n\n  /******/\n  // define __esModule on exports\n\n  /******/\n\n\n  __webpack_require__.r = function (exports) {\n    /******/\n    if (typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n      /******/\n      Object.defineProperty(exports, Symbol.toStringTag, {\n        value: 'Module'\n      });\n      /******/\n    }\n    /******/\n\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true\n    });\n    /******/\n  };\n  /******/\n\n  /******/\n  // create a fake namespace object\n\n  /******/\n  // mode & 1: value is a module id, require it\n\n  /******/\n  // mode & 2: merge all properties of value into the ns\n\n  /******/\n  // mode & 4: return value when already ns object\n\n  /******/\n  // mode & 8|1: behave like require\n\n  /******/\n\n\n  __webpack_require__.t = function (value, mode) {\n    /******/\n    if (mode & 1) value = __webpack_require__(value);\n    /******/\n\n    if (mode & 8) return value;\n    /******/\n\n    if (mode & 4 && typeof value === 'object' && value && value.__esModule) return value;\n    /******/\n\n    var ns = Object.create(null);\n    /******/\n\n    __webpack_require__.r(ns);\n    /******/\n\n\n    Object.defineProperty(ns, 'default', {\n      enumerable: true,\n      value: value\n    });\n    /******/\n\n    if (mode & 2 && typeof value != 'string') for (var key in value) __webpack_require__.d(ns, key, function (key) {\n      return value[key];\n    }.bind(null, key));\n    /******/\n\n    return ns;\n    /******/\n  };\n  /******/\n\n  /******/\n  // getDefaultExport function for compatibility with non-harmony modules\n\n  /******/\n\n\n  __webpack_require__.n = function (module) {\n    /******/\n    var getter = module && module.__esModule ?\n    /******/\n    function getDefault() {\n      return module['default'];\n    } :\n    /******/\n    function getModuleExports() {\n      return module;\n    };\n    /******/\n\n    __webpack_require__.d(getter, 'a', getter);\n    /******/\n\n\n    return getter;\n    /******/\n  };\n  /******/\n\n  /******/\n  // Object.prototype.hasOwnProperty.call\n\n  /******/\n\n\n  __webpack_require__.o = function (object, property) {\n    return Object.prototype.hasOwnProperty.call(object, property);\n  };\n  /******/\n\n  /******/\n  // __webpack_public_path__\n\n  /******/\n\n\n  __webpack_require__.p = \"\";\n  /******/\n\n  /******/\n\n  /******/\n  // Load entry module and return exports\n\n  /******/\n\n  return __webpack_require__(__webpack_require__.s = \"./src/assign.ts\");\n  /******/\n}(\n/************************************************************************/\n\n/******/\n{\n  /***/\n  \"./src/assign.ts\":\n  /*!***********************!*\\\r\n    !*** ./src/assign.ts ***!\r\n    \\***********************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var __three_vrm__ = __webpack_require__(\n    /*! . */\n    \"./src/index.ts\");\n\n    Object.assign(THREE, __three_vrm__);\n    /***/\n  },\n\n  /***/\n  \"./src/index.ts\":\n  /*!**********************!*\\\r\n    !*** ./src/index.ts ***!\r\n    \\**********************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./vrm/ */\n    \"./src/vrm/index.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/VRM.ts\":\n  /*!************************!*\\\r\n    !*** ./src/vrm/VRM.ts ***!\r\n    \\************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var disposer_1 = __webpack_require__(\n    /*! ./utils/disposer */\n    \"./src/vrm/utils/disposer.ts\");\n\n    var VRMImporter_1 = __webpack_require__(\n    /*! ./VRMImporter */\n    \"./src/vrm/VRMImporter.ts\");\n\n    var VRM = function () {\n      function VRM(params) {\n        this.scene = params.scene;\n        this.humanoid = params.humanoid;\n        this.blendShapeProxy = params.blendShapeProxy;\n        this.firstPerson = params.firstPerson;\n        this.lookAt = params.lookAt;\n        this.materials = params.materials;\n        this.springBoneManager = params.springBoneManager;\n        this.meta = params.meta;\n      }\n\n      VRM.from = function (gltf, options) {\n        if (options === void 0) {\n          options = {};\n        }\n\n        return __awaiter(this, void 0, Promise, function () {\n          var importer;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                importer = new VRMImporter_1.VRMImporter(options);\n                return [4, importer.import(gltf)];\n\n              case 1:\n                return [2, _a.sent()];\n            }\n          });\n        });\n      };\n\n      VRM.prototype.update = function (delta) {\n        if (this.lookAt) {\n          this.lookAt.update(delta);\n        }\n\n        if (this.blendShapeProxy) {\n          this.blendShapeProxy.update();\n        }\n\n        if (this.springBoneManager) {\n          this.springBoneManager.lateUpdate(delta);\n        }\n\n        if (this.materials) {\n          this.materials.forEach(function (material) {\n            if (material.updateVRMMaterials) {\n              material.updateVRMMaterials(delta);\n            }\n          });\n        }\n      };\n\n      VRM.prototype.dispose = function () {\n        var scene = this.scene;\n\n        if (scene) {\n          while (scene.children.length > 0) {\n            var object = scene.children[scene.children.length - 1];\n            disposer_1.deepDispose(object);\n            scene.remove(object);\n          }\n        }\n      };\n\n      return VRM;\n    }();\n\n    exports.VRM = VRM;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/VRMImporter.ts\":\n  /*!********************************!*\\\r\n    !*** ./src/vrm/VRMImporter.ts ***!\r\n    \\********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var blendshape_1 = __webpack_require__(\n    /*! ./blendshape */\n    \"./src/vrm/blendshape/index.ts\");\n\n    var firstperson_1 = __webpack_require__(\n    /*! ./firstperson */\n    \"./src/vrm/firstperson/index.ts\");\n\n    var VRMHumanoidImporter_1 = __webpack_require__(\n    /*! ./humanoid/VRMHumanoidImporter */\n    \"./src/vrm/humanoid/VRMHumanoidImporter.ts\");\n\n    var VRMLookAtImporter_1 = __webpack_require__(\n    /*! ./lookat/VRMLookAtImporter */\n    \"./src/vrm/lookat/VRMLookAtImporter.ts\");\n\n    var material_1 = __webpack_require__(\n    /*! ./material */\n    \"./src/vrm/material/index.ts\");\n\n    var reduceBones_1 = __webpack_require__(\n    /*! ./reduceBones */\n    \"./src/vrm/reduceBones.ts\");\n\n    var VRMSpringBoneImporter_1 = __webpack_require__(\n    /*! ./springbone/VRMSpringBoneImporter */\n    \"./src/vrm/springbone/VRMSpringBoneImporter.ts\");\n\n    var VRM_1 = __webpack_require__(\n    /*! ./VRM */\n    \"./src/vrm/VRM.ts\");\n\n    var VRMImporter = function () {\n      function VRMImporter(options) {\n        if (options === void 0) {\n          options = {};\n        }\n\n        this._blendShapeImporter = options.blendShapeImporter || new blendshape_1.VRMBlendShapeImporter();\n        this._lookAtImporter = options.lookAtImporter || new VRMLookAtImporter_1.VRMLookAtImporter();\n        this._humanoidImporter = options.humanoidImporter || new VRMHumanoidImporter_1.VRMHumanoidImporter();\n        this._firstPersonImporter = options.firstPersonImporter || new firstperson_1.VRMFirstPersonImporter();\n        this._materialImporter = options.materialImporter || new material_1.VRMMaterialImporter();\n        this._springBoneImporter = options.springBoneImporter || new VRMSpringBoneImporter_1.VRMSpringBoneImporter();\n      }\n\n      VRMImporter.prototype.import = function (gltf) {\n        return __awaiter(this, void 0, Promise, function () {\n          var vrmExt, scene, materials, humanoid, firstPerson, _a, blendShapeProxy, lookAt, _b, springBoneManager;\n\n          return __generator(this, function (_c) {\n            switch (_c.label) {\n              case 0:\n                if (gltf.parser.json.extensions === undefined || gltf.parser.json.extensions.VRM === undefined) {\n                  throw new Error('Could not find VRM extension on the GLTF');\n                }\n\n                vrmExt = gltf.parser.json.extensions.VRM;\n                scene = gltf.scene;\n                scene.updateMatrixWorld(false);\n                scene.traverse(function (object3d) {\n                  if (object3d.isMesh) {\n                    object3d.frustumCulled = false;\n                  }\n                });\n                reduceBones_1.reduceBones(scene);\n                return [4, this._materialImporter.convertGLTFMaterials(gltf)];\n\n              case 1:\n                materials = _c.sent() || undefined;\n                return [4, this._humanoidImporter.import(gltf)];\n\n              case 2:\n                humanoid = _c.sent() || undefined;\n                if (!humanoid) return [3, 4];\n                return [4, this._firstPersonImporter.import(gltf, humanoid)];\n\n              case 3:\n                _a = _c.sent() || undefined;\n                return [3, 5];\n\n              case 4:\n                _a = undefined;\n                _c.label = 5;\n\n              case 5:\n                firstPerson = _a;\n                return [4, this._blendShapeImporter.import(gltf)];\n\n              case 6:\n                blendShapeProxy = _c.sent() || undefined;\n                if (!(firstPerson && blendShapeProxy && humanoid)) return [3, 8];\n                return [4, this._lookAtImporter.import(gltf, firstPerson, blendShapeProxy, humanoid)];\n\n              case 7:\n                _b = _c.sent() || undefined;\n                return [3, 9];\n\n              case 8:\n                _b = undefined;\n                _c.label = 9;\n\n              case 9:\n                lookAt = _b;\n                return [4, this._springBoneImporter.import(gltf)];\n\n              case 10:\n                springBoneManager = _c.sent() || undefined;\n                return [2, new VRM_1.VRM({\n                  scene: gltf.scene,\n                  meta: vrmExt.meta,\n                  materials: materials,\n                  humanoid: humanoid,\n                  firstPerson: firstPerson,\n                  blendShapeProxy: blendShapeProxy,\n                  lookAt: lookAt,\n                  springBoneManager: springBoneManager\n                })];\n            }\n          });\n        });\n      };\n\n      return VRMImporter;\n    }();\n\n    exports.VRMImporter = VRMImporter;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/blendshape/VRMBlendShapeGroup.ts\":\n  /*!**************************************************!*\\\r\n    !*** ./src/vrm/blendshape/VRMBlendShapeGroup.ts ***!\r\n    \\**************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var VRMBlendShapeMaterialValueType;\n\n    (function (VRMBlendShapeMaterialValueType) {\n      VRMBlendShapeMaterialValueType[VRMBlendShapeMaterialValueType[\"NUMBER\"] = 0] = \"NUMBER\";\n      VRMBlendShapeMaterialValueType[VRMBlendShapeMaterialValueType[\"VECTOR2\"] = 1] = \"VECTOR2\";\n      VRMBlendShapeMaterialValueType[VRMBlendShapeMaterialValueType[\"VECTOR3\"] = 2] = \"VECTOR3\";\n      VRMBlendShapeMaterialValueType[VRMBlendShapeMaterialValueType[\"VECTOR4\"] = 3] = \"VECTOR4\";\n      VRMBlendShapeMaterialValueType[VRMBlendShapeMaterialValueType[\"COLOR\"] = 4] = \"COLOR\";\n    })(VRMBlendShapeMaterialValueType || (VRMBlendShapeMaterialValueType = {}));\n\n    var _v2 = new THREE.Vector2();\n\n    var _v3 = new THREE.Vector3();\n\n    var _v4 = new THREE.Vector4();\n\n    var _color = new THREE.Color();\n\n    var VRMBlendShapeGroup = function (_super) {\n      __extends(VRMBlendShapeGroup, _super);\n\n      function VRMBlendShapeGroup(expressionName) {\n        var _this = _super.call(this) || this;\n\n        _this.weight = 0.0;\n        _this.isBinary = false;\n        _this._binds = [];\n        _this._materialValues = [];\n        _this.name = \"BlendShapeController_\" + expressionName;\n        _this.type = 'BlendShapeController';\n        _this.visible = false;\n        return _this;\n      }\n\n      VRMBlendShapeGroup.prototype.addBind = function (args) {\n        var weight = args.weight / 100;\n\n        this._binds.push({\n          meshes: args.meshes,\n          morphTargetIndex: args.morphTargetIndex,\n          weight: weight\n        });\n      };\n\n      VRMBlendShapeGroup.prototype.addMaterialValue = function (args) {\n        var material = args.material;\n        var propertyName = args.propertyName;\n        var value = material[propertyName];\n\n        if (!value) {\n          return;\n        }\n\n        value = args.defaultValue || value;\n        var type;\n        var defaultValue;\n        var targetValue;\n        var deltaValue;\n\n        if (value.isVector2) {\n          type = VRMBlendShapeMaterialValueType.VECTOR2;\n          defaultValue = value.clone();\n          targetValue = new THREE.Vector2().fromArray(args.targetValue);\n          deltaValue = targetValue.clone().sub(defaultValue);\n        } else if (value.isVector3) {\n          type = VRMBlendShapeMaterialValueType.VECTOR3;\n          defaultValue = value.clone();\n          targetValue = new THREE.Vector3().fromArray(args.targetValue);\n          deltaValue = targetValue.clone().sub(defaultValue);\n        } else if (value.isVector4) {\n          type = VRMBlendShapeMaterialValueType.VECTOR4;\n          defaultValue = value.clone();\n          targetValue = new THREE.Vector4().fromArray([args.targetValue[2], args.targetValue[3], args.targetValue[0], args.targetValue[1]]);\n          deltaValue = targetValue.clone().sub(defaultValue);\n        } else if (value.isColor) {\n          type = VRMBlendShapeMaterialValueType.COLOR;\n          defaultValue = value.clone();\n          targetValue = new THREE.Color().fromArray(args.targetValue);\n          deltaValue = targetValue.clone().sub(defaultValue);\n        } else {\n          type = VRMBlendShapeMaterialValueType.NUMBER;\n          defaultValue = value;\n          targetValue = args.targetValue[0];\n          deltaValue = targetValue - defaultValue;\n        }\n\n        this._materialValues.push({\n          material: material,\n          propertyName: propertyName,\n          defaultValue: defaultValue,\n          targetValue: targetValue,\n          deltaValue: deltaValue,\n          type: type\n        });\n      };\n\n      VRMBlendShapeGroup.prototype.applyWeight = function () {\n        var w = this.isBinary ? this.weight < 0.5 ? 0.0 : 1.0 : this.weight;\n\n        this._binds.forEach(function (bind) {\n          bind.meshes.forEach(function (mesh) {\n            if (!mesh.morphTargetInfluences) {\n              return;\n            }\n\n            mesh.morphTargetInfluences[bind.morphTargetIndex] += w * bind.weight;\n          });\n        });\n\n        this._materialValues.forEach(function (materialValue) {\n          var prop = materialValue.material[materialValue.propertyName];\n\n          if (prop === undefined) {\n            return;\n          }\n\n          if (materialValue.type === VRMBlendShapeMaterialValueType.NUMBER) {\n            var deltaValue = materialValue.deltaValue;\n            materialValue.material[materialValue.propertyName] += deltaValue * w;\n          } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR2) {\n            var deltaValue = materialValue.deltaValue;\n            materialValue.material[materialValue.propertyName].add(_v2.copy(deltaValue).multiplyScalar(w));\n          } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR3) {\n            var deltaValue = materialValue.deltaValue;\n            materialValue.material[materialValue.propertyName].add(_v3.copy(deltaValue).multiplyScalar(w));\n          } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR4) {\n            var deltaValue = materialValue.deltaValue;\n            materialValue.material[materialValue.propertyName].add(_v4.copy(deltaValue).multiplyScalar(w));\n          } else if (materialValue.type === VRMBlendShapeMaterialValueType.COLOR) {\n            var deltaValue = materialValue.deltaValue;\n            materialValue.material[materialValue.propertyName].add(_color.copy(deltaValue).multiplyScalar(w));\n          }\n\n          if (typeof materialValue.material.shouldApplyUniforms === 'boolean') {\n            materialValue.material.shouldApplyUniforms = true;\n          }\n        });\n      };\n\n      VRMBlendShapeGroup.prototype.clearAppliedWeight = function () {\n        this._binds.forEach(function (bind) {\n          bind.meshes.forEach(function (mesh) {\n            if (!mesh.morphTargetInfluences) {\n              return;\n            }\n\n            mesh.morphTargetInfluences[bind.morphTargetIndex] = 0.0;\n          });\n        });\n\n        this._materialValues.forEach(function (materialValue) {\n          var prop = materialValue.material[materialValue.propertyName];\n\n          if (prop === undefined) {\n            return;\n          }\n\n          if (materialValue.type === VRMBlendShapeMaterialValueType.NUMBER) {\n            var defaultValue = materialValue.defaultValue;\n            materialValue.material[materialValue.propertyName] = defaultValue;\n          } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR2) {\n            var defaultValue = materialValue.defaultValue;\n            materialValue.material[materialValue.propertyName].copy(defaultValue);\n          } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR3) {\n            var defaultValue = materialValue.defaultValue;\n            materialValue.material[materialValue.propertyName].copy(defaultValue);\n          } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR4) {\n            var defaultValue = materialValue.defaultValue;\n            materialValue.material[materialValue.propertyName].copy(defaultValue);\n          } else if (materialValue.type === VRMBlendShapeMaterialValueType.COLOR) {\n            var defaultValue = materialValue.defaultValue;\n            materialValue.material[materialValue.propertyName].copy(defaultValue);\n          }\n\n          if (typeof materialValue.material.shouldApplyUniforms === 'boolean') {\n            materialValue.material.shouldApplyUniforms = true;\n          }\n        });\n      };\n\n      return VRMBlendShapeGroup;\n    }(THREE.Object3D);\n\n    exports.VRMBlendShapeGroup = VRMBlendShapeGroup;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/blendshape/VRMBlendShapeImporter.ts\":\n  /*!*****************************************************!*\\\r\n    !*** ./src/vrm/blendshape/VRMBlendShapeImporter.ts ***!\r\n    \\*****************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var types_1 = __webpack_require__(\n    /*! ../types */\n    \"./src/vrm/types/index.ts\");\n\n    var renameMaterialProperty_1 = __webpack_require__(\n    /*! ../utils/renameMaterialProperty */\n    \"./src/vrm/utils/renameMaterialProperty.ts\");\n\n    var VRMBlendShapeGroup_1 = __webpack_require__(\n    /*! ./VRMBlendShapeGroup */\n    \"./src/vrm/blendshape/VRMBlendShapeGroup.ts\");\n\n    var VRMBlendShapeProxy_1 = __webpack_require__(\n    /*! ./VRMBlendShapeProxy */\n    \"./src/vrm/blendshape/VRMBlendShapeProxy.ts\");\n\n    var VRMBlendShapeImporter = function () {\n      function VRMBlendShapeImporter() {}\n\n      VRMBlendShapeImporter.prototype.import = function (gltf) {\n        return __awaiter(this, void 0, Promise, function () {\n          var vrmExt, schemaBlendShape, blendShape, blendShapeGroups, blendShapePresetMap;\n\n          var _this = this;\n\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                vrmExt = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n\n                if (!vrmExt) {\n                  return [2, null];\n                }\n\n                schemaBlendShape = vrmExt.blendShapeMaster;\n\n                if (!schemaBlendShape) {\n                  return [2, null];\n                }\n\n                blendShape = new VRMBlendShapeProxy_1.VRMBlendShapeProxy();\n                blendShapeGroups = schemaBlendShape.blendShapeGroups;\n\n                if (!blendShapeGroups) {\n                  return [2, blendShape];\n                }\n\n                blendShapePresetMap = {};\n                return [4, Promise.all(blendShapeGroups.map(function (schemaGroup) {\n                  return __awaiter(_this, void 0, void 0, function () {\n                    var name, presetName, group, materialValues;\n\n                    var _this = this;\n\n                    return __generator(this, function (_a) {\n                      name = schemaGroup.name;\n\n                      if (name === undefined) {\n                        console.warn('VRMBlendShapeImporter: One of blendShapeGroups has no name');\n                        return [2];\n                      }\n\n                      if (schemaGroup.presetName && schemaGroup.presetName !== types_1.VRMSchema.BlendShapePresetName.Unknown && !blendShapePresetMap[schemaGroup.presetName]) {\n                        presetName = schemaGroup.presetName;\n                        blendShapePresetMap[schemaGroup.presetName] = name;\n                      }\n\n                      group = new VRMBlendShapeGroup_1.VRMBlendShapeGroup(name);\n                      gltf.scene.add(group);\n                      group.isBinary = schemaGroup.isBinary || false;\n\n                      if (schemaGroup.binds) {\n                        schemaGroup.binds.forEach(function (bind) {\n                          return __awaiter(_this, void 0, void 0, function () {\n                            var morphMeshes, primitives, morphTargetIndex;\n                            return __generator(this, function (_a) {\n                              switch (_a.label) {\n                                case 0:\n                                  if (bind.mesh === undefined || bind.index === undefined) {\n                                    return [2];\n                                  }\n\n                                  return [4, gltf.parser.getDependency('mesh', bind.mesh)];\n\n                                case 1:\n                                  morphMeshes = _a.sent();\n                                  primitives = morphMeshes.type === 'Group' ? morphMeshes.children : [morphMeshes];\n                                  morphTargetIndex = bind.index;\n\n                                  if (!primitives.every(function (primitive) {\n                                    return Array.isArray(primitive.morphTargetInfluences) && morphTargetIndex < primitive.morphTargetInfluences.length;\n                                  })) {\n                                    console.warn(\"VRMBlendShapeImporter: \" + schemaGroup.name + \" attempts to index \" + morphTargetIndex + \"th morph but not found.\");\n                                    return [2];\n                                  }\n\n                                  group.addBind({\n                                    meshes: primitives,\n                                    morphTargetIndex: morphTargetIndex,\n                                    weight: bind.weight || 100\n                                  });\n                                  return [2];\n                              }\n                            });\n                          });\n                        });\n                      }\n\n                      materialValues = schemaGroup.materialValues;\n\n                      if (materialValues) {\n                        materialValues.forEach(function (materialValue) {\n                          if (materialValue.materialName === undefined || materialValue.propertyName === undefined || materialValue.targetValue === undefined) {\n                            return;\n                          }\n\n                          var materials = [];\n                          gltf.scene.traverse(function (object) {\n                            if (object.material) {\n                              var material = object.material;\n\n                              if (Array.isArray(material)) {\n                                materials.push.apply(materials, material.filter(function (mtl) {\n                                  return mtl.name === materialValue.materialName && materials.indexOf(mtl) === -1;\n                                }));\n                              } else if (material.name === materialValue.materialName && materials.indexOf(material) === -1) {\n                                materials.push(material);\n                              }\n                            }\n                          });\n                          materials.forEach(function (material) {\n                            group.addMaterialValue({\n                              material: material,\n                              propertyName: renameMaterialProperty_1.renameMaterialProperty(materialValue.propertyName),\n                              targetValue: materialValue.targetValue\n                            });\n                          });\n                        });\n                      }\n\n                      blendShape.registerBlendShapeGroup(name, presetName, group);\n                      return [2];\n                    });\n                  });\n                }))];\n\n              case 1:\n                _a.sent();\n\n                return [2, blendShape];\n            }\n          });\n        });\n      };\n\n      return VRMBlendShapeImporter;\n    }();\n\n    exports.VRMBlendShapeImporter = VRMBlendShapeImporter;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/blendshape/VRMBlendShapeProxy.ts\":\n  /*!**************************************************!*\\\r\n    !*** ./src/vrm/blendshape/VRMBlendShapeProxy.ts ***!\r\n    \\**************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var math_1 = __webpack_require__(\n    /*! ../utils/math */\n    \"./src/vrm/utils/math.ts\");\n\n    var VRMBlendShapeProxy = function () {\n      function VRMBlendShapeProxy() {\n        this._blendShapeGroups = {};\n        this._blendShapePresetMap = {};\n      }\n\n      Object.defineProperty(VRMBlendShapeProxy.prototype, \"expressions\", {\n        get: function () {\n          return Object.keys(this._blendShapeGroups);\n        },\n        enumerable: true,\n        configurable: true\n      });\n\n      VRMBlendShapeProxy.prototype.getBlendShapeGroup = function (name) {\n        var presetName = this._blendShapePresetMap[name];\n        var controller = presetName ? this._blendShapeGroups[presetName] : this._blendShapeGroups[name];\n\n        if (!controller) {\n          console.warn(\"no blend shape found by \" + name);\n          return undefined;\n        }\n\n        return controller;\n      };\n\n      VRMBlendShapeProxy.prototype.registerBlendShapeGroup = function (name, presetName, controller) {\n        this._blendShapeGroups[name] = controller;\n\n        if (presetName) {\n          this._blendShapePresetMap[presetName] = name;\n        }\n      };\n\n      VRMBlendShapeProxy.prototype.getValue = function (name) {\n        var controller = this.getBlendShapeGroup(name);\n        return controller && controller.weight || null;\n      };\n\n      VRMBlendShapeProxy.prototype.setValue = function (name, weight) {\n        var controller = this.getBlendShapeGroup(name);\n\n        if (controller) {\n          controller.weight = math_1.saturate(weight);\n        }\n      };\n\n      VRMBlendShapeProxy.prototype.getBlendShapeTrackName = function (name) {\n        var controller = this.getBlendShapeGroup(name);\n        return controller ? controller.name + \".weight\" : null;\n      };\n\n      VRMBlendShapeProxy.prototype.update = function () {\n        var _this = this;\n\n        Object.keys(this._blendShapeGroups).forEach(function (name) {\n          var controller = _this._blendShapeGroups[name];\n          controller.clearAppliedWeight();\n        });\n        Object.keys(this._blendShapeGroups).forEach(function (name) {\n          var controller = _this._blendShapeGroups[name];\n          controller.applyWeight();\n        });\n      };\n\n      return VRMBlendShapeProxy;\n    }();\n\n    exports.VRMBlendShapeProxy = VRMBlendShapeProxy;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/blendshape/index.ts\":\n  /*!*************************************!*\\\r\n    !*** ./src/vrm/blendshape/index.ts ***!\r\n    \\*************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./VRMBlendShapeGroup */\n    \"./src/vrm/blendshape/VRMBlendShapeGroup.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMBlendShapeImporter */\n    \"./src/vrm/blendshape/VRMBlendShapeImporter.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMBlendShapeProxy */\n    \"./src/vrm/blendshape/VRMBlendShapeProxy.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/debug/VRMDebug.ts\":\n  /*!***********************************!*\\\r\n    !*** ./src/vrm/debug/VRMDebug.ts ***!\r\n    \\***********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var VRM_1 = __webpack_require__(\n    /*! ../VRM */\n    \"./src/vrm/VRM.ts\");\n\n    var VRMImporterDebug_1 = __webpack_require__(\n    /*! ./VRMImporterDebug */\n    \"./src/vrm/debug/VRMImporterDebug.ts\");\n\n    var VRMDebug = function (_super) {\n      __extends(VRMDebug, _super);\n\n      function VRMDebug(params, debugOption) {\n        if (debugOption === void 0) {\n          debugOption = {};\n        }\n\n        var _this = _super.call(this, params) || this;\n\n        if (!debugOption.disableBoxHelper) {\n          _this.scene.add(new THREE.BoxHelper(_this.scene));\n        }\n\n        if (!debugOption.disableSkeletonHelper) {\n          _this.scene.add(new THREE.SkeletonHelper(_this.scene));\n        }\n\n        return _this;\n      }\n\n      VRMDebug.from = function (gltf, options, debugOption) {\n        if (options === void 0) {\n          options = {};\n        }\n\n        if (debugOption === void 0) {\n          debugOption = {};\n        }\n\n        return __awaiter(this, void 0, Promise, function () {\n          var importer;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                importer = new VRMImporterDebug_1.VRMImporterDebug(options);\n                return [4, importer.import(gltf, debugOption)];\n\n              case 1:\n                return [2, _a.sent()];\n            }\n          });\n        });\n      };\n\n      VRMDebug.prototype.update = function (delta) {\n        _super.prototype.update.call(this, delta);\n      };\n\n      return VRMDebug;\n    }(VRM_1.VRM);\n\n    exports.VRMDebug = VRMDebug;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/debug/VRMDebugOptions.ts\":\n  /*!******************************************!*\\\r\n    !*** ./src/vrm/debug/VRMDebugOptions.ts ***!\r\n    \\******************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/debug/VRMImporterDebug.ts\":\n  /*!*******************************************!*\\\r\n    !*** ./src/vrm/debug/VRMImporterDebug.ts ***!\r\n    \\*******************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var reduceBones_1 = __webpack_require__(\n    /*! ../reduceBones */\n    \"./src/vrm/reduceBones.ts\");\n\n    var VRMImporter_1 = __webpack_require__(\n    /*! ../VRMImporter */\n    \"./src/vrm/VRMImporter.ts\");\n\n    var VRMDebug_1 = __webpack_require__(\n    /*! ./VRMDebug */\n    \"./src/vrm/debug/VRMDebug.ts\");\n\n    var VRMLookAtImporterDebug_1 = __webpack_require__(\n    /*! ./VRMLookAtImporterDebug */\n    \"./src/vrm/debug/VRMLookAtImporterDebug.ts\");\n\n    var VRMSpringBoneImporterDebug_1 = __webpack_require__(\n    /*! ./VRMSpringBoneImporterDebug */\n    \"./src/vrm/debug/VRMSpringBoneImporterDebug.ts\");\n\n    var VRMImporterDebug = function (_super) {\n      __extends(VRMImporterDebug, _super);\n\n      function VRMImporterDebug(options) {\n        if (options === void 0) {\n          options = {};\n        }\n\n        var _this = this;\n\n        options.lookAtImporter = options.lookAtImporter || new VRMLookAtImporterDebug_1.VRMLookAtImporterDebug();\n        options.springBoneImporter = options.springBoneImporter || new VRMSpringBoneImporterDebug_1.VRMSpringBoneImporterDebug();\n        _this = _super.call(this, options) || this;\n        return _this;\n      }\n\n      VRMImporterDebug.prototype.import = function (gltf, debugOptions) {\n        if (debugOptions === void 0) {\n          debugOptions = {};\n        }\n\n        return __awaiter(this, void 0, Promise, function () {\n          var vrmExt, scene, materials, humanoid, firstPerson, _a, blendShapeProxy, lookAt, _b, springBoneManager;\n\n          return __generator(this, function (_c) {\n            switch (_c.label) {\n              case 0:\n                if (gltf.parser.json.extensions === undefined || gltf.parser.json.extensions.VRM === undefined) {\n                  throw new Error('Could not find VRM extension on the GLTF');\n                }\n\n                vrmExt = gltf.parser.json.extensions.VRM;\n                scene = gltf.scene;\n                scene.updateMatrixWorld(false);\n                scene.traverse(function (object3d) {\n                  if (object3d.isMesh) {\n                    object3d.frustumCulled = false;\n                  }\n                });\n                reduceBones_1.reduceBones(scene);\n                return [4, this._materialImporter.convertGLTFMaterials(gltf)];\n\n              case 1:\n                materials = _c.sent() || undefined;\n                return [4, this._humanoidImporter.import(gltf)];\n\n              case 2:\n                humanoid = _c.sent() || undefined;\n                if (!humanoid) return [3, 4];\n                return [4, this._firstPersonImporter.import(gltf, humanoid)];\n\n              case 3:\n                _a = _c.sent() || undefined;\n                return [3, 5];\n\n              case 4:\n                _a = undefined;\n                _c.label = 5;\n\n              case 5:\n                firstPerson = _a;\n                return [4, this._blendShapeImporter.import(gltf)];\n\n              case 6:\n                blendShapeProxy = _c.sent() || undefined;\n                if (!(firstPerson && blendShapeProxy && humanoid)) return [3, 8];\n                return [4, this._lookAtImporter.import(gltf, firstPerson, blendShapeProxy, humanoid)];\n\n              case 7:\n                _b = _c.sent() || undefined;\n                return [3, 9];\n\n              case 8:\n                _b = undefined;\n                _c.label = 9;\n\n              case 9:\n                lookAt = _b;\n\n                if (lookAt.setupHelper) {\n                  lookAt.setupHelper(scene, debugOptions);\n                }\n\n                return [4, this._springBoneImporter.import(gltf)];\n\n              case 10:\n                springBoneManager = _c.sent() || undefined;\n                return [2, new VRMDebug_1.VRMDebug({\n                  scene: gltf.scene,\n                  meta: vrmExt.meta,\n                  materials: materials,\n                  humanoid: humanoid,\n                  firstPerson: firstPerson,\n                  blendShapeProxy: blendShapeProxy,\n                  lookAt: lookAt,\n                  springBoneManager: springBoneManager\n                }, debugOptions)];\n            }\n          });\n        });\n      };\n\n      return VRMImporterDebug;\n    }(VRMImporter_1.VRMImporter);\n\n    exports.VRMImporterDebug = VRMImporterDebug;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/debug/VRMLookAtHeadDebug.ts\":\n  /*!*********************************************!*\\\r\n    !*** ./src/vrm/debug/VRMLookAtHeadDebug.ts ***!\r\n    \\*********************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var VRMLookAtHead_1 = __webpack_require__(\n    /*! ../lookat/VRMLookAtHead */\n    \"./src/vrm/lookat/VRMLookAtHead.ts\");\n\n    var _v3 = new THREE.Vector3();\n\n    var VRMLookAtHeadDebug = function (_super) {\n      __extends(VRMLookAtHeadDebug, _super);\n\n      function VRMLookAtHeadDebug() {\n        return _super !== null && _super.apply(this, arguments) || this;\n      }\n\n      VRMLookAtHeadDebug.prototype.setupHelper = function (scene, debugOption) {\n        if (!debugOption.disableFaceDirectionHelper) {\n          this._faceDirectionHelper = new THREE.ArrowHelper(new THREE.Vector3(0, 0, -1), new THREE.Vector3(0, 0, 0), 0.5, 0xff00ff);\n          scene.add(this._faceDirectionHelper);\n        }\n      };\n\n      VRMLookAtHeadDebug.prototype.update = function (delta) {\n        _super.prototype.update.call(this, delta);\n\n        if (this._faceDirectionHelper) {\n          this.firstPerson.getFirstPersonWorldPosition(this._faceDirectionHelper.position);\n\n          this._faceDirectionHelper.setDirection(this.getLookAtWorldDirection(_v3));\n        }\n      };\n\n      return VRMLookAtHeadDebug;\n    }(VRMLookAtHead_1.VRMLookAtHead);\n\n    exports.VRMLookAtHeadDebug = VRMLookAtHeadDebug;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/debug/VRMLookAtImporterDebug.ts\":\n  /*!*************************************************!*\\\r\n    !*** ./src/vrm/debug/VRMLookAtImporterDebug.ts ***!\r\n    \\*************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var VRMLookAtImporter_1 = __webpack_require__(\n    /*! ../lookat/VRMLookAtImporter */\n    \"./src/vrm/lookat/VRMLookAtImporter.ts\");\n\n    var VRMLookAtHeadDebug_1 = __webpack_require__(\n    /*! ./VRMLookAtHeadDebug */\n    \"./src/vrm/debug/VRMLookAtHeadDebug.ts\");\n\n    var VRMLookAtImporterDebug = function (_super) {\n      __extends(VRMLookAtImporterDebug, _super);\n\n      function VRMLookAtImporterDebug() {\n        return _super !== null && _super.apply(this, arguments) || this;\n      }\n\n      VRMLookAtImporterDebug.prototype.import = function (gltf, firstPerson, blendShapeProxy, humanoid) {\n        var vrmExt = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n\n        if (!vrmExt) {\n          return null;\n        }\n\n        var schemaFirstPerson = vrmExt.firstPerson;\n\n        if (!schemaFirstPerson) {\n          return null;\n        }\n\n        var applyer = this._importApplyer(schemaFirstPerson, blendShapeProxy, humanoid);\n\n        return new VRMLookAtHeadDebug_1.VRMLookAtHeadDebug(firstPerson, applyer || undefined);\n      };\n\n      return VRMLookAtImporterDebug;\n    }(VRMLookAtImporter_1.VRMLookAtImporter);\n\n    exports.VRMLookAtImporterDebug = VRMLookAtImporterDebug;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/debug/VRMSpringBoneDebug.ts\":\n  /*!*********************************************!*\\\r\n    !*** ./src/vrm/debug/VRMSpringBoneDebug.ts ***!\r\n    \\*********************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var springbone_1 = __webpack_require__(\n    /*! ../springbone */\n    \"./src/vrm/springbone/index.ts\");\n\n    var _v3A = new THREE.Vector3();\n\n    var VRMSpringBoneDebug = function (_super) {\n      __extends(VRMSpringBoneDebug, _super);\n\n      function VRMSpringBoneDebug(bone, radius, stiffiness, gravityDir, gravityPower, dragForce, colliders) {\n        if (colliders === void 0) {\n          colliders = [];\n        }\n\n        return _super.call(this, bone, radius, stiffiness, gravityDir, gravityPower, dragForce, colliders) || this;\n      }\n\n      VRMSpringBoneDebug.prototype.getGizmo = function () {\n        if (this._gizmo) {\n          return this._gizmo;\n        }\n\n        var nextTailRelative = _v3A.copy(this._nextTail).sub(this._worldPosition);\n\n        var nextTailRelativeLength = nextTailRelative.length();\n        this._gizmo = new THREE.ArrowHelper(nextTailRelative.normalize(), this._worldPosition, nextTailRelativeLength, 0xffff00, this.radius, this.radius);\n        this._gizmo.line.renderOrder = springbone_1.GIZMO_RENDER_ORDER;\n        this._gizmo.cone.renderOrder = springbone_1.GIZMO_RENDER_ORDER;\n        this._gizmo.line.material.depthTest = false;\n        this._gizmo.line.material.transparent = true;\n        this._gizmo.cone.material.depthTest = false;\n        this._gizmo.cone.material.transparent = true;\n        return this._gizmo;\n      };\n\n      VRMSpringBoneDebug.prototype.update = function (delta) {\n        _super.prototype.update.call(this, delta);\n\n        this._updateGizmo();\n      };\n\n      VRMSpringBoneDebug.prototype._updateGizmo = function () {\n        if (!this._gizmo) {\n          return;\n        }\n\n        var nextTailRelative = _v3A.copy(this._currentTail).sub(this._worldPosition);\n\n        var nextTailRelativeLength = nextTailRelative.length();\n\n        this._gizmo.setDirection(nextTailRelative.normalize());\n\n        this._gizmo.setLength(nextTailRelativeLength, this.radius, this.radius);\n\n        this._gizmo.position.copy(this._worldPosition);\n      };\n\n      return VRMSpringBoneDebug;\n    }(springbone_1.VRMSpringBone);\n\n    exports.VRMSpringBoneDebug = VRMSpringBoneDebug;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/debug/VRMSpringBoneImporterDebug.ts\":\n  /*!*****************************************************!*\\\r\n    !*** ./src/vrm/debug/VRMSpringBoneImporterDebug.ts ***!\r\n    \\*****************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var VRMSpringBoneImporter_1 = __webpack_require__(\n    /*! ../springbone/VRMSpringBoneImporter */\n    \"./src/vrm/springbone/VRMSpringBoneImporter.ts\");\n\n    var VRMSpringBoneDebug_1 = __webpack_require__(\n    /*! ./VRMSpringBoneDebug */\n    \"./src/vrm/debug/VRMSpringBoneDebug.ts\");\n\n    var VRMSpringBoneImporterDebug = function (_super) {\n      __extends(VRMSpringBoneImporterDebug, _super);\n\n      function VRMSpringBoneImporterDebug() {\n        return _super !== null && _super.apply(this, arguments) || this;\n      }\n\n      Object.defineProperty(VRMSpringBoneImporterDebug.prototype, \"_isColiderMeshVisible\", {\n        get: function () {\n          return true;\n        },\n        enumerable: true,\n        configurable: true\n      });\n\n      VRMSpringBoneImporterDebug.prototype._createSpringBone = function (gltf, bone, hitRadius, stiffiness, gravityDir, gravityPower, dragForce, colliders) {\n        if (colliders === void 0) {\n          colliders = [];\n        }\n\n        var springBone = new VRMSpringBoneDebug_1.VRMSpringBoneDebug(bone, hitRadius, stiffiness, gravityDir, gravityPower, dragForce, colliders);\n        gltf.scene.add(springBone.getGizmo());\n        return springBone;\n      };\n\n      return VRMSpringBoneImporterDebug;\n    }(VRMSpringBoneImporter_1.VRMSpringBoneImporter);\n\n    exports.VRMSpringBoneImporterDebug = VRMSpringBoneImporterDebug;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/debug/index.ts\":\n  /*!********************************!*\\\r\n    !*** ./src/vrm/debug/index.ts ***!\r\n    \\********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./VRMDebugOptions */\n    \"./src/vrm/debug/VRMDebugOptions.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMDebug */\n    \"./src/vrm/debug/VRMDebug.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMSpringBoneDebug */\n    \"./src/vrm/debug/VRMSpringBoneDebug.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMSpringBoneImporterDebug */\n    \"./src/vrm/debug/VRMSpringBoneImporterDebug.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/firstperson/VRMFirstPerson.ts\":\n  /*!***********************************************!*\\\r\n    !*** ./src/vrm/firstperson/VRMFirstPerson.ts ***!\r\n    \\***********************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var math_1 = __webpack_require__(\n    /*! ../utils/math */\n    \"./src/vrm/utils/math.ts\");\n\n    var VECTOR3_FRONT = Object.freeze(new THREE.Vector3(0.0, 0.0, -1.0));\n\n    var _quat = new THREE.Quaternion();\n\n    var FirstPersonFlag;\n\n    (function (FirstPersonFlag) {\n      FirstPersonFlag[FirstPersonFlag[\"Auto\"] = 0] = \"Auto\";\n      FirstPersonFlag[FirstPersonFlag[\"Both\"] = 1] = \"Both\";\n      FirstPersonFlag[FirstPersonFlag[\"ThirdPersonOnly\"] = 2] = \"ThirdPersonOnly\";\n      FirstPersonFlag[FirstPersonFlag[\"FirstPersonOnly\"] = 3] = \"FirstPersonOnly\";\n    })(FirstPersonFlag || (FirstPersonFlag = {}));\n\n    var VRMRendererFirstPersonFlags = function () {\n      function VRMRendererFirstPersonFlags(firstPersonFlag, mesh) {\n        this.firstPersonFlag = VRMRendererFirstPersonFlags._parseFirstPersonFlag(firstPersonFlag);\n        this.mesh = mesh;\n      }\n\n      VRMRendererFirstPersonFlags._parseFirstPersonFlag = function (firstPersonFlag) {\n        switch (firstPersonFlag) {\n          case 'Both':\n            return FirstPersonFlag.Both;\n\n          case 'ThirdPersonOnly':\n            return FirstPersonFlag.ThirdPersonOnly;\n\n          case 'FirstPersonOnly':\n            return FirstPersonFlag.FirstPersonOnly;\n\n          default:\n            return FirstPersonFlag.Auto;\n        }\n      };\n\n      return VRMRendererFirstPersonFlags;\n    }();\n\n    exports.VRMRendererFirstPersonFlags = VRMRendererFirstPersonFlags;\n\n    var VRMFirstPerson = function () {\n      function VRMFirstPerson(firstPersonBone, firstPersonBoneOffset, meshAnnotations) {\n        this._meshAnnotations = [];\n        this._firstPersonOnlyLayer = VRMFirstPerson._DEFAULT_FIRSTPERSON_ONLY_LAYER;\n        this._thirdPersonOnlyLayer = VRMFirstPerson._DEFAULT_THIRDPERSON_ONLY_LAYER;\n        this._initialized = false;\n        this._firstPersonBone = firstPersonBone;\n        this._firstPersonBoneOffset = firstPersonBoneOffset;\n        this._meshAnnotations = meshAnnotations;\n      }\n\n      Object.defineProperty(VRMFirstPerson.prototype, \"firstPersonBone\", {\n        get: function () {\n          return this._firstPersonBone;\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(VRMFirstPerson.prototype, \"meshAnnotations\", {\n        get: function () {\n          return this._meshAnnotations;\n        },\n        enumerable: true,\n        configurable: true\n      });\n\n      VRMFirstPerson.prototype.getFirstPersonWorldDirection = function (target) {\n        return target.copy(VECTOR3_FRONT).applyQuaternion(math_1.getWorldQuaternionLite(this._firstPersonBone, _quat));\n      };\n\n      Object.defineProperty(VRMFirstPerson.prototype, \"firstPersonOnlyLayer\", {\n        get: function () {\n          return this._firstPersonOnlyLayer;\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(VRMFirstPerson.prototype, \"thirdPersonOnlyLayer\", {\n        get: function () {\n          return this._thirdPersonOnlyLayer;\n        },\n        enumerable: true,\n        configurable: true\n      });\n\n      VRMFirstPerson.prototype.getFirstPersonBoneOffset = function (target) {\n        return target.copy(this._firstPersonBoneOffset);\n      };\n\n      VRMFirstPerson.prototype.getFirstPersonWorldPosition = function (v3) {\n        var offset = this._firstPersonBoneOffset;\n        var v4 = new THREE.Vector4(offset.x, offset.y, offset.z, 1.0);\n        v4.applyMatrix4(this._firstPersonBone.matrixWorld);\n        return v3.set(v4.x, v4.y, v4.z);\n      };\n\n      VRMFirstPerson.prototype.setup = function (_a) {\n        var _this = this;\n\n        var _b = _a === void 0 ? {} : _a,\n            _c = _b.firstPersonOnlyLayer,\n            firstPersonOnlyLayer = _c === void 0 ? VRMFirstPerson._DEFAULT_FIRSTPERSON_ONLY_LAYER : _c,\n            _d = _b.thirdPersonOnlyLayer,\n            thirdPersonOnlyLayer = _d === void 0 ? VRMFirstPerson._DEFAULT_THIRDPERSON_ONLY_LAYER : _d;\n\n        if (this._initialized) {\n          return;\n        }\n\n        this._initialized = true;\n        this._firstPersonOnlyLayer = firstPersonOnlyLayer;\n        this._thirdPersonOnlyLayer = thirdPersonOnlyLayer;\n\n        this._meshAnnotations.forEach(function (item) {\n          if (item.firstPersonFlag === FirstPersonFlag.FirstPersonOnly) {\n            item.mesh.layers.set(_this._firstPersonOnlyLayer);\n            item.mesh.traverse(function (child) {\n              return child.layers.set(_this._firstPersonOnlyLayer);\n            });\n          } else if (item.firstPersonFlag === FirstPersonFlag.ThirdPersonOnly) {\n            item.mesh.layers.set(_this._thirdPersonOnlyLayer);\n            item.mesh.traverse(function (child) {\n              return child.layers.set(_this._thirdPersonOnlyLayer);\n            });\n          } else if (item.firstPersonFlag === FirstPersonFlag.Auto) {\n            _this._createHeadlessModel(item.mesh);\n          }\n        });\n      };\n\n      VRMFirstPerson.prototype._excludeTriangles = function (triangles, bws, skinIndex, exclude) {\n        var count = 0;\n\n        if (bws != null && bws.length > 0) {\n          for (var i = 0; i < triangles.length; i += 3) {\n            var a = triangles[i];\n            var b = triangles[i + 1];\n            var c = triangles[i + 2];\n            var bw0 = bws[a];\n            var skin0 = skinIndex[a];\n            if (bw0[0] > 0 && exclude.includes(skin0[0])) continue;\n            if (bw0[1] > 0 && exclude.includes(skin0[1])) continue;\n            if (bw0[2] > 0 && exclude.includes(skin0[2])) continue;\n            if (bw0[3] > 0 && exclude.includes(skin0[3])) continue;\n            var bw1 = bws[b];\n            var skin1 = skinIndex[b];\n            if (bw1[0] > 0 && exclude.includes(skin1[0])) continue;\n            if (bw1[1] > 0 && exclude.includes(skin1[1])) continue;\n            if (bw1[2] > 0 && exclude.includes(skin1[2])) continue;\n            if (bw1[3] > 0 && exclude.includes(skin1[3])) continue;\n            var bw2 = bws[c];\n            var skin2 = skinIndex[c];\n            if (bw2[0] > 0 && exclude.includes(skin2[0])) continue;\n            if (bw2[1] > 0 && exclude.includes(skin2[1])) continue;\n            if (bw2[2] > 0 && exclude.includes(skin2[2])) continue;\n            if (bw2[3] > 0 && exclude.includes(skin2[3])) continue;\n            triangles[count++] = a;\n            triangles[count++] = b;\n            triangles[count++] = c;\n          }\n        }\n\n        return count;\n      };\n\n      VRMFirstPerson.prototype._createErasedMesh = function (src, erasingBonesIndex) {\n        var dst = new THREE.SkinnedMesh(src.geometry.clone(), src.material);\n        dst.name = src.name + \"(erase)\";\n        dst.frustumCulled = src.frustumCulled;\n        dst.layers.set(this._firstPersonOnlyLayer);\n        var geometry = dst.geometry;\n        var skinIndexAttr = geometry.getAttribute('skinIndex').array;\n        var skinIndex = [];\n\n        for (var i = 0; i < skinIndexAttr.length; i += 4) {\n          skinIndex.push([skinIndexAttr[i], skinIndexAttr[i + 1], skinIndexAttr[i + 2], skinIndexAttr[i + 3]]);\n        }\n\n        var skinWeightAttr = geometry.getAttribute('skinWeight').array;\n        var skinWeight = [];\n\n        for (var i = 0; i < skinWeightAttr.length; i += 4) {\n          skinWeight.push([skinWeightAttr[i], skinWeightAttr[i + 1], skinWeightAttr[i + 2], skinWeightAttr[i + 3]]);\n        }\n\n        var oldTriangles = Array.from(geometry.getIndex().array);\n\n        var count = this._excludeTriangles(oldTriangles, skinWeight, skinIndex, erasingBonesIndex);\n\n        var newTriangle = [];\n\n        for (var i = 0; i < count; i++) {\n          newTriangle[i] = oldTriangles[i];\n        }\n\n        geometry.setIndex(newTriangle);\n\n        if (src.onBeforeRender) {\n          dst.onBeforeRender = src.onBeforeRender;\n        }\n\n        dst.bind(new THREE.Skeleton(src.skeleton.bones, src.skeleton.boneInverses), new THREE.Matrix4());\n        return dst;\n      };\n\n      VRMFirstPerson.prototype._createHeadlessModelForSkinnedMesh = function (parent, mesh) {\n        var _this = this;\n\n        var eraseBoneIndexes = [];\n        mesh.skeleton.bones.forEach(function (bone, index) {\n          if (_this._isEraseTarget(bone)) eraseBoneIndexes.push(index);\n        });\n\n        if (!eraseBoneIndexes.length) {\n          mesh.layers.enable(this._thirdPersonOnlyLayer);\n          mesh.layers.enable(this._firstPersonOnlyLayer);\n          return;\n        }\n\n        mesh.layers.set(this._thirdPersonOnlyLayer);\n\n        var newMesh = this._createErasedMesh(mesh, eraseBoneIndexes);\n\n        parent.add(newMesh);\n      };\n\n      VRMFirstPerson.prototype._createHeadlessModel = function (node) {\n        var _this = this;\n\n        if (node.type === 'Group') {\n          node.layers.set(this._thirdPersonOnlyLayer);\n\n          if (this._isEraseTarget(node)) {\n            node.traverse(function (child) {\n              return child.layers.set(_this._thirdPersonOnlyLayer);\n            });\n          } else {\n            var parent_1 = new THREE.Group();\n            parent_1.name = \"_headless_\" + node.name;\n            parent_1.layers.set(this._firstPersonOnlyLayer);\n            node.parent.add(parent_1);\n            node.children.filter(function (child) {\n              return child.type === 'SkinnedMesh';\n            }).forEach(function (child) {\n              _this._createHeadlessModelForSkinnedMesh(parent_1, child);\n            });\n          }\n        } else if (node.type === 'SkinnedMesh') {\n          this._createHeadlessModelForSkinnedMesh(node.parent, node);\n        } else {\n          if (this._isEraseTarget(node)) {\n            node.layers.set(this._thirdPersonOnlyLayer);\n            node.traverse(function (child) {\n              return child.layers.set(_this._thirdPersonOnlyLayer);\n            });\n          }\n        }\n      };\n\n      VRMFirstPerson.prototype._isEraseTarget = function (bone) {\n        if (bone.name === this._firstPersonBone.name) {\n          return true;\n        } else if (!bone.parent) {\n          return false;\n        } else {\n          return this._isEraseTarget(bone.parent);\n        }\n      };\n\n      VRMFirstPerson._DEFAULT_FIRSTPERSON_ONLY_LAYER = 9;\n      VRMFirstPerson._DEFAULT_THIRDPERSON_ONLY_LAYER = 10;\n      return VRMFirstPerson;\n    }();\n\n    exports.VRMFirstPerson = VRMFirstPerson;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/firstperson/VRMFirstPersonImporter.ts\":\n  /*!*******************************************************!*\\\r\n    !*** ./src/vrm/firstperson/VRMFirstPersonImporter.ts ***!\r\n    \\*******************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var types_1 = __webpack_require__(\n    /*! ../types */\n    \"./src/vrm/types/index.ts\");\n\n    var VRMFirstPerson_1 = __webpack_require__(\n    /*! ./VRMFirstPerson */\n    \"./src/vrm/firstperson/VRMFirstPerson.ts\");\n\n    var VRMFirstPersonImporter = function () {\n      function VRMFirstPersonImporter() {}\n\n      VRMFirstPersonImporter.prototype.import = function (gltf, humanoid) {\n        return __awaiter(this, void 0, Promise, function () {\n          var vrmExt, schemaFirstPerson, firstPersonBoneIndex, firstPersonBone, firstPersonBoneOffset, meshAnnotations, meshes;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                vrmExt = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n\n                if (!vrmExt) {\n                  return [2, null];\n                }\n\n                schemaFirstPerson = vrmExt.firstPerson;\n\n                if (!schemaFirstPerson) {\n                  return [2, null];\n                }\n\n                firstPersonBoneIndex = schemaFirstPerson.firstPersonBone;\n                if (!(firstPersonBoneIndex === undefined || firstPersonBoneIndex === -1)) return [3, 1];\n                firstPersonBone = humanoid.getBoneNode(types_1.VRMSchema.HumanoidBoneName.Head);\n                return [3, 3];\n\n              case 1:\n                return [4, gltf.parser.getDependency('node', firstPersonBoneIndex)];\n\n              case 2:\n                firstPersonBone = _a.sent();\n                _a.label = 3;\n\n              case 3:\n                if (!firstPersonBone) {\n                  console.warn('VRMFirstPersonImporter: Could not find firstPersonBone of the VRM');\n                  return [2, null];\n                }\n\n                firstPersonBoneOffset = schemaFirstPerson.firstPersonBoneOffset ? new THREE.Vector3(schemaFirstPerson.firstPersonBoneOffset.x, schemaFirstPerson.firstPersonBoneOffset.y, schemaFirstPerson.firstPersonBoneOffset.z) : new THREE.Vector3(0.0, 0.06, 0.0);\n                meshAnnotations = [];\n                return [4, gltf.parser.getDependencies('mesh')];\n\n              case 4:\n                meshes = _a.sent();\n                meshes.forEach(function (mesh, meshIndex) {\n                  var flag = schemaFirstPerson.meshAnnotations ? schemaFirstPerson.meshAnnotations.find(function (a) {\n                    return a.mesh === meshIndex;\n                  }) : undefined;\n                  meshAnnotations.push(new VRMFirstPerson_1.VRMRendererFirstPersonFlags(flag && flag.firstPersonFlag, mesh));\n                });\n                return [2, new VRMFirstPerson_1.VRMFirstPerson(firstPersonBone, firstPersonBoneOffset, meshAnnotations)];\n            }\n          });\n        });\n      };\n\n      return VRMFirstPersonImporter;\n    }();\n\n    exports.VRMFirstPersonImporter = VRMFirstPersonImporter;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/firstperson/index.ts\":\n  /*!**************************************!*\\\r\n    !*** ./src/vrm/firstperson/index.ts ***!\r\n    \\**************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./VRMFirstPerson */\n    \"./src/vrm/firstperson/VRMFirstPerson.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMFirstPersonImporter */\n    \"./src/vrm/firstperson/VRMFirstPersonImporter.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/humanoid/VRMHumanBone.ts\":\n  /*!******************************************!*\\\r\n    !*** ./src/vrm/humanoid/VRMHumanBone.ts ***!\r\n    \\******************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var VRMHumanBone = function () {\n      function VRMHumanBone(node, humanLimit) {\n        this.node = node;\n        this.humanLimit = humanLimit;\n      }\n\n      return VRMHumanBone;\n    }();\n\n    exports.VRMHumanBone = VRMHumanBone;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/humanoid/VRMHumanBones.ts\":\n  /*!*******************************************!*\\\r\n    !*** ./src/vrm/humanoid/VRMHumanBones.ts ***!\r\n    \\*******************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/humanoid/VRMHumanDescription.ts\":\n  /*!*************************************************!*\\\r\n    !*** ./src/vrm/humanoid/VRMHumanDescription.ts ***!\r\n    \\*************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/humanoid/VRMHumanLimit.ts\":\n  /*!*******************************************!*\\\r\n    !*** ./src/vrm/humanoid/VRMHumanLimit.ts ***!\r\n    \\*******************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/humanoid/VRMHumanoid.ts\":\n  /*!*****************************************!*\\\r\n    !*** ./src/vrm/humanoid/VRMHumanoid.ts ***!\r\n    \\*****************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var types_1 = __webpack_require__(\n    /*! ../types */\n    \"./src/vrm/types/index.ts\");\n\n    var VRMHumanoid = function () {\n      function VRMHumanoid(boneArray, humanDescription) {\n        this.humanBones = this._createHumanBones(boneArray);\n        this.humanDescription = humanDescription;\n        this.restPose = this.getPose();\n      }\n\n      VRMHumanoid.prototype.getPose = function () {\n        var _this = this;\n\n        var pose = {};\n        Object.keys(this.humanBones).forEach(function (vrmBoneName) {\n          var node = _this.getBoneNode(vrmBoneName);\n\n          if (!node) {\n            return;\n          }\n\n          if (pose[vrmBoneName]) {\n            return;\n          }\n\n          pose[vrmBoneName] = {\n            position: node.position.toArray(),\n            rotation: node.quaternion.toArray()\n          };\n        }, {});\n        return pose;\n      };\n\n      VRMHumanoid.prototype.setPose = function (poseObject) {\n        var _this = this;\n\n        Object.keys(poseObject).forEach(function (boneName) {\n          var state = poseObject[boneName];\n\n          var node = _this.getBoneNode(boneName);\n\n          if (!node) {\n            return;\n          }\n\n          var restState = _this.restPose[boneName];\n\n          if (!restState) {\n            return;\n          }\n\n          if (state.position) {\n            node.position.set(restState.position[0] + state.position[0], restState.position[1] + state.position[1], restState.position[2] + state.position[2]);\n          }\n\n          if (state.rotation) {\n            node.quaternion.fromArray(state.rotation);\n          }\n        });\n      };\n\n      VRMHumanoid.prototype.getBone = function (name) {\n        return this.humanBones[name][0] || undefined;\n      };\n\n      VRMHumanoid.prototype.getBones = function (name) {\n        return this.humanBones[name];\n      };\n\n      VRMHumanoid.prototype.getBoneNode = function (name) {\n        return this.humanBones[name][0] && this.humanBones[name][0].node || null;\n      };\n\n      VRMHumanoid.prototype.getBoneNodes = function (name) {\n        return this.humanBones[name].map(function (bone) {\n          return bone.node;\n        });\n      };\n\n      VRMHumanoid.prototype._createHumanBones = function (boneArray) {\n        var bones = Object.values(types_1.VRMSchema.HumanoidBoneName).reduce(function (accum, name) {\n          accum[name] = [];\n          return accum;\n        }, {});\n        boneArray.forEach(function (bone) {\n          bones[bone.name].push(bone.bone);\n        });\n        return bones;\n      };\n\n      return VRMHumanoid;\n    }();\n\n    exports.VRMHumanoid = VRMHumanoid;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/humanoid/VRMHumanoidImporter.ts\":\n  /*!*************************************************!*\\\r\n    !*** ./src/vrm/humanoid/VRMHumanoidImporter.ts ***!\r\n    \\*************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var VRMHumanBone_1 = __webpack_require__(\n    /*! ./VRMHumanBone */\n    \"./src/vrm/humanoid/VRMHumanBone.ts\");\n\n    var VRMHumanoid_1 = __webpack_require__(\n    /*! ./VRMHumanoid */\n    \"./src/vrm/humanoid/VRMHumanoid.ts\");\n\n    var VRMHumanoidImporter = function () {\n      function VRMHumanoidImporter() {}\n\n      VRMHumanoidImporter.prototype.import = function (gltf) {\n        return __awaiter(this, void 0, Promise, function () {\n          var vrmExt, schemaHumanoid, humanBoneArray, humanDescription;\n\n          var _this = this;\n\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                vrmExt = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n\n                if (!vrmExt) {\n                  return [2, null];\n                }\n\n                schemaHumanoid = vrmExt.humanoid;\n\n                if (!schemaHumanoid) {\n                  return [2, null];\n                }\n\n                humanBoneArray = [];\n                if (!schemaHumanoid.humanBones) return [3, 2];\n                return [4, Promise.all(schemaHumanoid.humanBones.map(function (bone) {\n                  return __awaiter(_this, void 0, void 0, function () {\n                    var node;\n                    return __generator(this, function (_a) {\n                      switch (_a.label) {\n                        case 0:\n                          if (!bone.bone || !bone.node) {\n                            return [2];\n                          }\n\n                          return [4, gltf.parser.getDependency('node', bone.node)];\n\n                        case 1:\n                          node = _a.sent();\n                          humanBoneArray.push({\n                            name: bone.bone,\n                            bone: new VRMHumanBone_1.VRMHumanBone(node, {\n                              axisLength: bone.axisLength,\n                              center: bone.center && new THREE.Vector3(bone.center.x, bone.center.y, bone.center.z),\n                              max: bone.max && new THREE.Vector3(bone.max.x, bone.max.y, bone.max.z),\n                              min: bone.min && new THREE.Vector3(bone.min.x, bone.min.y, bone.min.z),\n                              useDefaultValues: bone.useDefaultValues\n                            })\n                          });\n                          return [2];\n                      }\n                    });\n                  });\n                }))];\n\n              case 1:\n                _a.sent();\n\n                _a.label = 2;\n\n              case 2:\n                humanDescription = {\n                  armStretch: schemaHumanoid.armStretch,\n                  legStretch: schemaHumanoid.legStretch,\n                  upperArmTwist: schemaHumanoid.upperArmTwist,\n                  lowerArmTwist: schemaHumanoid.lowerArmTwist,\n                  upperLegTwist: schemaHumanoid.upperLegTwist,\n                  lowerLegTwist: schemaHumanoid.lowerLegTwist,\n                  feetSpacing: schemaHumanoid.feetSpacing,\n                  hasTranslationDoF: schemaHumanoid.hasTranslationDoF\n                };\n                return [2, new VRMHumanoid_1.VRMHumanoid(humanBoneArray, humanDescription)];\n            }\n          });\n        });\n      };\n\n      return VRMHumanoidImporter;\n    }();\n\n    exports.VRMHumanoidImporter = VRMHumanoidImporter;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/humanoid/index.ts\":\n  /*!***********************************!*\\\r\n    !*** ./src/vrm/humanoid/index.ts ***!\r\n    \\***********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./VRMHumanBone */\n    \"./src/vrm/humanoid/VRMHumanBone.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMHumanBones */\n    \"./src/vrm/humanoid/VRMHumanBones.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMHumanDescription */\n    \"./src/vrm/humanoid/VRMHumanDescription.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMHumanLimit */\n    \"./src/vrm/humanoid/VRMHumanLimit.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMHumanoid */\n    \"./src/vrm/humanoid/VRMHumanoid.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMHumanoidImporter */\n    \"./src/vrm/humanoid/VRMHumanoidImporter.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/index.ts\":\n  /*!**************************!*\\\r\n    !*** ./src/vrm/index.ts ***!\r\n    \\**************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./VRM */\n    \"./src/vrm/VRM.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMImporter */\n    \"./src/vrm/VRMImporter.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./reduceBones */\n    \"./src/vrm/reduceBones.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./blendshape */\n    \"./src/vrm/blendshape/index.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./debug */\n    \"./src/vrm/debug/index.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./firstperson */\n    \"./src/vrm/firstperson/index.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./humanoid */\n    \"./src/vrm/humanoid/index.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./lookat */\n    \"./src/vrm/lookat/index.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./springbone */\n    \"./src/vrm/springbone/index.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./types */\n    \"./src/vrm/types/index.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./material */\n    \"./src/vrm/material/index.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/lookat/CurveMapper.ts\":\n  /*!***************************************!*\\\r\n    !*** ./src/vrm/lookat/CurveMapper.ts ***!\r\n    \\***************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var hermiteSpline = function (y0, y1, t0, t1, x) {\n      var xc = x * x * x;\n      var xs = x * x;\n      var dy = y1 - y0;\n      var h01 = -2.0 * xc + 3.0 * xs;\n      var h10 = xc - 2.0 * xs + x;\n      var h11 = xc - xs;\n      return y0 + dy * h01 + t0 * h10 + t1 * h11;\n    };\n\n    var evaluateCurve = function (arr, x) {\n      if (arr.length < 8) {\n        throw new Error('evaluateCurve: Invalid curve detected! (Array length must be 8 at least)');\n      }\n\n      if (arr.length % 4 !== 0) {\n        throw new Error('evaluateCurve: Invalid curve detected! (Array length must be multiples of 4');\n      }\n\n      var outNode;\n\n      for (outNode = 0;; outNode++) {\n        if (arr.length <= 4 * outNode) {\n          return arr[4 * outNode - 3];\n        } else if (x <= arr[4 * outNode]) {\n          break;\n        }\n      }\n\n      var inNode = outNode - 1;\n\n      if (inNode < 0) {\n        return arr[4 * inNode + 5];\n      }\n\n      var x0 = arr[4 * inNode];\n      var x1 = arr[4 * outNode];\n      var xHermite = (x - x0) / (x1 - x0);\n      var y0 = arr[4 * inNode + 1];\n      var y1 = arr[4 * outNode + 1];\n      var t0 = arr[4 * inNode + 3];\n      var t1 = arr[4 * outNode + 2];\n      return hermiteSpline(y0, y1, t0, t1, xHermite);\n    };\n\n    var CurveMapper = function () {\n      function CurveMapper(xRange, yRange, curve) {\n        this.curve = [0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0];\n        this.curveXRangeDegree = 90.0;\n        this.curveYRangeDegree = 10.0;\n\n        if (xRange !== undefined) {\n          this.curveXRangeDegree = xRange;\n        }\n\n        if (yRange !== undefined) {\n          this.curveYRangeDegree = yRange;\n        }\n\n        if (curve !== undefined) {\n          this.curve = curve;\n        }\n      }\n\n      CurveMapper.prototype.map = function (src) {\n        var clampedSrc = Math.min(Math.max(src, 0.0), this.curveXRangeDegree);\n        var x = clampedSrc / this.curveXRangeDegree;\n        return this.curveYRangeDegree * evaluateCurve(this.curve, x);\n      };\n\n      return CurveMapper;\n    }();\n\n    exports.CurveMapper = CurveMapper;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/lookat/VRMLookAtApplyer.ts\":\n  /*!********************************************!*\\\r\n    !*** ./src/vrm/lookat/VRMLookAtApplyer.ts ***!\r\n    \\********************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var VRMLookAtApplyer = function () {\n      function VRMLookAtApplyer() {}\n\n      return VRMLookAtApplyer;\n    }();\n\n    exports.VRMLookAtApplyer = VRMLookAtApplyer;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/lookat/VRMLookAtBlendShapeApplyer.ts\":\n  /*!******************************************************!*\\\r\n    !*** ./src/vrm/lookat/VRMLookAtBlendShapeApplyer.ts ***!\r\n    \\******************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var types_1 = __webpack_require__(\n    /*! ../types */\n    \"./src/vrm/types/index.ts\");\n\n    var VRMLookAtApplyer_1 = __webpack_require__(\n    /*! ./VRMLookAtApplyer */\n    \"./src/vrm/lookat/VRMLookAtApplyer.ts\");\n\n    var VRMLookAtBlendShapeApplyer = function (_super) {\n      __extends(VRMLookAtBlendShapeApplyer, _super);\n\n      function VRMLookAtBlendShapeApplyer(blendShapeProxy, curveHorizontal, curveVerticalDown, curveVerticalUp) {\n        var _this = _super.call(this) || this;\n\n        _this.type = types_1.VRMSchema.FirstPersonLookAtTypeName.BlendShape;\n        _this._curveHorizontal = curveHorizontal;\n        _this._curveVerticalDown = curveVerticalDown;\n        _this._curveVerticalUp = curveVerticalUp;\n        _this._blendShapeProxy = blendShapeProxy;\n        return _this;\n      }\n\n      VRMLookAtBlendShapeApplyer.prototype.name = function () {\n        return types_1.VRMSchema.FirstPersonLookAtTypeName.BlendShape;\n      };\n\n      VRMLookAtBlendShapeApplyer.prototype.lookAt = function (euler) {\n        var srcX = euler.x;\n        var srcY = euler.y;\n\n        if (srcX < 0.0) {\n          this._blendShapeProxy.setValue(types_1.VRMSchema.BlendShapePresetName.Lookup, 0.0);\n\n          this._blendShapeProxy.setValue(types_1.VRMSchema.BlendShapePresetName.Lookdown, this._curveVerticalDown.map(-srcX));\n        } else {\n          this._blendShapeProxy.setValue(types_1.VRMSchema.BlendShapePresetName.Lookdown, 0.0);\n\n          this._blendShapeProxy.setValue(types_1.VRMSchema.BlendShapePresetName.Lookup, this._curveVerticalUp.map(srcX));\n        }\n\n        if (srcY < 0.0) {\n          this._blendShapeProxy.setValue(types_1.VRMSchema.BlendShapePresetName.Lookleft, 0.0);\n\n          this._blendShapeProxy.setValue(types_1.VRMSchema.BlendShapePresetName.Lookright, this._curveHorizontal.map(-srcY));\n        } else {\n          this._blendShapeProxy.setValue(types_1.VRMSchema.BlendShapePresetName.Lookright, 0.0);\n\n          this._blendShapeProxy.setValue(types_1.VRMSchema.BlendShapePresetName.Lookleft, this._curveHorizontal.map(srcY));\n        }\n      };\n\n      return VRMLookAtBlendShapeApplyer;\n    }(VRMLookAtApplyer_1.VRMLookAtApplyer);\n\n    exports.VRMLookAtBlendShapeApplyer = VRMLookAtBlendShapeApplyer;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/lookat/VRMLookAtBoneApplyer.ts\":\n  /*!************************************************!*\\\r\n    !*** ./src/vrm/lookat/VRMLookAtBoneApplyer.ts ***!\r\n    \\************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var types_1 = __webpack_require__(\n    /*! ../types */\n    \"./src/vrm/types/index.ts\");\n\n    var VRMLookAtApplyer_1 = __webpack_require__(\n    /*! ./VRMLookAtApplyer */\n    \"./src/vrm/lookat/VRMLookAtApplyer.ts\");\n\n    var VRMLookAtHead_1 = __webpack_require__(\n    /*! ./VRMLookAtHead */\n    \"./src/vrm/lookat/VRMLookAtHead.ts\");\n\n    var _euler = new THREE.Euler(0.0, 0.0, 0.0, VRMLookAtHead_1.VRMLookAtHead.EULER_ORDER);\n\n    var VRMLookAtBoneApplyer = function (_super) {\n      __extends(VRMLookAtBoneApplyer, _super);\n\n      function VRMLookAtBoneApplyer(humanoid, curveHorizontalInner, curveHorizontalOuter, curveVerticalDown, curveVerticalUp) {\n        var _this = _super.call(this) || this;\n\n        _this.type = types_1.VRMSchema.FirstPersonLookAtTypeName.Bone;\n        _this._curveHorizontalInner = curveHorizontalInner;\n        _this._curveHorizontalOuter = curveHorizontalOuter;\n        _this._curveVerticalDown = curveVerticalDown;\n        _this._curveVerticalUp = curveVerticalUp;\n        _this._leftEye = humanoid.getBoneNode(types_1.VRMSchema.HumanoidBoneName.LeftEye);\n        _this._rightEye = humanoid.getBoneNode(types_1.VRMSchema.HumanoidBoneName.RightEye);\n        return _this;\n      }\n\n      VRMLookAtBoneApplyer.prototype.lookAt = function (euler) {\n        var srcX = euler.x;\n        var srcY = euler.y;\n\n        if (this._leftEye) {\n          if (srcX < 0.0) {\n            _euler.x = -this._curveVerticalDown.map(-srcX);\n          } else {\n            _euler.x = this._curveVerticalUp.map(srcX);\n          }\n\n          if (srcY < 0.0) {\n            _euler.y = -this._curveHorizontalInner.map(-srcY);\n          } else {\n            _euler.y = this._curveHorizontalOuter.map(srcY);\n          }\n\n          this._leftEye.quaternion.setFromEuler(_euler);\n        }\n\n        if (this._rightEye) {\n          if (srcX < 0.0) {\n            _euler.x = -this._curveVerticalDown.map(-srcX);\n          } else {\n            _euler.x = this._curveVerticalUp.map(srcX);\n          }\n\n          if (srcY < 0.0) {\n            _euler.y = -this._curveHorizontalOuter.map(-srcY);\n          } else {\n            _euler.y = this._curveHorizontalInner.map(srcY);\n          }\n\n          this._rightEye.quaternion.setFromEuler(_euler);\n        }\n      };\n\n      return VRMLookAtBoneApplyer;\n    }(VRMLookAtApplyer_1.VRMLookAtApplyer);\n\n    exports.VRMLookAtBoneApplyer = VRMLookAtBoneApplyer;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/lookat/VRMLookAtHead.ts\":\n  /*!*****************************************!*\\\r\n    !*** ./src/vrm/lookat/VRMLookAtHead.ts ***!\r\n    \\*****************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var math_1 = __webpack_require__(\n    /*! ../utils/math */\n    \"./src/vrm/utils/math.ts\");\n\n    var VECTOR3_FRONT = Object.freeze(new THREE.Vector3(0.0, 0.0, -1.0));\n\n    var _v3A = new THREE.Vector3();\n\n    var _v3B = new THREE.Vector3();\n\n    var _v3C = new THREE.Vector3();\n\n    var _quat = new THREE.Quaternion();\n\n    var VRMLookAtHead = function () {\n      function VRMLookAtHead(firstPerson, applyer) {\n        this.autoUpdate = true;\n        this._euler = new THREE.Euler(0.0, 0.0, 0.0, VRMLookAtHead.EULER_ORDER);\n        this.firstPerson = firstPerson;\n        this.applyer = applyer;\n      }\n\n      VRMLookAtHead.prototype.getLookAtWorldDirection = function (target) {\n        var rot = math_1.getWorldQuaternionLite(this.firstPerson.firstPersonBone, _quat);\n        return target.copy(VECTOR3_FRONT).applyEuler(this._euler).applyQuaternion(rot);\n      };\n\n      VRMLookAtHead.prototype.lookAt = function (position) {\n        this._calcEuler(this._euler, position);\n\n        if (this.applyer) {\n          this.applyer.lookAt(this._euler);\n        }\n      };\n\n      VRMLookAtHead.prototype.update = function (delta) {\n        if (this.target && this.autoUpdate) {\n          this.lookAt(this.target.getWorldPosition(_v3A));\n\n          if (this.applyer) {\n            this.applyer.lookAt(this._euler);\n          }\n        }\n      };\n\n      VRMLookAtHead.prototype._calcEuler = function (target, position) {\n        var headPosition = this.firstPerson.getFirstPersonWorldPosition(_v3B);\n\n        var lookAtDir = _v3C.copy(position).sub(headPosition).normalize();\n\n        lookAtDir.applyQuaternion(math_1.getWorldQuaternionLite(this.firstPerson.firstPersonBone, _quat).inverse());\n        target.x = Math.atan2(lookAtDir.y, Math.sqrt(lookAtDir.x * lookAtDir.x + lookAtDir.z * lookAtDir.z));\n        target.y = Math.atan2(-lookAtDir.x, -lookAtDir.z);\n        return target;\n      };\n\n      VRMLookAtHead.EULER_ORDER = 'YXZ';\n      return VRMLookAtHead;\n    }();\n\n    exports.VRMLookAtHead = VRMLookAtHead;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/lookat/VRMLookAtImporter.ts\":\n  /*!*********************************************!*\\\r\n    !*** ./src/vrm/lookat/VRMLookAtImporter.ts ***!\r\n    \\*********************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var types_1 = __webpack_require__(\n    /*! ../types */\n    \"./src/vrm/types/index.ts\");\n\n    var CurveMapper_1 = __webpack_require__(\n    /*! ./CurveMapper */\n    \"./src/vrm/lookat/CurveMapper.ts\");\n\n    var VRMLookAtBlendShapeApplyer_1 = __webpack_require__(\n    /*! ./VRMLookAtBlendShapeApplyer */\n    \"./src/vrm/lookat/VRMLookAtBlendShapeApplyer.ts\");\n\n    var VRMLookAtBoneApplyer_1 = __webpack_require__(\n    /*! ./VRMLookAtBoneApplyer */\n    \"./src/vrm/lookat/VRMLookAtBoneApplyer.ts\");\n\n    var VRMLookAtHead_1 = __webpack_require__(\n    /*! ./VRMLookAtHead */\n    \"./src/vrm/lookat/VRMLookAtHead.ts\");\n\n    var VRMLookAtImporter = function () {\n      function VRMLookAtImporter() {}\n\n      VRMLookAtImporter.prototype.import = function (gltf, firstPerson, blendShapeProxy, humanoid) {\n        var vrmExt = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n\n        if (!vrmExt) {\n          return null;\n        }\n\n        var schemaFirstPerson = vrmExt.firstPerson;\n\n        if (!schemaFirstPerson) {\n          return null;\n        }\n\n        var applyer = this._importApplyer(schemaFirstPerson, blendShapeProxy, humanoid);\n\n        return new VRMLookAtHead_1.VRMLookAtHead(firstPerson, applyer || undefined);\n      };\n\n      VRMLookAtImporter.prototype._importApplyer = function (schemaFirstPerson, blendShapeProxy, humanoid) {\n        var lookAtHorizontalInner = schemaFirstPerson.lookAtHorizontalInner;\n        var lookAtHorizontalOuter = schemaFirstPerson.lookAtHorizontalOuter;\n        var lookAtVerticalDown = schemaFirstPerson.lookAtVerticalDown;\n        var lookAtVerticalUp = schemaFirstPerson.lookAtVerticalUp;\n\n        switch (schemaFirstPerson.lookAtTypeName) {\n          case types_1.VRMSchema.FirstPersonLookAtTypeName.Bone:\n            {\n              if (lookAtHorizontalInner === undefined || lookAtHorizontalOuter === undefined || lookAtVerticalDown === undefined || lookAtVerticalUp === undefined) {\n                return null;\n              } else {\n                return new VRMLookAtBoneApplyer_1.VRMLookAtBoneApplyer(humanoid, this._importCurveMapperBone(lookAtHorizontalInner), this._importCurveMapperBone(lookAtHorizontalOuter), this._importCurveMapperBone(lookAtVerticalDown), this._importCurveMapperBone(lookAtVerticalUp));\n              }\n            }\n\n          case types_1.VRMSchema.FirstPersonLookAtTypeName.BlendShape:\n            {\n              if (lookAtHorizontalOuter === undefined || lookAtVerticalDown === undefined || lookAtVerticalUp === undefined) {\n                return null;\n              } else {\n                return new VRMLookAtBlendShapeApplyer_1.VRMLookAtBlendShapeApplyer(blendShapeProxy, this._importCurveMapperBlendShape(lookAtHorizontalOuter), this._importCurveMapperBlendShape(lookAtVerticalDown), this._importCurveMapperBlendShape(lookAtVerticalUp));\n              }\n            }\n\n          default:\n            {\n              return null;\n            }\n        }\n      };\n\n      VRMLookAtImporter.prototype._importCurveMapperBone = function (map) {\n        return new CurveMapper_1.CurveMapper(typeof map.xRange === 'number' ? THREE.Math.DEG2RAD * map.xRange : undefined, typeof map.yRange === 'number' ? THREE.Math.DEG2RAD * map.yRange : undefined, map.curve);\n      };\n\n      VRMLookAtImporter.prototype._importCurveMapperBlendShape = function (map) {\n        return new CurveMapper_1.CurveMapper(typeof map.xRange === 'number' ? THREE.Math.DEG2RAD * map.xRange : undefined, map.yRange, map.curve);\n      };\n\n      return VRMLookAtImporter;\n    }();\n\n    exports.VRMLookAtImporter = VRMLookAtImporter;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/lookat/index.ts\":\n  /*!*********************************!*\\\r\n    !*** ./src/vrm/lookat/index.ts ***!\r\n    \\*********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./CurveMapper */\n    \"./src/vrm/lookat/CurveMapper.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMLookAtApplyer */\n    \"./src/vrm/lookat/VRMLookAtApplyer.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMLookAtBlendShapeApplyer */\n    \"./src/vrm/lookat/VRMLookAtBlendShapeApplyer.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMLookAtBoneApplyer */\n    \"./src/vrm/lookat/VRMLookAtBoneApplyer.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMLookAtHead */\n    \"./src/vrm/lookat/VRMLookAtHead.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMLookAtImporter */\n    \"./src/vrm/lookat/VRMLookAtImporter.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/material/MToonMaterial.ts\":\n  /*!*******************************************!*\\\r\n    !*** ./src/vrm/material/MToonMaterial.ts ***!\r\n    \\*******************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var getTexelDecodingFunction_1 = __webpack_require__(\n    /*! ./getTexelDecodingFunction */\n    \"./src/vrm/material/getTexelDecodingFunction.ts\");\n\n    var mtoon_vert_1 = __webpack_require__(\n    /*! ./shaders/mtoon.vert */\n    \"./src/vrm/material/shaders/mtoon.vert\");\n\n    var mtoon_frag_1 = __webpack_require__(\n    /*! ./shaders/mtoon.frag */\n    \"./src/vrm/material/shaders/mtoon.frag\");\n\n    var TAU = 2.0 * Math.PI;\n    var MToonMaterialCullMode;\n\n    (function (MToonMaterialCullMode) {\n      MToonMaterialCullMode[MToonMaterialCullMode[\"Off\"] = 0] = \"Off\";\n      MToonMaterialCullMode[MToonMaterialCullMode[\"Front\"] = 1] = \"Front\";\n      MToonMaterialCullMode[MToonMaterialCullMode[\"Back\"] = 2] = \"Back\";\n    })(MToonMaterialCullMode = exports.MToonMaterialCullMode || (exports.MToonMaterialCullMode = {}));\n\n    var MToonMaterialDebugMode;\n\n    (function (MToonMaterialDebugMode) {\n      MToonMaterialDebugMode[MToonMaterialDebugMode[\"None\"] = 0] = \"None\";\n      MToonMaterialDebugMode[MToonMaterialDebugMode[\"Normal\"] = 1] = \"Normal\";\n      MToonMaterialDebugMode[MToonMaterialDebugMode[\"LitShadeRate\"] = 2] = \"LitShadeRate\";\n      MToonMaterialDebugMode[MToonMaterialDebugMode[\"UV\"] = 3] = \"UV\";\n    })(MToonMaterialDebugMode = exports.MToonMaterialDebugMode || (exports.MToonMaterialDebugMode = {}));\n\n    var MToonMaterialOutlineColorMode;\n\n    (function (MToonMaterialOutlineColorMode) {\n      MToonMaterialOutlineColorMode[MToonMaterialOutlineColorMode[\"FixedColor\"] = 0] = \"FixedColor\";\n      MToonMaterialOutlineColorMode[MToonMaterialOutlineColorMode[\"MixedLighting\"] = 1] = \"MixedLighting\";\n    })(MToonMaterialOutlineColorMode = exports.MToonMaterialOutlineColorMode || (exports.MToonMaterialOutlineColorMode = {}));\n\n    var MToonMaterialOutlineWidthMode;\n\n    (function (MToonMaterialOutlineWidthMode) {\n      MToonMaterialOutlineWidthMode[MToonMaterialOutlineWidthMode[\"None\"] = 0] = \"None\";\n      MToonMaterialOutlineWidthMode[MToonMaterialOutlineWidthMode[\"WorldCoordinates\"] = 1] = \"WorldCoordinates\";\n      MToonMaterialOutlineWidthMode[MToonMaterialOutlineWidthMode[\"ScreenCoordinates\"] = 2] = \"ScreenCoordinates\";\n    })(MToonMaterialOutlineWidthMode = exports.MToonMaterialOutlineWidthMode || (exports.MToonMaterialOutlineWidthMode = {}));\n\n    var MToonMaterialRenderMode;\n\n    (function (MToonMaterialRenderMode) {\n      MToonMaterialRenderMode[MToonMaterialRenderMode[\"Opaque\"] = 0] = \"Opaque\";\n      MToonMaterialRenderMode[MToonMaterialRenderMode[\"Cutout\"] = 1] = \"Cutout\";\n      MToonMaterialRenderMode[MToonMaterialRenderMode[\"Transparent\"] = 2] = \"Transparent\";\n      MToonMaterialRenderMode[MToonMaterialRenderMode[\"TransparentWithZWrite\"] = 3] = \"TransparentWithZWrite\";\n    })(MToonMaterialRenderMode = exports.MToonMaterialRenderMode || (exports.MToonMaterialRenderMode = {}));\n\n    var MToonMaterial = function (_super) {\n      __extends(MToonMaterial, _super);\n\n      function MToonMaterial(colorSpaceGamma, parameters) {\n        var _this = _super.call(this) || this;\n\n        _this.isMToonMaterial = true;\n        _this.cutoff = 0.5;\n        _this.color = new THREE.Vector4(1.0, 1.0, 1.0, 1.0);\n        _this.shadeColor = new THREE.Vector4(0.97, 0.81, 0.86, 1.0);\n        _this.map = null;\n        _this.mainTex_ST = new THREE.Vector4(0.0, 0.0, 1.0, 1.0);\n        _this.shadeTexture = null;\n        _this.bumpScale = 1.0;\n        _this.normalMap = null;\n        _this.receiveShadowRate = 1.0;\n        _this.receiveShadowTexture = null;\n        _this.shadingGradeRate = 1.0;\n        _this.shadingGradeTexture = null;\n        _this.shadeShift = 0.0;\n        _this.shadeToony = 0.9;\n        _this.lightColorAttenuation = 0.0;\n        _this.indirectLightIntensity = 0.1;\n        _this.rimTexture = null;\n        _this.rimColor = new THREE.Vector4(0.0, 0.0, 0.0, 1.0);\n        _this.rimLightingMix = 0.0;\n        _this.rimFresnelPower = 1.0;\n        _this.rimLift = 0.0;\n        _this.sphereAdd = null;\n        _this.emissionColor = new THREE.Vector4(0.0, 0.0, 0.0, 1.0);\n        _this.emissiveMap = null;\n        _this.outlineWidthTexture = null;\n        _this.outlineWidth = 0.5;\n        _this.outlineScaledMaxDistance = 1.0;\n        _this.outlineColor = new THREE.Vector4(0.0, 0.0, 0.0, 1.0);\n        _this.outlineLightingMix = 1.0;\n        _this.uvAnimMaskTexture = null;\n        _this.uvAnimScrollX = 0.0;\n        _this.uvAnimScrollY = 0.0;\n        _this.uvAnimRotation = 0.0;\n        _this.shouldApplyUniforms = true;\n        _this._debugMode = MToonMaterialDebugMode.None;\n        _this._blendMode = MToonMaterialRenderMode.Opaque;\n        _this._outlineWidthMode = MToonMaterialOutlineWidthMode.None;\n        _this._outlineColorMode = MToonMaterialOutlineColorMode.FixedColor;\n        _this._cullMode = MToonMaterialCullMode.Back;\n        _this._outlineCullMode = MToonMaterialCullMode.Front;\n        _this._isOutline = false;\n        _this._uvAnimOffsetX = 0.0;\n        _this._uvAnimOffsetY = 0.0;\n        _this._uvAnimPhase = 0.0;\n        _this._colorSpaceGamma = colorSpaceGamma;\n\n        if (parameters === undefined) {\n          parameters = {};\n        }\n\n        ['mToonVersion', 'shadeTexture_ST', 'bumpMap_ST', 'receiveShadowTexture_ST', 'shadingGradeTexture_ST', 'sphereAdd_ST', 'emissionMap_ST', 'outlineWidthTexture_ST', 'srcBlend', 'dstBlend'].forEach(function (key) {\n          if (parameters[key] !== undefined) {\n            delete parameters[key];\n          }\n        });\n        parameters.fog = true;\n        parameters.lights = true;\n        parameters.clipping = true;\n        parameters.skinning = parameters.skinning || false;\n        parameters.morphTargets = parameters.morphTargets || false;\n        parameters.morphNormals = parameters.morphNormals || false;\n        parameters.uniforms = THREE.UniformsUtils.merge([THREE.UniformsLib.common, THREE.UniformsLib.normalmap, THREE.UniformsLib.emissivemap, THREE.UniformsLib.fog, THREE.UniformsLib.lights, {\n          cutoff: {\n            value: 0.5\n          },\n          color: {\n            value: new THREE.Color(1.0, 1.0, 1.0)\n          },\n          colorAlpha: {\n            value: 1.0\n          },\n          shadeColor: {\n            value: new THREE.Color(0.97, 0.81, 0.86)\n          },\n          mainTex_ST: {\n            value: new THREE.Vector4(0.0, 0.0, 1.0, 1.0)\n          },\n          shadeTexture: {\n            value: null\n          },\n          bumpScale: {\n            value: 1.0\n          },\n          receiveShadowRate: {\n            value: 1.0\n          },\n          receiveShadowTexture: {\n            value: null\n          },\n          shadingGradeRate: {\n            value: 1.0\n          },\n          shadingGradeTexture: {\n            value: null\n          },\n          shadeShift: {\n            value: 0.0\n          },\n          shadeToony: {\n            value: 0.9\n          },\n          lightColorAttenuation: {\n            value: 0.0\n          },\n          indirectLightIntensity: {\n            value: 0.1\n          },\n          rimTexture: {\n            value: null\n          },\n          rimColor: {\n            value: new THREE.Color(0.0, 0.0, 0.0)\n          },\n          rimLightingMix: {\n            value: 0.0\n          },\n          rimFresnelPower: {\n            value: 1.0\n          },\n          rimLift: {\n            value: 0.0\n          },\n          sphereAdd: {\n            value: null\n          },\n          emissionColor: {\n            value: new THREE.Color(0.0, 0.0, 0.0)\n          },\n          outlineWidthTexture: {\n            value: null\n          },\n          outlineWidth: {\n            value: 0.5\n          },\n          outlineScaledMaxDistance: {\n            value: 1.0\n          },\n          outlineColor: {\n            value: new THREE.Color(0.0, 0.0, 0.0)\n          },\n          outlineLightingMix: {\n            value: 1.0\n          },\n          uvAnimMaskTexture: {\n            value: null\n          },\n          uvAnimOffsetX: {\n            value: 0.0\n          },\n          uvAnimOffsetY: {\n            value: 0.0\n          },\n          uvAnimTheta: {\n            value: 0.0\n          }\n        }]);\n\n        _this.setValues(parameters);\n\n        _this._updateShaderCode();\n\n        _this._applyUniforms();\n\n        return _this;\n      }\n\n      Object.defineProperty(MToonMaterial.prototype, \"mainTex\", {\n        get: function () {\n          return this.map;\n        },\n        set: function (t) {\n          this.map = t;\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"bumpMap\", {\n        get: function () {\n          return this.normalMap;\n        },\n        set: function (t) {\n          this.normalMap = t;\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"emissionMap\", {\n        get: function () {\n          return this.emissiveMap;\n        },\n        set: function (t) {\n          this.emissiveMap = t;\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"blendMode\", {\n        get: function () {\n          return this._blendMode;\n        },\n        set: function (m) {\n          this._blendMode = m;\n          this.depthWrite = this._blendMode !== MToonMaterialRenderMode.Transparent;\n          this.transparent = this._blendMode === MToonMaterialRenderMode.Transparent || this._blendMode === MToonMaterialRenderMode.TransparentWithZWrite;\n\n          this._updateShaderCode();\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"debugMode\", {\n        get: function () {\n          return this._debugMode;\n        },\n        set: function (m) {\n          this._debugMode = m;\n\n          this._updateShaderCode();\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"outlineWidthMode\", {\n        get: function () {\n          return this._outlineWidthMode;\n        },\n        set: function (m) {\n          this._outlineWidthMode = m;\n\n          this._updateShaderCode();\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"outlineColorMode\", {\n        get: function () {\n          return this._outlineColorMode;\n        },\n        set: function (m) {\n          this._outlineColorMode = m;\n\n          this._updateShaderCode();\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"cullMode\", {\n        get: function () {\n          return this._cullMode;\n        },\n        set: function (m) {\n          this._cullMode = m;\n\n          this._updateCullFace();\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"outlineCullMode\", {\n        get: function () {\n          return this._outlineCullMode;\n        },\n        set: function (m) {\n          this._outlineCullMode = m;\n\n          this._updateCullFace();\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"zWrite\", {\n        get: function () {\n          return this.depthWrite ? 1 : 0;\n        },\n        set: function (i) {\n          this.depthWrite = 0.5 <= i;\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(MToonMaterial.prototype, \"isOutline\", {\n        get: function () {\n          return this._isOutline;\n        },\n        set: function (b) {\n          this._isOutline = b;\n\n          this._updateShaderCode();\n\n          this._updateCullFace();\n        },\n        enumerable: true,\n        configurable: true\n      });\n\n      MToonMaterial.prototype.updateVRMMaterials = function (delta) {\n        this._uvAnimOffsetX = this._uvAnimOffsetX + delta * this.uvAnimScrollX;\n        this._uvAnimOffsetY = this._uvAnimOffsetY + delta * this.uvAnimScrollY;\n        this._uvAnimPhase = this._uvAnimPhase + delta * this.uvAnimRotation;\n\n        this._applyUniforms();\n      };\n\n      MToonMaterial.prototype.copy = function (source) {\n        _super.prototype.copy.call(this, source);\n\n        this.cutoff = source.cutoff;\n        this.color.copy(source.color);\n        this.shadeColor.copy(source.shadeColor);\n        this.map = source.map;\n        this.mainTex_ST.copy(source.mainTex_ST);\n        this.shadeTexture = source.shadeTexture;\n        this.bumpScale = source.bumpScale;\n        this.normalMap = source.normalMap;\n        this.receiveShadowRate = source.receiveShadowRate;\n        this.receiveShadowTexture = source.receiveShadowTexture;\n        this.shadingGradeRate = source.shadingGradeRate;\n        this.shadingGradeTexture = source.shadingGradeTexture;\n        this.shadeShift = source.shadeShift;\n        this.shadeToony = source.shadeToony;\n        this.lightColorAttenuation = source.lightColorAttenuation;\n        this.indirectLightIntensity = source.indirectLightIntensity;\n        this.rimTexture = source.rimTexture;\n        this.rimColor.copy(source.rimColor);\n        this.rimLightingMix = source.rimLightingMix;\n        this.rimFresnelPower = source.rimFresnelPower;\n        this.rimLift = source.rimLift;\n        this.sphereAdd = source.sphereAdd;\n        this.emissionColor.copy(source.emissionColor);\n        this.emissiveMap = source.emissiveMap;\n        this.outlineWidthTexture = source.outlineWidthTexture;\n        this.outlineWidth = source.outlineWidth;\n        this.outlineScaledMaxDistance = source.outlineScaledMaxDistance;\n        this.outlineColor.copy(source.outlineColor);\n        this.outlineLightingMix = source.outlineLightingMix;\n        this.uvAnimMaskTexture = source.uvAnimMaskTexture;\n        this.uvAnimScrollX = source.uvAnimScrollX;\n        this.uvAnimScrollY = source.uvAnimScrollY;\n        this.uvAnimRotation = source.uvAnimRotation;\n        this.debugMode = source.debugMode;\n        this.blendMode = source.blendMode;\n        this.outlineWidthMode = source.outlineWidthMode;\n        this.outlineColorMode = source.outlineColorMode;\n        this.cullMode = source.cullMode;\n        this.outlineCullMode = source.outlineCullMode;\n        this.isOutline = source.isOutline;\n        return this;\n      };\n\n      MToonMaterial.prototype._applyUniforms = function () {\n        this.uniforms.uvAnimOffsetX.value = this._uvAnimOffsetX;\n        this.uniforms.uvAnimOffsetY.value = this._uvAnimOffsetY;\n        this.uniforms.uvAnimTheta.value = TAU * this._uvAnimPhase;\n\n        if (!this.shouldApplyUniforms) {\n          return;\n        }\n\n        this.shouldApplyUniforms = false;\n        this.uniforms.cutoff.value = this.cutoff;\n        this.uniforms.color.value.setRGB(this.color.x, this.color.y, this.color.z);\n\n        if (!this._colorSpaceGamma) {\n          this.uniforms.color.value.convertSRGBToLinear();\n        }\n\n        this.uniforms.colorAlpha.value = this.color.w;\n        this.uniforms.shadeColor.value.setRGB(this.shadeColor.x, this.shadeColor.y, this.shadeColor.z);\n\n        if (!this._colorSpaceGamma) {\n          this.uniforms.shadeColor.value.convertSRGBToLinear();\n        }\n\n        this.uniforms.map.value = this.map;\n        this.uniforms.mainTex_ST.value.copy(this.mainTex_ST);\n        this.uniforms.shadeTexture.value = this.shadeTexture;\n        this.uniforms.bumpScale.value = this.bumpScale;\n        this.uniforms.normalMap.value = this.normalMap;\n        this.uniforms.receiveShadowRate.value = this.receiveShadowRate;\n        this.uniforms.receiveShadowTexture.value = this.receiveShadowTexture;\n        this.uniforms.shadingGradeRate.value = this.shadingGradeRate;\n        this.uniforms.shadingGradeTexture.value = this.shadingGradeTexture;\n        this.uniforms.shadeShift.value = this.shadeShift;\n        this.uniforms.shadeToony.value = this.shadeToony;\n        this.uniforms.lightColorAttenuation.value = this.lightColorAttenuation;\n        this.uniforms.indirectLightIntensity.value = this.indirectLightIntensity;\n        this.uniforms.rimTexture.value = this.rimTexture;\n        this.uniforms.rimColor.value.setRGB(this.rimColor.x, this.rimColor.y, this.rimColor.z);\n\n        if (!this._colorSpaceGamma) {\n          this.uniforms.rimColor.value.convertSRGBToLinear();\n        }\n\n        this.uniforms.rimLightingMix.value = this.rimLightingMix;\n        this.uniforms.rimFresnelPower.value = this.rimFresnelPower;\n        this.uniforms.rimLift.value = this.rimLift;\n        this.uniforms.sphereAdd.value = this.sphereAdd;\n        this.uniforms.emissionColor.value.setRGB(this.emissionColor.x, this.emissionColor.y, this.emissionColor.z);\n\n        if (!this._colorSpaceGamma) {\n          this.uniforms.emissionColor.value.convertSRGBToLinear();\n        }\n\n        this.uniforms.emissiveMap.value = this.emissiveMap;\n        this.uniforms.outlineWidthTexture.value = this.outlineWidthTexture;\n        this.uniforms.outlineWidth.value = this.outlineWidth;\n        this.uniforms.outlineScaledMaxDistance.value = this.outlineScaledMaxDistance;\n        this.uniforms.outlineColor.value.setRGB(this.outlineColor.x, this.outlineColor.y, this.outlineColor.z);\n\n        if (!this._colorSpaceGamma) {\n          this.uniforms.outlineColor.value.convertSRGBToLinear();\n        }\n\n        this.uniforms.outlineLightingMix.value = this.outlineLightingMix;\n        this.uniforms.uvAnimMaskTexture.value = this.uvAnimMaskTexture;\n\n        this._updateCullFace();\n      };\n\n      MToonMaterial.prototype._updateShaderCode = function () {\n        this.defines = {\n          OUTLINE: this._isOutline,\n          BLENDMODE_OPAQUE: this._blendMode === MToonMaterialRenderMode.Opaque,\n          BLENDMODE_CUTOUT: this._blendMode === MToonMaterialRenderMode.Cutout,\n          BLENDMODE_TRANSPARENT: this._blendMode === MToonMaterialRenderMode.Transparent || this._blendMode === MToonMaterialRenderMode.TransparentWithZWrite,\n          USE_SHADETEXTURE: this.shadeTexture !== null,\n          USE_RECEIVESHADOWTEXTURE: this.receiveShadowTexture !== null,\n          USE_SHADINGGRADETEXTURE: this.shadingGradeTexture !== null,\n          USE_RIMTEXTURE: this.rimTexture !== null,\n          USE_SPHEREADD: this.sphereAdd !== null,\n          USE_OUTLINEWIDTHTEXTURE: this.outlineWidthTexture !== null,\n          USE_UVANIMMASKTEXTURE: this.uvAnimMaskTexture !== null,\n          DEBUG_NORMAL: this._debugMode === MToonMaterialDebugMode.Normal,\n          DEBUG_LITSHADERATE: this._debugMode === MToonMaterialDebugMode.LitShadeRate,\n          DEBUG_UV: this._debugMode === MToonMaterialDebugMode.UV,\n          OUTLINE_WIDTH_WORLD: this._outlineWidthMode === MToonMaterialOutlineWidthMode.WorldCoordinates,\n          OUTLINE_WIDTH_SCREEN: this._outlineWidthMode === MToonMaterialOutlineWidthMode.ScreenCoordinates,\n          OUTLINE_COLOR_FIXED: this._outlineColorMode === MToonMaterialOutlineColorMode.FixedColor,\n          OUTLINE_COLOR_MIXED: this._outlineColorMode === MToonMaterialOutlineColorMode.MixedLighting\n        };\n        var encodings = (this.shadeTexture !== null ? getTexelDecodingFunction_1.getTexelDecodingFunction('shadeTextureTexelToLinear', this.shadeTexture.encoding) + '\\n' : '') + (this.sphereAdd !== null ? getTexelDecodingFunction_1.getTexelDecodingFunction('sphereAddTexelToLinear', this.sphereAdd.encoding) + '\\n' : '');\n        this.vertexShader = mtoon_vert_1.default;\n        this.fragmentShader = encodings + mtoon_frag_1.default;\n        this.needsUpdate = true;\n      };\n\n      MToonMaterial.prototype._updateCullFace = function () {\n        if (!this.isOutline) {\n          if (this.cullMode === MToonMaterialCullMode.Off) {\n            this.side = THREE.DoubleSide;\n          } else if (this.cullMode === MToonMaterialCullMode.Front) {\n            this.side = THREE.BackSide;\n          } else if (this.cullMode === MToonMaterialCullMode.Back) {\n            this.side = THREE.FrontSide;\n          }\n        } else {\n          if (this.outlineCullMode === MToonMaterialCullMode.Off) {\n            this.side = THREE.DoubleSide;\n          } else if (this.outlineCullMode === MToonMaterialCullMode.Front) {\n            this.side = THREE.BackSide;\n          } else if (this.outlineCullMode === MToonMaterialCullMode.Back) {\n            this.side = THREE.FrontSide;\n          }\n        }\n      };\n\n      return MToonMaterial;\n    }(THREE.ShaderMaterial);\n\n    exports.MToonMaterial = MToonMaterial;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/material/VRMMaterialImporter.ts\":\n  /*!*************************************************!*\\\r\n    !*** ./src/vrm/material/VRMMaterialImporter.ts ***!\r\n    \\*************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var MToonMaterial_1 = __webpack_require__(\n    /*! ./MToonMaterial */\n    \"./src/vrm/material/MToonMaterial.ts\");\n\n    var VRMUnlitMaterial_1 = __webpack_require__(\n    /*! ./VRMUnlitMaterial */\n    \"./src/vrm/material/VRMUnlitMaterial.ts\");\n\n    var VRMMaterialImporter = function () {\n      function VRMMaterialImporter(options) {\n        if (options === void 0) {\n          options = {};\n        }\n\n        this._colorSpaceGamma = options.colorSpaceGamma || true;\n        this._requestEnvMap = options.requestEnvMap;\n      }\n\n      VRMMaterialImporter.prototype.convertGLTFMaterials = function (gltf) {\n        return __awaiter(this, void 0, Promise, function () {\n          var vrmExt, materialProperties, meshesMap, materialList, materials;\n\n          var _this = this;\n\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                vrmExt = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n\n                if (!vrmExt) {\n                  return [2, null];\n                }\n\n                materialProperties = vrmExt.materialProperties;\n\n                if (!materialProperties) {\n                  return [2, null];\n                }\n\n                return [4, gltf.parser.getDependencies('mesh')];\n\n              case 1:\n                meshesMap = _a.sent();\n                materialList = {};\n                materials = [];\n                return [4, Promise.all(meshesMap.map(function (mesh, meshIndex) {\n                  return __awaiter(_this, void 0, void 0, function () {\n                    var primitives;\n\n                    var _this = this;\n\n                    return __generator(this, function (_a) {\n                      switch (_a.label) {\n                        case 0:\n                          primitives = mesh.type === 'Group' ? mesh.children : [mesh];\n                          return [4, Promise.all(primitives.map(function (primitive, primitiveIndex) {\n                            return __awaiter(_this, void 0, void 0, function () {\n                              var vrmMaterialIndex, props, vrmMaterials;\n                              return __generator(this, function (_a) {\n                                switch (_a.label) {\n                                  case 0:\n                                    if (!Array.isArray(primitive.material)) {\n                                      primitive.material = [primitive.material];\n                                      primitive.geometry.addGroup(0, primitive.geometry.index.count, 0);\n                                    }\n\n                                    vrmMaterialIndex = gltf.parser.json.meshes[meshIndex].primitives[primitiveIndex].material;\n                                    props = materialProperties[vrmMaterialIndex];\n\n                                    if (!props) {\n                                      console.warn(\"VRMMaterialImporter: There are no material definition for material #\" + vrmMaterialIndex + \" on VRM extension.\");\n                                      props = {\n                                        shader: 'VRM_USE_GLTFSHADER'\n                                      };\n                                    }\n\n                                    if (!materialList[vrmMaterialIndex]) return [3, 1];\n                                    vrmMaterials = materialList[vrmMaterialIndex];\n                                    return [3, 3];\n\n                                  case 1:\n                                    return [4, this.createVRMMaterials(primitive.material[0], props, gltf)];\n\n                                  case 2:\n                                    vrmMaterials = _a.sent();\n                                    materialList[vrmMaterialIndex] = vrmMaterials;\n                                    materials.push(vrmMaterials.surface);\n\n                                    if (vrmMaterials.outline) {\n                                      materials.push(vrmMaterials.outline);\n                                    }\n\n                                    _a.label = 3;\n\n                                  case 3:\n                                    primitive.material[0] = vrmMaterials.surface;\n\n                                    if (this._requestEnvMap) {\n                                      this._requestEnvMap().then(function (envMap) {\n                                        vrmMaterials.surface.envMap = envMap;\n                                        vrmMaterials.surface.needsUpdate = true;\n                                      });\n                                    }\n\n                                    primitive.renderOrder = props.renderQueue || 2000;\n\n                                    if (vrmMaterials.outline) {\n                                      primitive.material[1] = vrmMaterials.outline;\n                                      primitive.geometry.addGroup(0, primitive.geometry.index.count, 1);\n                                    }\n\n                                    return [2];\n                                }\n                              });\n                            });\n                          }))];\n\n                        case 1:\n                          _a.sent();\n\n                          return [2];\n                      }\n                    });\n                  });\n                }))];\n\n              case 2:\n                _a.sent();\n\n                return [2, materials];\n            }\n          });\n        });\n      };\n\n      VRMMaterialImporter.prototype.createVRMMaterials = function (originalMaterial, vrmProps, gltf) {\n        return __awaiter(this, void 0, Promise, function () {\n          var newSurface, newOutline, params_1, params, params, params, params;\n\n          var _this = this;\n\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                if (!(vrmProps.shader === 'VRM/MToon')) return [3, 2];\n                return [4, this._extractMaterialProperties(originalMaterial, vrmProps, gltf)];\n\n              case 1:\n                params_1 = _a.sent();\n                ['srcBlend', 'dstBlend', 'isFirstSetup'].forEach(function (name) {\n                  if (params_1[name] !== undefined) {\n                    delete params_1[name];\n                  }\n                });\n                ['mainTex', 'shadeTexture', 'emission', 'sphereAdd'].forEach(function (name) {\n                  if (params_1[name] !== undefined) {\n                    params_1[name].encoding = _this._colorSpaceGamma ? THREE.LinearEncoding : THREE.sRGBEncoding;\n                  }\n                });\n                newSurface = new MToonMaterial_1.MToonMaterial(this._colorSpaceGamma, params_1);\n\n                if (params_1.outlineWidthMode !== MToonMaterial_1.MToonMaterialOutlineWidthMode.None) {\n                  params_1.isOutline = true;\n                  newOutline = new MToonMaterial_1.MToonMaterial(this._colorSpaceGamma, params_1);\n                }\n\n                return [3, 11];\n\n              case 2:\n                if (!(vrmProps.shader === 'VRM/UnlitTexture')) return [3, 4];\n                return [4, this._extractMaterialProperties(originalMaterial, vrmProps, gltf)];\n\n              case 3:\n                params = _a.sent();\n                params.renderType = VRMUnlitMaterial_1.VRMUnlitMaterialRenderType.Opaque;\n                newSurface = new VRMUnlitMaterial_1.VRMUnlitMaterial(params);\n                return [3, 11];\n\n              case 4:\n                if (!(vrmProps.shader === 'VRM/UnlitCutout')) return [3, 6];\n                return [4, this._extractMaterialProperties(originalMaterial, vrmProps, gltf)];\n\n              case 5:\n                params = _a.sent();\n                params.renderType = VRMUnlitMaterial_1.VRMUnlitMaterialRenderType.Cutout;\n                newSurface = new VRMUnlitMaterial_1.VRMUnlitMaterial(params);\n                return [3, 11];\n\n              case 6:\n                if (!(vrmProps.shader === 'VRM/UnlitTransparent')) return [3, 8];\n                return [4, this._extractMaterialProperties(originalMaterial, vrmProps, gltf)];\n\n              case 7:\n                params = _a.sent();\n                params.renderType = VRMUnlitMaterial_1.VRMUnlitMaterialRenderType.Transparent;\n                newSurface = new VRMUnlitMaterial_1.VRMUnlitMaterial(params);\n                return [3, 11];\n\n              case 8:\n                if (!(vrmProps.shader === 'VRM/UnlitTransparentZWrite')) return [3, 10];\n                return [4, this._extractMaterialProperties(originalMaterial, vrmProps, gltf)];\n\n              case 9:\n                params = _a.sent();\n                params.renderType = VRMUnlitMaterial_1.VRMUnlitMaterialRenderType.TransparentWithZWrite;\n                newSurface = new VRMUnlitMaterial_1.VRMUnlitMaterial(params);\n                return [3, 11];\n\n              case 10:\n                if (vrmProps.shader !== 'VRM_USE_GLTFSHADER') {\n                  console.warn(\"Unknown shader detected: \\\"\" + vrmProps.shader + \"\\\"\");\n                }\n\n                newSurface = this._convertGLTFMaterial(originalMaterial.clone());\n                _a.label = 11;\n\n              case 11:\n                newSurface.name = originalMaterial.name;\n                newSurface.userData = JSON.parse(JSON.stringify(originalMaterial.userData));\n                newSurface.userData.vrmMaterialProperties = vrmProps;\n\n                if (newOutline) {\n                  newOutline.name = originalMaterial.name + ' (Outline)';\n                  newOutline.userData = JSON.parse(JSON.stringify(originalMaterial.userData));\n                  newOutline.userData.vrmMaterialProperties = vrmProps;\n                }\n\n                return [2, {\n                  surface: newSurface,\n                  outline: newOutline\n                }];\n            }\n          });\n        });\n      };\n\n      VRMMaterialImporter.prototype._renameMaterialProperty = function (name) {\n        if (name[0] !== '_') {\n          console.warn(\"VRMMaterials: Given property name \\\"\" + name + \"\\\" might be invalid\");\n          return name;\n        }\n\n        name = name.substring(1);\n\n        if (!/[A-Z]/.test(name[0])) {\n          console.warn(\"VRMMaterials: Given property name \\\"\" + name + \"\\\" might be invalid\");\n          return name;\n        }\n\n        return name[0].toLowerCase() + name.substring(1);\n      };\n\n      VRMMaterialImporter.prototype._convertGLTFMaterial = function (material) {\n        if (material.isMeshStandardMaterial) {\n          var mtl = material;\n\n          if (this._colorSpaceGamma) {\n            if (mtl.map) {\n              mtl.map.encoding = THREE.LinearEncoding;\n            }\n\n            if (mtl.emissiveMap) {\n              mtl.emissiveMap.encoding = THREE.LinearEncoding;\n            }\n          } else {\n            mtl.color.convertSRGBToLinear();\n            mtl.emissive.convertSRGBToLinear();\n          }\n        }\n\n        if (material.isMeshBasicMaterial) {\n          var mtl = material;\n\n          if (this._colorSpaceGamma) {\n            if (mtl.map) {\n              mtl.map.encoding = THREE.LinearEncoding;\n            }\n          } else {\n            mtl.color.convertSRGBToLinear();\n          }\n        }\n\n        return material;\n      };\n\n      VRMMaterialImporter.prototype._extractMaterialProperties = function (originalMaterial, vrmProps, gltf) {\n        var taskList = [];\n        var params = {};\n\n        if (vrmProps.textureProperties) {\n          var _loop_1 = function (name) {\n            var newName = this_1._renameMaterialProperty(name);\n\n            var textureIndex = vrmProps.textureProperties[name];\n            taskList.push(gltf.parser.getDependency('texture', textureIndex).then(function (texture) {\n              params[newName] = texture;\n            }));\n          };\n\n          var this_1 = this;\n\n          for (var _i = 0, _a = Object.keys(vrmProps.textureProperties); _i < _a.length; _i++) {\n            var name = _a[_i];\n\n            _loop_1(name);\n          }\n        }\n\n        if (vrmProps.floatProperties) {\n          for (var _b = 0, _c = Object.keys(vrmProps.floatProperties); _b < _c.length; _b++) {\n            var name = _c[_b];\n\n            var newName = this._renameMaterialProperty(name);\n\n            params[newName] = vrmProps.floatProperties[name];\n          }\n        }\n\n        if (vrmProps.vectorProperties) {\n          var _loop_2 = function (name) {\n            var _a;\n\n            var newName = this_2._renameMaterialProperty(name);\n\n            var isTextureST = ['_MainTex', '_ShadeTexture', '_BumpMap', '_ReceiveShadowTexture', '_ShadingGradeTexture', '_SphereAdd', '_EmissionMap', '_OutlineWidthTexture'].some(function (textureName) {\n              return name === textureName;\n            });\n\n            if (isTextureST) {\n              newName += '_ST';\n            }\n\n            params[newName] = new ((_a = THREE.Vector4).bind.apply(_a, [void 0].concat(vrmProps.vectorProperties[name])))();\n          };\n\n          var this_2 = this;\n\n          for (var _d = 0, _e = Object.keys(vrmProps.vectorProperties); _d < _e.length; _d++) {\n            var name = _e[_d];\n\n            _loop_2(name);\n          }\n        }\n\n        if (vrmProps.keywordMap._ALPHATEST_ON && params.blendMode === MToonMaterial_1.MToonMaterialRenderMode.Opaque) {\n          params.blendMode = MToonMaterial_1.MToonMaterialRenderMode.Cutout;\n        }\n\n        params.skinning = originalMaterial.skinning || false;\n        params.morphTargets = originalMaterial.morphTargets || false;\n        params.morphNormals = originalMaterial.morphNormals || false;\n        return Promise.all(taskList).then(function () {\n          return params;\n        });\n      };\n\n      return VRMMaterialImporter;\n    }();\n\n    exports.VRMMaterialImporter = VRMMaterialImporter;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/material/VRMUnlitMaterial.ts\":\n  /*!**********************************************!*\\\r\n    !*** ./src/vrm/material/VRMUnlitMaterial.ts ***!\r\n    \\**********************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __extends = this && this.__extends || function () {\n      var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (d, b) {\n          d.__proto__ = b;\n        } || function (d, b) {\n          for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n        };\n\n        return extendStatics(d, b);\n      };\n\n      return function (d, b) {\n        extendStatics(d, b);\n\n        function __() {\n          this.constructor = d;\n        }\n\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n      };\n    }();\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var unlit_vert_1 = __webpack_require__(\n    /*! ./shaders/unlit.vert */\n    \"./src/vrm/material/shaders/unlit.vert\");\n\n    var unlit_frag_1 = __webpack_require__(\n    /*! ./shaders/unlit.frag */\n    \"./src/vrm/material/shaders/unlit.frag\");\n\n    var VRMUnlitMaterialRenderType;\n\n    (function (VRMUnlitMaterialRenderType) {\n      VRMUnlitMaterialRenderType[VRMUnlitMaterialRenderType[\"Opaque\"] = 0] = \"Opaque\";\n      VRMUnlitMaterialRenderType[VRMUnlitMaterialRenderType[\"Cutout\"] = 1] = \"Cutout\";\n      VRMUnlitMaterialRenderType[VRMUnlitMaterialRenderType[\"Transparent\"] = 2] = \"Transparent\";\n      VRMUnlitMaterialRenderType[VRMUnlitMaterialRenderType[\"TransparentWithZWrite\"] = 3] = \"TransparentWithZWrite\";\n    })(VRMUnlitMaterialRenderType = exports.VRMUnlitMaterialRenderType || (exports.VRMUnlitMaterialRenderType = {}));\n\n    var VRMUnlitMaterial = function (_super) {\n      __extends(VRMUnlitMaterial, _super);\n\n      function VRMUnlitMaterial(parameters) {\n        var _this = _super.call(this) || this;\n\n        _this.isVRMUnlitMaterial = true;\n        _this.cutoff = 0.5;\n        _this.map = null;\n        _this.mainTex_ST = new THREE.Vector4(0.0, 0.0, 1.0, 1.0);\n        _this._renderType = VRMUnlitMaterialRenderType.Opaque;\n        _this.shouldApplyUniforms = true;\n\n        if (parameters === undefined) {\n          parameters = {};\n        }\n\n        parameters.fog = true;\n        parameters.clipping = true;\n        parameters.skinning = parameters.skinning || false;\n        parameters.morphTargets = parameters.morphTargets || false;\n        parameters.morphNormals = parameters.morphNormals || false;\n        parameters.uniforms = THREE.UniformsUtils.merge([THREE.UniformsLib.common, THREE.UniformsLib.fog, {\n          cutoff: {\n            value: 0.5\n          },\n          mainTex_ST: {\n            value: new THREE.Vector4(0.0, 0.0, 1.0, 1.0)\n          }\n        }]);\n\n        _this.setValues(parameters);\n\n        _this._updateShaderCode();\n\n        _this._applyUniforms();\n\n        return _this;\n      }\n\n      Object.defineProperty(VRMUnlitMaterial.prototype, \"mainTex\", {\n        get: function () {\n          return this.map;\n        },\n        set: function (t) {\n          this.map = t;\n        },\n        enumerable: true,\n        configurable: true\n      });\n      Object.defineProperty(VRMUnlitMaterial.prototype, \"renderType\", {\n        get: function () {\n          return this._renderType;\n        },\n        set: function (t) {\n          this._renderType = t;\n          this.depthWrite = this._renderType !== VRMUnlitMaterialRenderType.Transparent;\n          this.transparent = this._renderType === VRMUnlitMaterialRenderType.Transparent || this._renderType === VRMUnlitMaterialRenderType.TransparentWithZWrite;\n\n          this._updateShaderCode();\n        },\n        enumerable: true,\n        configurable: true\n      });\n\n      VRMUnlitMaterial.prototype.updateVRMMaterials = function (delta) {\n        this._applyUniforms();\n      };\n\n      VRMUnlitMaterial.prototype.copy = function (source) {\n        _super.prototype.copy.call(this, source);\n\n        this.cutoff = source.cutoff;\n        this.map = source.map;\n        this.mainTex_ST.copy(source.mainTex_ST);\n        this.renderType = source.renderType;\n        return this;\n      };\n\n      VRMUnlitMaterial.prototype._applyUniforms = function () {\n        if (!this.shouldApplyUniforms) {\n          return;\n        }\n\n        this.shouldApplyUniforms = false;\n        this.uniforms.cutoff.value = this.cutoff;\n        this.uniforms.map.value = this.map;\n        this.uniforms.mainTex_ST.value.copy(this.mainTex_ST);\n      };\n\n      VRMUnlitMaterial.prototype._updateShaderCode = function () {\n        this.defines = {\n          RENDERTYPE_OPAQUE: this._renderType === VRMUnlitMaterialRenderType.Opaque,\n          RENDERTYPE_CUTOUT: this._renderType === VRMUnlitMaterialRenderType.Cutout,\n          RENDERTYPE_TRANSPARENT: this._renderType === VRMUnlitMaterialRenderType.Transparent || this._renderType === VRMUnlitMaterialRenderType.TransparentWithZWrite\n        };\n        this.vertexShader = unlit_vert_1.default;\n        this.fragmentShader = unlit_frag_1.default;\n        this.needsUpdate = true;\n      };\n\n      return VRMUnlitMaterial;\n    }(THREE.ShaderMaterial);\n\n    exports.VRMUnlitMaterial = VRMUnlitMaterial;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/material/getTexelDecodingFunction.ts\":\n  /*!******************************************************!*\\\r\n    !*** ./src/vrm/material/getTexelDecodingFunction.ts ***!\r\n    \\******************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    exports.getEncodingComponents = function (encoding) {\n      switch (encoding) {\n        case THREE.LinearEncoding:\n          return ['Linear', '( value )'];\n\n        case THREE.sRGBEncoding:\n          return ['sRGB', '( value )'];\n\n        case THREE.RGBEEncoding:\n          return ['RGBE', '( value )'];\n\n        case THREE.RGBM7Encoding:\n          return ['RGBM', '( value, 7.0 )'];\n\n        case THREE.RGBM16Encoding:\n          return ['RGBM', '( value, 16.0 )'];\n\n        case THREE.RGBDEncoding:\n          return ['RGBD', '( value, 256.0 )'];\n\n        case THREE.GammaEncoding:\n          return ['Gamma', '( value, float( GAMMA_FACTOR ) )'];\n\n        default:\n          throw new Error('unsupported encoding: ' + encoding);\n      }\n    };\n\n    exports.getTexelDecodingFunction = function (functionName, encoding) {\n      var components = exports.getEncodingComponents(encoding);\n      return 'vec4 ' + functionName + '( vec4 value ) { return ' + components[0] + 'ToLinear' + components[1] + '; }';\n    };\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/material/index.ts\":\n  /*!***********************************!*\\\r\n    !*** ./src/vrm/material/index.ts ***!\r\n    \\***********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./MToonMaterial */\n    \"./src/vrm/material/MToonMaterial.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMMaterialImporter */\n    \"./src/vrm/material/VRMMaterialImporter.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMUnlitMaterial */\n    \"./src/vrm/material/VRMUnlitMaterial.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/material/shaders/mtoon.frag\":\n  /*!*********************************************!*\\\r\n    !*** ./src/vrm/material/shaders/mtoon.frag ***!\r\n    \\*********************************************/\n\n  /*! exports provided: default */\n\n  /***/\n  function (module, __webpack_exports__, __webpack_require__) {\n    \"use strict\";\n\n    __webpack_require__.r(__webpack_exports__);\n    /* harmony default export */\n\n\n    __webpack_exports__[\"default\"] = \"// #define PHONG\\n\\n#ifdef BLENDMODE_CUTOUT\\n  uniform float cutoff;\\n#endif\\n\\nuniform vec3 color;\\nuniform float colorAlpha;\\nuniform vec3 shadeColor;\\n#ifdef USE_SHADETEXTURE\\n  uniform sampler2D shadeTexture;\\n#endif\\n\\nuniform float receiveShadowRate;\\n#ifdef USE_RECEIVESHADOWTEXTURE\\n  uniform sampler2D receiveShadowTexture;\\n#endif\\n\\nuniform float shadingGradeRate;\\n#ifdef USE_SHADINGGRADETEXTURE\\n  uniform sampler2D shadingGradeTexture;\\n#endif\\n\\nuniform float shadeShift;\\nuniform float shadeToony;\\nuniform float lightColorAttenuation;\\nuniform float indirectLightIntensity;\\n\\n#ifdef USE_RIMTEXTURE\\n  uniform sampler2D rimTexture;\\n#endif\\nuniform vec3 rimColor;\\nuniform float rimLightingMix;\\nuniform float rimFresnelPower;\\nuniform float rimLift;\\n\\n#ifdef USE_SPHEREADD\\n  uniform sampler2D sphereAdd;\\n#endif\\n\\nuniform vec3 emissionColor;\\n\\nuniform vec3 outlineColor;\\nuniform float outlineLightingMix;\\n\\n#ifdef USE_UVANIMMASKTEXTURE\\n  uniform sampler2D uvAnimMaskTexture;\\n#endif\\n\\nuniform float uvAnimOffsetX;\\nuniform float uvAnimOffsetY;\\nuniform float uvAnimTheta;\\n\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n\\n// #include <uv_pars_fragment>\\n#if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n  varying vec2 vUv;\\n#endif\\n\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n// #include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n// #include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n// #include <envmap_pars_fragment>\\n// #include <gradientmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n\\n// #include <lights_phong_pars_fragment>\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n  varying vec3 vNormal;\\n#endif\\n\\n#define Material_LightProbeLOD( material ) (0)\\n\\n#include <shadowmap_pars_fragment>\\n// #include <bumpmap_pars_fragment>\\n\\n// #include <normalmap_pars_fragment>\\n#ifdef USE_NORMALMAP\\n  uniform sampler2D normalMap;\\n  uniform float bumpScale;\\n\\n  // this number is very random, this is still a \\n  #define UV_DERIVATIVE_EPSILON 1E-6\\n\\n  // Per-Pixel Tangent Space Normal Mapping\\n  // http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n  vec3 perturbNormal2Arb( vec2 uv, vec3 eye_pos, vec3 surf_norm ) {\\n    // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\\n    vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\\n    vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\\n    vec2 st0 = dFdx( uv.st );\\n    vec2 st1 = dFdy( uv.st );\\n\\n    float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\\n    vec3 S = ( q0 * st1.t - q1 * st0.t ) * scale;\\n    vec3 T = ( - q0 * st1.s + q1 * st0.s ) * scale;\\n\\n    // Workaround for the issue that happens when delta of uv = 0.0\\n    if ( length( S ) == 0.0 || length( T ) == 0.0 ) {\\n      return surf_norm;\\n    }\\n\\n    S = normalize( S );\\n    T = normalize( T );\\n    vec3 N = normalize( surf_norm );\\n\\n    vec3 mapN = texture2D( normalMap, uv ).xyz * 2.0 - 1.0;\\n\\n    mapN.xy *= bumpScale;\\n\\n    #ifdef DOUBLE_SIDED\\n      // Workaround for Adreno GPUs gl_FrontFacing bug. See #15850 and #10331\\n      // http://hacksoflife.blogspot.com/2009/11/per-pixel-tangent-space-normal-mapping.html?showComment=1522254677437#c5087545147696715943\\n      vec3 NfromST = cross( S, T );\\n      if( dot( NfromST, N ) > 0.0 ) {\\n        S *= -1.0;\\n        T *= -1.0;\\n      }\\n    #else\\n      mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n    #endif\\n\\n    mat3 tsn = mat3( S, T, N );\\n\\n    return normalize( tsn * mapN );\\n  }\\n#endif\\n\\n// #include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\n\\n// == lighting stuff ===========================================================\\nfloat getLightIntensity(\\n  const in IncidentLight directLight,\\n  const in GeometricContext geometry,\\n  const in float shadow,\\n  const in float shadingGrade\\n) {\\n  float lightIntensity = dot( geometry.normal, directLight.direction );\\n  lightIntensity = 0.5 + 0.5 * lightIntensity;\\n  lightIntensity = lightIntensity * shadow;\\n  lightIntensity = lightIntensity * shadingGrade;\\n  lightIntensity = lightIntensity * 2.0 - 1.0;\\n  return smoothstep( shadeShift, shadeShift + ( 1.0 - shadeToony ), lightIntensity );\\n}\\n\\nvec3 getLighting( const in vec3 lightColor ) {\\n  vec3 lighting = lightColor;\\n  lighting = mix(\\n    lighting,\\n    vec3( max( 0.001, max( lighting.x, max( lighting.y, lighting.z ) ) ) ),\\n    lightColorAttenuation\\n  );\\n\\n  #ifndef PHYSICALLY_CORRECT_LIGHTS\\n    lighting *= PI;\\n  #endif\\n\\n  return lighting;\\n}\\n\\nvec3 getDiffuse(\\n  const in vec3 lit,\\n  const in vec3 shade,\\n  const in float lightIntensity,\\n  const in vec3 lighting\\n) {\\n  #ifdef DEBUG_LITSHADERATE\\n    return vec3( BRDF_Diffuse_Lambert( lightIntensity * lighting ) );\\n  #endif\\n\\n  return lighting * BRDF_Diffuse_Lambert( mix( shade, lit, lightIntensity ) );\\n}\\n\\nvec3 calcDirectDiffuse(\\n  const in vec2 uv,\\n  const in vec3 lit,\\n  const in vec3 shade,\\n  in GeometricContext geometry,\\n  inout ReflectedLight reflectedLight\\n) {\\n  IncidentLight directLight;\\n  vec3 lightingSum = vec3( 0.0 );\\n\\n  float shadingGrade = 1.0;\\n  #ifdef USE_SHADINGGRADETEXTURE\\n    shadingGrade = 1.0 - shadingGradeRate * ( 1.0 - texture2D( shadingGradeTexture, uv ).r );\\n  #endif\\n\\n  float receiveShadow = receiveShadowRate;\\n  #ifdef USE_RECEIVESHADOWTEXTURE\\n    receiveShadow *= texture2D( receiveShadowTexture, uv ).a;\\n  #endif\\n\\n  #if ( NUM_POINT_LIGHTS > 0 )\\n    PointLight pointLight;\\n\\n    #pragma unroll_loop\\n    for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n      pointLight = pointLights[ i ];\\n      getPointDirectLightIrradiance( pointLight, geometry, directLight );\\n\\n      float atten = 1.0;\\n      #ifdef USE_SHADOWMAP\\n        atten = all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n      #endif\\n\\n      float shadow = 1.0 - receiveShadow * ( 1.0 - ( 0.5 + 0.5 * atten ) );\\n      float lightIntensity = getLightIntensity( directLight, geometry, shadow, shadingGrade );\\n      vec3 lighting = getLighting( directLight.color );\\n      reflectedLight.directDiffuse += getDiffuse( lit, shade, lightIntensity, lighting );\\n      lightingSum += lighting;\\n    }\\n  #endif\\n\\n  #if ( NUM_SPOT_LIGHTS > 0 )\\n    SpotLight spotLight;\\n\\n    #pragma unroll_loop\\n    for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n      spotLight = spotLights[ i ];\\n      getSpotDirectLightIrradiance( spotLight, geometry, directLight );\\n\\n      float atten = 1.0;\\n      #ifdef USE_SHADOWMAP\\n        atten = all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n      #endif\\n\\n      float shadow = 1.0 - receiveShadow * ( 1.0 - ( 0.5 + 0.5 * atten ) );\\n      float lightIntensity = getLightIntensity( directLight, geometry, shadow, shadingGrade );\\n      vec3 lighting = getLighting( directLight.color );\\n      reflectedLight.directDiffuse += getDiffuse( lit, shade, lightIntensity, lighting );\\n      lightingSum += lighting;\\n    }\\n  #endif\\n\\n  #if ( NUM_DIR_LIGHTS > 0 )\\n    DirectionalLight directionalLight;\\n\\n    #pragma unroll_loop\\n    for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n      directionalLight = directionalLights[ i ];\\n      getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\n\\n      float atten = 1.0;\\n      #ifdef USE_SHADOWMAP\\n        atten = all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n      #endif\\n\\n      float shadow = 1.0 - receiveShadow * ( 1.0 - ( 0.5 + 0.5 * atten ) );\\n      float lightIntensity = getLightIntensity( directLight, geometry, shadow, shadingGrade );\\n      vec3 lighting = getLighting( directLight.color );\\n      reflectedLight.directDiffuse += getDiffuse( lit, shade, lightIntensity, lighting );\\n      lightingSum += lighting;\\n    }\\n  #endif\\n\\n  return lightingSum;\\n}\\n\\n// == post correction ==========================================================\\nvoid postCorrection() {\\n  #include <tonemapping_fragment>\\n  #include <encodings_fragment>\\n  #include <fog_fragment>\\n  #include <premultiplied_alpha_fragment>\\n  #include <dithering_fragment>\\n}\\n\\n// == main procedure ===========================================================\\nvoid main() {\\n  #include <clipping_planes_fragment>\\n\\n  vec2 uv = vec2(0.5, 0.5);\\n\\n  #if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n    uv = vUv;\\n\\n    float uvAnimMask = 1.0;\\n    #ifdef USE_UVANIMMASKTEXTURE\\n      uvAnimMask = texture2D( uvAnimMaskTexture, uv ).x;\\n    #endif\\n\\n    uv = uv + vec2( uvAnimOffsetX, uvAnimOffsetY ) * uvAnimMask;\\n    float uvRotCos = cos( uvAnimTheta * uvAnimMask );\\n    float uvRotSin = sin( uvAnimTheta * uvAnimMask );\\n    uv = mat2( uvRotCos, uvRotSin, -uvRotSin, uvRotCos ) * ( uv - 0.5 ) + 0.5;\\n  #endif\\n\\n  #ifdef DEBUG_UV\\n    gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\\n    #if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n      gl_FragColor = vec4( uv, 0.0, 1.0 );\\n    #endif\\n    return;\\n  #endif\\n\\n  vec4 diffuseColor = vec4( color, colorAlpha );\\n  ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n  vec3 totalEmissiveRadiance = emissionColor;\\n\\n  #include <logdepthbuf_fragment>\\n\\n  // #include <map_fragment>\\n  #ifdef USE_MAP\\n    diffuseColor *= mapTexelToLinear( texture2D( map, uv ) );\\n  #endif\\n\\n  #include <color_fragment>\\n  // #include <alphamap_fragment>\\n\\n  // -- MToon: alpha -----------------------------------------------------------\\n  // #include <alphatest_fragment>\\n  #ifdef BLENDMODE_CUTOUT\\n    if ( diffuseColor.a <= cutoff ) { discard; }\\n    diffuseColor.a = 1.0;\\n  #endif\\n\\n  #ifdef BLENDMODE_OPAQUE\\n    diffuseColor.a = 1.0;\\n  #endif\\n\\n  #if defined( OUTLINE ) && defined( OUTLINE_COLOR_FIXED ) // omitting DebugMode\\n    gl_FragColor = vec4( outlineColor, diffuseColor.a );\\n    postCorrection();\\n    return;\\n  #endif\\n\\n  // #include <specularmap_fragment>\\n  #include <normal_fragment_begin>\\n\\n  #ifdef OUTLINE\\n    normal *= -1.0;\\n  #endif\\n\\n  // #include <normal_fragment_maps>\\n  #ifdef USE_NORMALMAP\\n    normal = perturbNormal2Arb( uv, -vViewPosition, normal );\\n  #endif\\n\\n  // #include <emissivemap_fragment>\\n  #ifdef USE_EMISSIVEMAP\\n    totalEmissiveRadiance *= emissiveMapTexelToLinear( texture2D( emissiveMap, uv ) ).rgb;\\n  #endif\\n\\n  #ifdef DEBUG_NORMAL\\n    gl_FragColor = vec4( 0.5 + 0.5 * normal, 1.0 );\\n    return;\\n  #endif\\n\\n  // -- MToon: lighting --------------------------------------------------------\\n  // accumulation\\n  // #include <lights_phong_fragment>\\n  // #include <lights_fragment_begin>\\n  vec3 lit = diffuseColor.rgb;\\n  vec3 shade = shadeColor;\\n  #ifdef USE_SHADETEXTURE\\n    shade *= shadeTextureTexelToLinear( texture2D( shadeTexture, uv ) ).rgb;\\n  #endif\\n\\n  GeometricContext geometry;\\n\\n  geometry.position = - vViewPosition;\\n  geometry.normal = normal;\\n  geometry.viewDir = normalize( vViewPosition );\\n\\n  vec3 lighting = calcDirectDiffuse( uv, diffuseColor.rgb, shade, geometry, reflectedLight );\\n\\n  vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n  #if ( NUM_HEMI_LIGHTS > 0 )\\n    #pragma unroll_loop\\n    for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n      irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n    }\\n  #endif\\n\\n  // #include <lights_fragment_maps>\\n  #ifdef USE_LIGHTMAP\\n    vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).rgb * lightMapIntensity;\\n    #ifndef PHYSICALLY_CORRECT_LIGHTS\\n      lightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\\n    #endif\\n    irradiance += lightMapIrradiance;\\n  #endif\\n\\n  // #include <lights_fragment_end>\\n  reflectedLight.indirectDiffuse += indirectLightIntensity * irradiance * BRDF_Diffuse_Lambert( lit );\\n\\n  // modulation\\n  #include <aomap_fragment>\\n\\n  vec3 col = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\\n\\n  #if defined( OUTLINE ) && defined( OUTLINE_COLOR_MIXED ) // omitting DebugMode\\n    gl_FragColor = vec4(\\n      outlineColor.rgb * mix( vec3( 1.0 ), col, outlineLightingMix ),\\n      diffuseColor.a\\n    );\\n    postCorrection();\\n    return;\\n  #endif\\n\\n  // -- MToon: parametric rim lighting -----------------------------------------\\n  vec3 viewDir = normalize( vViewPosition );\\n  vec3 rimMix = mix(vec3(1.0), lighting + indirectLightIntensity * irradiance, rimLightingMix);\\n  vec3 rim = rimColor * pow( saturate( 1.0 - dot( viewDir, normal ) + rimLift ), rimFresnelPower );\\n  #ifdef USE_RIMTEXTURE\\n    rim *= texture2D( rimTexture, uv ).rgb;\\n  #endif\\n  col += rim;\\n\\n  // -- MToon: additive matcap -------------------------------------------------\\n  #ifdef USE_SPHEREADD\\n    {\\n      vec3 x = normalize( vec3( viewDir.z, 0.0, -viewDir.x ) );\\n      vec3 y = cross( viewDir, x ); // guaranteed to be normalized\\n      vec2 sphereUv = 0.5 + 0.5 * vec2( dot( x, normal ), -dot( y, normal ) );\\n      vec3 matcap = sphereAddTexelToLinear( texture2D( sphereAdd, sphereUv ) ).xyz;\\n      col += matcap;\\n    }\\n  #endif\\n\\n  // -- MToon: Emission --------------------------------------------------------\\n  col += totalEmissiveRadiance;\\n\\n  // #include <envmap_fragment>\\n\\n  // -- Almost done! -----------------------------------------------------------\\n  gl_FragColor = vec4( col, diffuseColor.a );\\n  postCorrection();\\n}\";\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/material/shaders/mtoon.vert\":\n  /*!*********************************************!*\\\r\n    !*** ./src/vrm/material/shaders/mtoon.vert ***!\r\n    \\*********************************************/\n\n  /*! exports provided: default */\n\n  /***/\n  function (module, __webpack_exports__, __webpack_require__) {\n    \"use strict\";\n\n    __webpack_require__.r(__webpack_exports__);\n    /* harmony default export */\n\n\n    __webpack_exports__[\"default\"] = \"// #define PHONG\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n  varying vec3 vNormal;\\n#endif\\n\\n#include <common>\\n\\n// #include <uv_pars_vertex>\\n#if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n  varying vec2 vUv;\\n  uniform vec4 mainTex_ST;\\n#endif\\n\\n#include <uv2_pars_vertex>\\n// #include <displacementmap_pars_vertex>\\n// #include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\n\\n#ifdef USE_OUTLINEWIDTHTEXTURE\\n  uniform sampler2D outlineWidthTexture;\\n#endif\\n\\nuniform float outlineWidth;\\nuniform float outlineScaledMaxDistance;\\n\\nvoid main() {\\n\\n  // #include <uv_vertex>\\n  #if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n    vUv = vec2( mainTex_ST.p * uv.x + mainTex_ST.s, mainTex_ST.q * uv.y + mainTex_ST.t );\\n  #endif\\n\\n  #include <uv2_vertex>\\n  #include <color_vertex>\\n\\n  #include <beginnormal_vertex>\\n  #include <morphnormal_vertex>\\n  #include <skinbase_vertex>\\n  #include <skinnormal_vertex>\\n  #include <defaultnormal_vertex>\\n\\n  #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\\n    vNormal = normalize( transformedNormal );\\n  #endif\\n\\n  #include <begin_vertex>\\n\\n  #include <morphtarget_vertex>\\n  #include <skinning_vertex>\\n  // #include <displacementmap_vertex>\\n  #include <project_vertex>\\n  #include <logdepthbuf_vertex>\\n  #include <clipping_planes_vertex>\\n\\n  vViewPosition = - mvPosition.xyz;\\n\\n  float outlineTex = 1.0;\\n\\n  #ifdef OUTLINE\\n    #ifdef USE_OUTLINEWIDTHTEXTURE\\n      outlineTex = texture2D( outlineWidthTexture, vUv ).r;\\n    #endif\\n\\n    #ifdef OUTLINE_WIDTH_WORLD\\n      vec3 outlineOffset = 0.01 * outlineWidth * outlineTex * normalize( objectNormal );\\n      gl_Position += projectionMatrix * modelViewMatrix * vec4( outlineOffset, 0.0 );\\n    #endif\\n\\n    #ifdef OUTLINE_WIDTH_SCREEN\\n      vec3 clipNormal = ( projectionMatrix * modelViewMatrix * vec4( normalize( objectNormal ), 0.0 ) ).xyz;\\n      vec2 projectedNormal = normalize( clipNormal.xy );\\n      projectedNormal *= min( gl_Position.w, outlineScaledMaxDistance );\\n      projectedNormal.x *= projectionMatrix[ 0 ].x / projectionMatrix[ 1 ].y;\\n      gl_Position.xy += 0.01 * outlineWidth * outlineTex * projectedNormal.xy;\\n    #endif\\n\\n    gl_Position.z += 1E-6 * gl_Position.w; // anti-artifact magic\\n  #endif\\n\\n  #include <worldpos_vertex>\\n  // #include <envmap_vertex>\\n  #include <shadowmap_vertex>\\n  #include <fog_vertex>\\n\\n}\";\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/material/shaders/unlit.frag\":\n  /*!*********************************************!*\\\r\n    !*** ./src/vrm/material/shaders/unlit.frag ***!\r\n    \\*********************************************/\n\n  /*! exports provided: default */\n\n  /***/\n  function (module, __webpack_exports__, __webpack_require__) {\n    \"use strict\";\n\n    __webpack_require__.r(__webpack_exports__);\n    /* harmony default export */\n\n\n    __webpack_exports__[\"default\"] = \"#ifdef RENDERTYPE_CUTOUT\\n  uniform float cutoff;\\n#endif\\n\\n#include <common>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n// #include <alphamap_pars_fragment>\\n// #include <aomap_pars_fragment>\\n// #include <lightmap_pars_fragment>\\n// #include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n// #include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\n\\n// == main procedure ===========================================================\\nvoid main() {\\n  #include <clipping_planes_fragment>\\n\\n  vec4 diffuseColor = vec4( 1.0 );\\n\\n  #include <logdepthbuf_fragment>\\n\\n  // #include <map_fragment>\\n  #ifdef USE_MAP\\n    diffuseColor *= mapTexelToLinear( texture2D( map, vUv ) );\\n  #endif\\n\\n  #include <color_fragment>\\n  // #include <alphamap_fragment>\\n\\n  // MToon: alpha\\n  // #include <alphatest_fragment>\\n  #ifdef RENDERTYPE_CUTOUT\\n    if ( diffuseColor.a <= cutoff ) { discard; }\\n    diffuseColor.a = 1.0;\\n  #endif\\n\\n  #ifdef RENDERTYPE_OPAQUE\\n    diffuseColor.a = 1.0;\\n  #endif\\n\\n  // #include <specularmap_fragment>\\n\\n  ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\n  // accumulation (baked indirect lighting only)\\n  #ifdef USE_LIGHTMAP\\n    reflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n  #else\\n    reflectedLight.indirectDiffuse += vec3( 1.0 );\\n  #endif\\n\\n  // modulation\\n  // #include <aomap_fragment>\\n\\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\\n  vec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\\n  // #include <envmap_fragment>\\n\\n  gl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\n  #include <premultiplied_alpha_fragment>\\n  #include <tonemapping_fragment>\\n  #include <encodings_fragment>\\n  #include <fog_fragment>\\n}\";\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/material/shaders/unlit.vert\":\n  /*!*********************************************!*\\\r\n    !*** ./src/vrm/material/shaders/unlit.vert ***!\r\n    \\*********************************************/\n\n  /*! exports provided: default */\n\n  /***/\n  function (module, __webpack_exports__, __webpack_require__) {\n    \"use strict\";\n\n    __webpack_require__.r(__webpack_exports__);\n    /* harmony default export */\n\n\n    __webpack_exports__[\"default\"] = \"#include <common>\\n\\n// #include <uv_pars_vertex>\\n#ifdef USE_MAP\\n  varying vec2 vUv;\\n  uniform vec4 mainTex_ST;\\n#endif\\n\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\n\\nvoid main() {\\n\\n  // #include <uv_vertex>\\n  #ifdef USE_MAP\\n    vUv = vec2( mainTex_ST.p * uv.x + mainTex_ST.s, mainTex_ST.q * uv.y + mainTex_ST.t );\\n  #endif\\n\\n  #include <uv2_vertex>\\n  #include <color_vertex>\\n  #include <skinbase_vertex>\\n\\n  #ifdef USE_ENVMAP\\n\\n  #include <beginnormal_vertex>\\n  #include <morphnormal_vertex>\\n  #include <skinnormal_vertex>\\n  #include <defaultnormal_vertex>\\n\\n  #endif\\n\\n  #include <begin_vertex>\\n  #include <morphtarget_vertex>\\n  #include <skinning_vertex>\\n  #include <project_vertex>\\n  #include <logdepthbuf_vertex>\\n\\n  #include <worldpos_vertex>\\n  #include <clipping_planes_vertex>\\n  #include <envmap_vertex>\\n  #include <fog_vertex>\\n\\n}\";\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/reduceBones.ts\":\n  /*!********************************!*\\\r\n    !*** ./src/vrm/reduceBones.ts ***!\r\n    \\********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    function reduceBones(root) {\n      root.traverse(function (obj) {\n        if (obj.type !== 'SkinnedMesh') {\n          return;\n        }\n\n        var mesh = obj;\n        var geometry = mesh.geometry.clone();\n        mesh.geometry = geometry;\n        var attribute = geometry.getAttribute('skinIndex');\n        var bones = [];\n        var boneInverses = [];\n        var boneIndexMap = {};\n        var array = attribute.array.map(function (index) {\n          if (boneIndexMap[index] === undefined) {\n            boneIndexMap[index] = bones.length;\n            bones.push(mesh.skeleton.bones[index]);\n            boneInverses.push(mesh.skeleton.boneInverses[index]);\n          }\n\n          return boneIndexMap[index];\n        });\n        geometry.removeAttribute('skinIndex');\n        geometry.addAttribute('skinIndex', new THREE.BufferAttribute(array, 4, false));\n        mesh.bind(new THREE.Skeleton(bones, boneInverses), new THREE.Matrix4());\n      });\n    }\n\n    exports.reduceBones = reduceBones;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/springbone/VRMSpringBone.ts\":\n  /*!*********************************************!*\\\r\n    !*** ./src/vrm/springbone/VRMSpringBone.ts ***!\r\n    \\*********************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var math_1 = __webpack_require__(\n    /*! ../utils/math */\n    \"./src/vrm/utils/math.ts\");\n\n    exports.GIZMO_RENDER_ORDER = 10000;\n    var IDENTITY_MATRIX4 = Object.freeze(new THREE.Matrix4());\n    var IDENTITY_QUATERNION = Object.freeze(new THREE.Quaternion());\n\n    var _v3A = new THREE.Vector3();\n\n    var _v3B = new THREE.Vector3();\n\n    var _v3C = new THREE.Vector3();\n\n    var _quatA = new THREE.Quaternion();\n\n    var _matA = new THREE.Matrix4();\n\n    var _matB = new THREE.Matrix4();\n\n    var VRMSpringBone = function () {\n      function VRMSpringBone(bone, radius, stiffiness, gravityDir, gravityPower, dragForce, colliders) {\n        var _this = this;\n\n        if (colliders === void 0) {\n          colliders = [];\n        }\n\n        this.bone = bone;\n        this.bone.matrixAutoUpdate = false;\n        this.radius = radius;\n        this.stiffnessForce = stiffiness;\n        this.gravityDir = gravityDir;\n        this.gravityPower = gravityPower;\n        this.dragForce = dragForce;\n        this.colliders = colliders;\n        this._worldPosition = new THREE.Vector3().setFromMatrixPosition(this.bone.matrixWorld);\n        this._parentWorldRotation = new THREE.Quaternion();\n        this._initialLocalMatrix = this.bone.matrix.clone();\n        this._initialLocalRotation = this.bone.quaternion.clone();\n\n        this._initialLocalChildPosition = function () {\n          if (_this.bone.children.length === 0) {\n            return _this.bone.position.clone().normalize().multiplyScalar(0.07);\n          } else {\n            var firstChild = _this.bone.children[0];\n            return firstChild.position.clone();\n          }\n        }();\n\n        this._currentTail = this.bone.localToWorld(this._initialLocalChildPosition.clone());\n        this._prevTail = this._currentTail.clone();\n        this._nextTail = this._currentTail.clone();\n        this._boneAxis = this._initialLocalChildPosition.clone().normalize();\n        this._worldBoneLength = this.bone.localToWorld(_v3A.copy(this._initialLocalChildPosition)).sub(this._worldPosition).length();\n      }\n\n      VRMSpringBone.prototype.reset = function () {\n        this.bone.matrix.copy(this._initialLocalMatrix);\n        this.bone.localToWorld(this._currentTail.copy(this._initialLocalChildPosition));\n\n        this._prevTail.copy(this._currentTail);\n\n        this._nextTail.copy(this._currentTail);\n\n        this.bone.updateMatrix();\n        this.bone.matrixWorld.multiplyMatrices(this._getParentMatrixWorld(), this.bone.matrix);\n\n        this._worldPosition.setFromMatrixPosition(this.bone.matrixWorld);\n      };\n\n      VRMSpringBone.prototype.update = function (delta) {\n        if (delta <= 0) return;\n        this.bone.matrixWorld.multiplyMatrices(this._getParentMatrixWorld(), this.bone.matrix);\n\n        if (this.bone.parent) {\n          math_1.getWorldQuaternionLite(this.bone.parent, this._parentWorldRotation);\n        } else {\n          this._parentWorldRotation.copy(IDENTITY_QUATERNION);\n        }\n\n        this._worldPosition.setFromMatrixPosition(this.bone.matrixWorld);\n\n        var stiffness = this.stiffnessForce * delta;\n\n        var external = _v3B.copy(this.gravityDir).multiplyScalar(this.gravityPower * delta);\n\n        this._nextTail.copy(this._currentTail).add(_v3A.copy(this._currentTail).sub(this._prevTail).multiplyScalar(1 - this.dragForce)).add(_v3A.copy(this._boneAxis).applyMatrix4(this._initialLocalMatrix).applyMatrix4(this._getParentMatrixWorld()).sub(this._worldPosition).normalize().multiplyScalar(stiffness)).add(external);\n\n        this._nextTail.sub(this._worldPosition).normalize().multiplyScalar(this._worldBoneLength).add(this._worldPosition);\n\n        this._collision(this._nextTail);\n\n        this._prevTail.copy(this._currentTail);\n\n        this._currentTail.copy(this._nextTail);\n\n        var initialWorldMatrixInv = _matA.getInverse(_matB.copy(this._getParentMatrixWorld()).multiply(this._initialLocalMatrix));\n\n        var applyRotation = _quatA.setFromUnitVectors(this._boneAxis, _v3A.copy(this._nextTail).applyMatrix4(initialWorldMatrixInv).normalize());\n\n        this.bone.quaternion.copy(this._initialLocalRotation).multiply(applyRotation);\n        this.bone.updateMatrix();\n        this.bone.matrixWorld.multiplyMatrices(this._getParentMatrixWorld(), this.bone.matrix);\n      };\n\n      VRMSpringBone.prototype._collision = function (tail) {\n        var _this = this;\n\n        this.colliders.forEach(function (collider) {\n          var colliderWorldPosition = _v3A.setFromMatrixPosition(collider.matrixWorld);\n\n          var colliderRadius = collider.geometry.boundingSphere.radius;\n          var r = _this.radius + colliderRadius;\n\n          if (tail.distanceToSquared(colliderWorldPosition) <= r * r) {\n            var normal = _v3B.subVectors(tail, colliderWorldPosition).normalize();\n\n            var posFromCollider = _v3C.addVectors(colliderWorldPosition, normal.multiplyScalar(r));\n\n            tail.copy(posFromCollider.sub(_this._worldPosition).normalize().multiplyScalar(_this._worldBoneLength).add(_this._worldPosition));\n          }\n        });\n      };\n\n      VRMSpringBone.prototype._getParentMatrixWorld = function () {\n        return this.bone.parent ? this.bone.parent.matrixWorld : IDENTITY_MATRIX4;\n      };\n\n      return VRMSpringBone;\n    }();\n\n    exports.VRMSpringBone = VRMSpringBone;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/springbone/VRMSpringBoneColliderGroup.ts\":\n  /*!**********************************************************!*\\\r\n    !*** ./src/vrm/springbone/VRMSpringBoneColliderGroup.ts ***!\r\n    \\**********************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/springbone/VRMSpringBoneImporter.ts\":\n  /*!*****************************************************!*\\\r\n    !*** ./src/vrm/springbone/VRMSpringBoneImporter.ts ***!\r\n    \\*****************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n      return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) {\n          try {\n            step(generator.next(value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function rejected(value) {\n          try {\n            step(generator[\"throw\"](value));\n          } catch (e) {\n            reject(e);\n          }\n        }\n\n        function step(result) {\n          result.done ? resolve(result.value) : new P(function (resolve) {\n            resolve(result.value);\n          }).then(fulfilled, rejected);\n        }\n\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n      });\n    };\n\n    var __generator = this && this.__generator || function (thisArg, body) {\n      var _ = {\n        label: 0,\n        sent: function () {\n          if (t[0] & 1) throw t[1];\n          return t[1];\n        },\n        trys: [],\n        ops: []\n      },\n          f,\n          y,\n          t,\n          g;\n      return g = {\n        next: verb(0),\n        \"throw\": verb(1),\n        \"return\": verb(2)\n      }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n        return this;\n      }), g;\n\n      function verb(n) {\n        return function (v) {\n          return step([n, v]);\n        };\n      }\n\n      function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n\n        while (_) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n\n          switch (op[0]) {\n            case 0:\n            case 1:\n              t = op;\n              break;\n\n            case 4:\n              _.label++;\n              return {\n                value: op[1],\n                done: false\n              };\n\n            case 5:\n              _.label++;\n              y = op[1];\n              op = [0];\n              continue;\n\n            case 7:\n              op = _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n\n            default:\n              if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n                _ = 0;\n                continue;\n              }\n\n              if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n                _.label = op[1];\n                break;\n              }\n\n              if (op[0] === 6 && _.label < t[1]) {\n                _.label = t[1];\n                t = op;\n                break;\n              }\n\n              if (t && _.label < t[2]) {\n                _.label = t[2];\n\n                _.ops.push(op);\n\n                break;\n              }\n\n              if (t[2]) _.ops.pop();\n\n              _.trys.pop();\n\n              continue;\n          }\n\n          op = body.call(thisArg, _);\n        } catch (e) {\n          op = [6, e];\n          y = 0;\n        } finally {\n          f = t = 0;\n        }\n\n        if (op[0] & 5) throw op[1];\n        return {\n          value: op[0] ? op[1] : void 0,\n          done: true\n        };\n      }\n    };\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    var VRMSpringBone_1 = __webpack_require__(\n    /*! ./VRMSpringBone */\n    \"./src/vrm/springbone/VRMSpringBone.ts\");\n\n    var VRMSpringBoneManager_1 = __webpack_require__(\n    /*! ./VRMSpringBoneManager */\n    \"./src/vrm/springbone/VRMSpringBoneManager.ts\");\n\n    var VRMSpringBoneImporter = function () {\n      function VRMSpringBoneImporter() {}\n\n      VRMSpringBoneImporter.prototype.import = function (gltf) {\n        return __awaiter(this, void 0, Promise, function () {\n          var colliderGroups, springBoneGroupList;\n          return __generator(this, function (_a) {\n            switch (_a.label) {\n              case 0:\n                if (!gltf.parser.json.extensions || !gltf.parser.json.extensions.VRM || !gltf.parser.json.extensions.VRM.secondaryAnimation) {\n                  return [2, null];\n                }\n\n                return [4, this._getColliderMeshGroups(gltf)];\n\n              case 1:\n                colliderGroups = _a.sent();\n                colliderGroups.forEach(function (group) {\n                  var _a;\n\n                  return (_a = gltf.scene).add.apply(_a, group.colliders);\n                });\n                return [4, this._getSpringBoneGroupList(gltf, colliderGroups)];\n\n              case 2:\n                springBoneGroupList = _a.sent();\n                return [2, new VRMSpringBoneManager_1.VRMSpringBoneManager(springBoneGroupList)];\n            }\n          });\n        });\n      };\n\n      Object.defineProperty(VRMSpringBoneImporter.prototype, \"_isColiderMeshVisible\", {\n        get: function () {\n          return false;\n        },\n        enumerable: true,\n        configurable: true\n      });\n\n      VRMSpringBoneImporter.prototype._createSpringBone = function (gltf, bone, hitRadius, stiffiness, gravityDir, gravityPower, dragForce, colliders) {\n        if (colliders === void 0) {\n          colliders = [];\n        }\n\n        return new VRMSpringBone_1.VRMSpringBone(bone, hitRadius, stiffiness, gravityDir, gravityPower, dragForce, colliders);\n      };\n\n      VRMSpringBoneImporter.prototype._getSpringBoneGroupList = function (gltf, colliderGroups) {\n        return __awaiter(this, void 0, Promise, function () {\n          var springBoneGroups, springBoneGroupList;\n\n          var _this = this;\n\n          return __generator(this, function (_a) {\n            springBoneGroups = gltf.parser.json.extensions.VRM.secondaryAnimation.boneGroups;\n            springBoneGroupList = [];\n            springBoneGroups.forEach(function (vrmBoneGroup) {\n              if (vrmBoneGroup.stiffiness === undefined || vrmBoneGroup.gravityDir === undefined || vrmBoneGroup.gravityDir.x === undefined || vrmBoneGroup.gravityDir.y === undefined || vrmBoneGroup.gravityDir.z === undefined || vrmBoneGroup.gravityPower === undefined || vrmBoneGroup.dragForce === undefined || vrmBoneGroup.hitRadius === undefined || vrmBoneGroup.colliderGroups === undefined || vrmBoneGroup.bones === undefined) {\n                return;\n              }\n\n              var stiffiness = vrmBoneGroup.stiffiness;\n              var gravityDir = new THREE.Vector3(vrmBoneGroup.gravityDir.x, vrmBoneGroup.gravityDir.y, vrmBoneGroup.gravityDir.z);\n              var gravityPower = vrmBoneGroup.gravityPower;\n              var dragForce = vrmBoneGroup.dragForce;\n              var hitRadius = vrmBoneGroup.hitRadius;\n              var colliders = [];\n              vrmBoneGroup.colliderGroups.forEach(function (colliderIndex) {\n                colliders.push.apply(colliders, colliderGroups[colliderIndex].colliders);\n              });\n              var springBoneGroup = [];\n              vrmBoneGroup.bones.forEach(function (nodeIndex) {\n                return __awaiter(_this, void 0, void 0, function () {\n                  var springRootBone;\n\n                  var _this = this;\n\n                  return __generator(this, function (_a) {\n                    switch (_a.label) {\n                      case 0:\n                        return [4, gltf.parser.getDependency('node', nodeIndex)];\n\n                      case 1:\n                        springRootBone = _a.sent();\n\n                        if (!springRootBone) {\n                          return [2];\n                        }\n\n                        springRootBone.traverse(function (bone) {\n                          var springBone = _this._createSpringBone(gltf, bone, hitRadius, stiffiness, gravityDir, gravityPower, dragForce, colliders);\n\n                          springBoneGroup.push(springBone);\n                        });\n                        return [2];\n                    }\n                  });\n                });\n              });\n              springBoneGroupList.push(springBoneGroup);\n            });\n            return [2, springBoneGroupList];\n          });\n        });\n      };\n\n      VRMSpringBoneImporter.prototype._getColliderMeshGroups = function (gltf) {\n        return __awaiter(this, void 0, Promise, function () {\n          var vrmExt, secondaryAnimation, vrmColliderGroups, colliderGroups;\n\n          var _this = this;\n\n          return __generator(this, function (_a) {\n            vrmExt = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n\n            if (vrmExt === undefined) {\n              return [2, []];\n            }\n\n            secondaryAnimation = vrmExt.secondaryAnimation;\n\n            if (secondaryAnimation === undefined) {\n              return [2, []];\n            }\n\n            vrmColliderGroups = secondaryAnimation.colliderGroups;\n\n            if (vrmColliderGroups === undefined) {\n              return [2, []];\n            }\n\n            colliderGroups = [];\n            vrmColliderGroups.forEach(function (colliderGroup) {\n              return __awaiter(_this, void 0, void 0, function () {\n                var bone, colliders, colliderMeshGroup;\n\n                var _this = this;\n\n                return __generator(this, function (_a) {\n                  switch (_a.label) {\n                    case 0:\n                      if (colliderGroup.node === undefined || colliderGroup.colliders === undefined) {\n                        return [2];\n                      }\n\n                      return [4, gltf.parser.getDependency('node', colliderGroup.node)];\n\n                    case 1:\n                      bone = _a.sent();\n                      colliders = [];\n                      colliderGroup.colliders.forEach(function (collider) {\n                        if (collider.offset === undefined || collider.offset.x === undefined || collider.offset.y === undefined || collider.offset.z === undefined || collider.radius === undefined) {\n                          return;\n                        }\n\n                        var offsetMatrix = new THREE.Matrix4().makeTranslation(collider.offset.x, collider.offset.y, -collider.offset.z);\n                        var visible = _this._isColiderMeshVisible;\n                        var colliderMesh = new THREE.Mesh(new THREE.SphereBufferGeometry(collider.radius, 8, 4), new THREE.MeshBasicMaterial({\n                          color: 0xff00ff,\n                          visible: visible,\n                          wireframe: true,\n                          transparent: true,\n                          depthTest: false\n                        }));\n                        colliderMesh.material.renderOrder = VRMSpringBone_1.GIZMO_RENDER_ORDER;\n                        colliderMesh.name = 'vrmColliderSphere';\n                        colliderMesh.geometry.computeBoundingSphere();\n\n                        colliderMesh.updateMatrixWorld = function () {\n                          colliderMesh.matrixWorld.copy(bone.matrixWorld).multiply(offsetMatrix);\n                        };\n\n                        colliders.push(colliderMesh);\n                      });\n                      colliderMeshGroup = {\n                        node: colliderGroup.node,\n                        colliders: colliders\n                      };\n                      colliderGroups.push(colliderMeshGroup);\n                      return [2];\n                  }\n                });\n              });\n            });\n            return [2, colliderGroups];\n          });\n        });\n      };\n\n      return VRMSpringBoneImporter;\n    }();\n\n    exports.VRMSpringBoneImporter = VRMSpringBoneImporter;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/springbone/VRMSpringBoneManager.ts\":\n  /*!****************************************************!*\\\r\n    !*** ./src/vrm/springbone/VRMSpringBoneManager.ts ***!\r\n    \\****************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var VRMSpringBoneManager = function () {\n      function VRMSpringBoneManager(springBoneGroupList) {\n        this.springBoneGroupList = [];\n        this.springBoneGroupList = springBoneGroupList;\n      }\n\n      VRMSpringBoneManager.prototype.lateUpdate = function (delta) {\n        this.springBoneGroupList.forEach(function (springBoneGroup) {\n          springBoneGroup.forEach(function (springBone) {\n            springBone.update(delta);\n          });\n        });\n      };\n\n      VRMSpringBoneManager.prototype.reset = function () {\n        this.springBoneGroupList.forEach(function (springBoneGroup) {\n          springBoneGroup.forEach(function (springBone) {\n            springBone.reset();\n          });\n        });\n      };\n\n      return VRMSpringBoneManager;\n    }();\n\n    exports.VRMSpringBoneManager = VRMSpringBoneManager;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/springbone/index.ts\":\n  /*!*************************************!*\\\r\n    !*** ./src/vrm/springbone/index.ts ***!\r\n    \\*************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./VRMSpringBone */\n    \"./src/vrm/springbone/VRMSpringBone.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMSpringBoneColliderGroup */\n    \"./src/vrm/springbone/VRMSpringBoneColliderGroup.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMSpringBoneImporter */\n    \"./src/vrm/springbone/VRMSpringBoneImporter.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMSpringBoneManager */\n    \"./src/vrm/springbone/VRMSpringBoneManager.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/types/GLTFSchema.ts\":\n  /*!*************************************!*\\\r\n    !*** ./src/vrm/types/GLTFSchema.ts ***!\r\n    \\*************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/types/VRMSchema.ts\":\n  /*!************************************!*\\\r\n    !*** ./src/vrm/types/VRMSchema.ts ***!\r\n    \\************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    var VRMSchema;\n\n    (function (VRMSchema) {\n      var BlendShapePresetName;\n\n      (function (BlendShapePresetName) {\n        BlendShapePresetName[\"A\"] = \"a\";\n        BlendShapePresetName[\"Angry\"] = \"angry\";\n        BlendShapePresetName[\"Blink\"] = \"blink\";\n        BlendShapePresetName[\"BlinkL\"] = \"blink_l\";\n        BlendShapePresetName[\"BlinkR\"] = \"blink_r\";\n        BlendShapePresetName[\"E\"] = \"e\";\n        BlendShapePresetName[\"Fun\"] = \"fun\";\n        BlendShapePresetName[\"I\"] = \"i\";\n        BlendShapePresetName[\"Joy\"] = \"joy\";\n        BlendShapePresetName[\"Lookdown\"] = \"lookdown\";\n        BlendShapePresetName[\"Lookleft\"] = \"lookleft\";\n        BlendShapePresetName[\"Lookright\"] = \"lookright\";\n        BlendShapePresetName[\"Lookup\"] = \"lookup\";\n        BlendShapePresetName[\"Neutral\"] = \"neutral\";\n        BlendShapePresetName[\"O\"] = \"o\";\n        BlendShapePresetName[\"Sorrow\"] = \"sorrow\";\n        BlendShapePresetName[\"U\"] = \"u\";\n        BlendShapePresetName[\"Unknown\"] = \"unknown\";\n      })(BlendShapePresetName = VRMSchema.BlendShapePresetName || (VRMSchema.BlendShapePresetName = {}));\n\n      var FirstPersonLookAtTypeName;\n\n      (function (FirstPersonLookAtTypeName) {\n        FirstPersonLookAtTypeName[\"BlendShape\"] = \"BlendShape\";\n        FirstPersonLookAtTypeName[\"Bone\"] = \"Bone\";\n      })(FirstPersonLookAtTypeName = VRMSchema.FirstPersonLookAtTypeName || (VRMSchema.FirstPersonLookAtTypeName = {}));\n\n      var HumanoidBoneName;\n\n      (function (HumanoidBoneName) {\n        HumanoidBoneName[\"Chest\"] = \"chest\";\n        HumanoidBoneName[\"Head\"] = \"head\";\n        HumanoidBoneName[\"Hips\"] = \"hips\";\n        HumanoidBoneName[\"Jaw\"] = \"jaw\";\n        HumanoidBoneName[\"LeftEye\"] = \"leftEye\";\n        HumanoidBoneName[\"LeftFoot\"] = \"leftFoot\";\n        HumanoidBoneName[\"LeftHand\"] = \"leftHand\";\n        HumanoidBoneName[\"LeftIndexDistal\"] = \"leftIndexDistal\";\n        HumanoidBoneName[\"LeftIndexIntermediate\"] = \"leftIndexIntermediate\";\n        HumanoidBoneName[\"LeftIndexProximal\"] = \"leftIndexProximal\";\n        HumanoidBoneName[\"LeftLittleDistal\"] = \"leftLittleDistal\";\n        HumanoidBoneName[\"LeftLittleIntermediate\"] = \"leftLittleIntermediate\";\n        HumanoidBoneName[\"LeftLittleProximal\"] = \"leftLittleProximal\";\n        HumanoidBoneName[\"LeftLowerArm\"] = \"leftLowerArm\";\n        HumanoidBoneName[\"LeftLowerLeg\"] = \"leftLowerLeg\";\n        HumanoidBoneName[\"LeftMiddleDistal\"] = \"leftMiddleDistal\";\n        HumanoidBoneName[\"LeftMiddleIntermediate\"] = \"leftMiddleIntermediate\";\n        HumanoidBoneName[\"LeftMiddleProximal\"] = \"leftMiddleProximal\";\n        HumanoidBoneName[\"LeftRingDistal\"] = \"leftRingDistal\";\n        HumanoidBoneName[\"LeftRingIntermediate\"] = \"leftRingIntermediate\";\n        HumanoidBoneName[\"LeftRingProximal\"] = \"leftRingProximal\";\n        HumanoidBoneName[\"LeftShoulder\"] = \"leftShoulder\";\n        HumanoidBoneName[\"LeftThumbDistal\"] = \"leftThumbDistal\";\n        HumanoidBoneName[\"LeftThumbIntermediate\"] = \"leftThumbIntermediate\";\n        HumanoidBoneName[\"LeftThumbProximal\"] = \"leftThumbProximal\";\n        HumanoidBoneName[\"LeftToes\"] = \"leftToes\";\n        HumanoidBoneName[\"LeftUpperArm\"] = \"leftUpperArm\";\n        HumanoidBoneName[\"LeftUpperLeg\"] = \"leftUpperLeg\";\n        HumanoidBoneName[\"Neck\"] = \"neck\";\n        HumanoidBoneName[\"RightEye\"] = \"rightEye\";\n        HumanoidBoneName[\"RightFoot\"] = \"rightFoot\";\n        HumanoidBoneName[\"RightHand\"] = \"rightHand\";\n        HumanoidBoneName[\"RightIndexDistal\"] = \"rightIndexDistal\";\n        HumanoidBoneName[\"RightIndexIntermediate\"] = \"rightIndexIntermediate\";\n        HumanoidBoneName[\"RightIndexProximal\"] = \"rightIndexProximal\";\n        HumanoidBoneName[\"RightLittleDistal\"] = \"rightLittleDistal\";\n        HumanoidBoneName[\"RightLittleIntermediate\"] = \"rightLittleIntermediate\";\n        HumanoidBoneName[\"RightLittleProximal\"] = \"rightLittleProximal\";\n        HumanoidBoneName[\"RightLowerArm\"] = \"rightLowerArm\";\n        HumanoidBoneName[\"RightLowerLeg\"] = \"rightLowerLeg\";\n        HumanoidBoneName[\"RightMiddleDistal\"] = \"rightMiddleDistal\";\n        HumanoidBoneName[\"RightMiddleIntermediate\"] = \"rightMiddleIntermediate\";\n        HumanoidBoneName[\"RightMiddleProximal\"] = \"rightMiddleProximal\";\n        HumanoidBoneName[\"RightRingDistal\"] = \"rightRingDistal\";\n        HumanoidBoneName[\"RightRingIntermediate\"] = \"rightRingIntermediate\";\n        HumanoidBoneName[\"RightRingProximal\"] = \"rightRingProximal\";\n        HumanoidBoneName[\"RightShoulder\"] = \"rightShoulder\";\n        HumanoidBoneName[\"RightThumbDistal\"] = \"rightThumbDistal\";\n        HumanoidBoneName[\"RightThumbIntermediate\"] = \"rightThumbIntermediate\";\n        HumanoidBoneName[\"RightThumbProximal\"] = \"rightThumbProximal\";\n        HumanoidBoneName[\"RightToes\"] = \"rightToes\";\n        HumanoidBoneName[\"RightUpperArm\"] = \"rightUpperArm\";\n        HumanoidBoneName[\"RightUpperLeg\"] = \"rightUpperLeg\";\n        HumanoidBoneName[\"Spine\"] = \"spine\";\n        HumanoidBoneName[\"UpperChest\"] = \"upperChest\";\n      })(HumanoidBoneName = VRMSchema.HumanoidBoneName || (VRMSchema.HumanoidBoneName = {}));\n\n      var MetaAllowedUserName;\n\n      (function (MetaAllowedUserName) {\n        MetaAllowedUserName[\"Everyone\"] = \"Everyone\";\n        MetaAllowedUserName[\"ExplicitlyLicensedPerson\"] = \"ExplicitlyLicensedPerson\";\n        MetaAllowedUserName[\"OnlyAuthor\"] = \"OnlyAuthor\";\n      })(MetaAllowedUserName = VRMSchema.MetaAllowedUserName || (VRMSchema.MetaAllowedUserName = {}));\n\n      var MetaUssageName;\n\n      (function (MetaUssageName) {\n        MetaUssageName[\"Allow\"] = \"Allow\";\n        MetaUssageName[\"Disallow\"] = \"Disallow\";\n      })(MetaUssageName = VRMSchema.MetaUssageName || (VRMSchema.MetaUssageName = {}));\n\n      var MetaLicenseName;\n\n      (function (MetaLicenseName) {\n        MetaLicenseName[\"Cc0\"] = \"CC0\";\n        MetaLicenseName[\"CcBy\"] = \"CC_BY\";\n        MetaLicenseName[\"CcByNc\"] = \"CC_BY_NC\";\n        MetaLicenseName[\"CcByNcNd\"] = \"CC_BY_NC_ND\";\n        MetaLicenseName[\"CcByNcSa\"] = \"CC_BY_NC_SA\";\n        MetaLicenseName[\"CcByNd\"] = \"CC_BY_ND\";\n        MetaLicenseName[\"CcBySa\"] = \"CC_BY_SA\";\n        MetaLicenseName[\"Other\"] = \"Other\";\n        MetaLicenseName[\"RedistributionProhibited\"] = \"Redistribution_Prohibited\";\n      })(MetaLicenseName = VRMSchema.MetaLicenseName || (VRMSchema.MetaLicenseName = {}));\n    })(VRMSchema = exports.VRMSchema || (exports.VRMSchema = {}));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/types/index.ts\":\n  /*!********************************!*\\\r\n    !*** ./src/vrm/types/index.ts ***!\r\n    \\********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    function __export(m) {\n      for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n    }\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    __export(__webpack_require__(\n    /*! ./GLTFSchema */\n    \"./src/vrm/types/GLTFSchema.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./VRMSchema */\n    \"./src/vrm/types/VRMSchema.ts\"));\n\n    __export(__webpack_require__(\n    /*! ./types */\n    \"./src/vrm/types/types.ts\"));\n    /***/\n\n  },\n\n  /***/\n  \"./src/vrm/types/types.ts\":\n  /*!********************************!*\\\r\n    !*** ./src/vrm/types/types.ts ***!\r\n    \\********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/utils/disposer.ts\":\n  /*!***********************************!*\\\r\n    !*** ./src/vrm/utils/disposer.ts ***!\r\n    \\***********************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    function disposeMaterial(material) {\n      Object.keys(material).forEach(function (propertyName) {\n        if (!!material[propertyName] && typeof material[propertyName].dispose === 'function') {\n          material[propertyName].dispose();\n        }\n      });\n      material.dispose();\n      material = undefined;\n    }\n\n    function dispose(object3D) {\n      if (object3D.geometry) {\n        object3D.geometry.dispose();\n        object3D.geometry = undefined;\n      }\n\n      if (!!object3D.material && Array.isArray(object3D.material)) {\n        object3D.material.forEach(function (material) {\n          return disposeMaterial(material);\n        });\n      } else if (object3D.material) {\n        disposeMaterial(object3D.material);\n      }\n    }\n\n    function deepDispose(object3D) {\n      object3D.traverse(dispose);\n    }\n\n    exports.deepDispose = deepDispose;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/utils/math.ts\":\n  /*!*******************************!*\\\r\n    !*** ./src/vrm/utils/math.ts ***!\r\n    \\*******************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    var THREE = __webpack_require__(\n    /*! three */\n    \"three\");\n\n    function saturate(value) {\n      return Math.max(Math.min(value, 1.0), 0.0);\n    }\n\n    exports.saturate = saturate;\n\n    function linstep(x, min, max) {\n      if (x <= min) return 0;\n      if (x >= max) return 1;\n      return (x - min) / (max - min);\n    }\n\n    exports.linstep = linstep;\n\n    var _position = new THREE.Vector3();\n\n    var _scale = new THREE.Vector3();\n\n    var _rotation = new THREE.Quaternion();\n\n    function getWorldPositionLite(object, out) {\n      object.matrixWorld.decompose(out, _rotation, _scale);\n      return out;\n    }\n\n    exports.getWorldPositionLite = getWorldPositionLite;\n\n    function getWorldScaleLite(object, out) {\n      object.matrixWorld.decompose(_position, _rotation, out);\n      return out;\n    }\n\n    exports.getWorldScaleLite = getWorldScaleLite;\n\n    function getWorldQuaternionLite(object, out) {\n      object.matrixWorld.decompose(_position, out, _scale);\n      return out;\n    }\n\n    exports.getWorldQuaternionLite = getWorldQuaternionLite;\n    /***/\n  },\n\n  /***/\n  \"./src/vrm/utils/renameMaterialProperty.ts\":\n  /*!*************************************************!*\\\r\n    !*** ./src/vrm/utils/renameMaterialProperty.ts ***!\r\n    \\*************************************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports, __webpack_require__) {\n    \"use strict\";\n\n    Object.defineProperty(exports, \"__esModule\", {\n      value: true\n    });\n\n    function renameMaterialProperty(name) {\n      if (name[0] !== '_') {\n        console.warn(\"renameMaterialProperty: Given property name \\\"\" + name + \"\\\" might be invalid\");\n        return name;\n      }\n\n      name = name.substring(1);\n\n      if (!/[A-Z]/.test(name[0])) {\n        console.warn(\"renameMaterialProperty: Given property name \\\"\" + name + \"\\\" might be invalid\");\n        return name;\n      }\n\n      return name[0].toLowerCase() + name.substring(1);\n    }\n\n    exports.renameMaterialProperty = renameMaterialProperty;\n    /***/\n  },\n\n  /***/\n  \"three\":\n  /*!************************!*\\\r\n    !*** external \"THREE\" ***!\r\n    \\************************/\n\n  /*! no static exports found */\n\n  /***/\n  function (module, exports) {\n    module.exports = THREE;\n    /***/\n  }\n  /******/\n\n});","map":{"version":3,"sources":["webpack://__three_vrm__/webpack/bootstrap","webpack://__three_vrm__/src/assign.ts","webpack://__three_vrm__/src/index.ts","webpack://__three_vrm__/src/vrm/VRM.ts","webpack://__three_vrm__/src/vrm/VRMImporter.ts","webpack://__three_vrm__/src/vrm/blendshape/VRMBlendShapeGroup.ts","webpack://__three_vrm__/src/vrm/blendshape/VRMBlendShapeImporter.ts","webpack://__three_vrm__/src/vrm/blendshape/VRMBlendShapeProxy.ts","webpack://__three_vrm__/src/vrm/blendshape/index.ts","webpack://__three_vrm__/src/vrm/debug/VRMDebug.ts","webpack://__three_vrm__/src/vrm/debug/VRMImporterDebug.ts","webpack://__three_vrm__/src/vrm/debug/VRMLookAtHeadDebug.ts","webpack://__three_vrm__/src/vrm/debug/VRMLookAtImporterDebug.ts","webpack://__three_vrm__/src/vrm/debug/VRMSpringBoneDebug.ts","webpack://__three_vrm__/src/vrm/debug/VRMSpringBoneImporterDebug.ts","webpack://__three_vrm__/src/vrm/debug/index.ts","webpack://__three_vrm__/src/vrm/firstperson/VRMFirstPerson.ts","webpack://__three_vrm__/src/vrm/firstperson/VRMFirstPersonImporter.ts","webpack://__three_vrm__/src/vrm/firstperson/index.ts","webpack://__three_vrm__/src/vrm/humanoid/VRMHumanBone.ts","webpack://__three_vrm__/src/vrm/humanoid/VRMHumanoid.ts","webpack://__three_vrm__/src/vrm/humanoid/VRMHumanoidImporter.ts","webpack://__three_vrm__/src/vrm/humanoid/index.ts","webpack://__three_vrm__/src/vrm/index.ts","webpack://__three_vrm__/src/vrm/lookat/CurveMapper.ts","webpack://__three_vrm__/src/vrm/lookat/VRMLookAtApplyer.ts","webpack://__three_vrm__/src/vrm/lookat/VRMLookAtBlendShapeApplyer.ts","webpack://__three_vrm__/src/vrm/lookat/VRMLookAtBoneApplyer.ts","webpack://__three_vrm__/src/vrm/lookat/VRMLookAtHead.ts","webpack://__three_vrm__/src/vrm/lookat/VRMLookAtImporter.ts","webpack://__three_vrm__/src/vrm/lookat/index.ts","webpack://__three_vrm__/src/vrm/material/MToonMaterial.ts","webpack://__three_vrm__/src/vrm/material/VRMMaterialImporter.ts","webpack://__three_vrm__/src/vrm/material/VRMUnlitMaterial.ts","webpack://__three_vrm__/src/vrm/material/getTexelDecodingFunction.ts","webpack://__three_vrm__/src/vrm/material/index.ts","webpack://__three_vrm__/src/vrm/material/shaders/mtoon.frag","webpack://__three_vrm__/src/vrm/material/shaders/mtoon.vert","webpack://__three_vrm__/src/vrm/material/shaders/unlit.frag","webpack://__three_vrm__/src/vrm/material/shaders/unlit.vert","webpack://__three_vrm__/src/vrm/reduceBones.ts","webpack://__three_vrm__/src/vrm/springbone/VRMSpringBone.ts","webpack://__three_vrm__/src/vrm/springbone/VRMSpringBoneImporter.ts","webpack://__three_vrm__/src/vrm/springbone/VRMSpringBoneManager.ts","webpack://__three_vrm__/src/vrm/springbone/index.ts","webpack://__three_vrm__/src/vrm/types/VRMSchema.ts","webpack://__three_vrm__/src/vrm/types/index.ts","webpack://__three_vrm__/src/vrm/utils/disposer.ts","webpack://__three_vrm__/src/vrm/utils/math.ts","webpack://__three_vrm__/src/vrm/utils/renameMaterialProperty.ts","webpack:/__three_vrm__/external \"THREE\""],"names":[],"mappings":"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","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/assign.ts\");\n","/* eslint-disable */\nimport * as __three_vrm__ from '.';\n// @ts-ignore\nObject.assign(THREE, __three_vrm__);\n","export * from './vrm/';\n","import * as THREE from 'three';\nimport { VRMBlendShapeProxy } from './blendshape';\nimport { VRMFirstPerson } from './firstperson';\nimport { VRMHumanoid } from './humanoid';\nimport { VRMLookAtHead } from './lookat';\nimport { VRMSpringBoneManager } from './springbone';\nimport { VRMSchema } from './types';\nimport { deepDispose } from './utils/disposer';\nimport { VRMImporter, VRMImporterOptions } from './VRMImporter';\n\n/**\n * Parameters for a [[VRM]] class.\n */\nexport interface VRMParameters {\n  scene: THREE.Scene;\n  humanoid?: VRMHumanoid;\n  blendShapeProxy?: VRMBlendShapeProxy;\n  firstPerson?: VRMFirstPerson;\n  lookAt?: VRMLookAtHead;\n  materials?: THREE.Material[];\n  springBoneManager?: VRMSpringBoneManager;\n  meta?: VRMSchema.Meta;\n}\n\n/**\n * A class that represents a single VRM model.\n * See the documentation of [[VRM.from]] for the most basic use of VRM.\n */\nexport class VRM {\n  /**\n   * Create a new VRM from a parsed result of GLTF taken from GLTFLoader.\n   * It's probably a thing what you want to get started with VRMs.\n   *\n   * @example Most basic use of VRM\n   * ```\n   * const scene = new THREE.Scene();\n   *\n   * new THREE.GLTFLoader().load( 'models/three-vrm-girl.vrm', ( gltf ) => {\n   *\n   *   THREE.VRM.from( gltf ).then( ( vrm ) => {\n   *\n   *     scene.add( vrm.scene );\n   *\n   *   } );\n   *\n   * } );\n   * ```\n   *\n   * @param gltf A parsed GLTF object taken from GLTFLoader\n   * @param options Options that will be used in importer\n   */\n  public static async from(gltf: THREE.GLTF, options: VRMImporterOptions = {}): Promise<VRM> {\n    const importer = new VRMImporter(options);\n    return await importer.import(gltf);\n  }\n  /**\n   * `THREE.Scene` that contains the entire VRM.\n   */\n  public readonly scene: THREE.Scene;\n\n  /**\n   * Contains [[VRMHumanoid]] of the VRM.\n   * You can control each bones using [[VRMHumanoid.getBoneNode]].\n   *\n   * @TODO Add a link to VRM spec\n   */\n  public readonly humanoid?: VRMHumanoid;\n\n  /**\n   * Contains [[VRMBlendShapeProxy]] of the VRM.\n   * You might want to control these facial expressions via [[VRMBlendShapeProxy.setValue]].\n   */\n  public readonly blendShapeProxy?: VRMBlendShapeProxy;\n\n  /**\n   * Contains [[VRMFirstPerson]] of the VRM.\n   * You can use various feature of the firstPerson field.\n   */\n  public readonly firstPerson?: VRMFirstPerson;\n\n  /**\n   * Contains [[VRMLookAtHead]] of the VRM.\n   * You might want to use [[VRMLookAtHead.target]] to control the eye direction of your VRMs.\n   */\n  public readonly lookAt?: VRMLookAtHead;\n\n  /**\n   * Contains materials of the VRM.\n   * `updateVRMMaterials` method of these materials will be called via its [[VRM.update]] method.\n   */\n  public readonly materials?: THREE.Material[];\n\n  /**\n   * Contains meta fields of the VRM.\n   * You might want to refer these license fields before use your VRMs.\n   */\n  public readonly meta?: VRMSchema.Meta;\n\n  /**\n   * A [[VRMSpringBoneManager]] manipulates all spring bones attached on the VRM.\n   * Usually you don't have to care about this property.\n   */\n  public readonly springBoneManager?: VRMSpringBoneManager;\n\n  /**\n   * Create a new VRM instance.\n   *\n   * @param params [[VRMParameters]] that represents components of the VRM\n   */\n  public constructor(params: VRMParameters) {\n    this.scene = params.scene;\n    this.humanoid = params.humanoid;\n    this.blendShapeProxy = params.blendShapeProxy;\n    this.firstPerson = params.firstPerson;\n    this.lookAt = params.lookAt;\n    this.materials = params.materials;\n    this.springBoneManager = params.springBoneManager;\n    this.meta = params.meta;\n  }\n\n  /**\n   * **You need to call this on your update loop.**\n   *\n   * This function updates every VRM components.\n   *\n   * @param delta deltaTime\n   */\n  public update(delta: number): void {\n    if (this.lookAt) {\n      this.lookAt.update(delta);\n    }\n\n    if (this.blendShapeProxy) {\n      this.blendShapeProxy.update();\n    }\n\n    if (this.springBoneManager) {\n      this.springBoneManager.lateUpdate(delta);\n    }\n\n    if (this.materials) {\n      this.materials.forEach((material: any) => {\n        if (material.updateVRMMaterials) {\n          material.updateVRMMaterials(delta);\n        }\n      });\n    }\n  }\n\n  /**\n   * Dispose everything about the VRM instance.\n   */\n  public dispose(): void {\n    const scene = this.scene;\n    if (scene) {\n      while (scene.children.length > 0) {\n        const object = scene.children[scene.children.length - 1];\n        deepDispose(object);\n        scene.remove(object);\n      }\n    }\n  }\n}\n","import * as THREE from 'three';\nimport { VRMBlendShapeImporter } from './blendshape';\nimport { VRMFirstPersonImporter } from './firstperson';\nimport { VRMHumanoidImporter } from './humanoid/VRMHumanoidImporter';\nimport { VRMLookAtImporter } from './lookat/VRMLookAtImporter';\nimport { VRMMaterialImporter } from './material';\nimport { reduceBones } from './reduceBones';\nimport { VRMSpringBoneImporter } from './springbone/VRMSpringBoneImporter';\nimport { VRMSchema } from './types';\nimport { VRM } from './VRM';\n\nexport interface VRMImporterOptions {\n  lookAtImporter?: VRMLookAtImporter;\n  humanoidImporter?: VRMHumanoidImporter;\n  blendShapeImporter?: VRMBlendShapeImporter;\n  firstPersonImporter?: VRMFirstPersonImporter;\n  materialImporter?: VRMMaterialImporter;\n  springBoneImporter?: VRMSpringBoneImporter;\n}\n\n/**\n * An importer that imports a [[VRM]] from a VRM extension of a GLTF.\n */\nexport class VRMImporter {\n  protected readonly _blendShapeImporter: VRMBlendShapeImporter;\n  protected readonly _lookAtImporter: VRMLookAtImporter;\n  protected readonly _humanoidImporter: VRMHumanoidImporter;\n  protected readonly _firstPersonImporter: VRMFirstPersonImporter;\n  protected readonly _materialImporter: VRMMaterialImporter;\n  protected readonly _springBoneImporter: VRMSpringBoneImporter;\n\n  /**\n   * Create a new VRMImporter.\n   *\n   * @param options [[VRMImporterOptions]], optionally contains importers for each component\n   */\n  public constructor(options: VRMImporterOptions = {}) {\n    this._blendShapeImporter = options.blendShapeImporter || new VRMBlendShapeImporter();\n    this._lookAtImporter = options.lookAtImporter || new VRMLookAtImporter();\n    this._humanoidImporter = options.humanoidImporter || new VRMHumanoidImporter();\n    this._firstPersonImporter = options.firstPersonImporter || new VRMFirstPersonImporter();\n    this._materialImporter = options.materialImporter || new VRMMaterialImporter();\n    this._springBoneImporter = options.springBoneImporter || new VRMSpringBoneImporter();\n  }\n\n  /**\n   * Receive a GLTF object retrieved from `THREE.GLTFLoader` and create a new [[VRM]] instance.\n   *\n   * @param gltf A parsed result of GLTF taken from GLTFLoader\n   */\n  public async import(gltf: THREE.GLTF): Promise<VRM> {\n    if (gltf.parser.json.extensions === undefined || gltf.parser.json.extensions.VRM === undefined) {\n      throw new Error('Could not find VRM extension on the GLTF');\n    }\n    const vrmExt: VRMSchema.VRM = gltf.parser.json.extensions.VRM;\n\n    const scene = gltf.scene;\n\n    scene.updateMatrixWorld(false);\n\n    // Skinned object should not be frustumCulled\n    // Since pre-skinned position might be outside of view\n    scene.traverse((object3d) => {\n      if ((object3d as any).isMesh) {\n        object3d.frustumCulled = false;\n      }\n    });\n\n    reduceBones(scene);\n\n    const materials = (await this._materialImporter.convertGLTFMaterials(gltf)) || undefined;\n\n    const humanoid = (await this._humanoidImporter.import(gltf)) || undefined;\n\n    const firstPerson = humanoid ? (await this._firstPersonImporter.import(gltf, humanoid)) || undefined : undefined;\n\n    const blendShapeProxy = (await this._blendShapeImporter.import(gltf)) || undefined;\n\n    const lookAt =\n      firstPerson && blendShapeProxy && humanoid\n        ? (await this._lookAtImporter.import(gltf, firstPerson, blendShapeProxy, humanoid)) || undefined\n        : undefined;\n\n    const springBoneManager = (await this._springBoneImporter.import(gltf)) || undefined;\n\n    return new VRM({\n      scene: gltf.scene,\n      meta: vrmExt.meta,\n      materials,\n      humanoid,\n      firstPerson,\n      blendShapeProxy,\n      lookAt,\n      springBoneManager,\n    });\n  }\n}\n","import * as THREE from 'three';\nimport { GLTFPrimitive } from '../types';\n\nexport interface VRMBlendShapeBind {\n  meshes: GLTFPrimitive[];\n  morphTargetIndex: number;\n  weight: number;\n}\n\nenum VRMBlendShapeMaterialValueType {\n  NUMBER,\n  VECTOR2,\n  VECTOR3,\n  VECTOR4,\n  COLOR,\n}\n\nexport interface VRMBlendShapeMaterialValue {\n  material: THREE.Material;\n  propertyName: string;\n  defaultValue: number | THREE.Vector2 | THREE.Vector3 | THREE.Vector4 | THREE.Color;\n  targetValue: number | THREE.Vector2 | THREE.Vector3 | THREE.Vector4 | THREE.Color;\n  deltaValue: number | THREE.Vector2 | THREE.Vector3 | THREE.Vector4 | THREE.Color; // targetValue - defaultValue\n  type: VRMBlendShapeMaterialValueType;\n}\n\nconst _v2 = new THREE.Vector2();\nconst _v3 = new THREE.Vector3();\nconst _v4 = new THREE.Vector4();\nconst _color = new THREE.Color();\n\n// animationMixer Scene \n// Object3D  Scene \nexport class VRMBlendShapeGroup extends THREE.Object3D {\n  public weight = 0.0;\n  public isBinary = false;\n\n  private _binds: VRMBlendShapeBind[] = [];\n  private _materialValues: VRMBlendShapeMaterialValue[] = [];\n\n  constructor(expressionName: string) {\n    super();\n    this.name = `BlendShapeController_${expressionName}`;\n\n    // traverse  Object3D \n    this.type = 'BlendShapeController';\n    //  visible  false \n    //  matrix \n    this.visible = false;\n  }\n\n  public addBind(args: { meshes: GLTFPrimitive[]; morphTargetIndex: number; weight: number }): void {\n    // original weight is 0-100 but we want to deal with this value within 0-1\n    const weight = args.weight / 100;\n\n    this._binds.push({\n      meshes: args.meshes,\n      morphTargetIndex: args.morphTargetIndex,\n      weight,\n    });\n  }\n\n  public addMaterialValue(args: {\n    material: THREE.Material;\n    propertyName: string;\n    targetValue: number[];\n    defaultValue?: number | THREE.Vector2 | THREE.Vector3 | THREE.Vector4 | THREE.Color;\n  }): void {\n    const material = args.material;\n    const propertyName = args.propertyName;\n\n    let value = (material as any)[propertyName];\n    if (!value) {\n      // property has not been found\n      return;\n    }\n    value = args.defaultValue || value;\n\n    let type: VRMBlendShapeMaterialValueType;\n    let defaultValue: number | THREE.Vector2 | THREE.Vector3 | THREE.Vector4 | THREE.Color;\n    let targetValue: number | THREE.Vector2 | THREE.Vector3 | THREE.Vector4 | THREE.Color;\n    let deltaValue: number | THREE.Vector2 | THREE.Vector3 | THREE.Vector4 | THREE.Color;\n\n    if ((value as any).isVector2) {\n      type = VRMBlendShapeMaterialValueType.VECTOR2;\n      defaultValue = (value as THREE.Vector2).clone();\n      targetValue = new THREE.Vector2().fromArray(args.targetValue);\n      deltaValue = targetValue.clone().sub(defaultValue);\n    } else if ((value as any).isVector3) {\n      type = VRMBlendShapeMaterialValueType.VECTOR3;\n      defaultValue = (value as THREE.Vector3).clone();\n      targetValue = new THREE.Vector3().fromArray(args.targetValue);\n      deltaValue = targetValue.clone().sub(defaultValue);\n    } else if ((value as any).isVector4) {\n      type = VRMBlendShapeMaterialValueType.VECTOR4;\n      defaultValue = (value as THREE.Vector4).clone();\n\n      // vectorProperty and targetValue index is different from each other\n      // exported vrm by UniVRM file is\n      //\n      // vectorProperty\n      // offset = targetValue[0], targetValue[1]\n      // tiling = targetValue[2], targetValue[3]\n      //\n      // targetValue\n      // offset = targetValue[2], targetValue[3]\n      // tiling = targetValue[0], targetValue[1]\n      targetValue = new THREE.Vector4().fromArray([\n        args.targetValue[2],\n        args.targetValue[3],\n        args.targetValue[0],\n        args.targetValue[1],\n      ]);\n      deltaValue = targetValue.clone().sub(defaultValue);\n    } else if ((value as any).isColor) {\n      type = VRMBlendShapeMaterialValueType.COLOR;\n      defaultValue = (value as THREE.Color).clone();\n      targetValue = new THREE.Color().fromArray(args.targetValue);\n      deltaValue = targetValue.clone().sub(defaultValue);\n    } else {\n      type = VRMBlendShapeMaterialValueType.NUMBER;\n      defaultValue = value as number;\n      targetValue = args.targetValue[0];\n      deltaValue = targetValue - defaultValue;\n    }\n\n    this._materialValues.push({\n      material,\n      propertyName,\n      defaultValue,\n      targetValue,\n      deltaValue,\n      type,\n    });\n  }\n\n  /**\n   * Apply weight to every assigned blend shapes.\n   * Should be called via {@link BlendShapeMaster#update}.\n   */\n  public applyWeight(): void {\n    const w = this.isBinary ? (this.weight < 0.5 ? 0.0 : 1.0) : this.weight;\n\n    this._binds.forEach((bind) => {\n      bind.meshes.forEach((mesh) => {\n        if (!mesh.morphTargetInfluences) {\n          return;\n        } // TODO: we should kick this at `addBind`\n        mesh.morphTargetInfluences[bind.morphTargetIndex] += w * bind.weight;\n      });\n    });\n\n    this._materialValues.forEach((materialValue) => {\n      const prop = (materialValue.material as any)[materialValue.propertyName];\n      if (prop === undefined) {\n        return;\n      } // TODO: we should kick this at `addMaterialValue`\n\n      if (materialValue.type === VRMBlendShapeMaterialValueType.NUMBER) {\n        const deltaValue = materialValue.deltaValue as number;\n        (materialValue.material as any)[materialValue.propertyName] += deltaValue * w;\n      } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR2) {\n        const deltaValue = materialValue.deltaValue as THREE.Vector2;\n        (materialValue.material as any)[materialValue.propertyName].add(_v2.copy(deltaValue).multiplyScalar(w));\n      } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR3) {\n        const deltaValue = materialValue.deltaValue as THREE.Vector3;\n        (materialValue.material as any)[materialValue.propertyName].add(_v3.copy(deltaValue).multiplyScalar(w));\n      } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR4) {\n        const deltaValue = materialValue.deltaValue as THREE.Vector4;\n        (materialValue.material as any)[materialValue.propertyName].add(_v4.copy(deltaValue).multiplyScalar(w));\n      } else if (materialValue.type === VRMBlendShapeMaterialValueType.COLOR) {\n        const deltaValue = materialValue.deltaValue as THREE.Color;\n        (materialValue.material as any)[materialValue.propertyName].add(_color.copy(deltaValue).multiplyScalar(w));\n      }\n\n      if (typeof (materialValue.material as any).shouldApplyUniforms === 'boolean') {\n        (materialValue.material as any).shouldApplyUniforms = true;\n      }\n    });\n  }\n\n  /**\n   * Clear previously assigned blend shapes.\n   */\n  public clearAppliedWeight(): void {\n    this._binds.forEach((bind) => {\n      bind.meshes.forEach((mesh) => {\n        if (!mesh.morphTargetInfluences) {\n          return;\n        } // TODO: we should kick this at `addBind`\n        mesh.morphTargetInfluences[bind.morphTargetIndex] = 0.0;\n      });\n    });\n\n    this._materialValues.forEach((materialValue) => {\n      const prop = (materialValue.material as any)[materialValue.propertyName];\n      if (prop === undefined) {\n        return;\n      } // TODO: we should kick this at `addMaterialValue`\n\n      if (materialValue.type === VRMBlendShapeMaterialValueType.NUMBER) {\n        const defaultValue = materialValue.defaultValue as number;\n        (materialValue.material as any)[materialValue.propertyName] = defaultValue;\n      } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR2) {\n        const defaultValue = materialValue.defaultValue as THREE.Vector2;\n        (materialValue.material as any)[materialValue.propertyName].copy(defaultValue);\n      } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR3) {\n        const defaultValue = materialValue.defaultValue as THREE.Vector3;\n        (materialValue.material as any)[materialValue.propertyName].copy(defaultValue);\n      } else if (materialValue.type === VRMBlendShapeMaterialValueType.VECTOR4) {\n        const defaultValue = materialValue.defaultValue as THREE.Vector4;\n        (materialValue.material as any)[materialValue.propertyName].copy(defaultValue);\n      } else if (materialValue.type === VRMBlendShapeMaterialValueType.COLOR) {\n        const defaultValue = materialValue.defaultValue as THREE.Color;\n        (materialValue.material as any)[materialValue.propertyName].copy(defaultValue);\n      }\n\n      if (typeof (materialValue.material as any).shouldApplyUniforms === 'boolean') {\n        (materialValue.material as any).shouldApplyUniforms = true;\n      }\n    });\n  }\n}\n","import * as THREE from 'three';\nimport { GLTFMesh, GLTFPrimitive, VRMSchema } from '../types';\nimport { renameMaterialProperty } from '../utils/renameMaterialProperty';\nimport { VRMBlendShapeGroup } from './VRMBlendShapeGroup';\nimport { VRMBlendShapeProxy } from './VRMBlendShapeProxy';\n\n/**\n * An importer that imports a [[VRMBlendShape]] from a VRM extension of a GLTF.\n */\nexport class VRMBlendShapeImporter {\n  /**\n   * Import a [[VRMBlendShape]] from a VRM.\n   *\n   * @param gltf A parsed result of GLTF taken from GLTFLoader\n   */\n  public async import(gltf: THREE.GLTF): Promise<VRMBlendShapeProxy | null> {\n    const vrmExt: VRMSchema.VRM | undefined = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n    if (!vrmExt) {\n      return null;\n    }\n\n    const schemaBlendShape: VRMSchema.BlendShape | undefined = vrmExt.blendShapeMaster;\n    if (!schemaBlendShape) {\n      return null;\n    }\n\n    const blendShape = new VRMBlendShapeProxy();\n\n    const blendShapeGroups: VRMSchema.BlendShapeGroup[] | undefined = schemaBlendShape.blendShapeGroups;\n    if (!blendShapeGroups) {\n      return blendShape;\n    }\n\n    const blendShapePresetMap: { [presetName in VRMSchema.BlendShapePresetName]?: string } = {};\n\n    await Promise.all(\n      blendShapeGroups.map(async (schemaGroup) => {\n        const name = schemaGroup.name;\n        if (name === undefined) {\n          console.warn('VRMBlendShapeImporter: One of blendShapeGroups has no name');\n          return;\n        }\n\n        let presetName: VRMSchema.BlendShapePresetName | undefined;\n        if (\n          schemaGroup.presetName &&\n          schemaGroup.presetName !== VRMSchema.BlendShapePresetName.Unknown &&\n          !blendShapePresetMap[schemaGroup.presetName]\n        ) {\n          presetName = schemaGroup.presetName;\n          blendShapePresetMap[schemaGroup.presetName] = name;\n        }\n\n        const group = new VRMBlendShapeGroup(name);\n        gltf.scene.add(group);\n\n        group.isBinary = schemaGroup.isBinary || false;\n\n        if (schemaGroup.binds) {\n          schemaGroup.binds.forEach(async (bind) => {\n            if (bind.mesh === undefined || bind.index === undefined) {\n              return;\n            }\n\n            const morphMeshes: GLTFMesh = await gltf.parser.getDependency('mesh', bind.mesh);\n            const primitives: GLTFPrimitive[] =\n              morphMeshes.type === 'Group'\n                ? (morphMeshes.children as Array<GLTFPrimitive>)\n                : [morphMeshes as GLTFPrimitive];\n            const morphTargetIndex = bind.index;\n            if (\n              !primitives.every(\n                (primitive) =>\n                  Array.isArray(primitive.morphTargetInfluences) &&\n                  morphTargetIndex < primitive.morphTargetInfluences.length,\n              )\n            ) {\n              console.warn(\n                `VRMBlendShapeImporter: ${schemaGroup.name} attempts to index ${morphTargetIndex}th morph but not found.`,\n              );\n              return;\n            }\n\n            group.addBind({\n              meshes: primitives,\n              morphTargetIndex,\n              weight: bind.weight || 100,\n            });\n          });\n        }\n\n        const materialValues = schemaGroup.materialValues;\n        if (materialValues) {\n          materialValues.forEach((materialValue) => {\n            if (\n              materialValue.materialName === undefined ||\n              materialValue.propertyName === undefined ||\n              materialValue.targetValue === undefined\n            ) {\n              return;\n            }\n\n            const materials: THREE.Material[] = [];\n            gltf.scene.traverse((object) => {\n              if ((object as any).material) {\n                const material: THREE.Material[] | THREE.Material = (object as any).material;\n                if (Array.isArray(material)) {\n                  materials.push(\n                    ...material.filter(\n                      (mtl) => mtl.name === materialValue.materialName! && materials.indexOf(mtl) === -1,\n                    ),\n                  );\n                } else if (material.name === materialValue.materialName && materials.indexOf(material) === -1) {\n                  materials.push(material);\n                }\n              }\n            });\n\n            materials.forEach((material) => {\n              group.addMaterialValue({\n                material,\n                propertyName: renameMaterialProperty(materialValue.propertyName!),\n                targetValue: materialValue.targetValue!,\n              });\n            });\n          });\n        }\n\n        blendShape.registerBlendShapeGroup(name, presetName, group);\n      }),\n    );\n\n    return blendShape;\n  }\n}\n","import { VRMSchema } from '../types';\nimport { saturate } from '../utils/math';\nimport { VRMBlendShapeGroup } from './VRMBlendShapeGroup';\n\nexport class VRMBlendShapeProxy {\n  /**\n   * List of registered blend shape.\n   */\n  public readonly _blendShapeGroups: { [name: string]: VRMBlendShapeGroup } = {};\n\n  /**\n   * A map from [[VRMSchema.BlendShapePresetName]] to its actual blend shape name.\n   */\n  private readonly _blendShapePresetMap: { [presetName in VRMSchema.BlendShapePresetName]?: string } = {};\n\n  /**\n   * Create a new VRMBlendShape.\n   */\n  public constructor() {\n    // do nothing\n  }\n\n  /**\n   * List of name of registered blend shape group.\n   */\n  public get expressions(): string[] {\n    return Object.keys(this._blendShapeGroups);\n  }\n\n  /**\n   * Return registered blend shape group.\n   *\n   * @param name Name of the blend shape group\n   */\n  public getBlendShapeGroup(name: string | VRMSchema.BlendShapePresetName): VRMBlendShapeGroup | undefined {\n    const presetName = this._blendShapePresetMap[name as VRMSchema.BlendShapePresetName];\n    const controller = presetName ? this._blendShapeGroups[presetName] : this._blendShapeGroups[name];\n    if (!controller) {\n      console.warn(`no blend shape found by ${name}`);\n      return undefined;\n    }\n    return controller;\n  }\n\n  /**\n   * Register a blend shape group.\n   *\n   * @param name Name of the blend shape gorup\n   * @param controller VRMBlendShapeController that describes the blend shape group\n   */\n  public registerBlendShapeGroup(\n    name: string,\n    presetName: VRMSchema.BlendShapePresetName | undefined,\n    controller: VRMBlendShapeGroup,\n  ): void {\n    this._blendShapeGroups[name] = controller;\n    if (presetName) {\n      this._blendShapePresetMap[presetName] = name;\n    }\n  }\n\n  /**\n   * Get current weight of specified blend shape group.\n   *\n   * @param name Name of the blend shape group\n   */\n  public getValue(name: VRMSchema.BlendShapePresetName | string): number | null {\n    const controller = this.getBlendShapeGroup(name);\n    return (controller && controller.weight) || null;\n  }\n\n  /**\n   * Set a weight to specified blend shape group.\n   *\n   * @param name Name of the blend shape group\n   * @param weight Weight\n   */\n  public setValue(name: VRMSchema.BlendShapePresetName | string, weight: number): void {\n    const controller = this.getBlendShapeGroup(name);\n    if (controller) {\n      controller.weight = saturate(weight);\n    }\n  }\n\n  /**\n   * Get a track name of specified blend shape group.\n   * This track name is needed to manipulate its blend shape group via keyframe animations.\n   *\n   * @example Manipulate a blend shape group using keyframe animation\n   * ```js\n   * const trackName = vrm.blendShapeProxy.getBlendShapeTrackName( THREE.VRMSchema.BlendShapePresetName.Blink );\n   * const track = new THREE.NumberKeyframeTrack(\n   *   name,\n   *   [ 0.0, 0.5, 1.0 ], // times\n   *   [ 0.0, 1.0, 0.0 ] // values\n   * );\n   *\n   * const clip = new THREE.AnimationClip(\n   *   'blink', // name\n   *   1.0, // duration\n   *   [ track ] // tracks\n   * );\n   *\n   * const mixer = new THREE.AnimationMixer( vrm.scene );\n   * const action = mixer.clipAction( clip );\n   * action.play();\n   * ```\n   *\n   * @param name Name of the blend shape group\n   */\n  public getBlendShapeTrackName(name: VRMSchema.BlendShapePresetName | string): string | null {\n    const controller = this.getBlendShapeGroup(name);\n    return controller ? `${controller.name}.weight` : null;\n  }\n\n  /**\n   * Update every blend shape groups.\n   */\n  public update(): void {\n    Object.keys(this._blendShapeGroups).forEach((name) => {\n      const controller = this._blendShapeGroups[name];\n      controller.clearAppliedWeight();\n    });\n\n    Object.keys(this._blendShapeGroups).forEach((name) => {\n      const controller = this._blendShapeGroups[name];\n      controller.applyWeight();\n    });\n  }\n}\n","export * from './VRMBlendShapeGroup';\nexport * from './VRMBlendShapeImporter';\nexport * from './VRMBlendShapeProxy';\n","import * as THREE from 'three';\nimport { VRM, VRMParameters } from '../VRM';\nimport { VRMImporterOptions } from '../VRMImporter';\nimport { VRMDebugOptions } from './VRMDebugOptions';\nimport { VRMImporterDebug } from './VRMImporterDebug';\n\n/**\n * [[VRM]] but it has some useful gizmos.\n */\nexport class VRMDebug extends VRM {\n  /**\n   * Create a new VRMDebug from a parsed result of GLTF taken from GLTFLoader.\n   *\n   * See [[VRM.from]] for a detailed example.\n   *\n   * @param gltf A parsed GLTF object taken from GLTFLoader\n   * @param options Options that will be used in importer\n   * @param debugOption Options for VRMDebug features\n   */\n  public static async from(\n    gltf: THREE.GLTF,\n    options: VRMImporterOptions = {},\n    debugOption: VRMDebugOptions = {},\n  ): Promise<VRM> {\n    const importer = new VRMImporterDebug(options);\n    return await importer.import(gltf, debugOption);\n  }\n\n  /**\n   * Create a new VRMDebug instance.\n   *\n   * @param params [[VRMParameters]] that represents components of the VRM\n   * @param debugOption Options for VRMDebug features\n   */\n  constructor(params: VRMParameters, debugOption: VRMDebugOptions = {}) {\n    super(params);\n\n    // Gizmo\n    if (!debugOption.disableBoxHelper) {\n      this.scene.add(new THREE.BoxHelper(this.scene));\n    }\n\n    if (!debugOption.disableSkeletonHelper) {\n      this.scene.add(new THREE.SkeletonHelper(this.scene));\n    }\n  }\n\n  public update(delta: number): void {\n    super.update(delta);\n  }\n}\n","import * as THREE from 'three';\nimport { reduceBones } from '../reduceBones';\nimport { VRMImporter, VRMImporterOptions } from '../VRMImporter';\nimport { VRMDebug } from './VRMDebug';\nimport { VRMDebugOptions } from './VRMDebugOptions';\nimport { VRMLookAtHeadDebug } from './VRMLookAtHeadDebug';\nimport { VRMLookAtImporterDebug } from './VRMLookAtImporterDebug';\nimport { VRMSpringBoneImporterDebug } from './VRMSpringBoneImporterDebug';\n\n/**\n * An importer that imports a [[VRMDebug]] from a VRM extension of a GLTF.\n */\nexport class VRMImporterDebug extends VRMImporter {\n  public constructor(options: VRMImporterOptions = {}) {\n    options.lookAtImporter = options.lookAtImporter || new VRMLookAtImporterDebug();\n    options.springBoneImporter = options.springBoneImporter || new VRMSpringBoneImporterDebug();\n    super(options);\n  }\n\n  public async import(gltf: THREE.GLTF, debugOptions: VRMDebugOptions = {}): Promise<VRMDebug> {\n    if (gltf.parser.json.extensions === undefined || gltf.parser.json.extensions.VRM === undefined) {\n      throw new Error('Could not find VRM extension on the GLTF');\n    }\n    const vrmExt = gltf.parser.json.extensions.VRM;\n\n    const scene = gltf.scene;\n\n    scene.updateMatrixWorld(false);\n\n    // Skinned object should not be frustumCulled\n    // Since pre-skinned position might be outside of view\n    scene.traverse((object3d) => {\n      if ((object3d as any).isMesh) {\n        object3d.frustumCulled = false;\n      }\n    });\n\n    reduceBones(scene);\n\n    const materials = (await this._materialImporter.convertGLTFMaterials(gltf)) || undefined;\n\n    const humanoid = (await this._humanoidImporter.import(gltf)) || undefined;\n\n    const firstPerson = humanoid ? (await this._firstPersonImporter.import(gltf, humanoid)) || undefined : undefined;\n\n    const blendShapeProxy = (await this._blendShapeImporter.import(gltf)) || undefined;\n\n    const lookAt =\n      firstPerson && blendShapeProxy && humanoid\n        ? (await this._lookAtImporter.import(gltf, firstPerson, blendShapeProxy, humanoid)) || undefined\n        : undefined;\n    if ((lookAt as any).setupHelper) {\n      (lookAt as VRMLookAtHeadDebug).setupHelper(scene, debugOptions);\n    }\n\n    const springBoneManager = (await this._springBoneImporter.import(gltf)) || undefined;\n\n    return new VRMDebug(\n      {\n        scene: gltf.scene,\n        meta: vrmExt.meta,\n        materials,\n        humanoid,\n        firstPerson,\n        blendShapeProxy,\n        lookAt,\n        springBoneManager,\n      },\n      debugOptions,\n    );\n  }\n}\n","import * as THREE from 'three';\nimport { VRMLookAtHead } from '../lookat/VRMLookAtHead';\nimport { VRMDebugOptions } from './VRMDebugOptions';\n\nconst _v3 = new THREE.Vector3();\n\nexport class VRMLookAtHeadDebug extends VRMLookAtHead {\n  private _faceDirectionHelper?: THREE.ArrowHelper;\n\n  public setupHelper(scene: THREE.Scene, debugOption: VRMDebugOptions): void {\n    if (!debugOption.disableFaceDirectionHelper) {\n      this._faceDirectionHelper = new THREE.ArrowHelper(\n        new THREE.Vector3(0, 0, -1),\n        new THREE.Vector3(0, 0, 0),\n        0.5,\n        0xff00ff,\n      );\n      scene.add(this._faceDirectionHelper);\n    }\n  }\n\n  public update(delta: number): void {\n    super.update(delta);\n\n    if (this._faceDirectionHelper) {\n      this.firstPerson.getFirstPersonWorldPosition(this._faceDirectionHelper.position);\n      this._faceDirectionHelper.setDirection(this.getLookAtWorldDirection(_v3));\n    }\n  }\n}\n","import * as THREE from 'three';\nimport { VRMBlendShapeProxy } from '../blendshape';\nimport { VRMFirstPerson } from '../firstperson';\nimport { VRMHumanoid } from '../humanoid';\nimport { VRMLookAtHead } from '../lookat/VRMLookAtHead';\nimport { VRMLookAtImporter } from '../lookat/VRMLookAtImporter';\nimport { VRMSchema } from '../types';\nimport { VRMLookAtHeadDebug } from './VRMLookAtHeadDebug';\n\nexport class VRMLookAtImporterDebug extends VRMLookAtImporter {\n  public import(\n    gltf: THREE.GLTF,\n    firstPerson: VRMFirstPerson,\n    blendShapeProxy: VRMBlendShapeProxy,\n    humanoid: VRMHumanoid,\n  ): VRMLookAtHead | null {\n    const vrmExt: VRMSchema.VRM | undefined = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n    if (!vrmExt) {\n      return null;\n    }\n\n    const schemaFirstPerson: VRMSchema.FirstPerson | undefined = vrmExt.firstPerson;\n    if (!schemaFirstPerson) {\n      return null;\n    }\n\n    const applyer = this._importApplyer(schemaFirstPerson, blendShapeProxy, humanoid);\n    return new VRMLookAtHeadDebug(firstPerson, applyer || undefined);\n  }\n}\n","import * as THREE from 'three';\nimport { GIZMO_RENDER_ORDER, VRMSpringBone } from '../springbone';\n\nconst _v3A = new THREE.Vector3();\n\nexport class VRMSpringBoneDebug extends VRMSpringBone {\n  private _gizmo?: THREE.ArrowHelper;\n\n  constructor(\n    bone: THREE.Object3D,\n    radius: number,\n    stiffiness: number,\n    gravityDir: THREE.Vector3,\n    gravityPower: number,\n    dragForce: number,\n    colliders: THREE.Mesh[] = [],\n  ) {\n    super(bone, radius, stiffiness, gravityDir, gravityPower, dragForce, colliders);\n  }\n\n  /**\n   * Return spring bone gizmo, as `THREE.ArrowHelper`.\n   * Useful in debugging spring bones.\n   */\n  public getGizmo(): THREE.ArrowHelper {\n    // return if gizmo is already existed\n    if (this._gizmo) {\n      return this._gizmo;\n    }\n\n    const nextTailRelative = _v3A.copy(this._nextTail).sub(this._worldPosition);\n    const nextTailRelativeLength = nextTailRelative.length();\n\n    this._gizmo = new THREE.ArrowHelper(\n      nextTailRelative.normalize(),\n      this._worldPosition,\n      nextTailRelativeLength,\n      0xffff00,\n      this.radius,\n      this.radius,\n    );\n\n    // it should be always visible\n    this._gizmo.line.renderOrder = GIZMO_RENDER_ORDER;\n    this._gizmo.cone.renderOrder = GIZMO_RENDER_ORDER;\n    (this._gizmo.line.material as THREE.Material).depthTest = false;\n    (this._gizmo.line.material as THREE.Material).transparent = true;\n    (this._gizmo.cone.material as THREE.Material).depthTest = false;\n    (this._gizmo.cone.material as THREE.Material).transparent = true;\n\n    return this._gizmo;\n  }\n\n  public update(delta: number): void {\n    super.update(delta);\n    // lastly we're gonna update gizmo\n    this._updateGizmo();\n  }\n\n  private _updateGizmo(): void {\n    if (!this._gizmo) {\n      return;\n    }\n\n    const nextTailRelative = _v3A.copy(this._currentTail).sub(this._worldPosition);\n    const nextTailRelativeLength = nextTailRelative.length();\n\n    this._gizmo.setDirection(nextTailRelative.normalize());\n    this._gizmo.setLength(nextTailRelativeLength, this.radius, this.radius);\n    this._gizmo.position.copy(this._worldPosition);\n  }\n}\n","import * as THREE from 'three';\nimport { VRMSpringBone } from '../springbone/VRMSpringBone';\nimport { VRMSpringBoneImporter } from '../springbone/VRMSpringBoneImporter';\nimport { VRMSpringBoneDebug } from './VRMSpringBoneDebug';\n\nexport class VRMSpringBoneImporterDebug extends VRMSpringBoneImporter {\n  protected get _isColiderMeshVisible(): boolean {\n    return true;\n  }\n\n  protected _createSpringBone(\n    gltf: THREE.GLTF,\n    bone: THREE.Object3D,\n    hitRadius: number,\n    stiffiness: number,\n    gravityDir: THREE.Vector3,\n    gravityPower: number,\n    dragForce: number,\n    colliders: THREE.Mesh[] = [],\n  ): VRMSpringBone {\n    const springBone = new VRMSpringBoneDebug(\n      bone,\n      hitRadius,\n      stiffiness,\n      gravityDir,\n      gravityPower,\n      dragForce,\n      colliders,\n    );\n    gltf.scene.add(springBone.getGizmo());\n    return springBone;\n  }\n}\n","export * from './VRMDebugOptions';\nexport * from './VRMDebug';\nexport * from './VRMSpringBoneDebug';\nexport * from './VRMSpringBoneImporterDebug';\n","import * as THREE from 'three';\nimport { GLTFMesh, GLTFNode } from '../types';\nimport { getWorldQuaternionLite } from '../utils/math';\n\nconst VECTOR3_FRONT = Object.freeze(new THREE.Vector3(0.0, 0.0, -1.0));\n\nconst _quat = new THREE.Quaternion();\n\nenum FirstPersonFlag {\n  Auto,\n  Both,\n  ThirdPersonOnly,\n  FirstPersonOnly,\n}\n\n/**\n * This class represents a single [`meshAnnotation`](https://github.com/vrm-c/UniVRM/blob/master/specification/0.0/schema/vrm.firstperson.meshannotation.schema.json) entry.\n * Each mesh will be assigned to specified layer when you call [[VRMFirstPerson.setup]].\n */\nexport class VRMRendererFirstPersonFlags {\n  private static _parseFirstPersonFlag(firstPersonFlag: string | undefined): FirstPersonFlag {\n    switch (firstPersonFlag) {\n      case 'Both':\n        return FirstPersonFlag.Both;\n      case 'ThirdPersonOnly':\n        return FirstPersonFlag.ThirdPersonOnly;\n      case 'FirstPersonOnly':\n        return FirstPersonFlag.FirstPersonOnly;\n      default:\n        return FirstPersonFlag.Auto;\n    }\n  }\n\n  /**\n   * A [[FirstPersonFlag]] of the annotation entry.\n   */\n  public firstPersonFlag: FirstPersonFlag;\n\n  /**\n   * A mesh of the annotation entry.\n   */\n  public mesh: GLTFMesh;\n\n  /**\n   * Create a new mesh annotation.\n   *\n   * @param firstPersonFlag A [[FirstPersonFlag]] of the annotation entry\n   * @param node A node of the annotation entry.\n   */\n  constructor(firstPersonFlag: string | undefined, mesh: GLTFMesh) {\n    this.firstPersonFlag = VRMRendererFirstPersonFlags._parseFirstPersonFlag(firstPersonFlag);\n    this.mesh = mesh;\n  }\n}\n\nexport class VRMFirstPerson {\n  /**\n   * A default camera layer for `FirstPersonOnly` layer.\n   *\n   * @see [[getFirstPersonOnlyLayer]]\n   */\n  private static readonly _DEFAULT_FIRSTPERSON_ONLY_LAYER = 9;\n\n  /**\n   * A default camera layer for `ThirdPersonOnly` layer.\n   *\n   * @see [[getThirdPersonOnlyLayer]]\n   */\n  private static readonly _DEFAULT_THIRDPERSON_ONLY_LAYER = 10;\n\n  private readonly _firstPersonBone: GLTFNode;\n  private readonly _meshAnnotations: VRMRendererFirstPersonFlags[] = [];\n  private readonly _firstPersonBoneOffset: THREE.Vector3;\n\n  private _firstPersonOnlyLayer = VRMFirstPerson._DEFAULT_FIRSTPERSON_ONLY_LAYER;\n  private _thirdPersonOnlyLayer = VRMFirstPerson._DEFAULT_THIRDPERSON_ONLY_LAYER;\n\n  private _initialized = false;\n\n  /**\n   * Create a new VRMFirstPerson object.\n   *\n   * @param firstPersonBone A first person bone\n   * @param firstPersonBoneOffset An offset from the specified first person bone\n   * @param meshAnnotations A renderer settings. See the description of [[RendererFirstPersonFlags]] for more info\n   */\n  constructor(\n    firstPersonBone: GLTFNode,\n    firstPersonBoneOffset: THREE.Vector3,\n    meshAnnotations: VRMRendererFirstPersonFlags[],\n  ) {\n    this._firstPersonBone = firstPersonBone;\n    this._firstPersonBoneOffset = firstPersonBoneOffset;\n    this._meshAnnotations = meshAnnotations;\n  }\n\n  public get firstPersonBone(): GLTFNode {\n    return this._firstPersonBone;\n  }\n\n  public get meshAnnotations(): VRMRendererFirstPersonFlags[] {\n    return this._meshAnnotations;\n  }\n\n  public getFirstPersonWorldDirection(target: THREE.Vector3): THREE.Vector3 {\n    return target.copy(VECTOR3_FRONT).applyQuaternion(getWorldQuaternionLite(this._firstPersonBone, _quat));\n  }\n\n  /**\n   * A camera layer represents `FirstPersonOnly` layer.\n   * Note that **you must call [[setup]] first before you use the layer feature** or it does not work properly.\n   *\n   * The value is [[DEFAULT_FIRSTPERSON_ONLY_LAYER]] by default but you can change the layer by specifying via [[setup]] if you prefer.\n   *\n   * @see https://vrm.dev/en/univrm/api/univrm_use_firstperson/\n   * @see https://threejs.org/docs/#api/en/core/Layers\n   */\n  public get firstPersonOnlyLayer(): number {\n    return this._firstPersonOnlyLayer;\n  }\n\n  /**\n   * A camera layer represents `ThirdPersonOnly` layer.\n   * Note that **you must call [[setup]] first before you use the layer feature** or it does not work properly.\n   *\n   * The value is [[DEFAULT_THIRDPERSON_ONLY_LAYER]] by default but you can change the layer by specifying via [[setup]] if you prefer.\n   *\n   * @see https://vrm.dev/en/univrm/api/univrm_use_firstperson/\n   * @see https://threejs.org/docs/#api/en/core/Layers\n   */\n  public get thirdPersonOnlyLayer(): number {\n    return this._thirdPersonOnlyLayer;\n  }\n\n  public getFirstPersonBoneOffset(target: THREE.Vector3): THREE.Vector3 {\n    return target.copy(this._firstPersonBoneOffset);\n  }\n\n  /**\n   * Get current world position of the first person.\n   * The position takes [[FirstPersonBone]] and [[FirstPersonOffset]] into account.\n   *\n   * @param v3 target\n   * @returns Current world position of the first person\n   */\n  public getFirstPersonWorldPosition(v3: THREE.Vector3): THREE.Vector3 {\n    // UniVRM#VRMFirstPersonEditor\n    // var worldOffset = head.localToWorldMatrix.MultiplyPoint(component.FirstPersonOffset);\n    const offset = this._firstPersonBoneOffset;\n    const v4 = new THREE.Vector4(offset.x, offset.y, offset.z, 1.0);\n    v4.applyMatrix4(this._firstPersonBone.matrixWorld);\n    return v3.set(v4.x, v4.y, v4.z);\n  }\n\n  /**\n   * In this method, it assigns layers for every meshes based on mesh annotations.\n   * You must call this method first before you use the layer feature.\n   *\n   * This is an equivalent of [VRMFirstPerson.Setup](https://github.com/vrm-c/UniVRM/blob/master/Assets/VRM/UniVRM/Scripts/FirstPerson/VRMFirstPerson.cs) of the UniVRM.\n   *\n   * The `cameraLayer` parameter specifies which layer will be assigned for `FirstPersonOnly` / `ThirdPersonOnly`.\n   * In UniVRM, we specified those by naming each desired layer as `FIRSTPERSON_ONLY_LAYER` / `THIRDPERSON_ONLY_LAYER`\n   * but we are going to specify these layers at here since we are unable to name layers in Three.js.\n   *\n   * @param cameraLayer Specify which layer will be for `FirstPersonOnly` / `ThirdPersonOnly`.\n   */\n  public setup({\n    firstPersonOnlyLayer = VRMFirstPerson._DEFAULT_FIRSTPERSON_ONLY_LAYER,\n    thirdPersonOnlyLayer = VRMFirstPerson._DEFAULT_THIRDPERSON_ONLY_LAYER,\n  } = {}): void {\n    if (this._initialized) {\n      return;\n    }\n    this._initialized = true;\n    this._firstPersonOnlyLayer = firstPersonOnlyLayer;\n    this._thirdPersonOnlyLayer = thirdPersonOnlyLayer;\n\n    this._meshAnnotations.forEach((item) => {\n      if (item.firstPersonFlag === FirstPersonFlag.FirstPersonOnly) {\n        item.mesh.layers.set(this._firstPersonOnlyLayer);\n        item.mesh.traverse((child) => child.layers.set(this._firstPersonOnlyLayer));\n      } else if (item.firstPersonFlag === FirstPersonFlag.ThirdPersonOnly) {\n        item.mesh.layers.set(this._thirdPersonOnlyLayer);\n        item.mesh.traverse((child) => child.layers.set(this._thirdPersonOnlyLayer));\n      } else if (item.firstPersonFlag === FirstPersonFlag.Auto) {\n        this._createHeadlessModel(item.mesh);\n      }\n    });\n  }\n\n  private _excludeTriangles(triangles: number[], bws: number[][], skinIndex: number[][], exclude: number[]): number {\n    let count = 0;\n    if (bws != null && bws.length > 0) {\n      for (let i = 0; i < triangles.length; i += 3) {\n        const a = triangles[i];\n        const b = triangles[i + 1];\n        const c = triangles[i + 2];\n        const bw0 = bws[a];\n        const skin0 = skinIndex[a];\n\n        if (bw0[0] > 0 && exclude.includes(skin0[0])) continue;\n        if (bw0[1] > 0 && exclude.includes(skin0[1])) continue;\n        if (bw0[2] > 0 && exclude.includes(skin0[2])) continue;\n        if (bw0[3] > 0 && exclude.includes(skin0[3])) continue;\n\n        const bw1 = bws[b];\n        const skin1 = skinIndex[b];\n        if (bw1[0] > 0 && exclude.includes(skin1[0])) continue;\n        if (bw1[1] > 0 && exclude.includes(skin1[1])) continue;\n        if (bw1[2] > 0 && exclude.includes(skin1[2])) continue;\n        if (bw1[3] > 0 && exclude.includes(skin1[3])) continue;\n\n        const bw2 = bws[c];\n        const skin2 = skinIndex[c];\n        if (bw2[0] > 0 && exclude.includes(skin2[0])) continue;\n        if (bw2[1] > 0 && exclude.includes(skin2[1])) continue;\n        if (bw2[2] > 0 && exclude.includes(skin2[2])) continue;\n        if (bw2[3] > 0 && exclude.includes(skin2[3])) continue;\n\n        triangles[count++] = a;\n        triangles[count++] = b;\n        triangles[count++] = c;\n      }\n    }\n    return count;\n  }\n\n  private _createErasedMesh(src: THREE.SkinnedMesh, erasingBonesIndex: number[]): THREE.SkinnedMesh {\n    const dst = new THREE.SkinnedMesh(src.geometry.clone(), src.material);\n    dst.name = `${src.name}(erase)`;\n    dst.frustumCulled = src.frustumCulled;\n    dst.layers.set(this._firstPersonOnlyLayer);\n\n    const geometry = dst.geometry as THREE.BufferGeometry;\n    const skinIndexAttr = geometry.getAttribute('skinIndex').array;\n    const skinIndex = [];\n    for (let i = 0; i < skinIndexAttr.length; i += 4) {\n      skinIndex.push([skinIndexAttr[i], skinIndexAttr[i + 1], skinIndexAttr[i + 2], skinIndexAttr[i + 3]]);\n    }\n    const skinWeightAttr = geometry.getAttribute('skinWeight').array;\n    const skinWeight = [];\n    for (let i = 0; i < skinWeightAttr.length; i += 4) {\n      skinWeight.push([skinWeightAttr[i], skinWeightAttr[i + 1], skinWeightAttr[i + 2], skinWeightAttr[i + 3]]);\n    }\n    const oldTriangles = Array.from(geometry.getIndex().array);\n    const count = this._excludeTriangles(oldTriangles, skinWeight, skinIndex, erasingBonesIndex);\n    const newTriangle: number[] = [];\n    for (let i = 0; i < count; i++) {\n      newTriangle[i] = oldTriangles[i];\n    }\n    geometry.setIndex(newTriangle);\n\n    // mtoon material includes onBeforeRender. this is unsupported at SkinnedMesh#clone\n    if (src.onBeforeRender) {\n      dst.onBeforeRender = src.onBeforeRender;\n    }\n    dst.bind(new THREE.Skeleton(src.skeleton.bones, src.skeleton.boneInverses), new THREE.Matrix4());\n    return dst;\n  }\n\n  private _createHeadlessModelForSkinnedMesh(parent: THREE.Object3D, mesh: THREE.SkinnedMesh): void {\n    const eraseBoneIndexes: number[] = [];\n    mesh.skeleton.bones.forEach((bone, index) => {\n      if (this._isEraseTarget(bone)) eraseBoneIndexes.push(index);\n    });\n\n    // Unlike UniVRM we don't copy mesh if no invisible bone was found\n    if (!eraseBoneIndexes.length) {\n      mesh.layers.enable(this._thirdPersonOnlyLayer);\n      mesh.layers.enable(this._firstPersonOnlyLayer);\n      return;\n    }\n    mesh.layers.set(this._thirdPersonOnlyLayer);\n    const newMesh = this._createErasedMesh(mesh, eraseBoneIndexes);\n    parent.add(newMesh);\n  }\n\n  private _createHeadlessModel(node: GLTFNode): void {\n    if (node.type === 'Group') {\n      node.layers.set(this._thirdPersonOnlyLayer);\n      if (this._isEraseTarget(node)) {\n        node.traverse((child) => child.layers.set(this._thirdPersonOnlyLayer));\n      } else {\n        const parent = new THREE.Group();\n        parent.name = `_headless_${node.name}`;\n        parent.layers.set(this._firstPersonOnlyLayer);\n        node.parent!.add(parent);\n        node.children\n          .filter((child) => child.type === 'SkinnedMesh')\n          .forEach((child) => {\n            this._createHeadlessModelForSkinnedMesh(parent, child as THREE.SkinnedMesh);\n          });\n      }\n    } else if (node.type === 'SkinnedMesh') {\n      this._createHeadlessModelForSkinnedMesh(node.parent!, node as THREE.SkinnedMesh);\n    } else {\n      if (this._isEraseTarget(node)) {\n        node.layers.set(this._thirdPersonOnlyLayer);\n        node.traverse((child) => child.layers.set(this._thirdPersonOnlyLayer));\n      }\n    }\n  }\n\n  private _isEraseTarget(bone: GLTFNode): boolean {\n    if (bone.name === this._firstPersonBone.name) {\n      return true;\n    } else if (!bone.parent) {\n      return false;\n    } else {\n      return this._isEraseTarget(bone.parent!);\n    }\n  }\n}\n","import * as THREE from 'three';\nimport { VRMHumanoid } from '../humanoid';\nimport { GLTFMesh, GLTFNode, VRMSchema } from '../types';\nimport { VRMFirstPerson, VRMRendererFirstPersonFlags } from './VRMFirstPerson';\n\n/**\n * An importer that imports a [[VRMFirstPerson]] from a VRM extension of a GLTF.\n */\nexport class VRMFirstPersonImporter {\n  /**\n   * Import a [[VRMFirstPerson]] from a VRM.\n   *\n   * @param gltf A parsed result of GLTF taken from GLTFLoader\n   * @param humanoid A [[VRMHumanoid]] instance that represents the VRM\n   */\n  public async import(gltf: THREE.GLTF, humanoid: VRMHumanoid): Promise<VRMFirstPerson | null> {\n    const vrmExt: VRMSchema.VRM | undefined = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n    if (!vrmExt) {\n      return null;\n    }\n\n    const schemaFirstPerson: VRMSchema.FirstPerson | undefined = vrmExt.firstPerson;\n    if (!schemaFirstPerson) {\n      return null;\n    }\n\n    const firstPersonBoneIndex = schemaFirstPerson.firstPersonBone;\n\n    let firstPersonBone: GLTFNode | null;\n    if (firstPersonBoneIndex === undefined || firstPersonBoneIndex === -1) {\n      firstPersonBone = humanoid.getBoneNode(VRMSchema.HumanoidBoneName.Head);\n    } else {\n      firstPersonBone = await gltf.parser.getDependency('node', firstPersonBoneIndex);\n    }\n\n    if (!firstPersonBone) {\n      console.warn('VRMFirstPersonImporter: Could not find firstPersonBone of the VRM');\n      return null;\n    }\n\n    const firstPersonBoneOffset = schemaFirstPerson.firstPersonBoneOffset\n      ? new THREE.Vector3(\n          schemaFirstPerson.firstPersonBoneOffset.x,\n          schemaFirstPerson.firstPersonBoneOffset.y,\n          schemaFirstPerson.firstPersonBoneOffset.z,\n        )\n      : new THREE.Vector3(0.0, 0.06, 0.0); // fallback, taken from UniVRM implementation\n\n    const meshAnnotations: VRMRendererFirstPersonFlags[] = [];\n    const meshes: GLTFMesh[] = await gltf.parser.getDependencies('mesh');\n    meshes.forEach((mesh, meshIndex) => {\n      const flag = schemaFirstPerson.meshAnnotations\n        ? schemaFirstPerson.meshAnnotations.find((a) => a.mesh === meshIndex)\n        : undefined;\n      meshAnnotations.push(new VRMRendererFirstPersonFlags(flag && flag.firstPersonFlag, mesh));\n    });\n\n    return new VRMFirstPerson(firstPersonBone, firstPersonBoneOffset, meshAnnotations);\n  }\n}\n","export * from './VRMFirstPerson';\nexport * from './VRMFirstPersonImporter';\n","import { GLTFNode } from '../types';\nimport { VRMHumanLimit } from './VRMHumanLimit';\n\n/**\n * A class represents a single `humanBone` of a VRM.\n */\nexport class VRMHumanBone {\n  /**\n   * A [[GLTFNode]] (that actually is a `THREE.Object3D`) that represents the bone.\n   */\n  public readonly node: GLTFNode;\n\n  /**\n   * A [[VRMHumanLimit]] object that represents properties of the bone.\n   */\n  public readonly humanLimit: VRMHumanLimit;\n\n  /**\n   * Create a new VRMHumanBone.\n   *\n   * @param node A [[GLTFNode]] that represents the new bone\n   * @param humanLimit A [[VRMHumanLimit]] object that represents properties of the new bone\n   */\n  public constructor(node: GLTFNode, humanLimit: VRMHumanLimit) {\n    this.node = node;\n    this.humanLimit = humanLimit;\n  }\n}\n","import { GLTFNode, RawVector3, RawVector4, VRMPose, VRMSchema } from '../types';\nimport { VRMHumanBone } from './VRMHumanBone';\nimport { VRMHumanBoneArray } from './VRMHumanBoneArray';\nimport { VRMHumanBones } from './VRMHumanBones';\nimport { VRMHumanDescription } from './VRMHumanDescription';\n\n/**\n * A class represents humanoid of a VRM.\n */\nexport class VRMHumanoid {\n  /**\n   * A [[VRMHumanBones]] that contains all the human bones of the VRM.\n   * You might want to get these bones using [[VRMHumanoid.getBone]].\n   */\n  public readonly humanBones: VRMHumanBones;\n\n  /**\n   * A [[VRMHumanDescription]] that represents properties of the humanoid.\n   */\n  public readonly humanDescription: VRMHumanDescription;\n\n  /**\n   * A [[VRMPose]] that is its default state.\n   * You might use [[VRMHumanoid.setPose]] with this pose to reset its state.\n   */\n  public readonly restPose: VRMPose;\n\n  /**\n   * Create a new [[VRMHumanoid]].\n   * @param boneArray A [[VRMHumanBoneArray]] contains all the bones of the new humanoid\n   * @param humanDescription A [[VRMHumanDescription]] that represents properties of the new humanoid\n   */\n  public constructor(boneArray: VRMHumanBoneArray, humanDescription: VRMHumanDescription) {\n    this.humanBones = this._createHumanBones(boneArray);\n    this.humanDescription = humanDescription;\n\n    this.restPose = this.getPose();\n  }\n\n  /**\n   * Return the current pose of this humanoid as a [[VRMPose]].\n   */\n  public getPose(): VRMPose {\n    const pose: VRMPose = {};\n    Object.keys(this.humanBones).forEach(\n      (vrmBoneName) => {\n        const node = this.getBoneNode(vrmBoneName as VRMSchema.HumanoidBoneName)!;\n\n        // Ignore when there are no bone on the VRMHumanoid\n        if (!node) {\n          return;\n        }\n\n        // When there are two or more bones in a same name, we are not going to overwrite existing one\n        if (pose[vrmBoneName]) {\n          return;\n        }\n\n        pose[vrmBoneName] = {\n          position: node.position.toArray() as RawVector3,\n          rotation: node.quaternion.toArray() as RawVector4,\n        };\n      },\n      {} as VRMPose,\n    );\n    return pose;\n  }\n\n  /**\n   * Let the humanoid do a specified pose.\n   *\n   * @param poseObject A [[VRMPose]] that represents a single pose\n   */\n  public setPose(poseObject: VRMPose): void {\n    Object.keys(poseObject).forEach((boneName) => {\n      const state = poseObject[boneName]!;\n      const node = this.getBoneNode(boneName as VRMSchema.HumanoidBoneName);\n\n      // Ignore when there are no bone that is defined in the pose on the VRMHumanoid\n      if (!node) {\n        return;\n      }\n\n      const restState = this.restPose[boneName];\n      if (!restState) {\n        return;\n      }\n\n      if (state.position) {\n        // \n        node.position.set(\n          restState.position![0] + state.position[0],\n          restState.position![1] + state.position[1],\n          restState.position![2] + state.position[2],\n        );\n      }\n      if (state.rotation) {\n        node.quaternion.fromArray(state.rotation);\n      }\n    });\n  }\n\n  /**\n   * Return a bone bound to a specified [[HumanBone]], as a [[VRMHumanBone]].\n   *\n   * See also: [[VRMHumanoid.getBones]]\n   *\n   * @param name Name of the bone you want\n   */\n  public getBone(name: VRMSchema.HumanoidBoneName): VRMHumanBone | undefined {\n    return this.humanBones[name][0] || undefined;\n  }\n\n  /**\n   * Return bones bound to a specified [[HumanBone]], as an array of [[VRMHumanBone]].\n   *\n   * See also: [[VRMHumanoid.getBone]]\n   *\n   * @param name Name of the bone you want\n   */\n  public getBones(name: VRMSchema.HumanoidBoneName): VRMHumanBone[] {\n    return this.humanBones[name];\n  }\n\n  /**\n   * Return a bone bound to a specified [[HumanBone]], as a THREE.Object3D.\n   *\n   * See also: [[VRMHumanoid.getBoneNodes]]\n   *\n   * @param name Name of the bone you want\n   */\n  public getBoneNode(name: VRMSchema.HumanoidBoneName): GLTFNode | null {\n    return (this.humanBones[name][0] && this.humanBones[name][0].node) || null;\n  }\n\n  /**\n   * Return bones bound to a specified [[HumanBone]], as an array of THREE.Object3D.\n   *\n   * See also: [[VRMHumanoid.getBoneNode]]\n   *\n   * @param name Name of the bone you want\n   */\n  public getBoneNodes(name: VRMSchema.HumanoidBoneName): GLTFNode[] {\n    return this.humanBones[name].map((bone) => bone.node);\n  }\n\n  /**\n   * Prepare a [[VRMHumanBones]] from a [[VRMHumanBoneArray]].\n   */\n  private _createHumanBones(boneArray: VRMHumanBoneArray): VRMHumanBones {\n    const bones: VRMHumanBones = Object.values(VRMSchema.HumanoidBoneName).reduce((accum, name) => {\n      accum[name] = [];\n      return accum;\n    }, {});\n\n    boneArray.forEach((bone) => {\n      bones[bone.name].push(bone.bone);\n    });\n\n    return bones;\n  }\n}\n","import * as THREE from 'three';\nimport { VRMSchema } from '../types';\nimport { VRMHumanBone } from './VRMHumanBone';\nimport { VRMHumanBoneArray } from './VRMHumanBoneArray';\nimport { VRMHumanDescription } from './VRMHumanDescription';\nimport { VRMHumanoid } from './VRMHumanoid';\n\n/**\n * An importer that imports a [[VRMHumanoid]] from a VRM extension of a GLTF.\n */\nexport class VRMHumanoidImporter {\n  /**\n   * Import a [[VRMHumanoid]] from a VRM.\n   *\n   * @param gltf A parsed result of GLTF taken from GLTFLoader\n   */\n  public async import(gltf: THREE.GLTF): Promise<VRMHumanoid | null> {\n    const vrmExt: VRMSchema.VRM | undefined = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n    if (!vrmExt) {\n      return null;\n    }\n\n    const schemaHumanoid: VRMSchema.Humanoid | undefined = vrmExt.humanoid;\n    if (!schemaHumanoid) {\n      return null;\n    }\n\n    const humanBoneArray: VRMHumanBoneArray = [];\n    if (schemaHumanoid.humanBones) {\n      await Promise.all(\n        schemaHumanoid.humanBones.map(async (bone) => {\n          if (!bone.bone || !bone.node) {\n            return;\n          }\n\n          const node = await gltf.parser.getDependency('node', bone.node);\n          humanBoneArray.push({\n            name: bone.bone,\n            bone: new VRMHumanBone(node, {\n              axisLength: bone.axisLength,\n              center: bone.center && new THREE.Vector3(bone.center.x, bone.center.y, bone.center.z),\n              max: bone.max && new THREE.Vector3(bone.max.x, bone.max.y, bone.max.z),\n              min: bone.min && new THREE.Vector3(bone.min.x, bone.min.y, bone.min.z),\n              useDefaultValues: bone.useDefaultValues,\n            }),\n          });\n        }),\n      );\n    }\n\n    const humanDescription: VRMHumanDescription = {\n      armStretch: schemaHumanoid.armStretch,\n      legStretch: schemaHumanoid.legStretch,\n      upperArmTwist: schemaHumanoid.upperArmTwist,\n      lowerArmTwist: schemaHumanoid.lowerArmTwist,\n      upperLegTwist: schemaHumanoid.upperLegTwist,\n      lowerLegTwist: schemaHumanoid.lowerLegTwist,\n      feetSpacing: schemaHumanoid.feetSpacing,\n      hasTranslationDoF: schemaHumanoid.hasTranslationDoF,\n    };\n\n    return new VRMHumanoid(humanBoneArray, humanDescription);\n  }\n}\n","export * from './VRMHumanBone';\nexport * from './VRMHumanBones';\nexport * from './VRMHumanDescription';\nexport * from './VRMHumanLimit';\nexport * from './VRMHumanoid';\nexport * from './VRMHumanoidImporter';\n","export * from './VRM';\nexport * from './VRMImporter';\nexport * from './reduceBones';\nexport * from './blendshape';\nexport * from './debug';\nexport * from './firstperson';\nexport * from './humanoid';\nexport * from './lookat';\nexport * from './springbone';\nexport * from './types';\nexport * from './material';\n","/**\n * Evaluate a hermite spline.\n *\n * @param y0 y on start\n * @param y1 y on end\n * @param t0 delta y on start\n * @param t1 delta y on end\n * @param x input value\n */\nconst hermiteSpline = (y0: number, y1: number, t0: number, t1: number, x: number): number => {\n  const xc = x * x * x;\n  const xs = x * x;\n  const dy = y1 - y0;\n  const h01 = -2.0 * xc + 3.0 * xs;\n  const h10 = xc - 2.0 * xs + x;\n  const h11 = xc - xs;\n  return y0 + dy * h01 + t0 * h10 + t1 * h11;\n};\n\n/**\n * Evaluate an AnimationCurve array. See AnimationCurve class of Unity for its details.\n *\n * See: https://docs.unity3d.com/ja/current/ScriptReference/AnimationCurve.html\n *\n * @param arr An array represents a curve\n * @param x An input value\n */\nconst evaluateCurve = (arr: number[], x: number): number => {\n  // -- sanity check -----------------------------------------------------------\n  if (arr.length < 8) {\n    throw new Error('evaluateCurve: Invalid curve detected! (Array length must be 8 at least)');\n  }\n  if (arr.length % 4 !== 0) {\n    throw new Error('evaluateCurve: Invalid curve detected! (Array length must be multiples of 4');\n  }\n\n  // -- check range ------------------------------------------------------------\n  let outNode;\n  for (outNode = 0; ; outNode++) {\n    if (arr.length <= 4 * outNode) {\n      return arr[4 * outNode - 3]; // too further!! assume as \"Clamp\"\n    } else if (x <= arr[4 * outNode]) {\n      break;\n    }\n  }\n\n  const inNode = outNode - 1;\n  if (inNode < 0) {\n    return arr[4 * inNode + 5]; // too behind!! assume as \"Clamp\"\n  }\n\n  // -- calculate local x ------------------------------------------------------\n  const x0 = arr[4 * inNode];\n  const x1 = arr[4 * outNode];\n  const xHermite = (x - x0) / (x1 - x0);\n\n  // -- finally do the hermite spline ------------------------------------------\n  const y0 = arr[4 * inNode + 1];\n  const y1 = arr[4 * outNode + 1];\n  const t0 = arr[4 * inNode + 3];\n  const t1 = arr[4 * outNode + 2];\n  return hermiteSpline(y0, y1, t0, t1, xHermite);\n};\n\n/**\n * This is an equivalent of CurveMapper class defined in UniVRM.\n * Will be used for [[VRMLookAtApplyer]]s, to define behavior of LookAt.\n *\n * See: https://github.com/vrm-c/UniVRM/blob/master/Assets/VRM/UniVRM/Scripts/LookAt/CurveMapper.cs\n */\nexport class CurveMapper {\n  /**\n   * An array represents the curve. See AnimationCurve class of Unity for its details.\n   *\n   * See: https://docs.unity3d.com/ja/current/ScriptReference/AnimationCurve.html\n   */\n  public curve: number[] = [0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0];\n\n  /**\n   * The maximum input range of the [[CurveMapper]].\n   */\n  public curveXRangeDegree = 90.0;\n\n  /**\n   * The maximum output value of the [[CurveMapper]].\n   */\n  public curveYRangeDegree = 10.0;\n\n  /**\n   * Create a new [[CurveMapper]].\n   *\n   * @param xRange The maximum input range\n   * @param yRange The maximum output value\n   * @param curve An array represents the curve\n   */\n  constructor(xRange?: number, yRange?: number, curve?: number[]) {\n    if (xRange !== undefined) {\n      this.curveXRangeDegree = xRange;\n    }\n\n    if (yRange !== undefined) {\n      this.curveYRangeDegree = yRange;\n    }\n\n    if (curve !== undefined) {\n      this.curve = curve;\n    }\n  }\n\n  /**\n   * Evaluate an input value and output a mapped value.\n   *\n   * @param src The input value\n   */\n  public map(src: number): number {\n    const clampedSrc = Math.min(Math.max(src, 0.0), this.curveXRangeDegree);\n    const x = clampedSrc / this.curveXRangeDegree;\n    return this.curveYRangeDegree * evaluateCurve(this.curve, x);\n  }\n}\n","import * as THREE from 'three';\nimport { VRMSchema } from '../types';\n\n/**\n * This class is used by [[VRMLookAtHead]], applies look at direction.\n * There are currently two variant of applier: [[VRMLookAtBoneApplyer]] and [[VRMLookAtBlendShapeApplyer]].\n */\nexport abstract class VRMLookAtApplyer {\n  /**\n   * It represents its type of applier.\n   */\n  public abstract readonly type: VRMSchema.FirstPersonLookAtTypeName;\n\n  /**\n   * Apply look at direction to its associated VRM model.\n   *\n   * @param euler `THREE.Euler` object that represents the look at direction\n   */\n  public abstract lookAt(euler: THREE.Euler): void;\n}\n","import * as THREE from 'three';\nimport { VRMBlendShapeProxy } from '../blendshape';\nimport { VRMSchema } from '../types';\nimport { CurveMapper } from './CurveMapper';\nimport { VRMLookAtApplyer } from './VRMLookAtApplyer';\n\n/**\n * This class is used by [[VRMLookAtHead]], applies look at direction to eye blend shapes of a VRM.\n */\nexport class VRMLookAtBlendShapeApplyer extends VRMLookAtApplyer {\n  public readonly type = VRMSchema.FirstPersonLookAtTypeName.BlendShape;\n\n  private readonly _curveHorizontal: CurveMapper;\n  private readonly _curveVerticalDown: CurveMapper;\n  private readonly _curveVerticalUp: CurveMapper;\n\n  private readonly _blendShapeProxy: VRMBlendShapeProxy;\n\n  /**\n   * Create a new VRMLookAtBlendShapeApplyer.\n   *\n   * @param blendShapeProxy A [[VRMBlendShapeProxy]] used by this applier\n   * @param curveHorizontal A [[CurveMapper]] used for transverse direction\n   * @param curveVerticalDown A [[CurveMapper]] used for down direction\n   * @param curveVerticalUp A [[CurveMapper]] used for up direction\n   */\n  constructor(\n    blendShapeProxy: VRMBlendShapeProxy,\n    curveHorizontal: CurveMapper,\n    curveVerticalDown: CurveMapper,\n    curveVerticalUp: CurveMapper,\n  ) {\n    super();\n\n    this._curveHorizontal = curveHorizontal;\n    this._curveVerticalDown = curveVerticalDown;\n    this._curveVerticalUp = curveVerticalUp;\n\n    this._blendShapeProxy = blendShapeProxy;\n  }\n\n  public name(): VRMSchema.FirstPersonLookAtTypeName {\n    return VRMSchema.FirstPersonLookAtTypeName.BlendShape;\n  }\n\n  public lookAt(euler: THREE.Euler): void {\n    const srcX = euler.x;\n    const srcY = euler.y;\n\n    if (srcX < 0.0) {\n      this._blendShapeProxy.setValue(VRMSchema.BlendShapePresetName.Lookup, 0.0);\n      this._blendShapeProxy.setValue(VRMSchema.BlendShapePresetName.Lookdown, this._curveVerticalDown.map(-srcX));\n    } else {\n      this._blendShapeProxy.setValue(VRMSchema.BlendShapePresetName.Lookdown, 0.0);\n      this._blendShapeProxy.setValue(VRMSchema.BlendShapePresetName.Lookup, this._curveVerticalUp.map(srcX));\n    }\n\n    if (srcY < 0.0) {\n      this._blendShapeProxy.setValue(VRMSchema.BlendShapePresetName.Lookleft, 0.0);\n      this._blendShapeProxy.setValue(VRMSchema.BlendShapePresetName.Lookright, this._curveHorizontal.map(-srcY));\n    } else {\n      this._blendShapeProxy.setValue(VRMSchema.BlendShapePresetName.Lookright, 0.0);\n      this._blendShapeProxy.setValue(VRMSchema.BlendShapePresetName.Lookleft, this._curveHorizontal.map(srcY));\n    }\n  }\n}\n","import * as THREE from 'three';\nimport { VRMHumanoid } from '../humanoid';\nimport { GLTFNode, VRMSchema } from '../types';\nimport { CurveMapper } from './CurveMapper';\nimport { VRMLookAtApplyer } from './VRMLookAtApplyer';\nimport { VRMLookAtHead } from './VRMLookAtHead';\n\nconst _euler = new THREE.Euler(0.0, 0.0, 0.0, VRMLookAtHead.EULER_ORDER);\n\n/**\n * This class is used by [[VRMLookAtHead]], applies look at direction to eye bones of a VRM.\n */\nexport class VRMLookAtBoneApplyer extends VRMLookAtApplyer {\n  public readonly type = VRMSchema.FirstPersonLookAtTypeName.Bone;\n\n  private readonly _curveHorizontalInner: CurveMapper;\n  private readonly _curveHorizontalOuter: CurveMapper;\n  private readonly _curveVerticalDown: CurveMapper;\n  private readonly _curveVerticalUp: CurveMapper;\n\n  private readonly _leftEye: GLTFNode | null;\n  private readonly _rightEye: GLTFNode | null;\n\n  /**\n   * Create a new VRMLookAtBoneApplyer.\n   *\n   * @param humanoid A [[VRMHumanoid]] used by this applier\n   * @param curveHorizontalInner A [[CurveMapper]] used for inner transverse direction\n   * @param curveHorizontalOuter A [[CurveMapper]] used for outer transverse direction\n   * @param curveVerticalDown A [[CurveMapper]] used for down direction\n   * @param curveVerticalUp A [[CurveMapper]] used for up direction\n   */\n  constructor(\n    humanoid: VRMHumanoid,\n    curveHorizontalInner: CurveMapper,\n    curveHorizontalOuter: CurveMapper,\n    curveVerticalDown: CurveMapper,\n    curveVerticalUp: CurveMapper,\n  ) {\n    super();\n\n    this._curveHorizontalInner = curveHorizontalInner;\n    this._curveHorizontalOuter = curveHorizontalOuter;\n    this._curveVerticalDown = curveVerticalDown;\n    this._curveVerticalUp = curveVerticalUp;\n\n    this._leftEye = humanoid.getBoneNode(VRMSchema.HumanoidBoneName.LeftEye);\n    this._rightEye = humanoid.getBoneNode(VRMSchema.HumanoidBoneName.RightEye);\n  }\n\n  public lookAt(euler: THREE.Euler): void {\n    const srcX = euler.x;\n    const srcY = euler.y;\n\n    // left\n    if (this._leftEye) {\n      if (srcX < 0.0) {\n        _euler.x = -this._curveVerticalDown.map(-srcX);\n      } else {\n        _euler.x = this._curveVerticalUp.map(srcX);\n      }\n\n      if (srcY < 0.0) {\n        _euler.y = -this._curveHorizontalInner.map(-srcY);\n      } else {\n        _euler.y = this._curveHorizontalOuter.map(srcY);\n      }\n\n      this._leftEye.quaternion.setFromEuler(_euler);\n    }\n\n    // right\n    if (this._rightEye) {\n      if (srcX < 0.0) {\n        _euler.x = -this._curveVerticalDown.map(-srcX);\n      } else {\n        _euler.x = this._curveVerticalUp.map(srcX);\n      }\n\n      if (srcY < 0.0) {\n        _euler.y = -this._curveHorizontalOuter.map(-srcY);\n      } else {\n        _euler.y = this._curveHorizontalInner.map(srcY);\n      }\n\n      this._rightEye.quaternion.setFromEuler(_euler);\n    }\n  }\n}\n","import * as THREE from 'three';\nimport { VRMFirstPerson } from '../firstperson/VRMFirstPerson';\nimport { getWorldQuaternionLite } from '../utils/math';\nimport { VRMLookAtApplyer } from './VRMLookAtApplyer';\n\nconst VECTOR3_FRONT = Object.freeze(new THREE.Vector3(0.0, 0.0, -1.0));\n\nconst _v3A = new THREE.Vector3();\nconst _v3B = new THREE.Vector3();\nconst _v3C = new THREE.Vector3();\nconst _quat = new THREE.Quaternion();\n\n/**\n * A class represents look at of a VRM.\n */\nexport class VRMLookAtHead {\n  public static readonly EULER_ORDER = 'YXZ'; // yaw-pitch-roll\n\n  /**\n   * Associated [[VRMFirstPerson]], will be used for direction calculation.\n   */\n  public readonly firstPerson: VRMFirstPerson;\n\n  /**\n   * Associated [[VRMLookAtApplyer]], its look at direction will be applied to the model using this applier.\n   */\n  public readonly applyer?: VRMLookAtApplyer;\n\n  /**\n   * If this is true, its look at direction will be updated automatically by calling [[VRMLookAtHead.update]] (which is called from [[VRM.update]]).\n   *\n   * See also: [[VRMLookAtHead.target]]\n   */\n  public autoUpdate = true;\n\n  /**\n   * The target object of the look at.\n   * Note that it does not make any sense if [[VRMLookAtHead.autoUpdate]] is disabled.\n   */\n  public target?: THREE.Object3D;\n\n  protected _euler: THREE.Euler = new THREE.Euler(0.0, 0.0, 0.0, VRMLookAtHead.EULER_ORDER);\n\n  /**\n   * Create a new VRMLookAtHead.\n   *\n   * @param firstPerson A [[VRMFirstPerson]] that will be associated with this new VRMLookAtHead\n   * @param applyer A [[VRMLookAtApplyer]] that will be associated with this new VRMLookAtHead\n   */\n  constructor(firstPerson: VRMFirstPerson, applyer?: VRMLookAtApplyer) {\n    this.firstPerson = firstPerson;\n    this.applyer = applyer;\n  }\n\n  /**\n   * Get its look at direction in world coordinate.\n   *\n   * @param target A target `THREE.Vector3`\n   */\n  public getLookAtWorldDirection(target: THREE.Vector3): THREE.Vector3 {\n    const rot = getWorldQuaternionLite(this.firstPerson.firstPersonBone, _quat);\n    return target\n      .copy(VECTOR3_FRONT)\n      .applyEuler(this._euler)\n      .applyQuaternion(rot);\n  }\n\n  /**\n   * Set its look at position.\n   * Note that its result will be instantly overwritten if [[VRMLookAtHead.autoUpdate]] is enabled.\n   *\n   * @param position A target position\n   */\n  public lookAt(position: THREE.Vector3): void {\n    this._calcEuler(this._euler, position);\n\n    if (this.applyer) {\n      this.applyer.lookAt(this._euler);\n    }\n  }\n\n  /**\n   * Update the VRMLookAtHead.\n   * If [[VRMLookAtHead.autoUpdate]] is disabled, it will do nothing.\n   *\n   * @param delta deltaTime\n   */\n  public update(delta: number): void {\n    if (this.target && this.autoUpdate) {\n      this.lookAt(this.target.getWorldPosition(_v3A));\n\n      if (this.applyer) {\n        this.applyer.lookAt(this._euler);\n      }\n    }\n  }\n\n  protected _calcEuler(target: THREE.Euler, position: THREE.Vector3): THREE.Euler {\n    const headPosition = this.firstPerson.getFirstPersonWorldPosition(_v3B);\n\n    // Look at direction in world coordinate\n    const lookAtDir = _v3C\n      .copy(position)\n      .sub(headPosition)\n      .normalize();\n\n    // Transform the direction into local coordinate from the first person bone\n    lookAtDir.applyQuaternion(getWorldQuaternionLite(this.firstPerson.firstPersonBone, _quat).inverse());\n\n    // convert the direction into euler\n    target.x = Math.atan2(lookAtDir.y, Math.sqrt(lookAtDir.x * lookAtDir.x + lookAtDir.z * lookAtDir.z));\n    target.y = Math.atan2(-lookAtDir.x, -lookAtDir.z);\n\n    return target;\n  }\n}\n","import * as THREE from 'three';\nimport { VRMBlendShapeProxy } from '../blendshape';\nimport { VRMFirstPerson } from '../firstperson';\nimport { VRMHumanoid } from '../humanoid';\nimport { VRMSchema } from '../types';\nimport { CurveMapper } from './CurveMapper';\nimport { VRMLookAtApplyer } from './VRMLookAtApplyer';\nimport { VRMLookAtBlendShapeApplyer } from './VRMLookAtBlendShapeApplyer';\nimport { VRMLookAtBoneApplyer } from './VRMLookAtBoneApplyer';\nimport { VRMLookAtHead } from './VRMLookAtHead';\n\n/**\n * An importer that imports a [[VRMLookAtHead]] from a VRM extension of a GLTF.\n */\nexport class VRMLookAtImporter {\n  /**\n   * Import a [[VRMLookAtHead]] from a VRM.\n   *\n   * @param gltf A parsed result of GLTF taken from GLTFLoader\n   * @param blendShapeProxy A [[VRMBlendShapeProxy]] instance that represents the VRM\n   * @param humanoid A [[VRMHumanoid]] instance that represents the VRM\n   */\n  public import(\n    gltf: THREE.GLTF,\n    firstPerson: VRMFirstPerson,\n    blendShapeProxy: VRMBlendShapeProxy,\n    humanoid: VRMHumanoid,\n  ): VRMLookAtHead | null {\n    const vrmExt: VRMSchema.VRM | undefined = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n    if (!vrmExt) {\n      return null;\n    }\n\n    const schemaFirstPerson: VRMSchema.FirstPerson | undefined = vrmExt.firstPerson;\n    if (!schemaFirstPerson) {\n      return null;\n    }\n\n    const applyer = this._importApplyer(schemaFirstPerson, blendShapeProxy, humanoid);\n    return new VRMLookAtHead(firstPerson, applyer || undefined);\n  }\n\n  protected _importApplyer(\n    schemaFirstPerson: VRMSchema.FirstPerson,\n    blendShapeProxy: VRMBlendShapeProxy,\n    humanoid: VRMHumanoid,\n  ): VRMLookAtApplyer | null {\n    const lookAtHorizontalInner = schemaFirstPerson.lookAtHorizontalInner;\n    const lookAtHorizontalOuter = schemaFirstPerson.lookAtHorizontalOuter;\n    const lookAtVerticalDown = schemaFirstPerson.lookAtVerticalDown;\n    const lookAtVerticalUp = schemaFirstPerson.lookAtVerticalUp;\n\n    switch (schemaFirstPerson.lookAtTypeName) {\n      case VRMSchema.FirstPersonLookAtTypeName.Bone: {\n        if (\n          lookAtHorizontalInner === undefined ||\n          lookAtHorizontalOuter === undefined ||\n          lookAtVerticalDown === undefined ||\n          lookAtVerticalUp === undefined\n        ) {\n          return null;\n        } else {\n          return new VRMLookAtBoneApplyer(\n            humanoid,\n            this._importCurveMapperBone(lookAtHorizontalInner),\n            this._importCurveMapperBone(lookAtHorizontalOuter),\n            this._importCurveMapperBone(lookAtVerticalDown),\n            this._importCurveMapperBone(lookAtVerticalUp),\n          );\n        }\n      }\n      case VRMSchema.FirstPersonLookAtTypeName.BlendShape: {\n        if (lookAtHorizontalOuter === undefined || lookAtVerticalDown === undefined || lookAtVerticalUp === undefined) {\n          return null;\n        } else {\n          return new VRMLookAtBlendShapeApplyer(\n            blendShapeProxy,\n            this._importCurveMapperBlendShape(lookAtHorizontalOuter),\n            this._importCurveMapperBlendShape(lookAtVerticalDown),\n            this._importCurveMapperBlendShape(lookAtVerticalUp),\n          );\n        }\n      }\n      default: {\n        return null;\n      }\n    }\n  }\n\n  private _importCurveMapperBone(map: VRMSchema.FirstPersonDegreeMap): CurveMapper {\n    return new CurveMapper(\n      typeof map.xRange === 'number' ? THREE.Math.DEG2RAD * map.xRange : undefined,\n      typeof map.yRange === 'number' ? THREE.Math.DEG2RAD * map.yRange : undefined,\n      map.curve,\n    );\n  }\n\n  private _importCurveMapperBlendShape(map: VRMSchema.FirstPersonDegreeMap): CurveMapper {\n    return new CurveMapper(\n      typeof map.xRange === 'number' ? THREE.Math.DEG2RAD * map.xRange : undefined,\n      map.yRange,\n      map.curve,\n    );\n  }\n}\n","export * from './CurveMapper';\nexport * from './VRMLookAtApplyer';\nexport * from './VRMLookAtBlendShapeApplyer';\nexport * from './VRMLookAtBoneApplyer';\nexport * from './VRMLookAtHead';\nexport * from './VRMLookAtImporter';\n","/* tslint:disable:member-ordering */\n\nimport * as THREE from 'three';\nimport { getTexelDecodingFunction } from './getTexelDecodingFunction';\nimport vertexShader from './shaders/mtoon.vert';\nimport fragmentShader from './shaders/mtoon.frag';\n\nconst TAU = 2.0 * Math.PI;\n\nexport interface MToonParameters extends THREE.ShaderMaterialParameters {\n  mToonVersion?: number; // _MToonVersion\n\n  cutoff?: number; // _Cutoff\n  color?: THREE.Vector4; // rgb of _Color\n  shadeColor?: THREE.Vector4; // _ShadeColor\n  map?: THREE.Texture; // _MainTex\n  mainTex?: THREE.Texture; // _MainTex (will be renamed to map)\n  mainTex_ST?: THREE.Vector4; // _MainTex_ST\n  shadeTexture?: THREE.Texture; // _ShadeTexture\n  bumpScale?: number; // _BumpScale\n  normalMap?: THREE.Texture; // _BumpMap\n  bumpMap?: THREE.Texture; // _BumpMap (will be renamed to normalMap)\n  receiveShadowRate?: number; // _ReceiveShadowRate\n  receiveShadowTexture?: THREE.Texture; // _ReceiveShadowTexture\n  shadingGradeRate?: number; // _ShadingGradeRate\n  shadingGradeTexture?: THREE.Texture; // _ShadingGradeTexture\n  shadeShift?: number; // _ShadeShift\n  shadeToony?: number; // _ShadeToony\n  lightColorAttenuation?: number; // _LightColorAttenuation\n  indirectLightIntensity?: number; // _IndirectLightIntensity\n  rimTexture?: THREE.Texture; // _RimTexture\n  rimColor?: THREE.Vector4; // _RimColor\n  rimLightingMix?: number; // _RimLightingMix\n  rimFresnelPower?: number; // _RimFresnelPower\n  rimLift?: number; // _RimLift\n  sphereAdd?: THREE.Texture; // _SphereAdd\n  emissionColor?: THREE.Vector4; // _EmissionColor\n  emissiveMap?: THREE.Texture; // _EmissionMap\n  emissionMap?: THREE.Texture; // _EmissionMap (will be renamed to emissiveMap)\n  outlineWidthTexture?: THREE.Texture; // _OutlineWidthTexture\n  outlineWidth?: number; // _OutlineWidth\n  outlineScaledMaxDistance?: number; // _OutlineScaledMaxDistance\n  outlineColor?: THREE.Vector4; // _OutlineColor\n  outlineLightingMix?: number; // _OutlineLightingMix\n  uvAnimMaskTexture?: THREE.Texture; // _UvAnimMaskTexture\n  uvAnimScrollX?: number; // _UvAnimScrollX\n  uvAnimScrollY?: number; // _UvAnimScrollY\n  uvAnimRotation?: number; // _uvAnimRotation\n\n  debugMode?: MToonMaterialDebugMode | number; // _DebugMode\n  blendMode?: MToonMaterialRenderMode | number; // _BlendMode\n  outlineWidthMode?: MToonMaterialOutlineWidthMode | number; // OutlineWidthMode\n  outlineColorMode?: MToonMaterialOutlineColorMode | number; // OutlineColorMode\n  cullMode?: MToonMaterialCullMode | number; // _CullMode\n  outlineCullMode?: MToonMaterialCullMode | number; // _OutlineCullMode\n  srcBlend?: number; // _SrcBlend\n  dstBlend?: number; // _DstBlend\n  zWrite?: number; // _ZWrite (will be renamed to depthWrite)\n\n  isOutline?: boolean;\n}\n\nexport enum MToonMaterialCullMode {\n  Off,\n  Front,\n  Back,\n}\n\nexport enum MToonMaterialDebugMode {\n  None,\n  Normal,\n  LitShadeRate,\n  UV,\n}\n\nexport enum MToonMaterialOutlineColorMode {\n  FixedColor,\n  MixedLighting,\n}\n\nexport enum MToonMaterialOutlineWidthMode {\n  None,\n  WorldCoordinates,\n  ScreenCoordinates,\n}\n\nexport enum MToonMaterialRenderMode {\n  Opaque,\n  Cutout,\n  Transparent,\n  TransparentWithZWrite,\n}\n\n/**\n * MToon is a material specification that has various features.\n * The spec and implementation are originally founded for Unity engine and this is a port of the material.\n *\n * See: https://github.com/Santarh/MToon\n */\nexport class MToonMaterial extends THREE.ShaderMaterial {\n  /**\n   * Readonly boolean that indicates this is a [[MToonMaterial]].\n   */\n  public readonly isMToonMaterial: boolean = true;\n\n  public cutoff = 0.5; // _Cutoff\n  public color: THREE.Vector4 = new THREE.Vector4(1.0, 1.0, 1.0, 1.0); // _Color\n  public shadeColor: THREE.Vector4 = new THREE.Vector4(0.97, 0.81, 0.86, 1.0); // _ShadeColor\n  public map: THREE.Texture | null = null; // _MainTex\n  public mainTex_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _MainTex_ST\n  public shadeTexture: THREE.Texture | null = null; // _ShadeTexture\n  // public shadeTexture_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _ShadeTexture_ST (unused)\n  public bumpScale = 1.0; // _BumpScale\n  public normalMap: THREE.Texture | null = null; // _BumpMap. again, THIS IS _BumpMap\n  // public bumpMap_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _BumpMap_ST (unused)\n  public receiveShadowRate = 1.0; // _ReceiveShadowRate\n  public receiveShadowTexture: THREE.Texture | null = null; // _ReceiveShadowTexture\n  // public receiveShadowTexture_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _ReceiveShadowTexture_ST (unused)\n  public shadingGradeRate = 1.0; // _ShadingGradeRate\n  public shadingGradeTexture: THREE.Texture | null = null; // _ShadingGradeTexture\n  // public shadingGradeTexture_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _ShadingGradeTexture_ST (unused)\n  public shadeShift = 0.0; // _ShadeShift\n  public shadeToony = 0.9; // _ShadeToony\n  public lightColorAttenuation = 0.0; // _LightColorAttenuation\n  public indirectLightIntensity = 0.1; // _IndirectLightIntensity\n  public rimTexture: THREE.Texture | null = null; // _RimTexture\n  public rimColor: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 0.0, 1.0); // _RimColor\n  public rimLightingMix = 0.0; // _RimLightingMix\n  public rimFresnelPower = 1.0; // _RimFresnelPower\n  public rimLift = 0.0; // _RimLift\n  public sphereAdd: THREE.Texture | null = null; // _SphereAdd\n  // public sphereAdd_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _SphereAdd_ST (unused)\n  public emissionColor: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 0.0, 1.0); // _EmissionColor\n  public emissiveMap: THREE.Texture | null = null; // _EmissionMap\n  // public emissionMap_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _EmissionMap_ST (unused)\n  public outlineWidthTexture: THREE.Texture | null = null; // _OutlineWidthTexture\n  // public outlineWidthTexture_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _OutlineWidthTexture_ST (unused)\n  public outlineWidth = 0.5; // _OutlineWidth\n  public outlineScaledMaxDistance = 1.0; // _OutlineScaledMaxDistance\n  public outlineColor: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 0.0, 1.0); // _OutlineColor\n  public outlineLightingMix = 1.0; // _OutlineLightingMix\n  public uvAnimMaskTexture: THREE.Texture | null = null; // _UvAnimMaskTexture\n  public uvAnimScrollX = 0.0; // _UvAnimScrollX\n  public uvAnimScrollY = 0.0; // _UvAnimScrollY\n  public uvAnimRotation = 0.0; // _uvAnimRotation\n\n  public shouldApplyUniforms = true; // when this is true, applyUniforms effects\n\n  private _debugMode: MToonMaterialDebugMode = MToonMaterialDebugMode.None; // _DebugMode\n  private _blendMode: MToonMaterialRenderMode = MToonMaterialRenderMode.Opaque; // _BlendMode\n  private _outlineWidthMode: MToonMaterialOutlineWidthMode = MToonMaterialOutlineWidthMode.None; // _OutlineWidthMode\n  private _outlineColorMode: MToonMaterialOutlineColorMode = MToonMaterialOutlineColorMode.FixedColor; // _OutlineColorMode\n  private _cullMode: MToonMaterialCullMode = MToonMaterialCullMode.Back; // _CullMode\n  private _outlineCullMode: MToonMaterialCullMode = MToonMaterialCullMode.Front; // _OutlineCullMode\n  // public srcBlend: number = 1.0; // _SrcBlend (is not supported)\n  // public dstBlend: number = 0.0; // _DstBlend (is not supported)\n  // public zWrite: number = 1.0; // _ZWrite (will be converted to depthWrite)\n\n  private _isOutline = false;\n\n  private readonly _colorSpaceGamma: boolean;\n\n  private _uvAnimOffsetX = 0.0;\n  private _uvAnimOffsetY = 0.0;\n  private _uvAnimPhase = 0.0;\n\n  // TODO: colorSpaceGamma\n  constructor(colorSpaceGamma: boolean, parameters?: MToonParameters) {\n    super();\n\n    this._colorSpaceGamma = colorSpaceGamma;\n\n    if (parameters === undefined) {\n      parameters = {};\n    }\n\n    // == these parameter has no compatibility with this implementation ========\n    [\n      'mToonVersion',\n      'shadeTexture_ST',\n      'bumpMap_ST',\n      'receiveShadowTexture_ST',\n      'shadingGradeTexture_ST',\n      'sphereAdd_ST',\n      'emissionMap_ST',\n      'outlineWidthTexture_ST',\n      'srcBlend',\n      'dstBlend',\n    ].forEach((key) => {\n      if ((parameters as any)[key] !== undefined) {\n        // console.warn(`THREE.${this.type}: The parameter \"${key}\" is not supported.`);\n        delete (parameters as any)[key];\n      }\n    });\n\n    // == enabling bunch of stuff ==============================================\n    parameters.fog = true;\n    parameters.lights = true;\n    parameters.clipping = true;\n\n    parameters.skinning = parameters.skinning || false;\n    parameters.morphTargets = parameters.morphTargets || false;\n    parameters.morphNormals = parameters.morphNormals || false;\n\n    // == uniforms =============================================================\n    parameters.uniforms = THREE.UniformsUtils.merge([\n      THREE.UniformsLib.common, // map\n      THREE.UniformsLib.normalmap, // normalMap\n      THREE.UniformsLib.emissivemap, // emissiveMap\n      THREE.UniformsLib.fog,\n      THREE.UniformsLib.lights,\n      {\n        cutoff: { value: 0.5 },\n        color: { value: new THREE.Color(1.0, 1.0, 1.0) },\n        colorAlpha: { value: 1.0 },\n        shadeColor: { value: new THREE.Color(0.97, 0.81, 0.86) },\n        mainTex_ST: { value: new THREE.Vector4(0.0, 0.0, 1.0, 1.0) },\n        shadeTexture: { value: null },\n        bumpScale: { value: 1.0 },\n        receiveShadowRate: { value: 1.0 },\n        receiveShadowTexture: { value: null },\n        shadingGradeRate: { value: 1.0 },\n        shadingGradeTexture: { value: null },\n        shadeShift: { value: 0.0 },\n        shadeToony: { value: 0.9 },\n        lightColorAttenuation: { value: 0.0 },\n        indirectLightIntensity: { value: 0.1 },\n        rimTexture: { value: null },\n        rimColor: { value: new THREE.Color(0.0, 0.0, 0.0) },\n        rimLightingMix: { value: 0.0 },\n        rimFresnelPower: { value: 1.0 },\n        rimLift: { value: 0.0 },\n        sphereAdd: { value: null },\n        emissionColor: { value: new THREE.Color(0.0, 0.0, 0.0) },\n        outlineWidthTexture: { value: null },\n        outlineWidth: { value: 0.5 },\n        outlineScaledMaxDistance: { value: 1.0 },\n        outlineColor: { value: new THREE.Color(0.0, 0.0, 0.0) },\n        outlineLightingMix: { value: 1.0 },\n        uvAnimMaskTexture: { value: null },\n        uvAnimOffsetX: { value: 0.0 },\n        uvAnimOffsetY: { value: 0.0 },\n        uvAnimTheta: { value: 0.0 },\n      },\n    ]);\n\n    // == finally compile the shader program ===================================\n    this.setValues(parameters);\n\n    // == update shader stuff ==================================================\n    this._updateShaderCode();\n    this._applyUniforms();\n  }\n\n  get mainTex(): THREE.Texture | null {\n    return this.map;\n  }\n\n  set mainTex(t: THREE.Texture | null) {\n    this.map = t;\n  }\n\n  get bumpMap(): THREE.Texture | null {\n    return this.normalMap;\n  }\n\n  set bumpMap(t: THREE.Texture | null) {\n    this.normalMap = t;\n  }\n\n  get emissionMap(): THREE.Texture | null {\n    return this.emissiveMap;\n  }\n\n  set emissionMap(t: THREE.Texture | null) {\n    this.emissiveMap = t;\n  }\n\n  get blendMode(): MToonMaterialRenderMode {\n    return this._blendMode;\n  }\n\n  set blendMode(m: MToonMaterialRenderMode) {\n    this._blendMode = m;\n\n    this.depthWrite = this._blendMode !== MToonMaterialRenderMode.Transparent;\n    this.transparent =\n      this._blendMode === MToonMaterialRenderMode.Transparent ||\n      this._blendMode === MToonMaterialRenderMode.TransparentWithZWrite;\n    this._updateShaderCode();\n  }\n\n  get debugMode(): MToonMaterialDebugMode {\n    return this._debugMode;\n  }\n\n  set debugMode(m: MToonMaterialDebugMode) {\n    this._debugMode = m;\n\n    this._updateShaderCode();\n  }\n\n  get outlineWidthMode(): MToonMaterialOutlineWidthMode {\n    return this._outlineWidthMode;\n  }\n\n  set outlineWidthMode(m: MToonMaterialOutlineWidthMode) {\n    this._outlineWidthMode = m;\n\n    this._updateShaderCode();\n  }\n\n  get outlineColorMode(): MToonMaterialOutlineColorMode {\n    return this._outlineColorMode;\n  }\n\n  set outlineColorMode(m: MToonMaterialOutlineColorMode) {\n    this._outlineColorMode = m;\n\n    this._updateShaderCode();\n  }\n\n  get cullMode(): MToonMaterialCullMode {\n    return this._cullMode;\n  }\n\n  set cullMode(m: MToonMaterialCullMode) {\n    this._cullMode = m;\n\n    this._updateCullFace();\n  }\n\n  get outlineCullMode(): MToonMaterialCullMode {\n    return this._outlineCullMode;\n  }\n\n  set outlineCullMode(m: MToonMaterialCullMode) {\n    this._outlineCullMode = m;\n\n    this._updateCullFace();\n  }\n\n  get zWrite(): number {\n    return this.depthWrite ? 1 : 0;\n  }\n\n  set zWrite(i: number) {\n    this.depthWrite = 0.5 <= i;\n  }\n\n  get isOutline(): boolean {\n    return this._isOutline;\n  }\n\n  set isOutline(b: boolean) {\n    this._isOutline = b;\n\n    this._updateShaderCode();\n    this._updateCullFace();\n  }\n\n  /**\n   * Update this material.\n   * Usually this will be called via [[VRM.update]] so you don't have to call this manually.\n   *\n   * @param delta deltaTime since last update\n   */\n  public updateVRMMaterials(delta: number): void {\n    this._uvAnimOffsetX = this._uvAnimOffsetX + delta * this.uvAnimScrollX;\n    this._uvAnimOffsetY = this._uvAnimOffsetY + delta * this.uvAnimScrollY;\n    this._uvAnimPhase = this._uvAnimPhase + delta * this.uvAnimRotation;\n\n    this._applyUniforms();\n  }\n\n  public copy(source: this): this {\n    super.copy(source);\n\n    // == copy members =========================================================\n    this.cutoff = source.cutoff;\n    this.color.copy(source.color);\n    this.shadeColor.copy(source.shadeColor);\n    this.map = source.map;\n    this.mainTex_ST.copy(source.mainTex_ST);\n    this.shadeTexture = source.shadeTexture;\n    this.bumpScale = source.bumpScale;\n    this.normalMap = source.normalMap;\n    this.receiveShadowRate = source.receiveShadowRate;\n    this.receiveShadowTexture = source.receiveShadowTexture;\n    this.shadingGradeRate = source.shadingGradeRate;\n    this.shadingGradeTexture = source.shadingGradeTexture;\n    this.shadeShift = source.shadeShift;\n    this.shadeToony = source.shadeToony;\n    this.lightColorAttenuation = source.lightColorAttenuation;\n    this.indirectLightIntensity = source.indirectLightIntensity;\n    this.rimTexture = source.rimTexture;\n    this.rimColor.copy(source.rimColor);\n    this.rimLightingMix = source.rimLightingMix;\n    this.rimFresnelPower = source.rimFresnelPower;\n    this.rimLift = source.rimLift;\n    this.sphereAdd = source.sphereAdd;\n    this.emissionColor.copy(source.emissionColor);\n    this.emissiveMap = source.emissiveMap;\n    this.outlineWidthTexture = source.outlineWidthTexture;\n    this.outlineWidth = source.outlineWidth;\n    this.outlineScaledMaxDistance = source.outlineScaledMaxDistance;\n    this.outlineColor.copy(source.outlineColor);\n    this.outlineLightingMix = source.outlineLightingMix;\n    this.uvAnimMaskTexture = source.uvAnimMaskTexture;\n    this.uvAnimScrollX = source.uvAnimScrollX;\n    this.uvAnimScrollY = source.uvAnimScrollY;\n    this.uvAnimRotation = source.uvAnimRotation;\n\n    this.debugMode = source.debugMode;\n    this.blendMode = source.blendMode;\n    this.outlineWidthMode = source.outlineWidthMode;\n    this.outlineColorMode = source.outlineColorMode;\n    this.cullMode = source.cullMode;\n    this.outlineCullMode = source.outlineCullMode;\n\n    this.isOutline = source.isOutline;\n\n    return this;\n  }\n\n  /**\n   * Apply updated uniform variables.\n   */\n  private _applyUniforms(): void {\n    this.uniforms.uvAnimOffsetX.value = this._uvAnimOffsetX;\n    this.uniforms.uvAnimOffsetY.value = this._uvAnimOffsetY;\n    this.uniforms.uvAnimTheta.value = TAU * this._uvAnimPhase;\n\n    if (!this.shouldApplyUniforms) {\n      return;\n    }\n    this.shouldApplyUniforms = false;\n\n    this.uniforms.cutoff.value = this.cutoff;\n    this.uniforms.color.value.setRGB(this.color.x, this.color.y, this.color.z);\n    if (!this._colorSpaceGamma) {\n      this.uniforms.color.value.convertSRGBToLinear();\n    }\n    this.uniforms.colorAlpha.value = this.color.w;\n    this.uniforms.shadeColor.value.setRGB(this.shadeColor.x, this.shadeColor.y, this.shadeColor.z);\n    if (!this._colorSpaceGamma) {\n      this.uniforms.shadeColor.value.convertSRGBToLinear();\n    }\n    this.uniforms.map.value = this.map;\n    this.uniforms.mainTex_ST.value.copy(this.mainTex_ST);\n    this.uniforms.shadeTexture.value = this.shadeTexture;\n    this.uniforms.bumpScale.value = this.bumpScale;\n    this.uniforms.normalMap.value = this.normalMap;\n    this.uniforms.receiveShadowRate.value = this.receiveShadowRate;\n    this.uniforms.receiveShadowTexture.value = this.receiveShadowTexture;\n    this.uniforms.shadingGradeRate.value = this.shadingGradeRate;\n    this.uniforms.shadingGradeTexture.value = this.shadingGradeTexture;\n    this.uniforms.shadeShift.value = this.shadeShift;\n    this.uniforms.shadeToony.value = this.shadeToony;\n    this.uniforms.lightColorAttenuation.value = this.lightColorAttenuation;\n    this.uniforms.indirectLightIntensity.value = this.indirectLightIntensity;\n    this.uniforms.rimTexture.value = this.rimTexture;\n    this.uniforms.rimColor.value.setRGB(this.rimColor.x, this.rimColor.y, this.rimColor.z);\n    if (!this._colorSpaceGamma) {\n      this.uniforms.rimColor.value.convertSRGBToLinear();\n    }\n    this.uniforms.rimLightingMix.value = this.rimLightingMix;\n    this.uniforms.rimFresnelPower.value = this.rimFresnelPower;\n    this.uniforms.rimLift.value = this.rimLift;\n    this.uniforms.sphereAdd.value = this.sphereAdd;\n    this.uniforms.emissionColor.value.setRGB(this.emissionColor.x, this.emissionColor.y, this.emissionColor.z);\n    if (!this._colorSpaceGamma) {\n      this.uniforms.emissionColor.value.convertSRGBToLinear();\n    }\n    this.uniforms.emissiveMap.value = this.emissiveMap;\n    this.uniforms.outlineWidthTexture.value = this.outlineWidthTexture;\n    this.uniforms.outlineWidth.value = this.outlineWidth;\n    this.uniforms.outlineScaledMaxDistance.value = this.outlineScaledMaxDistance;\n    this.uniforms.outlineColor.value.setRGB(this.outlineColor.x, this.outlineColor.y, this.outlineColor.z);\n    if (!this._colorSpaceGamma) {\n      this.uniforms.outlineColor.value.convertSRGBToLinear();\n    }\n    this.uniforms.outlineLightingMix.value = this.outlineLightingMix;\n    this.uniforms.uvAnimMaskTexture.value = this.uvAnimMaskTexture;\n\n    this._updateCullFace();\n  }\n\n  private _updateShaderCode(): void {\n    this.defines = {\n      OUTLINE: this._isOutline,\n      BLENDMODE_OPAQUE: this._blendMode === MToonMaterialRenderMode.Opaque,\n      BLENDMODE_CUTOUT: this._blendMode === MToonMaterialRenderMode.Cutout,\n      BLENDMODE_TRANSPARENT:\n        this._blendMode === MToonMaterialRenderMode.Transparent ||\n        this._blendMode === MToonMaterialRenderMode.TransparentWithZWrite,\n      USE_SHADETEXTURE: this.shadeTexture !== null,\n      USE_RECEIVESHADOWTEXTURE: this.receiveShadowTexture !== null,\n      USE_SHADINGGRADETEXTURE: this.shadingGradeTexture !== null,\n      USE_RIMTEXTURE: this.rimTexture !== null,\n      USE_SPHEREADD: this.sphereAdd !== null,\n      USE_OUTLINEWIDTHTEXTURE: this.outlineWidthTexture !== null,\n      USE_UVANIMMASKTEXTURE: this.uvAnimMaskTexture !== null,\n      DEBUG_NORMAL: this._debugMode === MToonMaterialDebugMode.Normal,\n      DEBUG_LITSHADERATE: this._debugMode === MToonMaterialDebugMode.LitShadeRate,\n      DEBUG_UV: this._debugMode === MToonMaterialDebugMode.UV,\n      OUTLINE_WIDTH_WORLD: this._outlineWidthMode === MToonMaterialOutlineWidthMode.WorldCoordinates,\n      OUTLINE_WIDTH_SCREEN: this._outlineWidthMode === MToonMaterialOutlineWidthMode.ScreenCoordinates,\n      OUTLINE_COLOR_FIXED: this._outlineColorMode === MToonMaterialOutlineColorMode.FixedColor,\n      OUTLINE_COLOR_MIXED: this._outlineColorMode === MToonMaterialOutlineColorMode.MixedLighting,\n    };\n\n    // == texture encodings ====================================================\n    const encodings =\n      (this.shadeTexture !== null\n        ? getTexelDecodingFunction('shadeTextureTexelToLinear', this.shadeTexture.encoding) + '\\n'\n        : '') +\n      (this.sphereAdd !== null\n        ? getTexelDecodingFunction('sphereAddTexelToLinear', this.sphereAdd.encoding) + '\\n'\n        : '');\n\n    // == generate shader code =================================================\n    this.vertexShader = vertexShader;\n    this.fragmentShader = encodings + fragmentShader;\n\n    // == set needsUpdate flag =================================================\n    this.needsUpdate = true;\n  }\n\n  private _updateCullFace(): void {\n    if (!this.isOutline) {\n      if (this.cullMode === MToonMaterialCullMode.Off) {\n        this.side = THREE.DoubleSide;\n      } else if (this.cullMode === MToonMaterialCullMode.Front) {\n        this.side = THREE.BackSide;\n      } else if (this.cullMode === MToonMaterialCullMode.Back) {\n        this.side = THREE.FrontSide;\n      }\n    } else {\n      if (this.outlineCullMode === MToonMaterialCullMode.Off) {\n        this.side = THREE.DoubleSide;\n      } else if (this.outlineCullMode === MToonMaterialCullMode.Front) {\n        this.side = THREE.BackSide;\n      } else if (this.outlineCullMode === MToonMaterialCullMode.Back) {\n        this.side = THREE.FrontSide;\n      }\n    }\n  }\n}\n","import * as THREE from 'three';\nimport { GLTFMesh, GLTFPrimitive, VRMSchema } from '../types';\nimport { MToonMaterial, MToonMaterialOutlineWidthMode, MToonMaterialRenderMode } from './MToonMaterial';\nimport { VRMUnlitMaterial, VRMUnlitMaterialRenderType } from './VRMUnlitMaterial';\n\n/**\n * Options for a [[VRMMaterialImporter]] instance.\n */\nexport interface VRMMaterialImporterOptions {\n  /**\n   * Whether the workflow should be linear or gamma.\n   *\n   * See also: https://threejs.org/docs/#api/en/renderers/WebGLRenderer.gammaOutput\n   */\n  colorSpaceGamma?: boolean;\n\n  /**\n   * A function that returns a `Promise` of environment map texture.\n   * The importer will attempt to call this function when it have to use an envmap.\n   */\n  requestEnvMap?: () => Promise<THREE.Texture | null>;\n}\n\n/**\n * An importer that imports VRM materials from a VRM extension of a GLTF.\n */\nexport class VRMMaterialImporter {\n  private readonly _colorSpaceGamma: boolean;\n  private readonly _requestEnvMap?: () => Promise<THREE.Texture | null>;\n\n  /**\n   * Create a new VRMMaterialImporter.\n   *\n   * @param options Options of the VRMMaterialImporter\n   */\n  constructor(options: VRMMaterialImporterOptions = {}) {\n    this._colorSpaceGamma = options.colorSpaceGamma || true;\n    this._requestEnvMap = options.requestEnvMap;\n  }\n\n  /**\n   * Convert all the materials of given GLTF based on VRM extension field `materialProperties`.\n   *\n   * @param gltf A parsed result of GLTF taken from GLTFLoader\n   */\n  public async convertGLTFMaterials(gltf: THREE.GLTF): Promise<THREE.Material[] | null> {\n    const vrmExt: VRMSchema.VRM | undefined = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n    if (!vrmExt) {\n      return null;\n    }\n\n    const materialProperties: VRMSchema.Material[] | undefined = vrmExt.materialProperties;\n    if (!materialProperties) {\n      return null;\n    }\n\n    const meshesMap: GLTFMesh[] = await gltf.parser.getDependencies('mesh');\n    const materialList: { [vrmMaterialIndex: number]: { surface: THREE.Material; outline?: THREE.Material } } = {};\n    const materials: THREE.Material[] = []; // result\n\n    await Promise.all(\n      meshesMap.map(async (mesh, meshIndex) => {\n        const primitives: GLTFPrimitive[] =\n          mesh.type === 'Group' ? (mesh.children as GLTFPrimitive[]) : [mesh as GLTFPrimitive];\n        await Promise.all(\n          primitives.map(async (primitive, primitiveIndex) => {\n            // if primitives material is not an array, make it an array\n            if (!Array.isArray(primitive.material)) {\n              primitive.material = [primitive.material];\n              (primitive.geometry as THREE.BufferGeometry).addGroup(\n                0,\n                (primitive.geometry as THREE.BufferGeometry).index.count,\n                0,\n              );\n            }\n\n            // create / push to cache (or pop from cache) vrm materials\n            const vrmMaterialIndex = gltf.parser.json.meshes![meshIndex].primitives[primitiveIndex].material!;\n\n            let props = materialProperties[vrmMaterialIndex];\n            if (!props) {\n              console.warn(\n                `VRMMaterialImporter: There are no material definition for material #${vrmMaterialIndex} on VRM extension.`,\n              );\n              props = { shader: 'VRM_USE_GLTFSHADER' }; // fallback\n            }\n\n            let vrmMaterials: { surface: THREE.Material; outline?: THREE.Material };\n            if (materialList[vrmMaterialIndex]) {\n              vrmMaterials = materialList[vrmMaterialIndex];\n            } else {\n              vrmMaterials = await this.createVRMMaterials(primitive.material[0], props, gltf);\n              materialList[vrmMaterialIndex] = vrmMaterials;\n\n              materials.push(vrmMaterials.surface);\n              if (vrmMaterials.outline) {\n                materials.push(vrmMaterials.outline);\n              }\n            }\n\n            // surface\n            primitive.material[0] = vrmMaterials.surface;\n\n            // envmap\n            if (this._requestEnvMap) {\n              this._requestEnvMap().then((envMap) => {\n                (vrmMaterials.surface as any).envMap = envMap;\n                vrmMaterials.surface.needsUpdate = true;\n              });\n            }\n\n            // render order\n            primitive.renderOrder = props.renderQueue || 2000;\n\n            // outline (\"2 pass shading using groups\" trick here)\n            if (vrmMaterials.outline) {\n              primitive.material[1] = vrmMaterials.outline;\n              (primitive.geometry as THREE.BufferGeometry).addGroup(\n                0,\n                (primitive.geometry as THREE.BufferGeometry).index.count,\n                1,\n              );\n            }\n          }),\n        );\n      }),\n    );\n\n    return materials;\n  }\n\n  public async createVRMMaterials(\n    originalMaterial: THREE.Material,\n    vrmProps: VRMSchema.Material,\n    gltf: THREE.GLTF,\n  ): Promise<{\n    surface: THREE.Material;\n    outline?: THREE.Material;\n  }> {\n    let newSurface: THREE.Material | undefined;\n    let newOutline: THREE.Material | undefined;\n\n    if (vrmProps.shader === 'VRM/MToon') {\n      const params = await this._extractMaterialProperties(originalMaterial, vrmProps, gltf);\n\n      // we need to get rid of these properties\n      ['srcBlend', 'dstBlend', 'isFirstSetup'].forEach((name) => {\n        if (params[name] !== undefined) {\n          delete params[name];\n        }\n      });\n\n      // these textures must be sRGB Encoding, depends on current colorspace\n      ['mainTex', 'shadeTexture', 'emission', 'sphereAdd'].forEach((name) => {\n        if (params[name] !== undefined) {\n          params[name].encoding = this._colorSpaceGamma ? THREE.LinearEncoding : THREE.sRGBEncoding;\n        }\n      });\n\n      // done\n      newSurface = new MToonMaterial(this._colorSpaceGamma, params);\n\n      // outline\n      if (params.outlineWidthMode !== MToonMaterialOutlineWidthMode.None) {\n        params.isOutline = true;\n        newOutline = new MToonMaterial(this._colorSpaceGamma, params);\n      }\n    } else if (vrmProps.shader === 'VRM/UnlitTexture') {\n      // this is very legacy\n      const params = await this._extractMaterialProperties(originalMaterial, vrmProps, gltf);\n      params.renderType = VRMUnlitMaterialRenderType.Opaque;\n      newSurface = new VRMUnlitMaterial(params);\n    } else if (vrmProps.shader === 'VRM/UnlitCutout') {\n      // this is very legacy\n      const params = await this._extractMaterialProperties(originalMaterial, vrmProps, gltf);\n      params.renderType = VRMUnlitMaterialRenderType.Cutout;\n      newSurface = new VRMUnlitMaterial(params);\n    } else if (vrmProps.shader === 'VRM/UnlitTransparent') {\n      // this is very legacy\n      const params = await this._extractMaterialProperties(originalMaterial, vrmProps, gltf);\n      params.renderType = VRMUnlitMaterialRenderType.Transparent;\n      newSurface = new VRMUnlitMaterial(params);\n    } else if (vrmProps.shader === 'VRM/UnlitTransparentZWrite') {\n      // this is very legacy\n      const params = await this._extractMaterialProperties(originalMaterial, vrmProps, gltf);\n      params.renderType = VRMUnlitMaterialRenderType.TransparentWithZWrite;\n      newSurface = new VRMUnlitMaterial(params);\n    } else {\n      if (vrmProps.shader !== 'VRM_USE_GLTFSHADER') {\n        console.warn(`Unknown shader detected: \"${vrmProps.shader}\"`);\n        // then presume as VRM_USE_GLTFSHADER\n      }\n\n      newSurface = this._convertGLTFMaterial(originalMaterial.clone());\n    }\n\n    newSurface.name = originalMaterial.name;\n    newSurface.userData = JSON.parse(JSON.stringify(originalMaterial.userData));\n    newSurface.userData.vrmMaterialProperties = vrmProps;\n\n    if (newOutline) {\n      newOutline.name = originalMaterial.name + ' (Outline)';\n      newOutline.userData = JSON.parse(JSON.stringify(originalMaterial.userData));\n      newOutline.userData.vrmMaterialProperties = vrmProps;\n    }\n\n    return {\n      surface: newSurface,\n      outline: newOutline,\n    };\n  }\n\n  private _renameMaterialProperty(name: string): string {\n    if (name[0] !== '_') {\n      console.warn(`VRMMaterials: Given property name \"${name}\" might be invalid`);\n      return name;\n    }\n    name = name.substring(1);\n\n    if (!/[A-Z]/.test(name[0])) {\n      console.warn(`VRMMaterials: Given property name \"${name}\" might be invalid`);\n      return name;\n    }\n    return name[0].toLowerCase() + name.substring(1);\n  }\n\n  private _convertGLTFMaterial(material: THREE.Material): THREE.Material {\n    if ((material as any).isMeshStandardMaterial) {\n      const mtl = material as THREE.MeshStandardMaterial;\n\n      if (this._colorSpaceGamma) {\n        if (mtl.map) {\n          mtl.map.encoding = THREE.LinearEncoding;\n        }\n        if (mtl.emissiveMap) {\n          mtl.emissiveMap.encoding = THREE.LinearEncoding;\n        }\n      } else {\n        (mtl as any).color.convertSRGBToLinear(); // TODO: `as any` is temporal, since there are no declaration in @types/three\n        (mtl as any).emissive.convertSRGBToLinear(); // TODO: `as any` is temporal, since there are no declaration in @types/three\n      }\n    }\n\n    if ((material as any).isMeshBasicMaterial) {\n      const mtl = material as THREE.MeshBasicMaterial;\n\n      if (this._colorSpaceGamma) {\n        if (mtl.map) {\n          mtl.map.encoding = THREE.LinearEncoding;\n        }\n      } else {\n        (mtl as any).color.convertSRGBToLinear(); // TODO: `as any` is temporal, since there are no declaration in @types/three\n      }\n    }\n\n    return material;\n  }\n\n  private _extractMaterialProperties(\n    originalMaterial: THREE.Material,\n    vrmProps: VRMSchema.Material,\n    gltf: THREE.GLTF,\n  ): Promise<any> {\n    const taskList: Array<Promise<any>> = [];\n    const params: any = {};\n\n    // extract texture properties\n    if (vrmProps.textureProperties) {\n      for (const name of Object.keys(vrmProps.textureProperties)) {\n        const newName = this._renameMaterialProperty(name);\n        const textureIndex = vrmProps.textureProperties[name];\n\n        taskList.push(\n          gltf.parser.getDependency('texture', textureIndex).then((texture: THREE.Texture) => {\n            params[newName] = texture;\n          }),\n        );\n      }\n    }\n\n    // extract float properties\n    if (vrmProps.floatProperties) {\n      for (const name of Object.keys(vrmProps.floatProperties)) {\n        const newName = this._renameMaterialProperty(name);\n        params[newName] = vrmProps.floatProperties[name];\n      }\n    }\n\n    // extract vector (color tbh) properties\n    if (vrmProps.vectorProperties) {\n      for (const name of Object.keys(vrmProps.vectorProperties)) {\n        let newName = this._renameMaterialProperty(name);\n\n        // if this is textureST (same name as texture name itself), add '_ST'\n        // this is my most favorite MToon feature tbh\n        const isTextureST = [\n          '_MainTex',\n          '_ShadeTexture',\n          '_BumpMap',\n          '_ReceiveShadowTexture',\n          '_ShadingGradeTexture',\n          '_SphereAdd',\n          '_EmissionMap',\n          '_OutlineWidthTexture',\n        ].some((textureName) => name === textureName);\n        if (isTextureST) {\n          newName += '_ST';\n        }\n\n        params[newName] = new THREE.Vector4(...vrmProps.vectorProperties[name]);\n      }\n    }\n\n    // TODO: f (https://github.com/dwango/UniVRM/issues/172)\n    if (vrmProps.keywordMap!._ALPHATEST_ON && params.blendMode === MToonMaterialRenderMode.Opaque) {\n      params.blendMode = MToonMaterialRenderMode.Cutout;\n    }\n\n    // set whether it needs skinning and morphing or not\n    params.skinning = (originalMaterial as any).skinning || false;\n    params.morphTargets = (originalMaterial as any).morphTargets || false;\n    params.morphNormals = (originalMaterial as any).morphNormals || false;\n\n    return Promise.all(taskList).then(() => params);\n  }\n}\n","/* tslint:disable:member-ordering */\n\nimport * as THREE from 'three';\nimport vertexShader from './shaders/unlit.vert';\nimport fragmentShader from './shaders/unlit.frag';\n\nexport interface VRMUnlitMaterialParameters extends THREE.ShaderMaterialParameters {\n  cutoff?: number; // _Cutoff\n  map?: THREE.Texture; // _MainTex\n  mainTex?: THREE.Texture; // _MainTex (will be renamed to map)\n  mainTex_ST?: THREE.Vector4; // _MainTex_ST\n\n  renderType?: VRMUnlitMaterialRenderType | number;\n}\n\nexport enum VRMUnlitMaterialRenderType {\n  Opaque,\n  Cutout,\n  Transparent,\n  TransparentWithZWrite,\n}\n\n/**\n * This is a material that is an equivalent of \"VRM/Unlit***\" on VRM spec, those materials are already kinda deprecated though...\n */\nexport class VRMUnlitMaterial extends THREE.ShaderMaterial {\n  /**\n   * Readonly boolean that indicates this is a [[VRMUnlitMaterial]].\n   */\n  public readonly isVRMUnlitMaterial: boolean = true;\n\n  public cutoff = 0.5;\n  public map: THREE.Texture | null = null; // _MainTex\n  public mainTex_ST: THREE.Vector4 = new THREE.Vector4(0.0, 0.0, 1.0, 1.0); // _MainTex_ST\n  private _renderType: VRMUnlitMaterialRenderType = VRMUnlitMaterialRenderType.Opaque;\n\n  public shouldApplyUniforms = true; // when this is true, applyUniforms effects\n\n  constructor(parameters?: VRMUnlitMaterialParameters) {\n    super();\n\n    if (parameters === undefined) {\n      parameters = {};\n    }\n\n    // == enabling bunch of stuff ==============================================\n    parameters.fog = true;\n    parameters.clipping = true;\n\n    parameters.skinning = parameters.skinning || false;\n    parameters.morphTargets = parameters.morphTargets || false;\n    parameters.morphNormals = parameters.morphNormals || false;\n\n    // == uniforms =============================================================\n    parameters.uniforms = THREE.UniformsUtils.merge([\n      THREE.UniformsLib.common, // map\n      THREE.UniformsLib.fog,\n      {\n        cutoff: { value: 0.5 },\n        mainTex_ST: { value: new THREE.Vector4(0.0, 0.0, 1.0, 1.0) },\n      },\n    ]);\n\n    // == finally compile the shader program ===================================\n    this.setValues(parameters);\n\n    // == update shader stuff ==================================================\n    this._updateShaderCode();\n    this._applyUniforms();\n  }\n\n  get mainTex(): THREE.Texture | null {\n    return this.map;\n  }\n\n  set mainTex(t: THREE.Texture | null) {\n    this.map = t;\n  }\n\n  get renderType(): VRMUnlitMaterialRenderType {\n    return this._renderType;\n  }\n\n  set renderType(t: VRMUnlitMaterialRenderType) {\n    this._renderType = t;\n\n    this.depthWrite = this._renderType !== VRMUnlitMaterialRenderType.Transparent;\n    this.transparent =\n      this._renderType === VRMUnlitMaterialRenderType.Transparent ||\n      this._renderType === VRMUnlitMaterialRenderType.TransparentWithZWrite;\n    this._updateShaderCode();\n  }\n\n  /**\n   * Update this material.\n   * Usually this will be called via [[VRM.update]] so you don't have to call this manually.\n   *\n   * @param delta deltaTime since last update\n   */\n  public updateVRMMaterials(delta: number): void {\n    this._applyUniforms();\n  }\n\n  public copy(source: this): this {\n    super.copy(source);\n\n    // == copy members =========================================================\n    this.cutoff = source.cutoff;\n    this.map = source.map;\n    this.mainTex_ST.copy(source.mainTex_ST);\n    this.renderType = source.renderType;\n\n    return this;\n  }\n\n  /**\n   * Apply updated uniform variables.\n   */\n  private _applyUniforms(): void {\n    if (!this.shouldApplyUniforms) {\n      return;\n    }\n    this.shouldApplyUniforms = false;\n\n    this.uniforms.cutoff.value = this.cutoff;\n    this.uniforms.map.value = this.map;\n    this.uniforms.mainTex_ST.value.copy(this.mainTex_ST);\n  }\n\n  private _updateShaderCode(): void {\n    this.defines = {\n      RENDERTYPE_OPAQUE: this._renderType === VRMUnlitMaterialRenderType.Opaque,\n      RENDERTYPE_CUTOUT: this._renderType === VRMUnlitMaterialRenderType.Cutout,\n      RENDERTYPE_TRANSPARENT:\n        this._renderType === VRMUnlitMaterialRenderType.Transparent ||\n        this._renderType === VRMUnlitMaterialRenderType.TransparentWithZWrite,\n    };\n\n    this.vertexShader = vertexShader;\n    this.fragmentShader = fragmentShader;\n\n    // == set needsUpdate flag =================================================\n    this.needsUpdate = true;\n  }\n}\n","import * as THREE from 'three';\n\nexport const getEncodingComponents = (encoding: THREE.TextureEncoding): [string, string] => {\n  switch (encoding) {\n    case THREE.LinearEncoding:\n      return ['Linear', '( value )'];\n    case THREE.sRGBEncoding:\n      return ['sRGB', '( value )'];\n    case THREE.RGBEEncoding:\n      return ['RGBE', '( value )'];\n    case THREE.RGBM7Encoding:\n      return ['RGBM', '( value, 7.0 )'];\n    case THREE.RGBM16Encoding:\n      return ['RGBM', '( value, 16.0 )'];\n    case THREE.RGBDEncoding:\n      return ['RGBD', '( value, 256.0 )'];\n    case THREE.GammaEncoding:\n      return ['Gamma', '( value, float( GAMMA_FACTOR ) )'];\n    default:\n      throw new Error('unsupported encoding: ' + encoding);\n  }\n};\n\nexport const getTexelDecodingFunction = (functionName: string, encoding: THREE.TextureEncoding): string => {\n  const components = getEncodingComponents(encoding);\n  return 'vec4 ' + functionName + '( vec4 value ) { return ' + components[0] + 'ToLinear' + components[1] + '; }';\n};\n","export * from './MToonMaterial';\nexport * from './VRMMaterialImporter';\nexport * from './VRMUnlitMaterial';\n","export default \"// #define PHONG\\n\\n#ifdef BLENDMODE_CUTOUT\\n  uniform float cutoff;\\n#endif\\n\\nuniform vec3 color;\\nuniform float colorAlpha;\\nuniform vec3 shadeColor;\\n#ifdef USE_SHADETEXTURE\\n  uniform sampler2D shadeTexture;\\n#endif\\n\\nuniform float receiveShadowRate;\\n#ifdef USE_RECEIVESHADOWTEXTURE\\n  uniform sampler2D receiveShadowTexture;\\n#endif\\n\\nuniform float shadingGradeRate;\\n#ifdef USE_SHADINGGRADETEXTURE\\n  uniform sampler2D shadingGradeTexture;\\n#endif\\n\\nuniform float shadeShift;\\nuniform float shadeToony;\\nuniform float lightColorAttenuation;\\nuniform float indirectLightIntensity;\\n\\n#ifdef USE_RIMTEXTURE\\n  uniform sampler2D rimTexture;\\n#endif\\nuniform vec3 rimColor;\\nuniform float rimLightingMix;\\nuniform float rimFresnelPower;\\nuniform float rimLift;\\n\\n#ifdef USE_SPHEREADD\\n  uniform sampler2D sphereAdd;\\n#endif\\n\\nuniform vec3 emissionColor;\\n\\nuniform vec3 outlineColor;\\nuniform float outlineLightingMix;\\n\\n#ifdef USE_UVANIMMASKTEXTURE\\n  uniform sampler2D uvAnimMaskTexture;\\n#endif\\n\\nuniform float uvAnimOffsetX;\\nuniform float uvAnimOffsetY;\\nuniform float uvAnimTheta;\\n\\n#include <common>\\n#include <packing>\\n#include <dithering_pars_fragment>\\n#include <color_pars_fragment>\\n\\n// #include <uv_pars_fragment>\\n#if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n  varying vec2 vUv;\\n#endif\\n\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n// #include <alphamap_pars_fragment>\\n#include <aomap_pars_fragment>\\n// #include <lightmap_pars_fragment>\\n#include <emissivemap_pars_fragment>\\n// #include <envmap_pars_fragment>\\n// #include <gradientmap_pars_fragment>\\n#include <fog_pars_fragment>\\n#include <bsdfs>\\n#include <lights_pars_begin>\\n\\n// #include <lights_phong_pars_fragment>\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n  varying vec3 vNormal;\\n#endif\\n\\n#define Material_LightProbeLOD( material ) (0)\\n\\n#include <shadowmap_pars_fragment>\\n// #include <bumpmap_pars_fragment>\\n\\n// #include <normalmap_pars_fragment>\\n#ifdef USE_NORMALMAP\\n  uniform sampler2D normalMap;\\n  uniform float bumpScale;\\n\\n  // this number is very random, this is still a \\n  #define UV_DERIVATIVE_EPSILON 1E-6\\n\\n  // Per-Pixel Tangent Space Normal Mapping\\n  // http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\\n  vec3 perturbNormal2Arb( vec2 uv, vec3 eye_pos, vec3 surf_norm ) {\\n    // Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\\n    vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\\n    vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\\n    vec2 st0 = dFdx( uv.st );\\n    vec2 st1 = dFdy( uv.st );\\n\\n    float scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\\n    vec3 S = ( q0 * st1.t - q1 * st0.t ) * scale;\\n    vec3 T = ( - q0 * st1.s + q1 * st0.s ) * scale;\\n\\n    // Workaround for the issue that happens when delta of uv = 0.0\\n    if ( length( S ) == 0.0 || length( T ) == 0.0 ) {\\n      return surf_norm;\\n    }\\n\\n    S = normalize( S );\\n    T = normalize( T );\\n    vec3 N = normalize( surf_norm );\\n\\n    vec3 mapN = texture2D( normalMap, uv ).xyz * 2.0 - 1.0;\\n\\n    mapN.xy *= bumpScale;\\n\\n    #ifdef DOUBLE_SIDED\\n      // Workaround for Adreno GPUs gl_FrontFacing bug. See #15850 and #10331\\n      // http://hacksoflife.blogspot.com/2009/11/per-pixel-tangent-space-normal-mapping.html?showComment=1522254677437#c5087545147696715943\\n      vec3 NfromST = cross( S, T );\\n      if( dot( NfromST, N ) > 0.0 ) {\\n        S *= -1.0;\\n        T *= -1.0;\\n      }\\n    #else\\n      mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n    #endif\\n\\n    mat3 tsn = mat3( S, T, N );\\n\\n    return normalize( tsn * mapN );\\n  }\\n#endif\\n\\n// #include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\n\\n// == lighting stuff ===========================================================\\nfloat getLightIntensity(\\n  const in IncidentLight directLight,\\n  const in GeometricContext geometry,\\n  const in float shadow,\\n  const in float shadingGrade\\n) {\\n  float lightIntensity = dot( geometry.normal, directLight.direction );\\n  lightIntensity = 0.5 + 0.5 * lightIntensity;\\n  lightIntensity = lightIntensity * shadow;\\n  lightIntensity = lightIntensity * shadingGrade;\\n  lightIntensity = lightIntensity * 2.0 - 1.0;\\n  return smoothstep( shadeShift, shadeShift + ( 1.0 - shadeToony ), lightIntensity );\\n}\\n\\nvec3 getLighting( const in vec3 lightColor ) {\\n  vec3 lighting = lightColor;\\n  lighting = mix(\\n    lighting,\\n    vec3( max( 0.001, max( lighting.x, max( lighting.y, lighting.z ) ) ) ),\\n    lightColorAttenuation\\n  );\\n\\n  #ifndef PHYSICALLY_CORRECT_LIGHTS\\n    lighting *= PI;\\n  #endif\\n\\n  return lighting;\\n}\\n\\nvec3 getDiffuse(\\n  const in vec3 lit,\\n  const in vec3 shade,\\n  const in float lightIntensity,\\n  const in vec3 lighting\\n) {\\n  #ifdef DEBUG_LITSHADERATE\\n    return vec3( BRDF_Diffuse_Lambert( lightIntensity * lighting ) );\\n  #endif\\n\\n  return lighting * BRDF_Diffuse_Lambert( mix( shade, lit, lightIntensity ) );\\n}\\n\\nvec3 calcDirectDiffuse(\\n  const in vec2 uv,\\n  const in vec3 lit,\\n  const in vec3 shade,\\n  in GeometricContext geometry,\\n  inout ReflectedLight reflectedLight\\n) {\\n  IncidentLight directLight;\\n  vec3 lightingSum = vec3( 0.0 );\\n\\n  float shadingGrade = 1.0;\\n  #ifdef USE_SHADINGGRADETEXTURE\\n    shadingGrade = 1.0 - shadingGradeRate * ( 1.0 - texture2D( shadingGradeTexture, uv ).r );\\n  #endif\\n\\n  float receiveShadow = receiveShadowRate;\\n  #ifdef USE_RECEIVESHADOWTEXTURE\\n    receiveShadow *= texture2D( receiveShadowTexture, uv ).a;\\n  #endif\\n\\n  #if ( NUM_POINT_LIGHTS > 0 )\\n    PointLight pointLight;\\n\\n    #pragma unroll_loop\\n    for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\\n      pointLight = pointLights[ i ];\\n      getPointDirectLightIrradiance( pointLight, geometry, directLight );\\n\\n      float atten = 1.0;\\n      #ifdef USE_SHADOWMAP\\n        atten = all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\\n      #endif\\n\\n      float shadow = 1.0 - receiveShadow * ( 1.0 - ( 0.5 + 0.5 * atten ) );\\n      float lightIntensity = getLightIntensity( directLight, geometry, shadow, shadingGrade );\\n      vec3 lighting = getLighting( directLight.color );\\n      reflectedLight.directDiffuse += getDiffuse( lit, shade, lightIntensity, lighting );\\n      lightingSum += lighting;\\n    }\\n  #endif\\n\\n  #if ( NUM_SPOT_LIGHTS > 0 )\\n    SpotLight spotLight;\\n\\n    #pragma unroll_loop\\n    for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\\n      spotLight = spotLights[ i ];\\n      getSpotDirectLightIrradiance( spotLight, geometry, directLight );\\n\\n      float atten = 1.0;\\n      #ifdef USE_SHADOWMAP\\n        atten = all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\\n      #endif\\n\\n      float shadow = 1.0 - receiveShadow * ( 1.0 - ( 0.5 + 0.5 * atten ) );\\n      float lightIntensity = getLightIntensity( directLight, geometry, shadow, shadingGrade );\\n      vec3 lighting = getLighting( directLight.color );\\n      reflectedLight.directDiffuse += getDiffuse( lit, shade, lightIntensity, lighting );\\n      lightingSum += lighting;\\n    }\\n  #endif\\n\\n  #if ( NUM_DIR_LIGHTS > 0 )\\n    DirectionalLight directionalLight;\\n\\n    #pragma unroll_loop\\n    for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\\n      directionalLight = directionalLights[ i ];\\n      getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\\n\\n      float atten = 1.0;\\n      #ifdef USE_SHADOWMAP\\n        atten = all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\\n      #endif\\n\\n      float shadow = 1.0 - receiveShadow * ( 1.0 - ( 0.5 + 0.5 * atten ) );\\n      float lightIntensity = getLightIntensity( directLight, geometry, shadow, shadingGrade );\\n      vec3 lighting = getLighting( directLight.color );\\n      reflectedLight.directDiffuse += getDiffuse( lit, shade, lightIntensity, lighting );\\n      lightingSum += lighting;\\n    }\\n  #endif\\n\\n  return lightingSum;\\n}\\n\\n// == post correction ==========================================================\\nvoid postCorrection() {\\n  #include <tonemapping_fragment>\\n  #include <encodings_fragment>\\n  #include <fog_fragment>\\n  #include <premultiplied_alpha_fragment>\\n  #include <dithering_fragment>\\n}\\n\\n// == main procedure ===========================================================\\nvoid main() {\\n  #include <clipping_planes_fragment>\\n\\n  vec2 uv = vec2(0.5, 0.5);\\n\\n  #if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n    uv = vUv;\\n\\n    float uvAnimMask = 1.0;\\n    #ifdef USE_UVANIMMASKTEXTURE\\n      uvAnimMask = texture2D( uvAnimMaskTexture, uv ).x;\\n    #endif\\n\\n    uv = uv + vec2( uvAnimOffsetX, uvAnimOffsetY ) * uvAnimMask;\\n    float uvRotCos = cos( uvAnimTheta * uvAnimMask );\\n    float uvRotSin = sin( uvAnimTheta * uvAnimMask );\\n    uv = mat2( uvRotCos, uvRotSin, -uvRotSin, uvRotCos ) * ( uv - 0.5 ) + 0.5;\\n  #endif\\n\\n  #ifdef DEBUG_UV\\n    gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\\n    #if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n      gl_FragColor = vec4( uv, 0.0, 1.0 );\\n    #endif\\n    return;\\n  #endif\\n\\n  vec4 diffuseColor = vec4( color, colorAlpha );\\n  ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n  vec3 totalEmissiveRadiance = emissionColor;\\n\\n  #include <logdepthbuf_fragment>\\n\\n  // #include <map_fragment>\\n  #ifdef USE_MAP\\n    diffuseColor *= mapTexelToLinear( texture2D( map, uv ) );\\n  #endif\\n\\n  #include <color_fragment>\\n  // #include <alphamap_fragment>\\n\\n  // -- MToon: alpha -----------------------------------------------------------\\n  // #include <alphatest_fragment>\\n  #ifdef BLENDMODE_CUTOUT\\n    if ( diffuseColor.a <= cutoff ) { discard; }\\n    diffuseColor.a = 1.0;\\n  #endif\\n\\n  #ifdef BLENDMODE_OPAQUE\\n    diffuseColor.a = 1.0;\\n  #endif\\n\\n  #if defined( OUTLINE ) && defined( OUTLINE_COLOR_FIXED ) // omitting DebugMode\\n    gl_FragColor = vec4( outlineColor, diffuseColor.a );\\n    postCorrection();\\n    return;\\n  #endif\\n\\n  // #include <specularmap_fragment>\\n  #include <normal_fragment_begin>\\n\\n  #ifdef OUTLINE\\n    normal *= -1.0;\\n  #endif\\n\\n  // #include <normal_fragment_maps>\\n  #ifdef USE_NORMALMAP\\n    normal = perturbNormal2Arb( uv, -vViewPosition, normal );\\n  #endif\\n\\n  // #include <emissivemap_fragment>\\n  #ifdef USE_EMISSIVEMAP\\n    totalEmissiveRadiance *= emissiveMapTexelToLinear( texture2D( emissiveMap, uv ) ).rgb;\\n  #endif\\n\\n  #ifdef DEBUG_NORMAL\\n    gl_FragColor = vec4( 0.5 + 0.5 * normal, 1.0 );\\n    return;\\n  #endif\\n\\n  // -- MToon: lighting --------------------------------------------------------\\n  // accumulation\\n  // #include <lights_phong_fragment>\\n  // #include <lights_fragment_begin>\\n  vec3 lit = diffuseColor.rgb;\\n  vec3 shade = shadeColor;\\n  #ifdef USE_SHADETEXTURE\\n    shade *= shadeTextureTexelToLinear( texture2D( shadeTexture, uv ) ).rgb;\\n  #endif\\n\\n  GeometricContext geometry;\\n\\n  geometry.position = - vViewPosition;\\n  geometry.normal = normal;\\n  geometry.viewDir = normalize( vViewPosition );\\n\\n  vec3 lighting = calcDirectDiffuse( uv, diffuseColor.rgb, shade, geometry, reflectedLight );\\n\\n  vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\\n  #if ( NUM_HEMI_LIGHTS > 0 )\\n    #pragma unroll_loop\\n    for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\\n      irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\\n    }\\n  #endif\\n\\n  // #include <lights_fragment_maps>\\n  #ifdef USE_LIGHTMAP\\n    vec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).rgb * lightMapIntensity;\\n    #ifndef PHYSICALLY_CORRECT_LIGHTS\\n      lightMapIrradiance *= PI; // factor of PI should not be present; included here to prevent breakage\\n    #endif\\n    irradiance += lightMapIrradiance;\\n  #endif\\n\\n  // #include <lights_fragment_end>\\n  reflectedLight.indirectDiffuse += indirectLightIntensity * irradiance * BRDF_Diffuse_Lambert( lit );\\n\\n  // modulation\\n  #include <aomap_fragment>\\n\\n  vec3 col = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\\n\\n  #if defined( OUTLINE ) && defined( OUTLINE_COLOR_MIXED ) // omitting DebugMode\\n    gl_FragColor = vec4(\\n      outlineColor.rgb * mix( vec3( 1.0 ), col, outlineLightingMix ),\\n      diffuseColor.a\\n    );\\n    postCorrection();\\n    return;\\n  #endif\\n\\n  // -- MToon: parametric rim lighting -----------------------------------------\\n  vec3 viewDir = normalize( vViewPosition );\\n  vec3 rimMix = mix(vec3(1.0), lighting + indirectLightIntensity * irradiance, rimLightingMix);\\n  vec3 rim = rimColor * pow( saturate( 1.0 - dot( viewDir, normal ) + rimLift ), rimFresnelPower );\\n  #ifdef USE_RIMTEXTURE\\n    rim *= texture2D( rimTexture, uv ).rgb;\\n  #endif\\n  col += rim;\\n\\n  // -- MToon: additive matcap -------------------------------------------------\\n  #ifdef USE_SPHEREADD\\n    {\\n      vec3 x = normalize( vec3( viewDir.z, 0.0, -viewDir.x ) );\\n      vec3 y = cross( viewDir, x ); // guaranteed to be normalized\\n      vec2 sphereUv = 0.5 + 0.5 * vec2( dot( x, normal ), -dot( y, normal ) );\\n      vec3 matcap = sphereAddTexelToLinear( texture2D( sphereAdd, sphereUv ) ).xyz;\\n      col += matcap;\\n    }\\n  #endif\\n\\n  // -- MToon: Emission --------------------------------------------------------\\n  col += totalEmissiveRadiance;\\n\\n  // #include <envmap_fragment>\\n\\n  // -- Almost done! -----------------------------------------------------------\\n  gl_FragColor = vec4( col, diffuseColor.a );\\n  postCorrection();\\n}\"","export default \"// #define PHONG\\n\\nvarying vec3 vViewPosition;\\n\\n#ifndef FLAT_SHADED\\n  varying vec3 vNormal;\\n#endif\\n\\n#include <common>\\n\\n// #include <uv_pars_vertex>\\n#if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n  varying vec2 vUv;\\n  uniform vec4 mainTex_ST;\\n#endif\\n\\n#include <uv2_pars_vertex>\\n// #include <displacementmap_pars_vertex>\\n// #include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <shadowmap_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\n\\n#ifdef USE_OUTLINEWIDTHTEXTURE\\n  uniform sampler2D outlineWidthTexture;\\n#endif\\n\\nuniform float outlineWidth;\\nuniform float outlineScaledMaxDistance;\\n\\nvoid main() {\\n\\n  // #include <uv_vertex>\\n  #if defined( USE_MAP ) || defined( USE_SHADETEXTURE ) || defined( USE_NORMALMAP ) || defined( USE_RECEIVESHADOWTEXTURE ) || defined( USE_SHADINGGRADETEXTURE ) || defined( USE_RIMTEXTURE ) || defined( USE_EMISSIVEMAP ) || defined( USE_OUTLINEWIDTHTEXTURE ) || defined( USE_UVANIMMASKTEXTURE )\\n    vUv = vec2( mainTex_ST.p * uv.x + mainTex_ST.s, mainTex_ST.q * uv.y + mainTex_ST.t );\\n  #endif\\n\\n  #include <uv2_vertex>\\n  #include <color_vertex>\\n\\n  #include <beginnormal_vertex>\\n  #include <morphnormal_vertex>\\n  #include <skinbase_vertex>\\n  #include <skinnormal_vertex>\\n  #include <defaultnormal_vertex>\\n\\n  #ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\\n    vNormal = normalize( transformedNormal );\\n  #endif\\n\\n  #include <begin_vertex>\\n\\n  #include <morphtarget_vertex>\\n  #include <skinning_vertex>\\n  // #include <displacementmap_vertex>\\n  #include <project_vertex>\\n  #include <logdepthbuf_vertex>\\n  #include <clipping_planes_vertex>\\n\\n  vViewPosition = - mvPosition.xyz;\\n\\n  float outlineTex = 1.0;\\n\\n  #ifdef OUTLINE\\n    #ifdef USE_OUTLINEWIDTHTEXTURE\\n      outlineTex = texture2D( outlineWidthTexture, vUv ).r;\\n    #endif\\n\\n    #ifdef OUTLINE_WIDTH_WORLD\\n      vec3 outlineOffset = 0.01 * outlineWidth * outlineTex * normalize( objectNormal );\\n      gl_Position += projectionMatrix * modelViewMatrix * vec4( outlineOffset, 0.0 );\\n    #endif\\n\\n    #ifdef OUTLINE_WIDTH_SCREEN\\n      vec3 clipNormal = ( projectionMatrix * modelViewMatrix * vec4( normalize( objectNormal ), 0.0 ) ).xyz;\\n      vec2 projectedNormal = normalize( clipNormal.xy );\\n      projectedNormal *= min( gl_Position.w, outlineScaledMaxDistance );\\n      projectedNormal.x *= projectionMatrix[ 0 ].x / projectionMatrix[ 1 ].y;\\n      gl_Position.xy += 0.01 * outlineWidth * outlineTex * projectedNormal.xy;\\n    #endif\\n\\n    gl_Position.z += 1E-6 * gl_Position.w; // anti-artifact magic\\n  #endif\\n\\n  #include <worldpos_vertex>\\n  // #include <envmap_vertex>\\n  #include <shadowmap_vertex>\\n  #include <fog_vertex>\\n\\n}\"","export default \"#ifdef RENDERTYPE_CUTOUT\\n  uniform float cutoff;\\n#endif\\n\\n#include <common>\\n#include <color_pars_fragment>\\n#include <uv_pars_fragment>\\n#include <uv2_pars_fragment>\\n#include <map_pars_fragment>\\n// #include <alphamap_pars_fragment>\\n// #include <aomap_pars_fragment>\\n// #include <lightmap_pars_fragment>\\n// #include <envmap_pars_fragment>\\n#include <fog_pars_fragment>\\n// #include <specularmap_pars_fragment>\\n#include <logdepthbuf_pars_fragment>\\n#include <clipping_planes_pars_fragment>\\n\\n// == main procedure ===========================================================\\nvoid main() {\\n  #include <clipping_planes_fragment>\\n\\n  vec4 diffuseColor = vec4( 1.0 );\\n\\n  #include <logdepthbuf_fragment>\\n\\n  // #include <map_fragment>\\n  #ifdef USE_MAP\\n    diffuseColor *= mapTexelToLinear( texture2D( map, vUv ) );\\n  #endif\\n\\n  #include <color_fragment>\\n  // #include <alphamap_fragment>\\n\\n  // MToon: alpha\\n  // #include <alphatest_fragment>\\n  #ifdef RENDERTYPE_CUTOUT\\n    if ( diffuseColor.a <= cutoff ) { discard; }\\n    diffuseColor.a = 1.0;\\n  #endif\\n\\n  #ifdef RENDERTYPE_OPAQUE\\n    diffuseColor.a = 1.0;\\n  #endif\\n\\n  // #include <specularmap_fragment>\\n\\n  ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\\n\\n  // accumulation (baked indirect lighting only)\\n  #ifdef USE_LIGHTMAP\\n    reflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\\n  #else\\n    reflectedLight.indirectDiffuse += vec3( 1.0 );\\n  #endif\\n\\n  // modulation\\n  // #include <aomap_fragment>\\n\\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\\n  vec3 outgoingLight = reflectedLight.indirectDiffuse;\\n\\n  // #include <envmap_fragment>\\n\\n  gl_FragColor = vec4( outgoingLight, diffuseColor.a );\\n\\n  #include <premultiplied_alpha_fragment>\\n  #include <tonemapping_fragment>\\n  #include <encodings_fragment>\\n  #include <fog_fragment>\\n}\"","export default \"#include <common>\\n\\n// #include <uv_pars_vertex>\\n#ifdef USE_MAP\\n  varying vec2 vUv;\\n  uniform vec4 mainTex_ST;\\n#endif\\n\\n#include <uv2_pars_vertex>\\n#include <envmap_pars_vertex>\\n#include <color_pars_vertex>\\n#include <fog_pars_vertex>\\n#include <morphtarget_pars_vertex>\\n#include <skinning_pars_vertex>\\n#include <logdepthbuf_pars_vertex>\\n#include <clipping_planes_pars_vertex>\\n\\nvoid main() {\\n\\n  // #include <uv_vertex>\\n  #ifdef USE_MAP\\n    vUv = vec2( mainTex_ST.p * uv.x + mainTex_ST.s, mainTex_ST.q * uv.y + mainTex_ST.t );\\n  #endif\\n\\n  #include <uv2_vertex>\\n  #include <color_vertex>\\n  #include <skinbase_vertex>\\n\\n  #ifdef USE_ENVMAP\\n\\n  #include <beginnormal_vertex>\\n  #include <morphnormal_vertex>\\n  #include <skinnormal_vertex>\\n  #include <defaultnormal_vertex>\\n\\n  #endif\\n\\n  #include <begin_vertex>\\n  #include <morphtarget_vertex>\\n  #include <skinning_vertex>\\n  #include <project_vertex>\\n  #include <logdepthbuf_vertex>\\n\\n  #include <worldpos_vertex>\\n  #include <clipping_planes_vertex>\\n  #include <envmap_vertex>\\n  #include <fog_vertex>\\n\\n}\"","import * as THREE from 'three';\n\nexport function reduceBones(root: THREE.Object3D): void {\n  // Traverse an entire tree\n  root.traverse((obj) => {\n    if (obj.type !== 'SkinnedMesh') {\n      return;\n    }\n\n    const mesh = obj as THREE.SkinnedMesh;\n    const geometry = (mesh.geometry as THREE.BufferGeometry).clone();\n    mesh.geometry = geometry;\n    const attribute = geometry.getAttribute('skinIndex');\n\n    // generate reduced bone list\n    const bones: THREE.Bone[] = []; // new list of bone\n    const boneInverses: THREE.Matrix4[] = []; // new list of boneInverse\n    const boneIndexMap: { [index: number]: number } = {}; // map of old bone index vs. new bone index\n    const array = (attribute.array as any).map((index: number) => {\n      // new skinIndex buffer\n      if (boneIndexMap[index] === undefined) {\n        boneIndexMap[index] = bones.length;\n        bones.push(mesh.skeleton.bones[index]);\n        boneInverses.push(mesh.skeleton.boneInverses[index]);\n      }\n      return boneIndexMap[index];\n    });\n\n    // attach new skinIndex buffer\n    geometry.removeAttribute('skinIndex');\n    geometry.addAttribute('skinIndex', new THREE.BufferAttribute(array, 4, false));\n    mesh.bind(new THREE.Skeleton(bones, boneInverses), new THREE.Matrix4());\n    //                                                 ^^^^^^^^^^^^^^^^^^^ transform of meshes should be ignored\n    // See: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n  });\n}\n","import * as THREE from 'three';\nimport { getWorldQuaternionLite } from '../utils/math';\n// based on\n// http://rocketjump.skr.jp/unity3d/109/\n// https://github.com/dwango/UniVRM/blob/master/Scripts/SpringBone/VRMSpringBone.cs\n\nexport const GIZMO_RENDER_ORDER = 10000;\nconst IDENTITY_MATRIX4 = Object.freeze(new THREE.Matrix4());\nconst IDENTITY_QUATERNION = Object.freeze(new THREE.Quaternion());\n\n// \nconst _v3A = new THREE.Vector3();\nconst _v3B = new THREE.Vector3();\nconst _v3C = new THREE.Vector3();\nconst _quatA = new THREE.Quaternion();\nconst _matA = new THREE.Matrix4();\nconst _matB = new THREE.Matrix4();\n\n/**\n * A class represents a single spring bone of a VRM.\n * It should be managed by a [[VRMSpringBoneManager]].\n */\nexport class VRMSpringBone {\n  /**\n   * Radius of the bone, will be used for collision.\n   */\n  public readonly radius: number;\n\n  /**\n   * Stiffness force of the bone. Increasing the value = faster convergence (feels \"harder\").\n   * On UniVRM, its range on GUI is between `0.0` and `4.0` .\n   */\n  public readonly stiffnessForce: number;\n\n  /**\n   * Power of the gravity against this bone.\n   * The \"power\" used in here is very far from scientific physics term...\n   */\n  public readonly gravityPower: number;\n\n  /**\n   * Direction of the gravity against this bone.\n   * Usually it should be normalized.\n   */\n  public readonly gravityDir: THREE.Vector3;\n\n  /**\n   * Drag force of the bone. Increasing the value = less oscillation (feels \"heavier\").\n   * On UniVRM, its range on GUI is between `0.0` and `1.0` .\n   */\n  public readonly dragForce: number;\n\n  /**\n   * An Object3D attached to this bone.\n   */\n  public readonly bone: THREE.Object3D;\n\n  /**\n   * Colliders (as `THREE.Mesh` ) attached to this bone.\n   */\n  public readonly colliders: THREE.Mesh[];\n\n  /**\n   * Current position of child tail, in world unit. Will be used for verlet integration.\n   */\n  protected _currentTail: THREE.Vector3;\n\n  /**\n   * Previous position of child tail, in world unit. Will be used for verlet integration.\n   */\n  protected _prevTail: THREE.Vector3;\n\n  /**\n   * Next position of child tail, in world unit. Will be used for verlet integration.\n   * Actually used only in [[update]] and it's kind of temporary variable.\n   */\n  protected _nextTail: THREE.Vector3;\n\n  /**\n   * Initial axis of the bone, in local unit.\n   */\n  protected _boneAxis: THREE.Vector3;\n\n  /**\n   * Length of the bone in **world unit**. Will be used for normalization in update loop.\n   * It's same as local unit length unless there are scale transformation in world matrix.\n   */\n  protected _worldBoneLength: number;\n\n  /**\n   * World position of this bone, kind of temporary variable.\n   */\n  protected _worldPosition: THREE.Vector3;\n\n  /**\n   * Rotation of parent bone, in world unit.\n   * We should update this constantly in [[update]].\n   */\n  private _parentWorldRotation: THREE.Quaternion;\n\n  /**\n   * Initial state of the local matrix of the bone.\n   */\n  private _initialLocalMatrix: THREE.Matrix4;\n\n  /**\n   * Initial state of the rotation of the bone.\n   */\n  private _initialLocalRotation: THREE.Quaternion;\n\n  /**\n   * Initial state of the position of its child.\n   */\n  private _initialLocalChildPosition: THREE.Vector3;\n\n  /**\n   * Create a new VRMSpringBone.\n   *\n   * @param bone An Object3D that will be attached to this bone\n   * @param radius Radius of the bone\n   * @param stiffness Stiffness force of the bone\n   * @param gravityDir Direction of the gravity against this bone\n   * @param gravityPower Power of the gravity against this bone\n   * @param dragForce Drag force of the bone\n   * @param colliders Colliders that will be attached to this bone\n   */\n  constructor(\n    bone: THREE.Object3D,\n    radius: number,\n    stiffiness: number,\n    gravityDir: THREE.Vector3,\n    gravityPower: number,\n    dragForce: number,\n    colliders: THREE.Mesh[] = [],\n  ) {\n    this.bone = bone; // uniVRM parent\n    this.bone.matrixAutoUpdate = false; // updatethree.js\n\n    this.radius = radius;\n    this.stiffnessForce = stiffiness;\n    this.gravityDir = gravityDir;\n    this.gravityPower = gravityPower;\n    this.dragForce = dragForce;\n    this.colliders = colliders;\n\n    this._worldPosition = new THREE.Vector3().setFromMatrixPosition(this.bone.matrixWorld);\n\n    this._parentWorldRotation = new THREE.Quaternion();\n\n    this._initialLocalMatrix = this.bone.matrix.clone();\n    this._initialLocalRotation = this.bone.quaternion.clone();\n    this._initialLocalChildPosition = ((): THREE.Vector3 => {\n      if (this.bone.children.length === 0) {\n        // \n        // https://github.com/dwango/UniVRM/blob/master/Assets/VRM/UniVRM/Scripts/SpringBone/VRMSpringBone.cs#L246\n        return this.bone.position\n          .clone()\n          .normalize()\n          .multiplyScalar(0.07); // magic number! derives from original source\n      } else {\n        const firstChild = this.bone.children[0];\n        return firstChild.position.clone();\n      }\n    })();\n\n    this._currentTail = this.bone.localToWorld(this._initialLocalChildPosition.clone());\n    this._prevTail = this._currentTail.clone();\n    this._nextTail = this._currentTail.clone();\n\n    this._boneAxis = this._initialLocalChildPosition.clone().normalize();\n    this._worldBoneLength = this.bone\n      .localToWorld(_v3A.copy(this._initialLocalChildPosition))\n      .sub(this._worldPosition)\n      .length();\n  }\n\n  /**\n   * Reset the state of this bone.\n   * You might want to call [[VRMSpringBoneManager.reset]] instead.\n   */\n  public reset(): void {\n    this.bone.matrix.copy(this._initialLocalMatrix);\n\n    this.bone.localToWorld(this._currentTail.copy(this._initialLocalChildPosition));\n    this._prevTail.copy(this._currentTail);\n    this._nextTail.copy(this._currentTail);\n\n    // matrixWorld\n    this.bone.updateMatrix();\n    this.bone.matrixWorld.multiplyMatrices(this._getParentMatrixWorld(), this.bone.matrix);\n    this._worldPosition.setFromMatrixPosition(this.bone.matrixWorld);\n  }\n\n  /**\n   * Update the state of this bone.\n   * You might want to call [[VRMSpringBoneManager.update]] instead.\n   *\n   * @param delta deltaTime\n   */\n  public update(delta: number): void {\n    if (delta <= 0) return;\n\n    // \n    // worldMatrix\n    this.bone.matrixWorld.multiplyMatrices(this._getParentMatrixWorld(), this.bone.matrix);\n\n    if (this.bone.parent) {\n      // SpringBone\n      // matrixWorldworldMatrixquaternion\n      // getWorldQuaternion\n      getWorldQuaternionLite(this.bone.parent, this._parentWorldRotation);\n    } else {\n      this._parentWorldRotation.copy(IDENTITY_QUATERNION);\n    }\n\n    // worldMatrixworldPosition\n    // `getWorldPosition()` \n    this._worldPosition.setFromMatrixPosition(this.bone.matrixWorld);\n    const stiffness = this.stiffnessForce * delta;\n    const external = _v3B.copy(this.gravityDir).multiplyScalar(this.gravityPower * delta);\n\n    // verlet\n    this._nextTail\n      .copy(this._currentTail)\n      .add(\n        _v3A\n          .copy(this._currentTail)\n          .sub(this._prevTail)\n          .multiplyScalar(1 - this.dragForce),\n      ) // ()\n      .add(\n        _v3A\n          .copy(this._boneAxis)\n          .applyMatrix4(this._initialLocalMatrix)\n          .applyMatrix4(this._getParentMatrixWorld())\n          .sub(this._worldPosition)\n          .normalize()\n          .multiplyScalar(stiffness),\n      ) // \n      .add(external); // \n\n    // normalize bone length\n    this._nextTail\n      .sub(this._worldPosition)\n      .normalize()\n      .multiplyScalar(this._worldBoneLength)\n      .add(this._worldPosition);\n\n    // Collision\n    this._collision(this._nextTail);\n\n    this._prevTail.copy(this._currentTail);\n    this._currentTail.copy(this._nextTail);\n\n    // Apply rotation, convert vector3 thing into actual quaternion\n    // Original UniVRM is doing world unit calculus at here but we're gonna do this on local unit\n    // since Three.js is not good at world coordination stuff\n    const initialWorldMatrixInv = _matA.getInverse(\n      _matB.copy(this._getParentMatrixWorld()).multiply(this._initialLocalMatrix),\n    );\n    const applyRotation = _quatA.setFromUnitVectors(\n      this._boneAxis,\n      _v3A\n        .copy(this._nextTail)\n        .applyMatrix4(initialWorldMatrixInv)\n        .normalize(),\n    );\n\n    this.bone.quaternion.copy(this._initialLocalRotation).multiply(applyRotation);\n\n    // We need to update its matrixWorld manually, since we tweaked the bone by our hand\n    this.bone.updateMatrix();\n    this.bone.matrixWorld.multiplyMatrices(this._getParentMatrixWorld(), this.bone.matrix);\n  }\n\n  /**\n   * Do collision math against every colliders attached to this bone.\n   *\n   * @param tail The tail you want to process\n   */\n  private _collision(tail: THREE.Vector3): void {\n    this.colliders.forEach((collider) => {\n      const colliderWorldPosition = _v3A.setFromMatrixPosition(collider.matrixWorld);\n      const colliderRadius = collider.geometry.boundingSphere.radius;\n      const r = this.radius + colliderRadius;\n\n      if (tail.distanceToSquared(colliderWorldPosition) <= r * r) {\n        // Collider\n        const normal = _v3B.subVectors(tail, colliderWorldPosition).normalize();\n        const posFromCollider = _v3C.addVectors(colliderWorldPosition, normal.multiplyScalar(r));\n\n        // normalize bone length\n        tail.copy(\n          posFromCollider\n            .sub(this._worldPosition)\n            .normalize()\n            .multiplyScalar(this._worldBoneLength)\n            .add(this._worldPosition),\n        );\n      }\n    });\n  }\n\n  /**\n   * Returns the world matrix of its parent object.\n   */\n  private _getParentMatrixWorld(): THREE.Matrix4 {\n    return this.bone.parent ? this.bone.parent.matrixWorld : IDENTITY_MATRIX4;\n  }\n}\n","import * as THREE from 'three';\nimport { GLTFNode, VRMSchema } from '../types';\nimport { GIZMO_RENDER_ORDER, VRMSpringBone } from './VRMSpringBone';\nimport { VRMSpringBoneColliderGroup, VRMSpringBoneColliderMesh } from './VRMSpringBoneColliderGroup';\nimport { VRMSpringBoneGroup, VRMSpringBoneManager } from './VRMSpringBoneManager';\n\n/**\n * An importer that imports a [[VRMSpringBoneManager]] from a VRM extension of a GLTF.\n */\nexport class VRMSpringBoneImporter {\n  /**\n   * Import a [[VRMLookAtHead]] from a VRM.\n   *\n   * @param gltf A parsed result of GLTF taken from GLTFLoader\n   */\n  public async import(gltf: THREE.GLTF): Promise<VRMSpringBoneManager | null> {\n    if (\n      !gltf.parser.json.extensions ||\n      !gltf.parser.json.extensions.VRM ||\n      !gltf.parser.json.extensions.VRM.secondaryAnimation\n    ) {\n      return null;\n    }\n\n    // \n    const colliderGroups = await this._getColliderMeshGroups(gltf);\n    colliderGroups.forEach((group) => gltf.scene.add(...group.colliders));\n\n    // stiffinessdragForceboneGroup\n    // \n    const springBoneGroupList = await this._getSpringBoneGroupList(gltf, colliderGroups);\n\n    return new VRMSpringBoneManager(springBoneGroupList);\n  }\n\n  protected get _isColiderMeshVisible(): boolean {\n    return false;\n  }\n\n  protected _createSpringBone(\n    gltf: THREE.GLTF,\n    bone: THREE.Object3D,\n    hitRadius: number,\n    stiffiness: number,\n    gravityDir: THREE.Vector3,\n    gravityPower: number,\n    dragForce: number,\n    colliders: THREE.Mesh[] = [],\n  ): VRMSpringBone {\n    return new VRMSpringBone(bone, hitRadius, stiffiness, gravityDir, gravityPower, dragForce, colliders);\n  }\n\n  private async _getSpringBoneGroupList(\n    gltf: THREE.GLTF,\n    colliderGroups: VRMSpringBoneColliderGroup[],\n  ): Promise<VRMSpringBoneGroup[]> {\n    const springBoneGroups: VRMSchema.SecondaryAnimationSpring[] = gltf.parser.json.extensions!.VRM!.secondaryAnimation!\n      .boneGroups;\n\n    const springBoneGroupList: VRMSpringBoneGroup[] = [];\n\n    springBoneGroups.forEach((vrmBoneGroup) => {\n      if (\n        vrmBoneGroup.stiffiness === undefined ||\n        vrmBoneGroup.gravityDir === undefined ||\n        vrmBoneGroup.gravityDir.x === undefined ||\n        vrmBoneGroup.gravityDir.y === undefined ||\n        vrmBoneGroup.gravityDir.z === undefined ||\n        vrmBoneGroup.gravityPower === undefined ||\n        vrmBoneGroup.dragForce === undefined ||\n        vrmBoneGroup.hitRadius === undefined ||\n        vrmBoneGroup.colliderGroups === undefined ||\n        vrmBoneGroup.bones === undefined\n      ) {\n        return;\n      }\n\n      const stiffiness = vrmBoneGroup.stiffiness;\n      const gravityDir = new THREE.Vector3(\n        vrmBoneGroup.gravityDir.x,\n        vrmBoneGroup.gravityDir.y,\n        vrmBoneGroup.gravityDir.z,\n      );\n      const gravityPower = vrmBoneGroup.gravityPower;\n      const dragForce = vrmBoneGroup.dragForce;\n      const hitRadius = vrmBoneGroup.hitRadius;\n\n      const colliders: VRMSpringBoneColliderMesh[] = [];\n      vrmBoneGroup.colliderGroups.forEach((colliderIndex) => {\n        colliders.push(...colliderGroups[colliderIndex].colliders);\n      });\n\n      const springBoneGroup: VRMSpringBoneGroup = [];\n      vrmBoneGroup.bones.forEach(async (nodeIndex) => {\n        // VRM\n        const springRootBone: GLTFNode = await gltf.parser.getDependency('node', nodeIndex);\n\n        // it's weird but there might be cases we can't find the root bone\n        if (!springRootBone) {\n          return;\n        }\n\n        springRootBone.traverse((bone) => {\n          const springBone = this._createSpringBone(\n            gltf,\n            bone,\n            hitRadius,\n            stiffiness,\n            gravityDir,\n            gravityPower,\n            dragForce,\n            colliders,\n          );\n          springBoneGroup.push(springBone);\n        });\n      });\n\n      springBoneGroupList.push(springBoneGroup);\n    });\n\n    return springBoneGroupList;\n  }\n\n  /**\n   * Create an array of [[VRMSpringBoneColliderGroup]].\n   */\n  private async _getColliderMeshGroups(gltf: THREE.GLTF): Promise<VRMSpringBoneColliderGroup[]> {\n    const vrmExt: VRMSchema.VRM | undefined = gltf.parser.json.extensions && gltf.parser.json.extensions.VRM;\n    if (vrmExt === undefined) {\n      return [];\n    }\n    const secondaryAnimation = vrmExt.secondaryAnimation;\n    if (secondaryAnimation === undefined) {\n      return [];\n    }\n    const vrmColliderGroups = secondaryAnimation.colliderGroups;\n    if (vrmColliderGroups === undefined) {\n      return [];\n    }\n\n    const colliderGroups: VRMSpringBoneColliderGroup[] = [];\n    vrmColliderGroups.forEach(async (colliderGroup) => {\n      if (colliderGroup.node === undefined || colliderGroup.colliders === undefined) {\n        return;\n      }\n\n      const bone = await gltf.parser.getDependency('node', colliderGroup.node);\n      const colliders: VRMSpringBoneColliderMesh[] = [];\n      colliderGroup.colliders.forEach((collider) => {\n        if (\n          collider.offset === undefined ||\n          collider.offset.x === undefined ||\n          collider.offset.y === undefined ||\n          collider.offset.z === undefined ||\n          collider.radius === undefined\n        ) {\n          return;\n        }\n\n        const offsetMatrix = new THREE.Matrix4().makeTranslation(\n          collider.offset.x,\n          collider.offset.y,\n          -collider.offset.z, // this is pretty weird. See: https://github.com/dwango/UniVRM/issues/65\n        );\n        const visible = this._isColiderMeshVisible;\n        const colliderMesh = new THREE.Mesh(\n          new THREE.SphereBufferGeometry(collider.radius, 8, 4),\n          new THREE.MeshBasicMaterial({\n            color: 0xff00ff,\n            visible,\n            wireframe: true,\n            transparent: true,\n            depthTest: false,\n          }),\n        );\n        (colliderMesh.material as any).renderOrder = GIZMO_RENDER_ORDER;\n\n        // the name have to be this in order to exclude colliders from bounding box\n        // (See Viewer.ts, search for child.name === 'vrmColliderSphere')\n        colliderMesh.name = 'vrmColliderSphere';\n\n        // We will use the radius of the sphere for collision vs bones.\n        // `boundingSphere` must be created to compute the radius.\n        colliderMesh.geometry.computeBoundingSphere();\n\n        // The colliderMesh must sync with the bone.\n        // Attaching bone's matrix to the colliderMesh at every update.\n        // (colliderMesh will move automecicallty)\n        colliderMesh.updateMatrixWorld = (): void => {\n          colliderMesh.matrixWorld.copy(bone.matrixWorld).multiply(offsetMatrix);\n        };\n        colliders.push(colliderMesh);\n      });\n\n      const colliderMeshGroup = {\n        node: colliderGroup.node,\n        colliders,\n      };\n      colliderGroups.push(colliderMeshGroup);\n    });\n\n    return colliderGroups;\n  }\n}\n","import { VRMSpringBone } from './VRMSpringBone';\n\n/**\n * Represents a single spring bone group of a VRM.\n */\nexport type VRMSpringBoneGroup = VRMSpringBone[];\n\n/**\n * A class manages every spring bones on a VRM.\n */\nexport class VRMSpringBoneManager {\n  public readonly springBoneGroupList: VRMSpringBoneGroup[] = [];\n\n  /**\n   * Create a new [[VRMSpringBoneManager]]\n   *\n   * @param springBoneGroupList An array of [[VRMSpringBoneGroup]]\n   */\n  public constructor(springBoneGroupList: VRMSpringBoneGroup[]) {\n    this.springBoneGroupList = springBoneGroupList;\n  }\n\n  /**\n   * Update every spring bone attached to this manager.\n   *\n   * @param delta deltaTime\n   */\n  public lateUpdate(delta: number): void {\n    this.springBoneGroupList.forEach((springBoneGroup) => {\n      springBoneGroup.forEach((springBone) => {\n        springBone.update(delta);\n      });\n    });\n  }\n\n  /**\n   * Reset every spring bone attached to this manager.\n   */\n  public reset(): void {\n    this.springBoneGroupList.forEach((springBoneGroup) => {\n      springBoneGroup.forEach((springBone) => {\n        springBone.reset();\n      });\n    });\n  }\n}\n","export * from './VRMSpringBone';\nexport * from './VRMSpringBoneColliderGroup';\nexport * from './VRMSpringBoneImporter';\nexport * from './VRMSpringBoneManager';\n","// Typedoc does not support export declarations yet\n// then we have to use `namespace` instead of export declarations for now.\n// See: https://github.com/TypeStrong/typedoc/pull/801\n\n// eslint-disable-next-line @typescript-eslint/no-namespace\nexport namespace VRMSchema {\n  /**\n   * VRM extension is for 3d humanoid avatars (and models) in VR applications.\n   */\n  export interface VRM {\n    blendShapeMaster?: BlendShape;\n    /**\n     * Version of exporter that vrm created. UniVRM-0.53.0\n     */\n    exporterVersion?: string;\n    firstPerson?: FirstPerson;\n    humanoid?: Humanoid;\n    materialProperties?: Material[];\n    meta?: Meta;\n    secondaryAnimation?: SecondaryAnimation;\n    /**\n     * Version of VRM specification. 0.0\n     */\n    specVersion?: string;\n  }\n\n  /**\n   * BlendShapeAvatar of UniVRM\n   */\n  export interface BlendShape {\n    blendShapeGroups?: BlendShapeGroup[];\n  }\n\n  export interface BlendShapeGroup {\n    /**\n     * Low level blendshape references.\n     */\n    binds?: BlendShapeBind[];\n    /**\n     * 0 or 1. Do not allow an intermediate value. Value should rounded\n     */\n    isBinary?: boolean;\n    /**\n     * Material animation references.\n     */\n    materialValues?: BlendShapeMaterialbind[];\n    /**\n     * Expression name\n     */\n    name?: string;\n    /**\n     * Predefined Expression name\n     */\n    presetName?: BlendShapePresetName;\n  }\n\n  export interface BlendShapeBind {\n    index?: number;\n    mesh?: number;\n    /**\n     * SkinnedMeshRenderer.SetBlendShapeWeight\n     */\n    weight?: number;\n  }\n\n  export interface BlendShapeMaterialbind {\n    materialName?: string;\n    propertyName?: string;\n    targetValue?: number[];\n  }\n\n  /**\n   * Predefined Expression name\n   */\n  export enum BlendShapePresetName {\n    A = 'a',\n    Angry = 'angry',\n    Blink = 'blink',\n    BlinkL = 'blink_l',\n    BlinkR = 'blink_r',\n    E = 'e',\n    Fun = 'fun',\n    I = 'i',\n    Joy = 'joy',\n    Lookdown = 'lookdown',\n    Lookleft = 'lookleft',\n    Lookright = 'lookright',\n    Lookup = 'lookup',\n    Neutral = 'neutral',\n    O = 'o',\n    Sorrow = 'sorrow',\n    U = 'u',\n    Unknown = 'unknown',\n  }\n\n  export interface FirstPerson {\n    /**\n     * The bone whose rendering should be turned off in first-person view. Usually Head is\n     * specified.\n     */\n    firstPersonBone?: number;\n    /**\n     * The target position of the VR headset in first-person view. It is assumed that an offset\n     * from the head bone to the VR headset is added.\n     */\n    firstPersonBoneOffset?: Vector3;\n    lookAtHorizontalInner?: FirstPersonDegreeMap;\n    lookAtHorizontalOuter?: FirstPersonDegreeMap;\n    /**\n     * Eye controller mode.\n     */\n    lookAtTypeName?: FirstPersonLookAtTypeName;\n    lookAtVerticalDown?: FirstPersonDegreeMap;\n    lookAtVerticalUp?: FirstPersonDegreeMap;\n    /**\n     * Switch display / undisplay for each mesh in first-person view or the others.\n     */\n    meshAnnotations?: FirstPersonMeshannotation[];\n  }\n\n  /**\n   * Eye controller setting.\n   */\n  export interface FirstPersonDegreeMap {\n    /**\n     * None linear mapping params. time, value, inTangent, outTangent\n     */\n    curve?: number[];\n    /**\n     * Look at input clamp range degree.\n     */\n    xRange?: number;\n    /**\n     * Look at map range degree from xRange.\n     */\n    yRange?: number;\n  }\n\n  /**\n   * Eye controller mode.\n   */\n  export enum FirstPersonLookAtTypeName {\n    BlendShape = 'BlendShape',\n    Bone = 'Bone',\n  }\n\n  export interface FirstPersonMeshannotation {\n    firstPersonFlag?: string;\n    mesh?: number;\n  }\n\n  export interface Humanoid {\n    /**\n     * Unity's HumanDescription.armStretch\n     */\n    armStretch?: number;\n    /**\n     * Unity's HumanDescription.feetSpacing\n     */\n    feetSpacing?: number;\n    /**\n     * Unity's HumanDescription.hasTranslationDoF\n     */\n    hasTranslationDoF?: boolean;\n    humanBones?: HumanoidBone[];\n    /**\n     * Unity's HumanDescription.legStretch\n     */\n    legStretch?: number;\n    /**\n     * Unity's HumanDescription.lowerArmTwist\n     */\n    lowerArmTwist?: number;\n    /**\n     * Unity's HumanDescription.lowerLegTwist\n     */\n    lowerLegTwist?: number;\n    /**\n     * Unity's HumanDescription.upperArmTwist\n     */\n    upperArmTwist?: number;\n    /**\n     * Unity's HumanDescription.upperLegTwist\n     */\n    upperLegTwist?: number;\n  }\n\n  export interface HumanoidBone {\n    /**\n     * Unity's HumanLimit.axisLength\n     */\n    axisLength?: number;\n    /**\n     * Human bone name.\n     */\n    bone?: HumanoidBoneName;\n    /**\n     * Unity's HumanLimit.center\n     */\n    center?: Vector3;\n    /**\n     * Unity's HumanLimit.max\n     */\n    max?: Vector3;\n    /**\n     * Unity's HumanLimit.min\n     */\n    min?: Vector3;\n    /**\n     * Reference node index\n     */\n    node?: number;\n    /**\n     * Unity's HumanLimit.useDefaultValues\n     */\n    useDefaultValues?: boolean;\n  }\n\n  /**\n   * Human bone name.\n   */\n  export enum HumanoidBoneName {\n    Chest = 'chest',\n    Head = 'head',\n    Hips = 'hips',\n    Jaw = 'jaw',\n    LeftEye = 'leftEye',\n    LeftFoot = 'leftFoot',\n    LeftHand = 'leftHand',\n    LeftIndexDistal = 'leftIndexDistal',\n    LeftIndexIntermediate = 'leftIndexIntermediate',\n    LeftIndexProximal = 'leftIndexProximal',\n    LeftLittleDistal = 'leftLittleDistal',\n    LeftLittleIntermediate = 'leftLittleIntermediate',\n    LeftLittleProximal = 'leftLittleProximal',\n    LeftLowerArm = 'leftLowerArm',\n    LeftLowerLeg = 'leftLowerLeg',\n    LeftMiddleDistal = 'leftMiddleDistal',\n    LeftMiddleIntermediate = 'leftMiddleIntermediate',\n    LeftMiddleProximal = 'leftMiddleProximal',\n    LeftRingDistal = 'leftRingDistal',\n    LeftRingIntermediate = 'leftRingIntermediate',\n    LeftRingProximal = 'leftRingProximal',\n    LeftShoulder = 'leftShoulder',\n    LeftThumbDistal = 'leftThumbDistal',\n    LeftThumbIntermediate = 'leftThumbIntermediate',\n    LeftThumbProximal = 'leftThumbProximal',\n    LeftToes = 'leftToes',\n    LeftUpperArm = 'leftUpperArm',\n    LeftUpperLeg = 'leftUpperLeg',\n    Neck = 'neck',\n    RightEye = 'rightEye',\n    RightFoot = 'rightFoot',\n    RightHand = 'rightHand',\n    RightIndexDistal = 'rightIndexDistal',\n    RightIndexIntermediate = 'rightIndexIntermediate',\n    RightIndexProximal = 'rightIndexProximal',\n    RightLittleDistal = 'rightLittleDistal',\n    RightLittleIntermediate = 'rightLittleIntermediate',\n    RightLittleProximal = 'rightLittleProximal',\n    RightLowerArm = 'rightLowerArm',\n    RightLowerLeg = 'rightLowerLeg',\n    RightMiddleDistal = 'rightMiddleDistal',\n    RightMiddleIntermediate = 'rightMiddleIntermediate',\n    RightMiddleProximal = 'rightMiddleProximal',\n    RightRingDistal = 'rightRingDistal',\n    RightRingIntermediate = 'rightRingIntermediate',\n    RightRingProximal = 'rightRingProximal',\n    RightShoulder = 'rightShoulder',\n    RightThumbDistal = 'rightThumbDistal',\n    RightThumbIntermediate = 'rightThumbIntermediate',\n    RightThumbProximal = 'rightThumbProximal',\n    RightToes = 'rightToes',\n    RightUpperArm = 'rightUpperArm',\n    RightUpperLeg = 'rightUpperLeg',\n    Spine = 'spine',\n    UpperChest = 'upperChest',\n  }\n\n  export interface Material {\n    floatProperties?: { [key: string]: any };\n    keywordMap?: { [key: string]: any };\n    name?: string;\n    renderQueue?: number;\n    shader?: string;\n    tagMap?: { [key: string]: any };\n    textureProperties?: { [key: string]: any };\n    vectorProperties?: { [key: string]: any };\n  }\n\n  export interface Meta {\n    /**\n     * A person who can perform with this avatar\n     */\n    allowedUserName?: MetaAllowedUserName;\n    /**\n     * Author of VRM model\n     */\n    author?: string;\n    /**\n     * For commercial use\n     */\n    commercialUssageName?: MetaUssageName;\n    /**\n     * Contact Information of VRM model author\n     */\n    contactInformation?: string;\n    /**\n     * License type\n     */\n    licenseName?: MetaLicenseName;\n    /**\n     * If Other is selected, put the URL link of the license document here.\n     */\n    otherLicenseUrl?: string;\n    /**\n     * If there are any conditions not mentioned above, put the URL link of the license document\n     * here.\n     */\n    otherPermissionUrl?: string;\n    /**\n     * Reference of VRM model\n     */\n    reference?: string;\n    /**\n     * Permission to perform sexual acts with this avatar\n     */\n    sexualUssageName?: MetaUssageName;\n    /**\n     * Thumbnail of VRM model\n     */\n    texture?: number;\n    /**\n     * Title of VRM model\n     */\n    title?: string;\n    /**\n     * Version of VRM model\n     */\n    version?: string;\n    /**\n     * Permission to perform violent acts with this avatar\n     */\n    violentUssageName?: MetaUssageName;\n  }\n\n  /**\n   * A person who can perform with this avatar\n   */\n  export enum MetaAllowedUserName {\n    Everyone = 'Everyone',\n    ExplicitlyLicensedPerson = 'ExplicitlyLicensedPerson',\n    OnlyAuthor = 'OnlyAuthor',\n  }\n\n  /**\n   * For commercial use\n   *\n   * Permission to perform sexual acts with this avatar\n   *\n   * Permission to perform violent acts with this avatar\n   */\n  export enum MetaUssageName {\n    Allow = 'Allow',\n    Disallow = 'Disallow',\n  }\n\n  /**\n   * License type\n   */\n  export enum MetaLicenseName {\n    Cc0 = 'CC0',\n    CcBy = 'CC_BY',\n    CcByNc = 'CC_BY_NC',\n    CcByNcNd = 'CC_BY_NC_ND',\n    CcByNcSa = 'CC_BY_NC_SA',\n    CcByNd = 'CC_BY_ND',\n    CcBySa = 'CC_BY_SA',\n    Other = 'Other',\n    RedistributionProhibited = 'Redistribution_Prohibited',\n  }\n\n  /**\n   * The setting of automatic animation of string-like objects such as tails and hairs.\n   */\n  export interface SecondaryAnimation {\n    boneGroups?: SecondaryAnimationSpring[];\n    colliderGroups?: SecondaryAnimationCollidergroup[];\n  }\n\n  export interface SecondaryAnimationSpring {\n    /**\n     * Specify the node index of the root bone of the swaying object.\n     */\n    bones?: number[];\n    /**\n     * The reference point of a swaying object can be set at any location except the origin.\n     * When implementing UI moving with warp, the parent node to move with warp can be specified\n     * if you don't want to make the object swaying with warp movement.\n     */\n    center?: number;\n    /**\n     * Specify the index of the collider group for collisions with swaying objects.\n     */\n    colliderGroups?: number[];\n    /**\n     * Annotation comment\n     */\n    comment?: string;\n    /**\n     * The resistance (deceleration) of automatic animation.\n     */\n    dragForce?: number;\n    /**\n     * The direction of gravity. Set (0, -1, 0) for simulating the gravity. Set (1, 0, 0) for\n     * simulating the wind.\n     */\n    gravityDir?: Vector3;\n    /**\n     * The strength of gravity.\n     */\n    gravityPower?: number;\n    /**\n     * The radius of the sphere used for the collision detection with colliders.\n     */\n    hitRadius?: number;\n    /**\n     * The resilience of the swaying object (the power of returning to the initial pose).\n     */\n    stiffiness?: number;\n  }\n\n  export interface SecondaryAnimationCollidergroup {\n    colliders?: SecondaryAnimationCollider[];\n    /**\n     * The node of the collider group for setting up collision detections.\n     */\n    node?: number;\n  }\n\n  export interface SecondaryAnimationCollider {\n    /**\n     * The local coordinate from the node of the collider group.\n     */\n    offset?: Vector3;\n    /**\n     * The radius of the collider.\n     */\n    radius?: number;\n  }\n\n  export interface Vector3 {\n    x?: number;\n    y?: number;\n    z?: number;\n  }\n}\n","// Typedoc does not support export declarations yet\n// then we have to use `namespace` instead of export declarations for now.\n// See: https://github.com/TypeStrong/typedoc/pull/801\n\n// import * as GLTFSchema from './GLTFSchema';\n// import * as VRMSchema from './VRMSchema';\n\n// export { GLTFSchema, VRMSchema };\n\nexport * from './GLTFSchema';\nexport * from './VRMSchema';\n\nexport * from './types';\n","import * as THREE from 'three';\n\nfunction disposeMaterial(material: any): void {\n  Object.keys(material).forEach((propertyName) => {\n    if (!!material[propertyName] && typeof material[propertyName].dispose === 'function') {\n      material[propertyName].dispose();\n    }\n  });\n\n  material.dispose();\n  material = undefined;\n}\n\nfunction dispose(object3D: any): void {\n  if (object3D.geometry) {\n    object3D.geometry.dispose();\n    object3D.geometry = undefined;\n  }\n\n  if (!!object3D.material && Array.isArray(object3D.material)) {\n    object3D.material.forEach((material: THREE.Material) => disposeMaterial(material));\n  } else if (object3D.material) {\n    disposeMaterial(object3D.material);\n  }\n}\n\nexport function deepDispose(object3D: THREE.Object3D): void {\n  object3D.traverse(dispose);\n}\n","import * as THREE from 'three';\n\n/**\n * Clamp an input number within [ `0.0` - `1.0` ].\n *\n * @param value The input value\n */\nexport function saturate(value: number): number {\n  return Math.max(Math.min(value, 1.0), 0.0);\n}\n\n/**\n * Map the range of an input value from [ `min` - `max` ] to [ `0.0` - `1.0` ].\n * If input value is less than `min` , it returns `0.0`.\n * If input value is greater than `max` , it returns `1.0`.\n *\n * See also: https://threejs.org/docs/#api/en/math/Math.smoothstep\n *\n * @param x The value that will be mapped into the specified range\n * @param min Minimum value of the range\n * @param max Maximum value of the range\n */\nexport function linstep(x: number, min: number, max: number): number {\n  if (x <= min) return 0;\n  if (x >= max) return 1;\n\n  return (x - min) / (max - min);\n}\n\nconst _position = new THREE.Vector3();\nconst _scale = new THREE.Vector3();\nconst _rotation = new THREE.Quaternion();\n\n/**\n * Extract world position of an object from its world space matrix, in cheaper way.\n *\n * @param object The object\n * @param out Target vector\n */\nexport function getWorldPositionLite(object: THREE.Object3D, out: THREE.Vector3): THREE.Vector3 {\n  object.matrixWorld.decompose(out, _rotation, _scale);\n  return out;\n}\n\n/**\n * Extract world scale of an object from its world space matrix, in cheaper way.\n *\n * @param object The object\n * @param out Target vector\n */\nexport function getWorldScaleLite(object: THREE.Object3D, out: THREE.Vector3): THREE.Vector3 {\n  object.matrixWorld.decompose(_position, _rotation, out);\n  return out;\n}\n\n/**\n * Extract world rotation of an object from its world space matrix, in cheaper way.\n *\n * @param object The object\n * @param out Target vector\n */\nexport function getWorldQuaternionLite(object: THREE.Object3D, out: THREE.Quaternion): THREE.Quaternion {\n  object.matrixWorld.decompose(_position, out, _scale);\n  return out;\n}\n","export function renameMaterialProperty(name: string): string {\n  if (name[0] !== '_') {\n    console.warn(`renameMaterialProperty: Given property name \"${name}\" might be invalid`);\n    return name;\n  }\n  name = name.substring(1);\n\n  if (!/[A-Z]/.test(name[0])) {\n    console.warn(`renameMaterialProperty: Given property name \"${name}\" might be invalid`);\n    return name;\n  }\n  return name[0].toLowerCase() + name.substring(1);\n}\n","module.exports = THREE;"],"sourceRoot":""},"metadata":{},"sourceType":"module"}