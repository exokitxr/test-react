{"ast":null,"code":"/* eslint-disable */\n\n/**\n * @license\n * webxr-polyfill\n * Copyright (c) 2017 Google\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @license\n * cardboard-vr-display\n * Copyright (c) 2015-2017 Google\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @license\n * webvr-polyfill-dpdb \n * Copyright (c) 2017 Google\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @license\n * wglu-preserve-state\n * Copyright (c) 2016, Brandon Jones.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * @license\n * nosleep.js\n * Copyright (c) 2017, Rich Tibbett\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\nif (!/(Helio)/g.test(navigator.userAgent)) {\n  const _global = typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : {};\n\n  const PRIVATE = Symbol('@@webxr-polyfill/EventTarget');\n\n  class EventTarget {\n    constructor() {\n      this[PRIVATE] = {\n        listeners: new Map()\n      };\n    }\n\n    addEventListener(type, listener) {\n      if (typeof type !== 'string') {\n        throw new Error('`type` must be a string');\n      }\n\n      if (typeof listener !== 'function') {\n        throw new Error('`listener` must be a function');\n      }\n\n      const typedListeners = this[PRIVATE].listeners.get(type) || [];\n      typedListeners.push(listener);\n      this[PRIVATE].listeners.set(type, typedListeners);\n    }\n\n    removeEventListener(type, listener) {\n      if (typeof type !== 'string') {\n        throw new Error('`type` must be a string');\n      }\n\n      if (typeof listener !== 'function') {\n        throw new Error('`listener` must be a function');\n      }\n\n      const typedListeners = this[PRIVATE].listeners.get(type) || [];\n\n      for (let i = typedListeners.length; i >= 0; i--) {\n        if (typedListeners[i] === listener) {\n          typedListeners.pop();\n        }\n      }\n    }\n\n    dispatchEvent(type, event) {\n      const typedListeners = this[PRIVATE].listeners.get(type) || [];\n      const queue = [];\n\n      for (let i = 0; i < typedListeners.length; i++) {\n        queue[i] = typedListeners[i];\n      }\n\n      for (let listener of queue) {\n        listener(event);\n      }\n\n      if (typeof this[\"on\".concat(type)] === 'function') {\n        this[\"on\".concat(type)](event);\n      }\n    }\n\n  }\n\n  const PRIVATE$1 = Symbol('@@webxr-polyfill/XR');\n  const XRSessionModes = ['inline', 'immersive-vr', 'immersive-ar'];\n  const POLYFILL_REQUEST_SESSION_ERROR = \"Polyfill Error: Must call navigator.xr.supportsSession() with any XRSessionMode\\nor navigator.xr.requestSession('inline') prior to requesting an immersive\\nsession. This is a limitation specific to the WebXR Polyfill and does not apply\\nto native implementations of the API.\";\n\n  class XR$1 extends EventTarget {\n    constructor(devicePromise) {\n      super();\n      this[PRIVATE$1] = {\n        device: null,\n        devicePromise,\n        immersiveSession: null,\n        inlineSessions: new Set()\n      };\n      devicePromise.then(device => {\n        this[PRIVATE$1].device = device;\n      });\n    }\n\n    async supportsSession(mode) {\n      if (!this[PRIVATE$1].device) {\n        await this[PRIVATE$1].devicePromise;\n      }\n\n      if (mode != 'inline') {\n        if (!this[PRIVATE$1].device.supportsSession(mode)) {\n          return Promise.reject(null);\n        }\n      }\n\n      return Promise.resolve(null);\n    }\n\n    async requestSession(mode) {\n      if (!this[PRIVATE$1].device) {\n        if (mode != 'inline') {\n          throw new Error(POLYFILL_REQUEST_SESSION_ERROR);\n        } else {\n          await this[PRIVATE$1].devicePromise;\n        }\n      }\n\n      const sessionId = await this[PRIVATE$1].device.requestSession(mode);\n      const session = new XRSession(this[PRIVATE$1].device, mode, sessionId);\n\n      if (mode == 'inline') {\n        this[PRIVATE$1].inlineSessions.add(session);\n      } else {\n        this[PRIVATE$1].immersiveSession = session;\n      }\n\n      const onSessionEnd = () => {\n        if (mode == 'inline') {\n          this[PRIVATE$1].inlineSessions.delete(session);\n        } else {\n          this[PRIVATE$1].immersiveSession = null;\n        }\n\n        session.removeEventListener('end', onSessionEnd);\n      };\n\n      session.addEventListener('end', onSessionEnd);\n      return session;\n    }\n\n  }\n\n  let now;\n\n  if ('performance' in _global === false) {\n    let startTime = Date.now();\n\n    now = () => Date.now() - startTime;\n  } else {\n    now = () => performance.now();\n  }\n\n  var now$1 = now;\n  const PRIVATE$2 = Symbol('@@webxr-polyfill/XRPose');\n\n  class XRPose$1 {\n    constructor(transform, emulatedPosition) {\n      this[PRIVATE$2] = {\n        transform,\n        emulatedPosition\n      };\n    }\n\n    get transform() {\n      return this[PRIVATE$2].transform;\n    }\n\n    get emulatedPosition() {\n      return this[PRIVATE$2].emulatedPosition;\n    }\n\n    _setTransform(transform) {\n      this[PRIVATE$2].transform = transform;\n    }\n\n  }\n\n  const EPSILON = 0.000001;\n  let ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\n  const degree = Math.PI / 180;\n\n  function create() {\n    let out = new ARRAY_TYPE(16);\n\n    if (ARRAY_TYPE != Float32Array) {\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 0;\n      out[4] = 0;\n      out[6] = 0;\n      out[7] = 0;\n      out[8] = 0;\n      out[9] = 0;\n      out[11] = 0;\n      out[12] = 0;\n      out[13] = 0;\n      out[14] = 0;\n    }\n\n    out[0] = 1;\n    out[5] = 1;\n    out[10] = 1;\n    out[15] = 1;\n    return out;\n  }\n\n  function copy(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n    return out;\n  }\n\n  function identity(out) {\n    out[0] = 1;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = 1;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[10] = 1;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n    out[15] = 1;\n    return out;\n  }\n\n  function invert(out, a) {\n    let a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    let a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7];\n    let a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11];\n    let a30 = a[12],\n        a31 = a[13],\n        a32 = a[14],\n        a33 = a[15];\n    let b00 = a00 * a11 - a01 * a10;\n    let b01 = a00 * a12 - a02 * a10;\n    let b02 = a00 * a13 - a03 * a10;\n    let b03 = a01 * a12 - a02 * a11;\n    let b04 = a01 * a13 - a03 * a11;\n    let b05 = a02 * a13 - a03 * a12;\n    let b06 = a20 * a31 - a21 * a30;\n    let b07 = a20 * a32 - a22 * a30;\n    let b08 = a20 * a33 - a23 * a30;\n    let b09 = a21 * a32 - a22 * a31;\n    let b10 = a21 * a33 - a23 * a31;\n    let b11 = a22 * a33 - a23 * a32;\n    let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n    if (!det) {\n      return null;\n    }\n\n    det = 1.0 / det;\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n    return out;\n  }\n\n  function multiply(out, a, b) {\n    let a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    let a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7];\n    let a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11];\n    let a30 = a[12],\n        a31 = a[13],\n        a32 = a[14],\n        a33 = a[15];\n    let b0 = b[0],\n        b1 = b[1],\n        b2 = b[2],\n        b3 = b[3];\n    out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n    b0 = b[4];\n    b1 = b[5];\n    b2 = b[6];\n    b3 = b[7];\n    out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n    b0 = b[8];\n    b1 = b[9];\n    b2 = b[10];\n    b3 = b[11];\n    out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n    b0 = b[12];\n    b1 = b[13];\n    b2 = b[14];\n    b3 = b[15];\n    out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n    out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n    out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n    out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n    return out;\n  }\n\n  function fromRotationTranslation(out, q, v) {\n    let x = q[0],\n        y = q[1],\n        z = q[2],\n        w = q[3];\n    let x2 = x + x;\n    let y2 = y + y;\n    let z2 = z + z;\n    let xx = x * x2;\n    let xy = x * y2;\n    let xz = x * z2;\n    let yy = y * y2;\n    let yz = y * z2;\n    let zz = z * z2;\n    let wx = w * x2;\n    let wy = w * y2;\n    let wz = w * z2;\n    out[0] = 1 - (yy + zz);\n    out[1] = xy + wz;\n    out[2] = xz - wy;\n    out[3] = 0;\n    out[4] = xy - wz;\n    out[5] = 1 - (xx + zz);\n    out[6] = yz + wx;\n    out[7] = 0;\n    out[8] = xz + wy;\n    out[9] = yz - wx;\n    out[10] = 1 - (xx + yy);\n    out[11] = 0;\n    out[12] = v[0];\n    out[13] = v[1];\n    out[14] = v[2];\n    out[15] = 1;\n    return out;\n  }\n\n  function getTranslation(out, mat) {\n    out[0] = mat[12];\n    out[1] = mat[13];\n    out[2] = mat[14];\n    return out;\n  }\n\n  function getRotation(out, mat) {\n    let trace = mat[0] + mat[5] + mat[10];\n    let S = 0;\n\n    if (trace > 0) {\n      S = Math.sqrt(trace + 1.0) * 2;\n      out[3] = 0.25 * S;\n      out[0] = (mat[6] - mat[9]) / S;\n      out[1] = (mat[8] - mat[2]) / S;\n      out[2] = (mat[1] - mat[4]) / S;\n    } else if (mat[0] > mat[5] && mat[0] > mat[10]) {\n      S = Math.sqrt(1.0 + mat[0] - mat[5] - mat[10]) * 2;\n      out[3] = (mat[6] - mat[9]) / S;\n      out[0] = 0.25 * S;\n      out[1] = (mat[1] + mat[4]) / S;\n      out[2] = (mat[8] + mat[2]) / S;\n    } else if (mat[5] > mat[10]) {\n      S = Math.sqrt(1.0 + mat[5] - mat[0] - mat[10]) * 2;\n      out[3] = (mat[8] - mat[2]) / S;\n      out[0] = (mat[1] + mat[4]) / S;\n      out[1] = 0.25 * S;\n      out[2] = (mat[6] + mat[9]) / S;\n    } else {\n      S = Math.sqrt(1.0 + mat[10] - mat[0] - mat[5]) * 2;\n      out[3] = (mat[1] - mat[4]) / S;\n      out[0] = (mat[8] + mat[2]) / S;\n      out[1] = (mat[6] + mat[9]) / S;\n      out[2] = 0.25 * S;\n    }\n\n    return out;\n  }\n\n  function perspective(out, fovy, aspect, near, far) {\n    let f = 1.0 / Math.tan(fovy / 2),\n        nf;\n    out[0] = f / aspect;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = f;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = -1;\n    out[12] = 0;\n    out[13] = 0;\n    out[15] = 0;\n\n    if (far != null && far !== Infinity) {\n      nf = 1 / (near - far);\n      out[10] = (far + near) * nf;\n      out[14] = 2 * far * near * nf;\n    } else {\n      out[10] = -1;\n      out[14] = -2 * near;\n    }\n\n    return out;\n  }\n\n  function create$1() {\n    let out = new ARRAY_TYPE(3);\n\n    if (ARRAY_TYPE != Float32Array) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n    }\n\n    return out;\n  }\n\n  function clone$1(a) {\n    var out = new ARRAY_TYPE(3);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n  }\n\n  function length(a) {\n    let x = a[0];\n    let y = a[1];\n    let z = a[2];\n    return Math.sqrt(x * x + y * y + z * z);\n  }\n\n  function fromValues$1(x, y, z) {\n    let out = new ARRAY_TYPE(3);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n  }\n\n  function copy$1(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    return out;\n  }\n\n  function add$1(out, a, b) {\n    out[0] = a[0] + b[0];\n    out[1] = a[1] + b[1];\n    out[2] = a[2] + b[2];\n    return out;\n  }\n\n  function scale$1(out, a, b) {\n    out[0] = a[0] * b;\n    out[1] = a[1] * b;\n    out[2] = a[2] * b;\n    return out;\n  }\n\n  function normalize(out, a) {\n    let x = a[0];\n    let y = a[1];\n    let z = a[2];\n    let len = x * x + y * y + z * z;\n\n    if (len > 0) {\n      len = 1 / Math.sqrt(len);\n      out[0] = a[0] * len;\n      out[1] = a[1] * len;\n      out[2] = a[2] * len;\n    }\n\n    return out;\n  }\n\n  function dot(a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n  }\n\n  function cross(out, a, b) {\n    let ax = a[0],\n        ay = a[1],\n        az = a[2];\n    let bx = b[0],\n        by = b[1],\n        bz = b[2];\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n  }\n\n  function transformQuat(out, a, q) {\n    let qx = q[0],\n        qy = q[1],\n        qz = q[2],\n        qw = q[3];\n    let x = a[0],\n        y = a[1],\n        z = a[2];\n    let uvx = qy * z - qz * y,\n        uvy = qz * x - qx * z,\n        uvz = qx * y - qy * x;\n    let uuvx = qy * uvz - qz * uvy,\n        uuvy = qz * uvx - qx * uvz,\n        uuvz = qx * uvy - qy * uvx;\n    let w2 = qw * 2;\n    uvx *= w2;\n    uvy *= w2;\n    uvz *= w2;\n    uuvx *= 2;\n    uuvy *= 2;\n    uuvz *= 2;\n    out[0] = x + uvx + uuvx;\n    out[1] = y + uvy + uuvy;\n    out[2] = z + uvz + uuvz;\n    return out;\n  }\n\n  function angle(a, b) {\n    let tempA = fromValues$1(a[0], a[1], a[2]);\n    let tempB = fromValues$1(b[0], b[1], b[2]);\n    normalize(tempA, tempA);\n    normalize(tempB, tempB);\n    let cosine = dot(tempA, tempB);\n\n    if (cosine > 1.0) {\n      return 0;\n    } else if (cosine < -1.0) {\n      return Math.PI;\n    } else {\n      return Math.acos(cosine);\n    }\n  }\n\n  const len = length;\n\n  const forEach = function () {\n    let vec = create$1();\n    return function (a, stride, offset, count, fn, arg) {\n      let i, l;\n\n      if (!stride) {\n        stride = 3;\n      }\n\n      if (!offset) {\n        offset = 0;\n      }\n\n      if (count) {\n        l = Math.min(count * stride + offset, a.length);\n      } else {\n        l = a.length;\n      }\n\n      for (i = offset; i < l; i += stride) {\n        vec[0] = a[i];\n        vec[1] = a[i + 1];\n        vec[2] = a[i + 2];\n        fn(vec, vec, arg);\n        a[i] = vec[0];\n        a[i + 1] = vec[1];\n        a[i + 2] = vec[2];\n      }\n\n      return a;\n    };\n  }();\n\n  function create$2() {\n    let out = new ARRAY_TYPE(9);\n\n    if (ARRAY_TYPE != Float32Array) {\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 0;\n      out[5] = 0;\n      out[6] = 0;\n      out[7] = 0;\n    }\n\n    out[0] = 1;\n    out[4] = 1;\n    out[8] = 1;\n    return out;\n  }\n\n  function create$3() {\n    let out = new ARRAY_TYPE(4);\n\n    if (ARRAY_TYPE != Float32Array) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 0;\n    }\n\n    return out;\n  }\n\n  function clone$3(a) {\n    let out = new ARRAY_TYPE(4);\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    return out;\n  }\n\n  function fromValues$3(x, y, z, w) {\n    let out = new ARRAY_TYPE(4);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    out[3] = w;\n    return out;\n  }\n\n  function copy$3(out, a) {\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    return out;\n  }\n\n  function normalize$1(out, a) {\n    let x = a[0];\n    let y = a[1];\n    let z = a[2];\n    let w = a[3];\n    let len = x * x + y * y + z * z + w * w;\n\n    if (len > 0) {\n      len = 1 / Math.sqrt(len);\n      out[0] = x * len;\n      out[1] = y * len;\n      out[2] = z * len;\n      out[3] = w * len;\n    }\n\n    return out;\n  }\n\n  const forEach$1 = function () {\n    let vec = create$3();\n    return function (a, stride, offset, count, fn, arg) {\n      let i, l;\n\n      if (!stride) {\n        stride = 4;\n      }\n\n      if (!offset) {\n        offset = 0;\n      }\n\n      if (count) {\n        l = Math.min(count * stride + offset, a.length);\n      } else {\n        l = a.length;\n      }\n\n      for (i = offset; i < l; i += stride) {\n        vec[0] = a[i];\n        vec[1] = a[i + 1];\n        vec[2] = a[i + 2];\n        vec[3] = a[i + 3];\n        fn(vec, vec, arg);\n        a[i] = vec[0];\n        a[i + 1] = vec[1];\n        a[i + 2] = vec[2];\n        a[i + 3] = vec[3];\n      }\n\n      return a;\n    };\n  }();\n\n  function create$4() {\n    let out = new ARRAY_TYPE(4);\n\n    if (ARRAY_TYPE != Float32Array) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n    }\n\n    out[3] = 1;\n    return out;\n  }\n\n  function setAxisAngle(out, axis, rad) {\n    rad = rad * 0.5;\n    let s = Math.sin(rad);\n    out[0] = s * axis[0];\n    out[1] = s * axis[1];\n    out[2] = s * axis[2];\n    out[3] = Math.cos(rad);\n    return out;\n  }\n\n  function multiply$4(out, a, b) {\n    let ax = a[0],\n        ay = a[1],\n        az = a[2],\n        aw = a[3];\n    let bx = b[0],\n        by = b[1],\n        bz = b[2],\n        bw = b[3];\n    out[0] = ax * bw + aw * bx + ay * bz - az * by;\n    out[1] = ay * bw + aw * by + az * bx - ax * bz;\n    out[2] = az * bw + aw * bz + ax * by - ay * bx;\n    out[3] = aw * bw - ax * bx - ay * by - az * bz;\n    return out;\n  }\n\n  function slerp(out, a, b, t) {\n    let ax = a[0],\n        ay = a[1],\n        az = a[2],\n        aw = a[3];\n    let bx = b[0],\n        by = b[1],\n        bz = b[2],\n        bw = b[3];\n    let omega, cosom, sinom, scale0, scale1;\n    cosom = ax * bx + ay * by + az * bz + aw * bw;\n\n    if (cosom < 0.0) {\n      cosom = -cosom;\n      bx = -bx;\n      by = -by;\n      bz = -bz;\n      bw = -bw;\n    }\n\n    if (1.0 - cosom > EPSILON) {\n      omega = Math.acos(cosom);\n      sinom = Math.sin(omega);\n      scale0 = Math.sin((1.0 - t) * omega) / sinom;\n      scale1 = Math.sin(t * omega) / sinom;\n    } else {\n      scale0 = 1.0 - t;\n      scale1 = t;\n    }\n\n    out[0] = scale0 * ax + scale1 * bx;\n    out[1] = scale0 * ay + scale1 * by;\n    out[2] = scale0 * az + scale1 * bz;\n    out[3] = scale0 * aw + scale1 * bw;\n    return out;\n  }\n\n  function invert$2(out, a) {\n    let a0 = a[0],\n        a1 = a[1],\n        a2 = a[2],\n        a3 = a[3];\n    let dot$$1 = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n    let invDot = dot$$1 ? 1.0 / dot$$1 : 0;\n    out[0] = -a0 * invDot;\n    out[1] = -a1 * invDot;\n    out[2] = -a2 * invDot;\n    out[3] = a3 * invDot;\n    return out;\n  }\n\n  function fromMat3(out, m) {\n    let fTrace = m[0] + m[4] + m[8];\n    let fRoot;\n\n    if (fTrace > 0.0) {\n      fRoot = Math.sqrt(fTrace + 1.0);\n      out[3] = 0.5 * fRoot;\n      fRoot = 0.5 / fRoot;\n      out[0] = (m[5] - m[7]) * fRoot;\n      out[1] = (m[6] - m[2]) * fRoot;\n      out[2] = (m[1] - m[3]) * fRoot;\n    } else {\n      let i = 0;\n      if (m[4] > m[0]) i = 1;\n      if (m[8] > m[i * 3 + i]) i = 2;\n      let j = (i + 1) % 3;\n      let k = (i + 2) % 3;\n      fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n      out[i] = 0.5 * fRoot;\n      fRoot = 0.5 / fRoot;\n      out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n      out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n      out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n    }\n\n    return out;\n  }\n\n  function fromEuler(out, x, y, z) {\n    let halfToRad = 0.5 * Math.PI / 180.0;\n    x *= halfToRad;\n    y *= halfToRad;\n    z *= halfToRad;\n    let sx = Math.sin(x);\n    let cx = Math.cos(x);\n    let sy = Math.sin(y);\n    let cy = Math.cos(y);\n    let sz = Math.sin(z);\n    let cz = Math.cos(z);\n    out[0] = sx * cy * cz - cx * sy * sz;\n    out[1] = cx * sy * cz + sx * cy * sz;\n    out[2] = cx * cy * sz - sx * sy * cz;\n    out[3] = cx * cy * cz + sx * sy * sz;\n    return out;\n  }\n\n  const clone$4 = clone$3;\n  const fromValues$4 = fromValues$3;\n  const copy$4 = copy$3;\n  const normalize$2 = normalize$1;\n\n  const rotationTo = function () {\n    let tmpvec3 = create$1();\n    let xUnitVec3 = fromValues$1(1, 0, 0);\n    let yUnitVec3 = fromValues$1(0, 1, 0);\n    return function (out, a, b) {\n      let dot$$1 = dot(a, b);\n\n      if (dot$$1 < -0.999999) {\n        cross(tmpvec3, xUnitVec3, a);\n        if (len(tmpvec3) < 0.000001) cross(tmpvec3, yUnitVec3, a);\n        normalize(tmpvec3, tmpvec3);\n        setAxisAngle(out, tmpvec3, Math.PI);\n        return out;\n      } else if (dot$$1 > 0.999999) {\n        out[0] = 0;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        return out;\n      } else {\n        cross(tmpvec3, a, b);\n        out[0] = tmpvec3[0];\n        out[1] = tmpvec3[1];\n        out[2] = tmpvec3[2];\n        out[3] = 1 + dot$$1;\n        return normalize$2(out, out);\n      }\n    };\n  }();\n\n  const sqlerp = function () {\n    let temp1 = create$4();\n    let temp2 = create$4();\n    return function (out, a, b, c, d, t) {\n      slerp(temp1, a, d, t);\n      slerp(temp2, b, c, t);\n      slerp(out, temp1, temp2, 2 * t * (1 - t));\n      return out;\n    };\n  }();\n\n  const setAxes = function () {\n    let matr = create$2();\n    return function (out, view, right, up) {\n      matr[0] = right[0];\n      matr[3] = right[1];\n      matr[6] = right[2];\n      matr[1] = up[0];\n      matr[4] = up[1];\n      matr[7] = up[2];\n      matr[2] = -view[0];\n      matr[5] = -view[1];\n      matr[8] = -view[2];\n      return normalize$2(out, fromMat3(out, matr));\n    };\n  }();\n\n  const PRIVATE$3 = Symbol('@@webxr-polyfill/XRRigidTransform');\n\n  class XRRigidTransform$1 {\n    constructor() {\n      this[PRIVATE$3] = {\n        matrix: null,\n        position: null,\n        orientation: null,\n        inverse: null\n      };\n\n      if (arguments.length === 0) {\n        this[PRIVATE$3].matrix = identity(new Float32Array(16));\n      } else if (arguments.length === 1) {\n        if (arguments[0] instanceof Float32Array) {\n          this[PRIVATE$3].matrix = arguments[0];\n        } else {\n          this[PRIVATE$3].position = this._getPoint(arguments[0]);\n          this[PRIVATE$3].orientation = DOMPointReadOnly.fromPoint({\n            x: 0,\n            y: 0,\n            z: 0,\n            w: 1\n          });\n        }\n      } else if (arguments.length === 2) {\n        this[PRIVATE$3].position = this._getPoint(arguments[0]);\n        this[PRIVATE$3].orientation = this._getPoint(arguments[1]);\n      } else {\n        throw new Error(\"Too many arguments!\");\n      }\n\n      if (this[PRIVATE$3].matrix) {\n        let position = create$1();\n        getTranslation(position, this[PRIVATE$3].matrix);\n        this[PRIVATE$3].position = DOMPointReadOnly.fromPoint({\n          x: position[0],\n          y: position[1],\n          z: position[2]\n        });\n        let orientation = create$4();\n        getRotation(orientation, this[PRIVATE$3].matrix);\n        this[PRIVATE$3].orientation = DOMPointReadOnly.fromPoint({\n          x: orientation[0],\n          y: orientation[1],\n          z: orientation[2],\n          w: orientation[3]\n        });\n      } else {\n        this[PRIVATE$3].matrix = identity(new Float32Array(16));\n        fromRotationTranslation(this[PRIVATE$3].matrix, fromValues$4(this[PRIVATE$3].orientation.x, this[PRIVATE$3].orientation.y, this[PRIVATE$3].orientation.z, this[PRIVATE$3].orientation.w), fromValues$1(this[PRIVATE$3].position.x, this[PRIVATE$3].position.y, this[PRIVATE$3].position.z));\n      }\n    }\n\n    _getPoint(arg) {\n      if (arg instanceof DOMPointReadOnly) {\n        return arg;\n      }\n\n      return DOMPointReadOnly.fromPoint(arg);\n    }\n\n    get matrix() {\n      return this[PRIVATE$3].matrix;\n    }\n\n    get position() {\n      return this[PRIVATE$3].position;\n    }\n\n    get orientation() {\n      return this[PRIVATE$3].orientation;\n    }\n\n    get inverse() {\n      if (this[PRIVATE$3].inverse === null) {\n        let invMatrix = identity(new Float32Array(16));\n        invert(invMatrix, this[PRIVATE$3].matrix);\n        this[PRIVATE$3].inverse = new XRRigidTransform$1(invMatrix);\n        this[PRIVATE$3].inverse[PRIVATE$3].inverse = this;\n      }\n\n      return this[PRIVATE$3].inverse;\n    }\n\n  }\n\n  const PRIVATE$4 = Symbol('@@webxr-polyfill/XRViewerPose');\n\n  class XRViewerPose extends XRPose$1 {\n    constructor(device, views) {\n      super(new XRRigidTransform$1(), false);\n      this[PRIVATE$4] = {\n        device,\n        views,\n        leftViewMatrix: identity(new Float32Array(16)),\n        rightViewMatrix: identity(new Float32Array(16)),\n        poseModelMatrix: identity(new Float32Array(16))\n      };\n    }\n\n    get poseModelMatrix() {\n      return this[PRIVATE$4].poseModelMatrix;\n    }\n\n    get views() {\n      return this[PRIVATE$4].views;\n    }\n\n    _updateFromReferenceSpace(refSpace) {\n      const pose = this[PRIVATE$4].device.getBasePoseMatrix();\n      const leftViewMatrix = this[PRIVATE$4].device.getBaseViewMatrix('left');\n      const rightViewMatrix = this[PRIVATE$4].device.getBaseViewMatrix('right');\n\n      if (pose) {\n        refSpace._transformBasePoseMatrix(this[PRIVATE$4].poseModelMatrix, pose);\n\n        refSpace._adjustForOriginOffset(this[PRIVATE$4].poseModelMatrix);\n\n        super._setTransform(new XRRigidTransform$1(this[PRIVATE$4].poseModelMatrix));\n      }\n\n      if (leftViewMatrix) {\n        refSpace._transformBaseViewMatrix(this[PRIVATE$4].leftViewMatrix, leftViewMatrix, this[PRIVATE$4].poseModelMatrix);\n\n        multiply(this[PRIVATE$4].leftViewMatrix, this[PRIVATE$4].leftViewMatrix, refSpace._originOffsetMatrix());\n      }\n\n      if (rightViewMatrix) {\n        refSpace._transformBaseViewMatrix(this[PRIVATE$4].rightViewMatrix, rightViewMatrix, this[PRIVATE$4].poseModelMatrix);\n\n        multiply(this[PRIVATE$4].rightViewMatrix, this[PRIVATE$4].rightViewMatrix, refSpace._originOffsetMatrix());\n      }\n\n      for (let view of this[PRIVATE$4].views) {\n        if (view.eye == \"left\") {\n          view._updateViewMatrix(this[PRIVATE$4].leftViewMatrix);\n        } else if (view.eye == \"right\") {\n          view._updateViewMatrix(this[PRIVATE$4].rightViewMatrix);\n        }\n      }\n    }\n\n  }\n\n  const PRIVATE$5 = Symbol('@@webxr-polyfill/XRViewport');\n\n  class XRViewport {\n    constructor(target) {\n      this[PRIVATE$5] = {\n        target\n      };\n    }\n\n    get x() {\n      return this[PRIVATE$5].target.x;\n    }\n\n    get y() {\n      return this[PRIVATE$5].target.y;\n    }\n\n    get width() {\n      return this[PRIVATE$5].target.width;\n    }\n\n    get height() {\n      return this[PRIVATE$5].target.height;\n    }\n\n  }\n\n  const XREyes = ['left', 'right'];\n  const PRIVATE$6 = Symbol('@@webxr-polyfill/XRView');\n\n  class XRView {\n    constructor(device, eye, sessionId) {\n      if (!XREyes.includes(eye)) {\n        throw new Error(\"XREye must be one of: \".concat(XREyes));\n      }\n\n      const temp = Object.create(null);\n      const viewport = new XRViewport(temp);\n      this[PRIVATE$6] = {\n        device,\n        eye,\n        viewport,\n        temp,\n        sessionId,\n        transform: null\n      };\n    }\n\n    get eye() {\n      return this[PRIVATE$6].eye;\n    }\n\n    get projectionMatrix() {\n      return this[PRIVATE$6].device.getProjectionMatrix(this.eye);\n    }\n\n    get transform() {\n      return this[PRIVATE$6].transform;\n    }\n\n    _updateViewMatrix(viewMatrix) {\n      let invMatrix = identity(new Float32Array(16));\n      invert(invMatrix, viewMatrix);\n      this[PRIVATE$6].transform = new XRRigidTransform$1(invMatrix);\n    }\n\n    _getViewport(layer) {\n      if (this[PRIVATE$6].device.getViewport(this[PRIVATE$6].sessionId, this.eye, layer, this[PRIVATE$6].temp)) {\n        return this[PRIVATE$6].viewport;\n      }\n\n      return undefined;\n    }\n\n  }\n\n  var EPSILON$1 = 0.000001;\n  var ARRAY_TYPE$1 = typeof Float32Array !== 'undefined' ? Float32Array : Array;\n  var degree$1 = Math.PI / 180;\n\n  function create$7() {\n    var out = new ARRAY_TYPE$1(9);\n\n    if (ARRAY_TYPE$1 != Float32Array) {\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 0;\n      out[5] = 0;\n      out[6] = 0;\n      out[7] = 0;\n    }\n\n    out[0] = 1;\n    out[4] = 1;\n    out[8] = 1;\n    return out;\n  }\n\n  function create$9() {\n    var out = new ARRAY_TYPE$1(3);\n\n    if (ARRAY_TYPE$1 != Float32Array) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n    }\n\n    return out;\n  }\n\n  function length$3(a) {\n    var x = a[0];\n    var y = a[1];\n    var z = a[2];\n    return Math.sqrt(x * x + y * y + z * z);\n  }\n\n  function fromValues$9(x, y, z) {\n    var out = new ARRAY_TYPE$1(3);\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n  }\n\n  function normalize$3(out, a) {\n    var x = a[0];\n    var y = a[1];\n    var z = a[2];\n    var len = x * x + y * y + z * z;\n\n    if (len > 0) {\n      len = 1 / Math.sqrt(len);\n      out[0] = a[0] * len;\n      out[1] = a[1] * len;\n      out[2] = a[2] * len;\n    }\n\n    return out;\n  }\n\n  function dot$3(a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n  }\n\n  function cross$1(out, a, b) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2];\n    var bx = b[0],\n        by = b[1],\n        bz = b[2];\n    out[0] = ay * bz - az * by;\n    out[1] = az * bx - ax * bz;\n    out[2] = ax * by - ay * bx;\n    return out;\n  }\n\n  var len$3 = length$3;\n\n  var forEach$2 = function () {\n    var vec = create$9();\n    return function (a, stride, offset, count, fn, arg) {\n      var i = void 0,\n          l = void 0;\n\n      if (!stride) {\n        stride = 3;\n      }\n\n      if (!offset) {\n        offset = 0;\n      }\n\n      if (count) {\n        l = Math.min(count * stride + offset, a.length);\n      } else {\n        l = a.length;\n      }\n\n      for (i = offset; i < l; i += stride) {\n        vec[0] = a[i];\n        vec[1] = a[i + 1];\n        vec[2] = a[i + 2];\n        fn(vec, vec, arg);\n        a[i] = vec[0];\n        a[i + 1] = vec[1];\n        a[i + 2] = vec[2];\n      }\n\n      return a;\n    };\n  }();\n\n  function create$10() {\n    var out = new ARRAY_TYPE$1(4);\n\n    if (ARRAY_TYPE$1 != Float32Array) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 0;\n    }\n\n    return out;\n  }\n\n  function normalize$4(out, a) {\n    var x = a[0];\n    var y = a[1];\n    var z = a[2];\n    var w = a[3];\n    var len = x * x + y * y + z * z + w * w;\n\n    if (len > 0) {\n      len = 1 / Math.sqrt(len);\n      out[0] = x * len;\n      out[1] = y * len;\n      out[2] = z * len;\n      out[3] = w * len;\n    }\n\n    return out;\n  }\n\n  var forEach$3 = function () {\n    var vec = create$10();\n    return function (a, stride, offset, count, fn, arg) {\n      var i = void 0,\n          l = void 0;\n\n      if (!stride) {\n        stride = 4;\n      }\n\n      if (!offset) {\n        offset = 0;\n      }\n\n      if (count) {\n        l = Math.min(count * stride + offset, a.length);\n      } else {\n        l = a.length;\n      }\n\n      for (i = offset; i < l; i += stride) {\n        vec[0] = a[i];\n        vec[1] = a[i + 1];\n        vec[2] = a[i + 2];\n        vec[3] = a[i + 3];\n        fn(vec, vec, arg);\n        a[i] = vec[0];\n        a[i + 1] = vec[1];\n        a[i + 2] = vec[2];\n        a[i + 3] = vec[3];\n      }\n\n      return a;\n    };\n  }();\n\n  function create$11() {\n    var out = new ARRAY_TYPE$1(4);\n\n    if (ARRAY_TYPE$1 != Float32Array) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n    }\n\n    out[3] = 1;\n    return out;\n  }\n\n  function setAxisAngle$1(out, axis, rad) {\n    rad = rad * 0.5;\n    var s = Math.sin(rad);\n    out[0] = s * axis[0];\n    out[1] = s * axis[1];\n    out[2] = s * axis[2];\n    out[3] = Math.cos(rad);\n    return out;\n  }\n\n  function slerp$1(out, a, b, t) {\n    var ax = a[0],\n        ay = a[1],\n        az = a[2],\n        aw = a[3];\n    var bx = b[0],\n        by = b[1],\n        bz = b[2],\n        bw = b[3];\n    var omega = void 0,\n        cosom = void 0,\n        sinom = void 0,\n        scale0 = void 0,\n        scale1 = void 0;\n    cosom = ax * bx + ay * by + az * bz + aw * bw;\n\n    if (cosom < 0.0) {\n      cosom = -cosom;\n      bx = -bx;\n      by = -by;\n      bz = -bz;\n      bw = -bw;\n    }\n\n    if (1.0 - cosom > EPSILON$1) {\n      omega = Math.acos(cosom);\n      sinom = Math.sin(omega);\n      scale0 = Math.sin((1.0 - t) * omega) / sinom;\n      scale1 = Math.sin(t * omega) / sinom;\n    } else {\n      scale0 = 1.0 - t;\n      scale1 = t;\n    }\n\n    out[0] = scale0 * ax + scale1 * bx;\n    out[1] = scale0 * ay + scale1 * by;\n    out[2] = scale0 * az + scale1 * bz;\n    out[3] = scale0 * aw + scale1 * bw;\n    return out;\n  }\n\n  function fromMat3$1(out, m) {\n    var fTrace = m[0] + m[4] + m[8];\n    var fRoot = void 0;\n\n    if (fTrace > 0.0) {\n      fRoot = Math.sqrt(fTrace + 1.0);\n      out[3] = 0.5 * fRoot;\n      fRoot = 0.5 / fRoot;\n      out[0] = (m[5] - m[7]) * fRoot;\n      out[1] = (m[6] - m[2]) * fRoot;\n      out[2] = (m[1] - m[3]) * fRoot;\n    } else {\n      var i = 0;\n      if (m[4] > m[0]) i = 1;\n      if (m[8] > m[i * 3 + i]) i = 2;\n      var j = (i + 1) % 3;\n      var k = (i + 2) % 3;\n      fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n      out[i] = 0.5 * fRoot;\n      fRoot = 0.5 / fRoot;\n      out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n      out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n      out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n    }\n\n    return out;\n  }\n\n  var normalize$5 = normalize$4;\n\n  var rotationTo$1 = function () {\n    var tmpvec3 = create$9();\n    var xUnitVec3 = fromValues$9(1, 0, 0);\n    var yUnitVec3 = fromValues$9(0, 1, 0);\n    return function (out, a, b) {\n      var dot = dot$3(a, b);\n\n      if (dot < -0.999999) {\n        cross$1(tmpvec3, xUnitVec3, a);\n        if (len$3(tmpvec3) < 0.000001) cross$1(tmpvec3, yUnitVec3, a);\n        normalize$3(tmpvec3, tmpvec3);\n        setAxisAngle$1(out, tmpvec3, Math.PI);\n        return out;\n      } else if (dot > 0.999999) {\n        out[0] = 0;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        return out;\n      } else {\n        cross$1(tmpvec3, a, b);\n        out[0] = tmpvec3[0];\n        out[1] = tmpvec3[1];\n        out[2] = tmpvec3[2];\n        out[3] = 1 + dot;\n        return normalize$5(out, out);\n      }\n    };\n  }();\n\n  var sqlerp$1 = function () {\n    var temp1 = create$11();\n    var temp2 = create$11();\n    return function (out, a, b, c, d, t) {\n      slerp$1(temp1, a, d, t);\n      slerp$1(temp2, b, c, t);\n      slerp$1(out, temp1, temp2, 2 * t * (1 - t));\n      return out;\n    };\n  }();\n\n  var setAxes$1 = function () {\n    var matr = create$7();\n    return function (out, view, right, up) {\n      matr[0] = right[0];\n      matr[3] = right[1];\n      matr[6] = right[2];\n      matr[1] = up[0];\n      matr[4] = up[1];\n      matr[7] = up[2];\n      matr[2] = -view[0];\n      matr[5] = -view[1];\n      matr[8] = -view[2];\n      return normalize$5(out, fromMat3$1(out, matr));\n    };\n  }();\n\n  function create$13() {\n    var out = new ARRAY_TYPE$1(2);\n\n    if (ARRAY_TYPE$1 != Float32Array) {\n      out[0] = 0;\n      out[1] = 0;\n    }\n\n    return out;\n  }\n\n  var forEach$4 = function () {\n    var vec = create$13();\n    return function (a, stride, offset, count, fn, arg) {\n      var i = void 0,\n          l = void 0;\n\n      if (!stride) {\n        stride = 2;\n      }\n\n      if (!offset) {\n        offset = 0;\n      }\n\n      if (count) {\n        l = Math.min(count * stride + offset, a.length);\n      } else {\n        l = a.length;\n      }\n\n      for (i = offset; i < l; i += stride) {\n        vec[0] = a[i];\n        vec[1] = a[i + 1];\n        fn(vec, vec, arg);\n        a[i] = vec[0];\n        a[i + 1] = vec[1];\n      }\n\n      return a;\n    };\n  }();\n\n  const PRIVATE$7 = Symbol('@@webxr-polyfill/XRFrame');\n\n  class XRFrame {\n    constructor(device, session, sessionId) {\n      const views = [new XRView(device, 'left', sessionId)];\n\n      if (session.immersive) {\n        views.push(new XRView(device, 'right', sessionId));\n      }\n\n      this[PRIVATE$7] = {\n        device,\n        viewerPose: new XRViewerPose(device, views),\n        views,\n        session\n      };\n    }\n\n    get session() {\n      return this[PRIVATE$7].session;\n    }\n\n    getViewerPose(space) {\n      this[PRIVATE$7].viewerPose._updateFromReferenceSpace(space);\n\n      return this[PRIVATE$7].viewerPose;\n    }\n\n    getPose(space, baseSpace) {\n      if (space._specialType === \"viewer\") {\n        let viewerPose = this.getViewerPose(baseSpace);\n        return new XRPose(new XRRigidTransform(viewerPose.poseModelMatrix), viewerPose.emulatedPosition);\n      }\n\n      if (space._specialType === \"target-ray\" || space._specialType === \"grip\") {\n        return this[PRIVATE$7].device.getInputPose(space._inputSource, baseSpace, space._specialType);\n      }\n\n      return null;\n    }\n\n  }\n\n  const PRIVATE$8 = Symbol('@@webxr-polyfill/XRSpace');\n\n  class XRSpace {\n    constructor(specialType = null, inputSource = null) {\n      this[PRIVATE$8] = {\n        specialType,\n        inputSource\n      };\n    }\n\n    get _specialType() {\n      return this[PRIVATE$8].specialType;\n    }\n\n    get _inputSource() {\n      return this[PRIVATE$8].inputSource;\n    }\n\n  }\n\n  const DEFAULT_EMULATION_HEIGHT = 1.6;\n  const PRIVATE$9 = Symbol('@@webxr-polyfill/XRReferenceSpace');\n  const XRReferenceSpaceTypes = ['viewer', 'local', 'local-floor', 'bounded-floor', 'unbounded'];\n\n  function isFloor(type) {\n    return type === 'bounded-floor' || type === 'local-floor';\n  }\n\n  class XRReferenceSpace extends XRSpace {\n    constructor(device, type, transform) {\n      if (!XRReferenceSpaceTypes.includes(type)) {\n        throw new Error(\"XRReferenceSpaceType must be one of \".concat(XRReferenceSpaceTypes));\n      }\n\n      super(type === 'viewer' ? 'viewer' : null);\n\n      if (type === 'bounded-floor' && !transform) {\n        throw new Error(\"XRReferenceSpace cannot use 'bounded-floor' type if the platform does not provide the floor level\");\n      }\n\n      if (isFloor(type) && !transform) {\n        transform = identity(new Float32Array(16));\n        transform[13] = DEFAULT_EMULATION_HEIGHT;\n      }\n\n      if (!transform) {\n        transform = identity(new Float32Array(16));\n      }\n\n      this[PRIVATE$9] = {\n        type,\n        transform,\n        device,\n        originOffset: identity(new Float32Array(16))\n      };\n    }\n\n    _transformBasePoseMatrix(out, pose) {\n      multiply(out, this[PRIVATE$9].transform, pose);\n    }\n\n    _transformBaseViewMatrix(out, view) {\n      invert(out, this[PRIVATE$9].transform);\n      multiply(out, view, out);\n    }\n\n    _originOffsetMatrix() {\n      return this[PRIVATE$9].originOffset;\n    }\n\n    _adjustForOriginOffset(transformMatrix) {\n      let inverseOriginOffsetMatrix = identity(new Float32Array(16));\n      invert(inverseOriginOffsetMatrix, this[PRIVATE$9].originOffset);\n      multiply(transformMatrix, inverseOriginOffsetMatrix, transformMatrix);\n    }\n\n    getOffsetReferenceSpace(additionalOffset) {\n      let newSpace = new XRReferenceSpace(this[PRIVATE$9].device, this[PRIVATE$9].type, this[PRIVATE$9].transform, this[PRIVATE$9].bounds);\n      multiply(newSpace[PRIVATE$9].originOffset, this[PRIVATE$9].originOffset, additionalOffset.matrix);\n      return newSpace;\n    }\n\n  }\n\n  const POLYFILLED_XR_COMPATIBLE = Symbol('@@webxr-polyfill/polyfilled-xr-compatible');\n  const XR_COMPATIBLE = Symbol('@@webxr-polyfill/xr-compatible');\n  const PRIVATE$10 = Symbol('@@webxr-polyfill/XRWebGLLayer');\n  const XRWebGLLayerInit = Object.freeze({\n    antialias: true,\n    depth: false,\n    stencil: false,\n    alpha: true,\n    multiview: false,\n    ignoreDepthValues: false,\n    framebufferScaleFactor: 1.0\n  });\n\n  class XRWebGLLayer {\n    constructor(session, context, layerInit = {}) {\n      const config = Object.assign({}, XRWebGLLayerInit, layerInit);\n\n      if (!(session instanceof XRSession$1)) {\n        throw new Error('session must be a XRSession');\n      }\n\n      if (session.ended) {\n        throw new Error(\"InvalidStateError\");\n      }\n\n      if (context[POLYFILLED_XR_COMPATIBLE]) {\n        if (context[XR_COMPATIBLE] !== true) {\n          throw new Error(\"InvalidStateError\");\n        }\n      }\n\n      const framebuffer = context.getParameter(context.FRAMEBUFFER_BINDING);\n      this[PRIVATE$10] = {\n        context,\n        config,\n        framebuffer,\n        session\n      };\n    }\n\n    get context() {\n      return this[PRIVATE$10].context;\n    }\n\n    get antialias() {\n      return this[PRIVATE$10].config.antialias;\n    }\n\n    get ignoreDepthValues() {\n      return true;\n    }\n\n    get framebuffer() {\n      return this[PRIVATE$10].framebuffer;\n    }\n\n    get framebufferWidth() {\n      return this[PRIVATE$10].context.drawingBufferWidth;\n    }\n\n    get framebufferHeight() {\n      return this[PRIVATE$10].context.drawingBufferHeight;\n    }\n\n    get _session() {\n      return this[PRIVATE$10].session;\n    }\n\n    getViewport(view) {\n      return view._getViewport(this);\n    }\n\n  }\n\n  const PRIVATE$11 = Symbol('@@webxr-polyfill/XRSession');\n\n  class XRSession$1 extends EventTarget {\n    constructor(device, mode, id) {\n      super();\n      let immersive = mode != 'inline';\n      let outputContext = null;\n      this[PRIVATE$11] = {\n        device,\n        mode,\n        immersive,\n        outputContext,\n        ended: false,\n        suspended: false,\n        suspendedCallback: null,\n        id,\n        activeRenderState: null,\n        pendingRenderState: null\n      };\n      const frame = new XRFrame(device, this, this[PRIVATE$11].id);\n      this[PRIVATE$11].frame = frame;\n\n      this[PRIVATE$11].onPresentationEnd = sessionId => {\n        if (sessionId !== this[PRIVATE$11].id) {\n          this[PRIVATE$11].suspended = false;\n          this.dispatchEvent('focus', {\n            session: this\n          });\n          const suspendedCallback = this[PRIVATE$11].suspendedCallback;\n          this[PRIVATE$11].suspendedCallback = null;\n\n          if (suspendedCallback) {\n            this.requestAnimationFrame(suspendedCallback);\n          }\n\n          return;\n        }\n\n        this[PRIVATE$11].ended = true;\n        device.removeEventListener('@webvr-polyfill/vr-present-end', this[PRIVATE$11].onPresentationEnd);\n        device.removeEventListener('@webvr-polyfill/vr-present-start', this[PRIVATE$11].onPresentationStart);\n        device.removeEventListener('@@webvr-polyfill/input-select-start', this[PRIVATE$11].onSelectStart);\n        device.removeEventListener('@@webvr-polyfill/input-select-end', this[PRIVATE$11].onSelectEnd);\n        this.dispatchEvent('end', {\n          session: this\n        });\n      };\n\n      device.addEventListener('@@webxr-polyfill/vr-present-end', this[PRIVATE$11].onPresentationEnd);\n\n      this[PRIVATE$11].onPresentationStart = sessionId => {\n        if (sessionId === this[PRIVATE$11].id) {\n          return;\n        }\n\n        this[PRIVATE$11].suspended = true;\n        this.dispatchEvent('blur', {\n          session: this\n        });\n      };\n\n      device.addEventListener('@@webxr-polyfill/vr-present-start', this[PRIVATE$11].onPresentationStart);\n\n      this[PRIVATE$11].onSelectStart = evt => {\n        if (evt.sessionId !== this[PRIVATE$11].id) {\n          return;\n        }\n\n        this.dispatchEvent('selectstart', {\n          frame: this[PRIVATE$11].frame,\n          inputSource: evt.inputSource\n        });\n      };\n\n      device.addEventListener('@@webxr-polyfill/input-select-start', this[PRIVATE$11].onSelectStart);\n\n      this[PRIVATE$11].onSelectEnd = evt => {\n        if (evt.sessionId !== this[PRIVATE$11].id) {\n          return;\n        }\n\n        this.dispatchEvent('selectend', {\n          frame: this[PRIVATE$11].frame,\n          inputSource: evt.inputSource\n        });\n        this.dispatchEvent('select', {\n          frame: this[PRIVATE$11].frame,\n          inputSource: evt.inputSource\n        });\n      };\n\n      device.addEventListener('@@webxr-polyfill/input-select-end', this[PRIVATE$11].onSelectEnd);\n      this.onblur = undefined;\n      this.onfocus = undefined;\n      this.onresetpose = undefined;\n      this.onend = undefined;\n      this.onselect = undefined;\n      this.onselectstart = undefined;\n      this.onselectend = undefined;\n    }\n\n    get renderState() {\n      return this[PRIVATE$11].activeRenderState;\n    }\n\n    get immersive() {\n      return this[PRIVATE$11].immersive;\n    }\n\n    get outputContext() {\n      return this[PRIVATE$11].outputContext;\n    }\n\n    get depthNear() {\n      return this[PRIVATE$11].device.depthNear;\n    }\n\n    set depthNear(value) {\n      this[PRIVATE$11].device.depthNear = value;\n    }\n\n    get depthFar() {\n      return this[PRIVATE$11].device.depthFar;\n    }\n\n    set depthFar(value) {\n      this[PRIVATE$11].device.depthFar = value;\n    }\n\n    get environmentBlendMode() {\n      return this[PRIVATE$11].device.environmentBlendMode || 'opaque';\n    }\n\n    get baseLayer() {\n      return this[PRIVATE$11].baseLayer;\n    }\n\n    set baseLayer(value) {\n      if (this[PRIVATE$11].ended) {\n        return;\n      }\n\n      this[PRIVATE$11].baseLayer = value;\n      this[PRIVATE$11].device.onBaseLayerSet(this[PRIVATE$11].id, value);\n    }\n\n    async requestReferenceSpace(type) {\n      if (this[PRIVATE$11].ended) {\n        return;\n      }\n\n      if (type === 'unbounded') {\n        throw new NotSupportedError(\"The WebXR polyfill does not support the \".concat(type, \" reference space\"));\n      }\n\n      if (!XRReferenceSpaceTypes.includes(type)) {\n        throw new TypeError(\"XRReferenceSpaceType must be one of \".concat(XRReferenceSpaceTypes));\n      }\n\n      let transform = await this[PRIVATE$11].device.requestFrameOfReferenceTransform(type);\n\n      if (type === 'bounded-floor') {\n        if (!transform) {\n          throw new NotSupportedError(\"\".concat(type, \" XRReferenceSpace not supported by this device.\"));\n        }\n\n        let bounds = this[PRIVATE$11].device.requestStageBounds();\n\n        if (!bounds) {\n          throw new NotSupportedError(\"\".concat(type, \" XRReferenceSpace not supported by this device.\"));\n        }\n\n        throw new NotSupportedError(\"The WebXR polyfill does not support the \".concat(type, \" reference space yet.\"));\n      }\n\n      return new XRReferenceSpace(this[PRIVATE$11].device, type, transform);\n    }\n\n    requestAnimationFrame(callback) {\n      if (this[PRIVATE$11].ended) {\n        return;\n      }\n\n      if (this[PRIVATE$11].suspended && this[PRIVATE$11].suspendedCallback) {\n        return;\n      }\n\n      if (this[PRIVATE$11].suspended && !this[PRIVATE$11].suspendedCallback) {\n        this[PRIVATE$11].suspendedCallback = callback;\n      }\n\n      return this[PRIVATE$11].device.requestAnimationFrame(() => {\n        if (this[PRIVATE$11].pendingRenderState !== null) {\n          this[PRIVATE$11].activeRenderState = this[PRIVATE$11].pendingRenderState;\n          this[PRIVATE$11].pendingRenderState = null;\n\n          if (this[PRIVATE$11].activeRenderState.baseLayer) {\n            this[PRIVATE$11].device.onBaseLayerSet(this[PRIVATE$11].id, this[PRIVATE$11].activeRenderState.baseLayer);\n          }\n\n          if (this[PRIVATE$11].activeRenderState.inlineVerticalFieldOfView) {\n            this[PRIVATE$11].device.onInlineVerticalFieldOfViewSet(this[PRIVATE$11].id, this[PRIVATE$11].activeRenderState.inlineVerticalFieldOfView);\n          }\n        }\n\n        this[PRIVATE$11].device.onFrameStart(this[PRIVATE$11].id);\n        callback(now$1(), this[PRIVATE$11].frame);\n        this[PRIVATE$11].device.onFrameEnd(this[PRIVATE$11].id);\n      });\n    }\n\n    cancelAnimationFrame(handle) {\n      if (this[PRIVATE$11].ended) {\n        return;\n      }\n\n      this[PRIVATE$11].device.cancelAnimationFrame(handle);\n    }\n\n    get inputSources() {\n      return this[PRIVATE$11].device.getInputSources();\n    }\n\n    async end() {\n      if (this[PRIVATE$11].ended) {\n        return;\n      }\n\n      if (!this.immersive) {\n        this[PRIVATE$11].ended = true;\n        this[PRIVATE$11].device.removeEventListener('@@webvr-polyfill/vr-present-start', this[PRIVATE$11].onPresentationStart);\n        this[PRIVATE$11].device.removeEventListener('@@webvr-polyfill/vr-present-end', this[PRIVATE$11].onPresentationEnd);\n        this[PRIVATE$11].device.removeEventListener('@@webvr-polyfill/input-select-start', this[PRIVATE$11].onSelectStart);\n        this[PRIVATE$11].device.removeEventListener('@@webvr-polyfill/input-select-end', this[PRIVATE$11].onSelectEnd);\n        this.dispatchEvent('end', {\n          session: this\n        });\n      }\n\n      return this[PRIVATE$11].device.endSession(this[PRIVATE$11].id);\n    }\n\n    updateRenderState(newState) {\n      if (this[PRIVATE$11].ended) {\n        const message = \"Can't call updateRenderState on an XRSession \" + \"that has already ended.\";\n        throw new Error(message);\n      }\n\n      if (newState.baseLayer && newState.baseLayer._session !== this) {\n        const message = \"Called updateRenderState with a base layer that was \" + \"created by a different session.\";\n        throw new Error(message);\n      }\n\n      const fovSet = newState.inlineVerticalFieldOfView !== null && newState.inlineVerticalFieldOfView !== undefined;\n\n      if (fovSet) {\n        if (this[PRIVATE$11].immersive) {\n          const message = \"inlineVerticalFieldOfView must not be set for an \" + \"XRRenderState passed to updateRenderState for an \" + \"immersive session.\";\n          throw new Error(message);\n        } else {\n          newState.inlineVerticalFieldOfView = Math.min(3.13, Math.max(0.01, newState.inlineVerticalFieldOfView));\n        }\n      }\n\n      if (this[PRIVATE$11].pendingRenderState === null) {\n        this[PRIVATE$11].pendingRenderState = Object.assign({}, this[PRIVATE$11].activeRenderState, newState);\n      }\n    }\n\n  }\n\n  const PRIVATE$12 = Symbol('@@webxr-polyfill/XRInputSource');\n\n  class XRInputSource {\n    constructor(impl) {\n      this[PRIVATE$12] = {\n        impl,\n        gripSpace: new XRSpace(\"grip\", this),\n        targetRaySpace: new XRSpace(\"target-ray\", this)\n      };\n    }\n\n    get handedness() {\n      return this[PRIVATE$12].impl.handedness;\n    }\n\n    get targetRayMode() {\n      return this[PRIVATE$12].impl.targetRayMode;\n    }\n\n    get gripSpace() {\n      let mode = this[PRIVATE$12].impl.targetRayMode;\n\n      if (mode === \"gaze\" || mode === \"screen\") {\n        return null;\n      }\n\n      return this[PRIVATE$12].gripSpace;\n    }\n\n    get targetRaySpace() {\n      return this[PRIVATE$12].targetRaySpace;\n    }\n\n    get profiles() {\n      return this[PRIVATE$12].impl.profiles;\n    }\n\n    get gamepad() {\n      return this[PRIVATE$12].impl.gamepad;\n    }\n\n  }\n\n  const PRIVATE$13 = Symbol('@@webxr-polyfill/XRRenderState');\n  const XRRenderStateInit = Object.freeze({\n    depthNear: 0.1,\n    depthFar: 1000.0,\n    inlineVerticalFieldOfView: null,\n    baseLayer: null\n  });\n\n  class XRRenderState {\n    constructor(stateInit = {}) {\n      const config = Object.assign({}, XRRenderStateInit, stateInit);\n      this[PRIVATE$13] = {\n        config\n      };\n    }\n\n    get depthNear() {\n      return this[PRIVATE$13].depthNear;\n    }\n\n    get depthFar() {\n      return this[PRIVATE$13].depthFar;\n    }\n\n    get inlineVerticalFieldOfView() {\n      return this[PRIVATE$13].inlineVerticalFieldOfView;\n    }\n\n    get baseLayer() {\n      return this[PRIVATE$13].baseLayer;\n    }\n\n  }\n\n  var API = {\n    XR: XR$1,\n    XRSession: XRSession$1,\n    XRFrame,\n    XRView,\n    XRViewport,\n    XRViewerPose,\n    XRWebGLLayer,\n    XRSpace,\n    XRReferenceSpace,\n    XRInputSource,\n    XRRenderState,\n    XRRigidTransform: XRRigidTransform$1,\n    XRPose: XRPose$1\n  };\n\n  const polyfillMakeXRCompatible = Context => {\n    if (typeof Context.prototype.makeXRCompatible === 'function') {\n      return false;\n    }\n\n    Context.prototype.makeXRCompatible = function () {\n      this[XR_COMPATIBLE] = true;\n      return Promise.resolve();\n    };\n\n    return true;\n  };\n\n  const polyfillGetContext = Canvas => {\n    const getContext = Canvas.prototype.getContext;\n\n    Canvas.prototype.getContext = function (contextType, glAttribs) {\n      const ctx = getContext.call(this, contextType, glAttribs);\n\n      if (ctx) {\n        ctx[POLYFILLED_XR_COMPATIBLE] = true;\n\n        if (glAttribs && 'xrCompatible' in glAttribs) {\n          ctx[XR_COMPATIBLE] = glAttribs.xrCompatible;\n        }\n      }\n\n      return ctx;\n    };\n  };\n\n  const isImageBitmapSupported = global => !!(global.ImageBitmapRenderingContext && global.createImageBitmap);\n\n  const applyCanvasStylesForMinimalRendering = canvas => {\n    canvas.style.display = 'block';\n    canvas.style.position = 'absolute';\n    canvas.style.width = canvas.style.height = '1px';\n    canvas.style.top = canvas.style.left = '0px';\n  };\n\n  var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n  function unwrapExports(x) {\n    return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n  }\n\n  function createCommonjsModule(fn, module) {\n    return module = {\n      exports: {}\n    }, fn(module, module.exports), module.exports;\n  }\n\n  var cardboardVrDisplay = createCommonjsModule(function (module, exports) {\n    (function (global, factory) {\n      module.exports = factory();\n    })(commonjsGlobal, function () {\n      var classCallCheck = function (instance, Constructor) {\n        if (!(instance instanceof Constructor)) {\n          throw new TypeError(\"Cannot call a class as a function\");\n        }\n      };\n\n      var createClass = function () {\n        function defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        return function (Constructor, protoProps, staticProps) {\n          if (protoProps) defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) defineProperties(Constructor, staticProps);\n          return Constructor;\n        };\n      }();\n\n      var slicedToArray = function () {\n        function sliceIterator(arr, i) {\n          var _arr = [];\n          var _n = true;\n          var _d = false;\n          var _e = undefined;\n\n          try {\n            for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n              _arr.push(_s.value);\n\n              if (i && _arr.length === i) break;\n            }\n          } catch (err) {\n            _d = true;\n            _e = err;\n          } finally {\n            try {\n              if (!_n && _i[\"return\"]) _i[\"return\"]();\n            } finally {\n              if (_d) throw _e;\n            }\n          }\n\n          return _arr;\n        }\n\n        return function (arr, i) {\n          if (Array.isArray(arr)) {\n            return arr;\n          } else if (Symbol.iterator in Object(arr)) {\n            return sliceIterator(arr, i);\n          } else {\n            throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n          }\n        };\n      }();\n\n      var MIN_TIMESTEP = 0.001;\n      var MAX_TIMESTEP = 1;\n\n      var dataUri = function dataUri(mimeType, svg) {\n        return 'data:' + mimeType + ',' + encodeURIComponent(svg);\n      };\n\n      var lerp = function lerp(a, b, t) {\n        return a + (b - a) * t;\n      };\n\n      var isIOS = function () {\n        var isIOS = /iPad|iPhone|iPod/.test(navigator.platform);\n        return function () {\n          return isIOS;\n        };\n      }();\n\n      var isWebViewAndroid = function () {\n        var isWebViewAndroid = navigator.userAgent.indexOf('Version') !== -1 && navigator.userAgent.indexOf('Android') !== -1 && navigator.userAgent.indexOf('Chrome') !== -1;\n        return function () {\n          return isWebViewAndroid;\n        };\n      }();\n\n      var isSafari = function () {\n        var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n        return function () {\n          return isSafari;\n        };\n      }();\n\n      var isFirefoxAndroid = function () {\n        var isFirefoxAndroid = navigator.userAgent.indexOf('Firefox') !== -1 && navigator.userAgent.indexOf('Android') !== -1;\n        return function () {\n          return isFirefoxAndroid;\n        };\n      }();\n\n      var getChromeVersion = function () {\n        var match = navigator.userAgent.match(/.*Chrome\\/([0-9]+)/);\n        var value = match ? parseInt(match[1], 10) : null;\n        return function () {\n          return value;\n        };\n      }();\n\n      var isChromeWithoutDeviceMotion = function () {\n        var value = false;\n\n        if (getChromeVersion() === 65) {\n          var match = navigator.userAgent.match(/.*Chrome\\/([0-9\\.]*)/);\n\n          if (match) {\n            var _match$1$split = match[1].split('.'),\n                _match$1$split2 = slicedToArray(_match$1$split, 4),\n                major = _match$1$split2[0],\n                minor = _match$1$split2[1],\n                branch = _match$1$split2[2],\n                build = _match$1$split2[3];\n\n            value = parseInt(branch, 10) === 3325 && parseInt(build, 10) < 148;\n          }\n        }\n\n        return function () {\n          return value;\n        };\n      }();\n\n      var isR7 = function () {\n        var isR7 = navigator.userAgent.indexOf('R7 Build') !== -1;\n        return function () {\n          return isR7;\n        };\n      }();\n\n      var isLandscapeMode = function isLandscapeMode() {\n        var rtn = window.orientation == 90 || window.orientation == -90;\n        return isR7() ? !rtn : rtn;\n      };\n\n      var isTimestampDeltaValid = function isTimestampDeltaValid(timestampDeltaS) {\n        if (isNaN(timestampDeltaS)) {\n          return false;\n        }\n\n        if (timestampDeltaS <= MIN_TIMESTEP) {\n          return false;\n        }\n\n        if (timestampDeltaS > MAX_TIMESTEP) {\n          return false;\n        }\n\n        return true;\n      };\n\n      var getScreenWidth = function getScreenWidth() {\n        return Math.max(window.screen.width, window.screen.height) * window.devicePixelRatio;\n      };\n\n      var getScreenHeight = function getScreenHeight() {\n        return Math.min(window.screen.width, window.screen.height) * window.devicePixelRatio;\n      };\n\n      var requestFullscreen = function requestFullscreen(element) {\n        if (isWebViewAndroid()) {\n          return false;\n        }\n\n        if (element.requestFullscreen) {\n          element.requestFullscreen();\n        } else if (element.webkitRequestFullscreen) {\n          element.webkitRequestFullscreen();\n        } else if (element.mozRequestFullScreen) {\n          element.mozRequestFullScreen();\n        } else if (element.msRequestFullscreen) {\n          element.msRequestFullscreen();\n        } else {\n          return false;\n        }\n\n        return true;\n      };\n\n      var exitFullscreen = function exitFullscreen() {\n        if (document.exitFullscreen) {\n          document.exitFullscreen();\n        } else if (document.webkitExitFullscreen) {\n          document.webkitExitFullscreen();\n        } else if (document.mozCancelFullScreen) {\n          document.mozCancelFullScreen();\n        } else if (document.msExitFullscreen) {\n          document.msExitFullscreen();\n        } else {\n          return false;\n        }\n\n        return true;\n      };\n\n      var getFullscreenElement = function getFullscreenElement() {\n        return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;\n      };\n\n      var linkProgram = function linkProgram(gl, vertexSource, fragmentSource, attribLocationMap) {\n        var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n        gl.shaderSource(vertexShader, vertexSource);\n        gl.compileShader(vertexShader);\n        var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n        gl.shaderSource(fragmentShader, fragmentSource);\n        gl.compileShader(fragmentShader);\n        var program = gl.createProgram();\n        gl.attachShader(program, vertexShader);\n        gl.attachShader(program, fragmentShader);\n\n        for (var attribName in attribLocationMap) {\n          gl.bindAttribLocation(program, attribLocationMap[attribName], attribName);\n        }\n\n        gl.linkProgram(program);\n        gl.deleteShader(vertexShader);\n        gl.deleteShader(fragmentShader);\n        return program;\n      };\n\n      var getProgramUniforms = function getProgramUniforms(gl, program) {\n        var uniforms = {};\n        var uniformCount = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n        var uniformName = '';\n\n        for (var i = 0; i < uniformCount; i++) {\n          var uniformInfo = gl.getActiveUniform(program, i);\n          uniformName = uniformInfo.name.replace('[0]', '');\n          uniforms[uniformName] = gl.getUniformLocation(program, uniformName);\n        }\n\n        return uniforms;\n      };\n\n      var orthoMatrix = function orthoMatrix(out, left, right, bottom, top, near, far) {\n        var lr = 1 / (left - right),\n            bt = 1 / (bottom - top),\n            nf = 1 / (near - far);\n        out[0] = -2 * lr;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = -2 * bt;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 2 * nf;\n        out[11] = 0;\n        out[12] = (left + right) * lr;\n        out[13] = (top + bottom) * bt;\n        out[14] = (far + near) * nf;\n        out[15] = 1;\n        return out;\n      };\n\n      var isMobile = function isMobile() {\n        var check = false;\n\n        (function (a) {\n          if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true;\n        })(navigator.userAgent || navigator.vendor || window.opera);\n\n        return check;\n      };\n\n      var extend = function extend(dest, src) {\n        for (var key in src) {\n          if (src.hasOwnProperty(key)) {\n            dest[key] = src[key];\n          }\n        }\n\n        return dest;\n      };\n\n      var safariCssSizeWorkaround = function safariCssSizeWorkaround(canvas) {\n        if (isIOS()) {\n          var width = canvas.style.width;\n          var height = canvas.style.height;\n          canvas.style.width = parseInt(width) + 1 + 'px';\n          canvas.style.height = parseInt(height) + 'px';\n          setTimeout(function () {\n            canvas.style.width = width;\n            canvas.style.height = height;\n          }, 100);\n        }\n\n        window.canvas = canvas;\n      };\n\n      var frameDataFromPose = function () {\n        var piOver180 = Math.PI / 180.0;\n        var rad45 = Math.PI * 0.25;\n\n        function mat4_perspectiveFromFieldOfView(out, fov, near, far) {\n          var upTan = Math.tan(fov ? fov.upDegrees * piOver180 : rad45),\n              downTan = Math.tan(fov ? fov.downDegrees * piOver180 : rad45),\n              leftTan = Math.tan(fov ? fov.leftDegrees * piOver180 : rad45),\n              rightTan = Math.tan(fov ? fov.rightDegrees * piOver180 : rad45),\n              xScale = 2.0 / (leftTan + rightTan),\n              yScale = 2.0 / (upTan + downTan);\n          out[0] = xScale;\n          out[1] = 0.0;\n          out[2] = 0.0;\n          out[3] = 0.0;\n          out[4] = 0.0;\n          out[5] = yScale;\n          out[6] = 0.0;\n          out[7] = 0.0;\n          out[8] = -((leftTan - rightTan) * xScale * 0.5);\n          out[9] = (upTan - downTan) * yScale * 0.5;\n          out[10] = far / (near - far);\n          out[11] = -1.0;\n          out[12] = 0.0;\n          out[13] = 0.0;\n          out[14] = far * near / (near - far);\n          out[15] = 0.0;\n          return out;\n        }\n\n        function mat4_fromRotationTranslation(out, q, v) {\n          var x = q[0],\n              y = q[1],\n              z = q[2],\n              w = q[3],\n              x2 = x + x,\n              y2 = y + y,\n              z2 = z + z,\n              xx = x * x2,\n              xy = x * y2,\n              xz = x * z2,\n              yy = y * y2,\n              yz = y * z2,\n              zz = z * z2,\n              wx = w * x2,\n              wy = w * y2,\n              wz = w * z2;\n          out[0] = 1 - (yy + zz);\n          out[1] = xy + wz;\n          out[2] = xz - wy;\n          out[3] = 0;\n          out[4] = xy - wz;\n          out[5] = 1 - (xx + zz);\n          out[6] = yz + wx;\n          out[7] = 0;\n          out[8] = xz + wy;\n          out[9] = yz - wx;\n          out[10] = 1 - (xx + yy);\n          out[11] = 0;\n          out[12] = v[0];\n          out[13] = v[1];\n          out[14] = v[2];\n          out[15] = 1;\n          return out;\n        }\n\n        function mat4_translate(out, a, v) {\n          var x = v[0],\n              y = v[1],\n              z = v[2],\n              a00,\n              a01,\n              a02,\n              a03,\n              a10,\n              a11,\n              a12,\n              a13,\n              a20,\n              a21,\n              a22,\n              a23;\n\n          if (a === out) {\n            out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n            out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n            out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n            out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n          } else {\n            a00 = a[0];\n            a01 = a[1];\n            a02 = a[2];\n            a03 = a[3];\n            a10 = a[4];\n            a11 = a[5];\n            a12 = a[6];\n            a13 = a[7];\n            a20 = a[8];\n            a21 = a[9];\n            a22 = a[10];\n            a23 = a[11];\n            out[0] = a00;\n            out[1] = a01;\n            out[2] = a02;\n            out[3] = a03;\n            out[4] = a10;\n            out[5] = a11;\n            out[6] = a12;\n            out[7] = a13;\n            out[8] = a20;\n            out[9] = a21;\n            out[10] = a22;\n            out[11] = a23;\n            out[12] = a00 * x + a10 * y + a20 * z + a[12];\n            out[13] = a01 * x + a11 * y + a21 * z + a[13];\n            out[14] = a02 * x + a12 * y + a22 * z + a[14];\n            out[15] = a03 * x + a13 * y + a23 * z + a[15];\n          }\n\n          return out;\n        }\n\n        function mat4_invert(out, a) {\n          var a00 = a[0],\n              a01 = a[1],\n              a02 = a[2],\n              a03 = a[3],\n              a10 = a[4],\n              a11 = a[5],\n              a12 = a[6],\n              a13 = a[7],\n              a20 = a[8],\n              a21 = a[9],\n              a22 = a[10],\n              a23 = a[11],\n              a30 = a[12],\n              a31 = a[13],\n              a32 = a[14],\n              a33 = a[15],\n              b00 = a00 * a11 - a01 * a10,\n              b01 = a00 * a12 - a02 * a10,\n              b02 = a00 * a13 - a03 * a10,\n              b03 = a01 * a12 - a02 * a11,\n              b04 = a01 * a13 - a03 * a11,\n              b05 = a02 * a13 - a03 * a12,\n              b06 = a20 * a31 - a21 * a30,\n              b07 = a20 * a32 - a22 * a30,\n              b08 = a20 * a33 - a23 * a30,\n              b09 = a21 * a32 - a22 * a31,\n              b10 = a21 * a33 - a23 * a31,\n              b11 = a22 * a33 - a23 * a32,\n              det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n          if (!det) {\n            return null;\n          }\n\n          det = 1.0 / det;\n          out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n          out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n          out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n          out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n          out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n          out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n          out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n          out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n          out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n          out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n          out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n          out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n          out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n          out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n          out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n          out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n          return out;\n        }\n\n        var defaultOrientation = new Float32Array([0, 0, 0, 1]);\n        var defaultPosition = new Float32Array([0, 0, 0]);\n\n        function updateEyeMatrices(projection, view, pose, fov, offset, vrDisplay) {\n          mat4_perspectiveFromFieldOfView(projection, fov || null, vrDisplay.depthNear, vrDisplay.depthFar);\n          var orientation = pose.orientation || defaultOrientation;\n          var position = pose.position || defaultPosition;\n          mat4_fromRotationTranslation(view, orientation, position);\n          if (offset) mat4_translate(view, view, offset);\n          mat4_invert(view, view);\n        }\n\n        return function (frameData, pose, vrDisplay) {\n          if (!frameData || !pose) return false;\n          frameData.pose = pose;\n          frameData.timestamp = pose.timestamp;\n          updateEyeMatrices(frameData.leftProjectionMatrix, frameData.leftViewMatrix, pose, vrDisplay._getFieldOfView(\"left\"), vrDisplay._getEyeOffset(\"left\"), vrDisplay);\n          updateEyeMatrices(frameData.rightProjectionMatrix, frameData.rightViewMatrix, pose, vrDisplay._getFieldOfView(\"right\"), vrDisplay._getEyeOffset(\"right\"), vrDisplay);\n          return true;\n        };\n      }();\n\n      var isInsideCrossOriginIFrame = function isInsideCrossOriginIFrame() {\n        var isFramed = window.self !== window.top;\n        var refOrigin = getOriginFromUrl(document.referrer);\n        var thisOrigin = getOriginFromUrl(window.location.href);\n        return isFramed && refOrigin !== thisOrigin;\n      };\n\n      var getOriginFromUrl = function getOriginFromUrl(url) {\n        var domainIdx;\n        var protoSepIdx = url.indexOf(\"://\");\n\n        if (protoSepIdx !== -1) {\n          domainIdx = protoSepIdx + 3;\n        } else {\n          domainIdx = 0;\n        }\n\n        var domainEndIdx = url.indexOf('/', domainIdx);\n\n        if (domainEndIdx === -1) {\n          domainEndIdx = url.length;\n        }\n\n        return url.substring(0, domainEndIdx);\n      };\n\n      var getQuaternionAngle = function getQuaternionAngle(quat) {\n        if (quat.w > 1) {\n          console.warn('getQuaternionAngle: w > 1');\n          return 0;\n        }\n\n        var angle = 2 * Math.acos(quat.w);\n        return angle;\n      };\n\n      var warnOnce = function () {\n        var observedWarnings = {};\n        return function (key, message) {\n          if (observedWarnings[key] === undefined) {\n            console.warn('webvr-polyfill: ' + message);\n            observedWarnings[key] = true;\n          }\n        };\n      }();\n\n      var deprecateWarning = function deprecateWarning(deprecated, suggested) {\n        var alternative = suggested ? 'Please use ' + suggested + ' instead.' : '';\n        warnOnce(deprecated, deprecated + ' has been deprecated. ' + 'This may not work on native WebVR displays. ' + alternative);\n      };\n\n      function WGLUPreserveGLState(gl, bindings, callback) {\n        if (!bindings) {\n          callback(gl);\n          return;\n        }\n\n        var boundValues = [];\n        var activeTexture = null;\n\n        for (var i = 0; i < bindings.length; ++i) {\n          var binding = bindings[i];\n\n          switch (binding) {\n            case gl.TEXTURE_BINDING_2D:\n            case gl.TEXTURE_BINDING_CUBE_MAP:\n              var textureUnit = bindings[++i];\n\n              if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31) {\n                console.error(\"TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit\");\n                boundValues.push(null, null);\n                break;\n              }\n\n              if (!activeTexture) {\n                activeTexture = gl.getParameter(gl.ACTIVE_TEXTURE);\n              }\n\n              gl.activeTexture(textureUnit);\n              boundValues.push(gl.getParameter(binding), null);\n              break;\n\n            case gl.ACTIVE_TEXTURE:\n              activeTexture = gl.getParameter(gl.ACTIVE_TEXTURE);\n              boundValues.push(null);\n              break;\n\n            default:\n              boundValues.push(gl.getParameter(binding));\n              break;\n          }\n        }\n\n        callback(gl);\n\n        for (var i = 0; i < bindings.length; ++i) {\n          var binding = bindings[i];\n          var boundValue = boundValues[i];\n\n          switch (binding) {\n            case gl.ACTIVE_TEXTURE:\n              break;\n\n            case gl.ARRAY_BUFFER_BINDING:\n              gl.bindBuffer(gl.ARRAY_BUFFER, boundValue);\n              break;\n\n            case gl.COLOR_CLEAR_VALUE:\n              gl.clearColor(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n              break;\n\n            case gl.COLOR_WRITEMASK:\n              gl.colorMask(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n              break;\n\n            case gl.CURRENT_PROGRAM:\n              gl.useProgram(boundValue);\n              break;\n\n            case gl.ELEMENT_ARRAY_BUFFER_BINDING:\n              gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, boundValue);\n              break;\n\n            case gl.FRAMEBUFFER_BINDING:\n              gl.bindFramebuffer(gl.FRAMEBUFFER, boundValue);\n              break;\n\n            case gl.RENDERBUFFER_BINDING:\n              gl.bindRenderbuffer(gl.RENDERBUFFER, boundValue);\n              break;\n\n            case gl.TEXTURE_BINDING_2D:\n              var textureUnit = bindings[++i];\n              if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31) break;\n              gl.activeTexture(textureUnit);\n              gl.bindTexture(gl.TEXTURE_2D, boundValue);\n              break;\n\n            case gl.TEXTURE_BINDING_CUBE_MAP:\n              var textureUnit = bindings[++i];\n              if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31) break;\n              gl.activeTexture(textureUnit);\n              gl.bindTexture(gl.TEXTURE_CUBE_MAP, boundValue);\n              break;\n\n            case gl.VIEWPORT:\n              gl.viewport(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n              break;\n\n            case gl.BLEND:\n            case gl.CULL_FACE:\n            case gl.DEPTH_TEST:\n            case gl.SCISSOR_TEST:\n            case gl.STENCIL_TEST:\n              if (boundValue) {\n                gl.enable(binding);\n              } else {\n                gl.disable(binding);\n              }\n\n              break;\n\n            default:\n              console.log(\"No GL restore behavior for 0x\" + binding.toString(16));\n              break;\n          }\n\n          if (activeTexture) {\n            gl.activeTexture(activeTexture);\n          }\n        }\n      }\n\n      var glPreserveState = WGLUPreserveGLState;\n      var distortionVS = ['attribute vec2 position;', 'attribute vec3 texCoord;', 'varying vec2 vTexCoord;', 'uniform vec4 viewportOffsetScale[2];', 'void main() {', '  vec4 viewport = viewportOffsetScale[int(texCoord.z)];', '  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;', '  gl_Position = vec4( position, 1.0, 1.0 );', '}'].join('\\n');\n      var distortionFS = ['precision mediump float;', 'uniform sampler2D diffuse;', 'varying vec2 vTexCoord;', 'void main() {', '  gl_FragColor = texture2D(diffuse, vTexCoord);', '}'].join('\\n');\n\n      function CardboardDistorter(gl, cardboardUI, bufferScale, dirtySubmitFrameBindings) {\n        this.gl = gl;\n        this.cardboardUI = cardboardUI;\n        this.bufferScale = bufferScale;\n        this.dirtySubmitFrameBindings = dirtySubmitFrameBindings;\n        this.ctxAttribs = gl.getContextAttributes();\n        this.meshWidth = 20;\n        this.meshHeight = 20;\n        this.bufferWidth = gl.drawingBufferWidth;\n        this.bufferHeight = gl.drawingBufferHeight;\n        this.realBindFramebuffer = gl.bindFramebuffer;\n        this.realEnable = gl.enable;\n        this.realDisable = gl.disable;\n        this.realColorMask = gl.colorMask;\n        this.realClearColor = gl.clearColor;\n        this.realViewport = gl.viewport;\n\n        if (!isIOS()) {\n          this.realCanvasWidth = Object.getOwnPropertyDescriptor(gl.canvas.__proto__, 'width');\n          this.realCanvasHeight = Object.getOwnPropertyDescriptor(gl.canvas.__proto__, 'height');\n        }\n\n        this.isPatched = false;\n        this.lastBoundFramebuffer = null;\n        this.cullFace = false;\n        this.depthTest = false;\n        this.blend = false;\n        this.scissorTest = false;\n        this.stencilTest = false;\n        this.viewport = [0, 0, 0, 0];\n        this.colorMask = [true, true, true, true];\n        this.clearColor = [0, 0, 0, 0];\n        this.attribs = {\n          position: 0,\n          texCoord: 1\n        };\n        this.program = linkProgram(gl, distortionVS, distortionFS, this.attribs);\n        this.uniforms = getProgramUniforms(gl, this.program);\n        this.viewportOffsetScale = new Float32Array(8);\n        this.setTextureBounds();\n        this.vertexBuffer = gl.createBuffer();\n        this.indexBuffer = gl.createBuffer();\n        this.indexCount = 0;\n        this.renderTarget = gl.createTexture();\n        this.framebuffer = gl.createFramebuffer();\n        this.depthStencilBuffer = null;\n        this.depthBuffer = null;\n        this.stencilBuffer = null;\n\n        if (this.ctxAttribs.depth && this.ctxAttribs.stencil) {\n          this.depthStencilBuffer = gl.createRenderbuffer();\n        } else if (this.ctxAttribs.depth) {\n          this.depthBuffer = gl.createRenderbuffer();\n        } else if (this.ctxAttribs.stencil) {\n          this.stencilBuffer = gl.createRenderbuffer();\n        }\n\n        this.patch();\n        this.onResize();\n      }\n\n      CardboardDistorter.prototype.destroy = function () {\n        var gl = this.gl;\n        this.unpatch();\n        gl.deleteProgram(this.program);\n        gl.deleteBuffer(this.vertexBuffer);\n        gl.deleteBuffer(this.indexBuffer);\n        gl.deleteTexture(this.renderTarget);\n        gl.deleteFramebuffer(this.framebuffer);\n\n        if (this.depthStencilBuffer) {\n          gl.deleteRenderbuffer(this.depthStencilBuffer);\n        }\n\n        if (this.depthBuffer) {\n          gl.deleteRenderbuffer(this.depthBuffer);\n        }\n\n        if (this.stencilBuffer) {\n          gl.deleteRenderbuffer(this.stencilBuffer);\n        }\n\n        if (this.cardboardUI) {\n          this.cardboardUI.destroy();\n        }\n      };\n\n      CardboardDistorter.prototype.onResize = function () {\n        var gl = this.gl;\n        var self = this;\n        var glState = [gl.RENDERBUFFER_BINDING, gl.TEXTURE_BINDING_2D, gl.TEXTURE0];\n        glPreserveState(gl, glState, function (gl) {\n          self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, null);\n\n          if (self.scissorTest) {\n            self.realDisable.call(gl, gl.SCISSOR_TEST);\n          }\n\n          self.realColorMask.call(gl, true, true, true, true);\n          self.realViewport.call(gl, 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n          self.realClearColor.call(gl, 0, 0, 0, 1);\n          gl.clear(gl.COLOR_BUFFER_BIT);\n          self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.framebuffer);\n          gl.bindTexture(gl.TEXTURE_2D, self.renderTarget);\n          gl.texImage2D(gl.TEXTURE_2D, 0, self.ctxAttribs.alpha ? gl.RGBA : gl.RGB, self.bufferWidth, self.bufferHeight, 0, self.ctxAttribs.alpha ? gl.RGBA : gl.RGB, gl.UNSIGNED_BYTE, null);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n          gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, self.renderTarget, 0);\n\n          if (self.ctxAttribs.depth && self.ctxAttribs.stencil) {\n            gl.bindRenderbuffer(gl.RENDERBUFFER, self.depthStencilBuffer);\n            gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, self.bufferWidth, self.bufferHeight);\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, self.depthStencilBuffer);\n          } else if (self.ctxAttribs.depth) {\n            gl.bindRenderbuffer(gl.RENDERBUFFER, self.depthBuffer);\n            gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, self.bufferWidth, self.bufferHeight);\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, self.depthBuffer);\n          } else if (self.ctxAttribs.stencil) {\n            gl.bindRenderbuffer(gl.RENDERBUFFER, self.stencilBuffer);\n            gl.renderbufferStorage(gl.RENDERBUFFER, gl.STENCIL_INDEX8, self.bufferWidth, self.bufferHeight);\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.STENCIL_ATTACHMENT, gl.RENDERBUFFER, self.stencilBuffer);\n          }\n\n          if (!gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\n            console.error('Framebuffer incomplete!');\n          }\n\n          self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.lastBoundFramebuffer);\n\n          if (self.scissorTest) {\n            self.realEnable.call(gl, gl.SCISSOR_TEST);\n          }\n\n          self.realColorMask.apply(gl, self.colorMask);\n          self.realViewport.apply(gl, self.viewport);\n          self.realClearColor.apply(gl, self.clearColor);\n        });\n\n        if (this.cardboardUI) {\n          this.cardboardUI.onResize();\n        }\n      };\n\n      CardboardDistorter.prototype.patch = function () {\n        if (this.isPatched) {\n          return;\n        }\n\n        var self = this;\n        var canvas = this.gl.canvas;\n        var gl = this.gl;\n\n        if (!isIOS()) {\n          canvas.width = getScreenWidth() * this.bufferScale;\n          canvas.height = getScreenHeight() * this.bufferScale;\n          Object.defineProperty(canvas, 'width', {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n              return self.bufferWidth;\n            },\n            set: function set(value) {\n              self.bufferWidth = value;\n              self.realCanvasWidth.set.call(canvas, value);\n              self.onResize();\n            }\n          });\n          Object.defineProperty(canvas, 'height', {\n            configurable: true,\n            enumerable: true,\n            get: function get() {\n              return self.bufferHeight;\n            },\n            set: function set(value) {\n              self.bufferHeight = value;\n              self.realCanvasHeight.set.call(canvas, value);\n              self.onResize();\n            }\n          });\n        }\n\n        this.lastBoundFramebuffer = gl.getParameter(gl.FRAMEBUFFER_BINDING);\n\n        if (this.lastBoundFramebuffer == null) {\n          this.lastBoundFramebuffer = this.framebuffer;\n          this.gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n        }\n\n        this.gl.bindFramebuffer = function (target, framebuffer) {\n          self.lastBoundFramebuffer = framebuffer ? framebuffer : self.framebuffer;\n          self.realBindFramebuffer.call(gl, target, self.lastBoundFramebuffer);\n        };\n\n        this.cullFace = gl.getParameter(gl.CULL_FACE);\n        this.depthTest = gl.getParameter(gl.DEPTH_TEST);\n        this.blend = gl.getParameter(gl.BLEND);\n        this.scissorTest = gl.getParameter(gl.SCISSOR_TEST);\n        this.stencilTest = gl.getParameter(gl.STENCIL_TEST);\n\n        gl.enable = function (pname) {\n          switch (pname) {\n            case gl.CULL_FACE:\n              self.cullFace = true;\n              break;\n\n            case gl.DEPTH_TEST:\n              self.depthTest = true;\n              break;\n\n            case gl.BLEND:\n              self.blend = true;\n              break;\n\n            case gl.SCISSOR_TEST:\n              self.scissorTest = true;\n              break;\n\n            case gl.STENCIL_TEST:\n              self.stencilTest = true;\n              break;\n          }\n\n          self.realEnable.call(gl, pname);\n        };\n\n        gl.disable = function (pname) {\n          switch (pname) {\n            case gl.CULL_FACE:\n              self.cullFace = false;\n              break;\n\n            case gl.DEPTH_TEST:\n              self.depthTest = false;\n              break;\n\n            case gl.BLEND:\n              self.blend = false;\n              break;\n\n            case gl.SCISSOR_TEST:\n              self.scissorTest = false;\n              break;\n\n            case gl.STENCIL_TEST:\n              self.stencilTest = false;\n              break;\n          }\n\n          self.realDisable.call(gl, pname);\n        };\n\n        this.colorMask = gl.getParameter(gl.COLOR_WRITEMASK);\n\n        gl.colorMask = function (r, g, b, a) {\n          self.colorMask[0] = r;\n          self.colorMask[1] = g;\n          self.colorMask[2] = b;\n          self.colorMask[3] = a;\n          self.realColorMask.call(gl, r, g, b, a);\n        };\n\n        this.clearColor = gl.getParameter(gl.COLOR_CLEAR_VALUE);\n\n        gl.clearColor = function (r, g, b, a) {\n          self.clearColor[0] = r;\n          self.clearColor[1] = g;\n          self.clearColor[2] = b;\n          self.clearColor[3] = a;\n          self.realClearColor.call(gl, r, g, b, a);\n        };\n\n        this.viewport = gl.getParameter(gl.VIEWPORT);\n\n        gl.viewport = function (x, y, w, h) {\n          self.viewport[0] = x;\n          self.viewport[1] = y;\n          self.viewport[2] = w;\n          self.viewport[3] = h;\n          self.realViewport.call(gl, x, y, w, h);\n        };\n\n        this.isPatched = true;\n        safariCssSizeWorkaround(canvas);\n      };\n\n      CardboardDistorter.prototype.unpatch = function () {\n        if (!this.isPatched) {\n          return;\n        }\n\n        var gl = this.gl;\n        var canvas = this.gl.canvas;\n\n        if (!isIOS()) {\n          Object.defineProperty(canvas, 'width', this.realCanvasWidth);\n          Object.defineProperty(canvas, 'height', this.realCanvasHeight);\n        }\n\n        canvas.width = this.bufferWidth;\n        canvas.height = this.bufferHeight;\n        gl.bindFramebuffer = this.realBindFramebuffer;\n        gl.enable = this.realEnable;\n        gl.disable = this.realDisable;\n        gl.colorMask = this.realColorMask;\n        gl.clearColor = this.realClearColor;\n        gl.viewport = this.realViewport;\n\n        if (this.lastBoundFramebuffer == this.framebuffer) {\n          gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        }\n\n        this.isPatched = false;\n        setTimeout(function () {\n          safariCssSizeWorkaround(canvas);\n        }, 1);\n      };\n\n      CardboardDistorter.prototype.setTextureBounds = function (leftBounds, rightBounds) {\n        if (!leftBounds) {\n          leftBounds = [0, 0, 0.5, 1];\n        }\n\n        if (!rightBounds) {\n          rightBounds = [0.5, 0, 0.5, 1];\n        }\n\n        this.viewportOffsetScale[0] = leftBounds[0];\n        this.viewportOffsetScale[1] = leftBounds[1];\n        this.viewportOffsetScale[2] = leftBounds[2];\n        this.viewportOffsetScale[3] = leftBounds[3];\n        this.viewportOffsetScale[4] = rightBounds[0];\n        this.viewportOffsetScale[5] = rightBounds[1];\n        this.viewportOffsetScale[6] = rightBounds[2];\n        this.viewportOffsetScale[7] = rightBounds[3];\n      };\n\n      CardboardDistorter.prototype.submitFrame = function () {\n        var gl = this.gl;\n        var self = this;\n        var glState = [];\n\n        if (!this.dirtySubmitFrameBindings) {\n          glState.push(gl.CURRENT_PROGRAM, gl.ARRAY_BUFFER_BINDING, gl.ELEMENT_ARRAY_BUFFER_BINDING, gl.TEXTURE_BINDING_2D, gl.TEXTURE0);\n        }\n\n        glPreserveState(gl, glState, function (gl) {\n          self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, null);\n\n          if (self.cullFace) {\n            self.realDisable.call(gl, gl.CULL_FACE);\n          }\n\n          if (self.depthTest) {\n            self.realDisable.call(gl, gl.DEPTH_TEST);\n          }\n\n          if (self.blend) {\n            self.realDisable.call(gl, gl.BLEND);\n          }\n\n          if (self.scissorTest) {\n            self.realDisable.call(gl, gl.SCISSOR_TEST);\n          }\n\n          if (self.stencilTest) {\n            self.realDisable.call(gl, gl.STENCIL_TEST);\n          }\n\n          self.realColorMask.call(gl, true, true, true, true);\n          self.realViewport.call(gl, 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n\n          if (self.ctxAttribs.alpha || isIOS()) {\n            self.realClearColor.call(gl, 0, 0, 0, 1);\n            gl.clear(gl.COLOR_BUFFER_BIT);\n          }\n\n          gl.useProgram(self.program);\n          gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, self.indexBuffer);\n          gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n          gl.enableVertexAttribArray(self.attribs.position);\n          gl.enableVertexAttribArray(self.attribs.texCoord);\n          gl.vertexAttribPointer(self.attribs.position, 2, gl.FLOAT, false, 20, 0);\n          gl.vertexAttribPointer(self.attribs.texCoord, 3, gl.FLOAT, false, 20, 8);\n          gl.activeTexture(gl.TEXTURE0);\n          gl.uniform1i(self.uniforms.diffuse, 0);\n          gl.bindTexture(gl.TEXTURE_2D, self.renderTarget);\n          gl.uniform4fv(self.uniforms.viewportOffsetScale, self.viewportOffsetScale);\n          gl.drawElements(gl.TRIANGLES, self.indexCount, gl.UNSIGNED_SHORT, 0);\n\n          if (self.cardboardUI) {\n            self.cardboardUI.renderNoState();\n          }\n\n          self.realBindFramebuffer.call(self.gl, gl.FRAMEBUFFER, self.framebuffer);\n\n          if (!self.ctxAttribs.preserveDrawingBuffer) {\n            self.realClearColor.call(gl, 0, 0, 0, 0);\n            gl.clear(gl.COLOR_BUFFER_BIT);\n          }\n\n          if (!self.dirtySubmitFrameBindings) {\n            self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.lastBoundFramebuffer);\n          }\n\n          if (self.cullFace) {\n            self.realEnable.call(gl, gl.CULL_FACE);\n          }\n\n          if (self.depthTest) {\n            self.realEnable.call(gl, gl.DEPTH_TEST);\n          }\n\n          if (self.blend) {\n            self.realEnable.call(gl, gl.BLEND);\n          }\n\n          if (self.scissorTest) {\n            self.realEnable.call(gl, gl.SCISSOR_TEST);\n          }\n\n          if (self.stencilTest) {\n            self.realEnable.call(gl, gl.STENCIL_TEST);\n          }\n\n          self.realColorMask.apply(gl, self.colorMask);\n          self.realViewport.apply(gl, self.viewport);\n\n          if (self.ctxAttribs.alpha || !self.ctxAttribs.preserveDrawingBuffer) {\n            self.realClearColor.apply(gl, self.clearColor);\n          }\n        });\n\n        if (isIOS()) {\n          var canvas = gl.canvas;\n\n          if (canvas.width != self.bufferWidth || canvas.height != self.bufferHeight) {\n            self.bufferWidth = canvas.width;\n            self.bufferHeight = canvas.height;\n            self.onResize();\n          }\n        }\n      };\n\n      CardboardDistorter.prototype.updateDeviceInfo = function (deviceInfo) {\n        var gl = this.gl;\n        var self = this;\n        var glState = [gl.ARRAY_BUFFER_BINDING, gl.ELEMENT_ARRAY_BUFFER_BINDING];\n        glPreserveState(gl, glState, function (gl) {\n          var vertices = self.computeMeshVertices_(self.meshWidth, self.meshHeight, deviceInfo);\n          gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n          gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n\n          if (!self.indexCount) {\n            var indices = self.computeMeshIndices_(self.meshWidth, self.meshHeight);\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, self.indexBuffer);\n            gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indices, gl.STATIC_DRAW);\n            self.indexCount = indices.length;\n          }\n        });\n      };\n\n      CardboardDistorter.prototype.computeMeshVertices_ = function (width, height, deviceInfo) {\n        var vertices = new Float32Array(2 * width * height * 5);\n        var lensFrustum = deviceInfo.getLeftEyeVisibleTanAngles();\n        var noLensFrustum = deviceInfo.getLeftEyeNoLensTanAngles();\n        var viewport = deviceInfo.getLeftEyeVisibleScreenRect(noLensFrustum);\n        var vidx = 0;\n\n        for (var e = 0; e < 2; e++) {\n          for (var j = 0; j < height; j++) {\n            for (var i = 0; i < width; i++, vidx++) {\n              var u = i / (width - 1);\n              var v = j / (height - 1);\n              var s = u;\n              var t = v;\n              var x = lerp(lensFrustum[0], lensFrustum[2], u);\n              var y = lerp(lensFrustum[3], lensFrustum[1], v);\n              var d = Math.sqrt(x * x + y * y);\n              var r = deviceInfo.distortion.distortInverse(d);\n              var p = x * r / d;\n              var q = y * r / d;\n              u = (p - noLensFrustum[0]) / (noLensFrustum[2] - noLensFrustum[0]);\n              v = (q - noLensFrustum[3]) / (noLensFrustum[1] - noLensFrustum[3]);\n              u = (viewport.x + u * viewport.width - 0.5) * 2.0;\n              v = (viewport.y + v * viewport.height - 0.5) * 2.0;\n              vertices[vidx * 5 + 0] = u;\n              vertices[vidx * 5 + 1] = v;\n              vertices[vidx * 5 + 2] = s;\n              vertices[vidx * 5 + 3] = t;\n              vertices[vidx * 5 + 4] = e;\n            }\n          }\n\n          var w = lensFrustum[2] - lensFrustum[0];\n          lensFrustum[0] = -(w + lensFrustum[0]);\n          lensFrustum[2] = w - lensFrustum[2];\n          w = noLensFrustum[2] - noLensFrustum[0];\n          noLensFrustum[0] = -(w + noLensFrustum[0]);\n          noLensFrustum[2] = w - noLensFrustum[2];\n          viewport.x = 1 - (viewport.x + viewport.width);\n        }\n\n        return vertices;\n      };\n\n      CardboardDistorter.prototype.computeMeshIndices_ = function (width, height) {\n        var indices = new Uint16Array(2 * (width - 1) * (height - 1) * 6);\n        var halfwidth = width / 2;\n        var halfheight = height / 2;\n        var vidx = 0;\n        var iidx = 0;\n\n        for (var e = 0; e < 2; e++) {\n          for (var j = 0; j < height; j++) {\n            for (var i = 0; i < width; i++, vidx++) {\n              if (i == 0 || j == 0) continue;\n\n              if (i <= halfwidth == j <= halfheight) {\n                indices[iidx++] = vidx;\n                indices[iidx++] = vidx - width - 1;\n                indices[iidx++] = vidx - width;\n                indices[iidx++] = vidx - width - 1;\n                indices[iidx++] = vidx;\n                indices[iidx++] = vidx - 1;\n              } else {\n                indices[iidx++] = vidx - 1;\n                indices[iidx++] = vidx - width;\n                indices[iidx++] = vidx;\n                indices[iidx++] = vidx - width;\n                indices[iidx++] = vidx - 1;\n                indices[iidx++] = vidx - width - 1;\n              }\n            }\n          }\n        }\n\n        return indices;\n      };\n\n      CardboardDistorter.prototype.getOwnPropertyDescriptor_ = function (proto, attrName) {\n        var descriptor = Object.getOwnPropertyDescriptor(proto, attrName);\n\n        if (descriptor.get === undefined || descriptor.set === undefined) {\n          descriptor.configurable = true;\n          descriptor.enumerable = true;\n\n          descriptor.get = function () {\n            return this.getAttribute(attrName);\n          };\n\n          descriptor.set = function (val) {\n            this.setAttribute(attrName, val);\n          };\n        }\n\n        return descriptor;\n      };\n\n      var uiVS = ['attribute vec2 position;', 'uniform mat4 projectionMat;', 'void main() {', '  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );', '}'].join('\\n');\n      var uiFS = ['precision mediump float;', 'uniform vec4 color;', 'void main() {', '  gl_FragColor = color;', '}'].join('\\n');\n      var DEG2RAD = Math.PI / 180.0;\n      var kAnglePerGearSection = 60;\n      var kOuterRimEndAngle = 12;\n      var kInnerRimBeginAngle = 20;\n      var kOuterRadius = 1;\n      var kMiddleRadius = 0.75;\n      var kInnerRadius = 0.3125;\n      var kCenterLineThicknessDp = 4;\n      var kButtonWidthDp = 28;\n      var kTouchSlopFactor = 1.5;\n\n      function CardboardUI(gl) {\n        this.gl = gl;\n        this.attribs = {\n          position: 0\n        };\n        this.program = linkProgram(gl, uiVS, uiFS, this.attribs);\n        this.uniforms = getProgramUniforms(gl, this.program);\n        this.vertexBuffer = gl.createBuffer();\n        this.gearOffset = 0;\n        this.gearVertexCount = 0;\n        this.arrowOffset = 0;\n        this.arrowVertexCount = 0;\n        this.projMat = new Float32Array(16);\n        this.listener = null;\n        this.onResize();\n      }\n\n      CardboardUI.prototype.destroy = function () {\n        var gl = this.gl;\n\n        if (this.listener) {\n          gl.canvas.removeEventListener('click', this.listener, false);\n        }\n\n        gl.deleteProgram(this.program);\n        gl.deleteBuffer(this.vertexBuffer);\n      };\n\n      CardboardUI.prototype.listen = function (optionsCallback, backCallback) {\n        var canvas = this.gl.canvas;\n\n        this.listener = function (event) {\n          var midline = canvas.clientWidth / 2;\n          var buttonSize = kButtonWidthDp * kTouchSlopFactor;\n\n          if (event.clientX > midline - buttonSize && event.clientX < midline + buttonSize && event.clientY > canvas.clientHeight - buttonSize) {\n            optionsCallback(event);\n          } else if (event.clientX < buttonSize && event.clientY < buttonSize) {\n            backCallback(event);\n          }\n        };\n\n        canvas.addEventListener('click', this.listener, false);\n      };\n\n      CardboardUI.prototype.onResize = function () {\n        var gl = this.gl;\n        var self = this;\n        var glState = [gl.ARRAY_BUFFER_BINDING];\n        glPreserveState(gl, glState, function (gl) {\n          var vertices = [];\n          var midline = gl.drawingBufferWidth / 2;\n          var physicalPixels = Math.max(screen.width, screen.height) * window.devicePixelRatio;\n          var scalingRatio = gl.drawingBufferWidth / physicalPixels;\n          var dps = scalingRatio * window.devicePixelRatio;\n          var lineWidth = kCenterLineThicknessDp * dps / 2;\n          var buttonSize = kButtonWidthDp * kTouchSlopFactor * dps;\n          var buttonScale = kButtonWidthDp * dps / 2;\n          var buttonBorder = (kButtonWidthDp * kTouchSlopFactor - kButtonWidthDp) * dps;\n          vertices.push(midline - lineWidth, buttonSize);\n          vertices.push(midline - lineWidth, gl.drawingBufferHeight);\n          vertices.push(midline + lineWidth, buttonSize);\n          vertices.push(midline + lineWidth, gl.drawingBufferHeight);\n          self.gearOffset = vertices.length / 2;\n\n          function addGearSegment(theta, r) {\n            var angle = (90 - theta) * DEG2RAD;\n            var x = Math.cos(angle);\n            var y = Math.sin(angle);\n            vertices.push(kInnerRadius * x * buttonScale + midline, kInnerRadius * y * buttonScale + buttonScale);\n            vertices.push(r * x * buttonScale + midline, r * y * buttonScale + buttonScale);\n          }\n\n          for (var i = 0; i <= 6; i++) {\n            var segmentTheta = i * kAnglePerGearSection;\n            addGearSegment(segmentTheta, kOuterRadius);\n            addGearSegment(segmentTheta + kOuterRimEndAngle, kOuterRadius);\n            addGearSegment(segmentTheta + kInnerRimBeginAngle, kMiddleRadius);\n            addGearSegment(segmentTheta + (kAnglePerGearSection - kInnerRimBeginAngle), kMiddleRadius);\n            addGearSegment(segmentTheta + (kAnglePerGearSection - kOuterRimEndAngle), kOuterRadius);\n          }\n\n          self.gearVertexCount = vertices.length / 2 - self.gearOffset;\n          self.arrowOffset = vertices.length / 2;\n\n          function addArrowVertex(x, y) {\n            vertices.push(buttonBorder + x, gl.drawingBufferHeight - buttonBorder - y);\n          }\n\n          var angledLineWidth = lineWidth / Math.sin(45 * DEG2RAD);\n          addArrowVertex(0, buttonScale);\n          addArrowVertex(buttonScale, 0);\n          addArrowVertex(buttonScale + angledLineWidth, angledLineWidth);\n          addArrowVertex(angledLineWidth, buttonScale + angledLineWidth);\n          addArrowVertex(angledLineWidth, buttonScale - angledLineWidth);\n          addArrowVertex(0, buttonScale);\n          addArrowVertex(buttonScale, buttonScale * 2);\n          addArrowVertex(buttonScale + angledLineWidth, buttonScale * 2 - angledLineWidth);\n          addArrowVertex(angledLineWidth, buttonScale - angledLineWidth);\n          addArrowVertex(0, buttonScale);\n          addArrowVertex(angledLineWidth, buttonScale - lineWidth);\n          addArrowVertex(kButtonWidthDp * dps, buttonScale - lineWidth);\n          addArrowVertex(angledLineWidth, buttonScale + lineWidth);\n          addArrowVertex(kButtonWidthDp * dps, buttonScale + lineWidth);\n          self.arrowVertexCount = vertices.length / 2 - self.arrowOffset;\n          gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n          gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n        });\n      };\n\n      CardboardUI.prototype.render = function () {\n        var gl = this.gl;\n        var self = this;\n        var glState = [gl.CULL_FACE, gl.DEPTH_TEST, gl.BLEND, gl.SCISSOR_TEST, gl.STENCIL_TEST, gl.COLOR_WRITEMASK, gl.VIEWPORT, gl.CURRENT_PROGRAM, gl.ARRAY_BUFFER_BINDING];\n        glPreserveState(gl, glState, function (gl) {\n          gl.disable(gl.CULL_FACE);\n          gl.disable(gl.DEPTH_TEST);\n          gl.disable(gl.BLEND);\n          gl.disable(gl.SCISSOR_TEST);\n          gl.disable(gl.STENCIL_TEST);\n          gl.colorMask(true, true, true, true);\n          gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n          self.renderNoState();\n        });\n      };\n\n      CardboardUI.prototype.renderNoState = function () {\n        var gl = this.gl;\n        gl.useProgram(this.program);\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n        gl.enableVertexAttribArray(this.attribs.position);\n        gl.vertexAttribPointer(this.attribs.position, 2, gl.FLOAT, false, 8, 0);\n        gl.uniform4f(this.uniforms.color, 1.0, 1.0, 1.0, 1.0);\n        orthoMatrix(this.projMat, 0, gl.drawingBufferWidth, 0, gl.drawingBufferHeight, 0.1, 1024.0);\n        gl.uniformMatrix4fv(this.uniforms.projectionMat, false, this.projMat);\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n        gl.drawArrays(gl.TRIANGLE_STRIP, this.gearOffset, this.gearVertexCount);\n        gl.drawArrays(gl.TRIANGLE_STRIP, this.arrowOffset, this.arrowVertexCount);\n      };\n\n      function Distortion(coefficients) {\n        this.coefficients = coefficients;\n      }\n\n      Distortion.prototype.distortInverse = function (radius) {\n        var r0 = 0;\n        var r1 = 1;\n        var dr0 = radius - this.distort(r0);\n\n        while (Math.abs(r1 - r0) > 0.0001) {\n          var dr1 = radius - this.distort(r1);\n          var r2 = r1 - dr1 * ((r1 - r0) / (dr1 - dr0));\n          r0 = r1;\n          r1 = r2;\n          dr0 = dr1;\n        }\n\n        return r1;\n      };\n\n      Distortion.prototype.distort = function (radius) {\n        var r2 = radius * radius;\n        var ret = 0;\n\n        for (var i = 0; i < this.coefficients.length; i++) {\n          ret = r2 * (ret + this.coefficients[i]);\n        }\n\n        return (ret + 1) * radius;\n      };\n\n      var degToRad = Math.PI / 180;\n      var radToDeg = 180 / Math.PI;\n\n      var Vector3 = function Vector3(x, y, z) {\n        this.x = x || 0;\n        this.y = y || 0;\n        this.z = z || 0;\n      };\n\n      Vector3.prototype = {\n        constructor: Vector3,\n        set: function set(x, y, z) {\n          this.x = x;\n          this.y = y;\n          this.z = z;\n          return this;\n        },\n        copy: function copy(v) {\n          this.x = v.x;\n          this.y = v.y;\n          this.z = v.z;\n          return this;\n        },\n        length: function length() {\n          return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n        },\n        normalize: function normalize() {\n          var scalar = this.length();\n\n          if (scalar !== 0) {\n            var invScalar = 1 / scalar;\n            this.multiplyScalar(invScalar);\n          } else {\n            this.x = 0;\n            this.y = 0;\n            this.z = 0;\n          }\n\n          return this;\n        },\n        multiplyScalar: function multiplyScalar(scalar) {\n          this.x *= scalar;\n          this.y *= scalar;\n          this.z *= scalar;\n        },\n        applyQuaternion: function applyQuaternion(q) {\n          var x = this.x;\n          var y = this.y;\n          var z = this.z;\n          var qx = q.x;\n          var qy = q.y;\n          var qz = q.z;\n          var qw = q.w;\n          var ix = qw * x + qy * z - qz * y;\n          var iy = qw * y + qz * x - qx * z;\n          var iz = qw * z + qx * y - qy * x;\n          var iw = -qx * x - qy * y - qz * z;\n          this.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n          this.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n          this.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n          return this;\n        },\n        dot: function dot(v) {\n          return this.x * v.x + this.y * v.y + this.z * v.z;\n        },\n        crossVectors: function crossVectors(a, b) {\n          var ax = a.x,\n              ay = a.y,\n              az = a.z;\n          var bx = b.x,\n              by = b.y,\n              bz = b.z;\n          this.x = ay * bz - az * by;\n          this.y = az * bx - ax * bz;\n          this.z = ax * by - ay * bx;\n          return this;\n        }\n      };\n\n      var Quaternion = function Quaternion(x, y, z, w) {\n        this.x = x || 0;\n        this.y = y || 0;\n        this.z = z || 0;\n        this.w = w !== undefined ? w : 1;\n      };\n\n      Quaternion.prototype = {\n        constructor: Quaternion,\n        set: function set(x, y, z, w) {\n          this.x = x;\n          this.y = y;\n          this.z = z;\n          this.w = w;\n          return this;\n        },\n        copy: function copy(quaternion) {\n          this.x = quaternion.x;\n          this.y = quaternion.y;\n          this.z = quaternion.z;\n          this.w = quaternion.w;\n          return this;\n        },\n        setFromEulerXYZ: function setFromEulerXYZ(x, y, z) {\n          var c1 = Math.cos(x / 2);\n          var c2 = Math.cos(y / 2);\n          var c3 = Math.cos(z / 2);\n          var s1 = Math.sin(x / 2);\n          var s2 = Math.sin(y / 2);\n          var s3 = Math.sin(z / 2);\n          this.x = s1 * c2 * c3 + c1 * s2 * s3;\n          this.y = c1 * s2 * c3 - s1 * c2 * s3;\n          this.z = c1 * c2 * s3 + s1 * s2 * c3;\n          this.w = c1 * c2 * c3 - s1 * s2 * s3;\n          return this;\n        },\n        setFromEulerYXZ: function setFromEulerYXZ(x, y, z) {\n          var c1 = Math.cos(x / 2);\n          var c2 = Math.cos(y / 2);\n          var c3 = Math.cos(z / 2);\n          var s1 = Math.sin(x / 2);\n          var s2 = Math.sin(y / 2);\n          var s3 = Math.sin(z / 2);\n          this.x = s1 * c2 * c3 + c1 * s2 * s3;\n          this.y = c1 * s2 * c3 - s1 * c2 * s3;\n          this.z = c1 * c2 * s3 - s1 * s2 * c3;\n          this.w = c1 * c2 * c3 + s1 * s2 * s3;\n          return this;\n        },\n        setFromAxisAngle: function setFromAxisAngle(axis, angle) {\n          var halfAngle = angle / 2,\n              s = Math.sin(halfAngle);\n          this.x = axis.x * s;\n          this.y = axis.y * s;\n          this.z = axis.z * s;\n          this.w = Math.cos(halfAngle);\n          return this;\n        },\n        multiply: function multiply(q) {\n          return this.multiplyQuaternions(this, q);\n        },\n        multiplyQuaternions: function multiplyQuaternions(a, b) {\n          var qax = a.x,\n              qay = a.y,\n              qaz = a.z,\n              qaw = a.w;\n          var qbx = b.x,\n              qby = b.y,\n              qbz = b.z,\n              qbw = b.w;\n          this.x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n          this.y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n          this.z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n          this.w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n          return this;\n        },\n        inverse: function inverse() {\n          this.x *= -1;\n          this.y *= -1;\n          this.z *= -1;\n          this.normalize();\n          return this;\n        },\n        normalize: function normalize() {\n          var l = Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);\n\n          if (l === 0) {\n            this.x = 0;\n            this.y = 0;\n            this.z = 0;\n            this.w = 1;\n          } else {\n            l = 1 / l;\n            this.x = this.x * l;\n            this.y = this.y * l;\n            this.z = this.z * l;\n            this.w = this.w * l;\n          }\n\n          return this;\n        },\n        slerp: function slerp(qb, t) {\n          if (t === 0) return this;\n          if (t === 1) return this.copy(qb);\n          var x = this.x,\n              y = this.y,\n              z = this.z,\n              w = this.w;\n          var cosHalfTheta = w * qb.w + x * qb.x + y * qb.y + z * qb.z;\n\n          if (cosHalfTheta < 0) {\n            this.w = -qb.w;\n            this.x = -qb.x;\n            this.y = -qb.y;\n            this.z = -qb.z;\n            cosHalfTheta = -cosHalfTheta;\n          } else {\n            this.copy(qb);\n          }\n\n          if (cosHalfTheta >= 1.0) {\n            this.w = w;\n            this.x = x;\n            this.y = y;\n            this.z = z;\n            return this;\n          }\n\n          var halfTheta = Math.acos(cosHalfTheta);\n          var sinHalfTheta = Math.sqrt(1.0 - cosHalfTheta * cosHalfTheta);\n\n          if (Math.abs(sinHalfTheta) < 0.001) {\n            this.w = 0.5 * (w + this.w);\n            this.x = 0.5 * (x + this.x);\n            this.y = 0.5 * (y + this.y);\n            this.z = 0.5 * (z + this.z);\n            return this;\n          }\n\n          var ratioA = Math.sin((1 - t) * halfTheta) / sinHalfTheta,\n              ratioB = Math.sin(t * halfTheta) / sinHalfTheta;\n          this.w = w * ratioA + this.w * ratioB;\n          this.x = x * ratioA + this.x * ratioB;\n          this.y = y * ratioA + this.y * ratioB;\n          this.z = z * ratioA + this.z * ratioB;\n          return this;\n        },\n        setFromUnitVectors: function () {\n          var v1, r;\n          var EPS = 0.000001;\n          return function (vFrom, vTo) {\n            if (v1 === undefined) v1 = new Vector3();\n            r = vFrom.dot(vTo) + 1;\n\n            if (r < EPS) {\n              r = 0;\n\n              if (Math.abs(vFrom.x) > Math.abs(vFrom.z)) {\n                v1.set(-vFrom.y, vFrom.x, 0);\n              } else {\n                v1.set(0, -vFrom.z, vFrom.y);\n              }\n            } else {\n              v1.crossVectors(vFrom, vTo);\n            }\n\n            this.x = v1.x;\n            this.y = v1.y;\n            this.z = v1.z;\n            this.w = r;\n            this.normalize();\n            return this;\n          };\n        }()\n      };\n\n      function Device(params) {\n        this.width = params.width || getScreenWidth();\n        this.height = params.height || getScreenHeight();\n        this.widthMeters = params.widthMeters;\n        this.heightMeters = params.heightMeters;\n        this.bevelMeters = params.bevelMeters;\n      }\n\n      var DEFAULT_ANDROID = new Device({\n        widthMeters: 0.110,\n        heightMeters: 0.062,\n        bevelMeters: 0.004\n      });\n      var DEFAULT_IOS = new Device({\n        widthMeters: 0.1038,\n        heightMeters: 0.0584,\n        bevelMeters: 0.004\n      });\n      var Viewers = {\n        CardboardV1: new CardboardViewer({\n          id: 'CardboardV1',\n          label: 'Cardboard I/O 2014',\n          fov: 40,\n          interLensDistance: 0.060,\n          baselineLensDistance: 0.035,\n          screenLensDistance: 0.042,\n          distortionCoefficients: [0.441, 0.156],\n          inverseCoefficients: [-0.4410035, 0.42756155, -0.4804439, 0.5460139, -0.58821183, 0.5733938, -0.48303202, 0.33299083, -0.17573841, 0.0651772, -0.01488963, 0.001559834]\n        }),\n        CardboardV2: new CardboardViewer({\n          id: 'CardboardV2',\n          label: 'Cardboard I/O 2015',\n          fov: 60,\n          interLensDistance: 0.064,\n          baselineLensDistance: 0.035,\n          screenLensDistance: 0.039,\n          distortionCoefficients: [0.34, 0.55],\n          inverseCoefficients: [-0.33836704, -0.18162185, 0.862655, -1.2462051, 1.0560602, -0.58208317, 0.21609078, -0.05444823, 0.009177956, -9.904169E-4, 6.183535E-5, -1.6981803E-6]\n        })\n      };\n\n      function DeviceInfo(deviceParams, additionalViewers) {\n        this.viewer = Viewers.CardboardV2;\n        this.updateDeviceParams(deviceParams);\n        this.distortion = new Distortion(this.viewer.distortionCoefficients);\n\n        for (var i = 0; i < additionalViewers.length; i++) {\n          var viewer = additionalViewers[i];\n          Viewers[viewer.id] = new CardboardViewer(viewer);\n        }\n      }\n\n      DeviceInfo.prototype.updateDeviceParams = function (deviceParams) {\n        this.device = this.determineDevice_(deviceParams) || this.device;\n      };\n\n      DeviceInfo.prototype.getDevice = function () {\n        return this.device;\n      };\n\n      DeviceInfo.prototype.setViewer = function (viewer) {\n        this.viewer = viewer;\n        this.distortion = new Distortion(this.viewer.distortionCoefficients);\n      };\n\n      DeviceInfo.prototype.determineDevice_ = function (deviceParams) {\n        if (!deviceParams) {\n          if (isIOS()) {\n            console.warn('Using fallback iOS device measurements.');\n            return DEFAULT_IOS;\n          } else {\n            console.warn('Using fallback Android device measurements.');\n            return DEFAULT_ANDROID;\n          }\n        }\n\n        var METERS_PER_INCH = 0.0254;\n        var metersPerPixelX = METERS_PER_INCH / deviceParams.xdpi;\n        var metersPerPixelY = METERS_PER_INCH / deviceParams.ydpi;\n        var width = getScreenWidth();\n        var height = getScreenHeight();\n        return new Device({\n          widthMeters: metersPerPixelX * width,\n          heightMeters: metersPerPixelY * height,\n          bevelMeters: deviceParams.bevelMm * 0.001\n        });\n      };\n\n      DeviceInfo.prototype.getDistortedFieldOfViewLeftEye = function () {\n        var viewer = this.viewer;\n        var device = this.device;\n        var distortion = this.distortion;\n        var eyeToScreenDistance = viewer.screenLensDistance;\n        var outerDist = (device.widthMeters - viewer.interLensDistance) / 2;\n        var innerDist = viewer.interLensDistance / 2;\n        var bottomDist = viewer.baselineLensDistance - device.bevelMeters;\n        var topDist = device.heightMeters - bottomDist;\n        var outerAngle = radToDeg * Math.atan(distortion.distort(outerDist / eyeToScreenDistance));\n        var innerAngle = radToDeg * Math.atan(distortion.distort(innerDist / eyeToScreenDistance));\n        var bottomAngle = radToDeg * Math.atan(distortion.distort(bottomDist / eyeToScreenDistance));\n        var topAngle = radToDeg * Math.atan(distortion.distort(topDist / eyeToScreenDistance));\n        return {\n          leftDegrees: Math.min(outerAngle, viewer.fov),\n          rightDegrees: Math.min(innerAngle, viewer.fov),\n          downDegrees: Math.min(bottomAngle, viewer.fov),\n          upDegrees: Math.min(topAngle, viewer.fov)\n        };\n      };\n\n      DeviceInfo.prototype.getLeftEyeVisibleTanAngles = function () {\n        var viewer = this.viewer;\n        var device = this.device;\n        var distortion = this.distortion;\n        var fovLeft = Math.tan(-degToRad * viewer.fov);\n        var fovTop = Math.tan(degToRad * viewer.fov);\n        var fovRight = Math.tan(degToRad * viewer.fov);\n        var fovBottom = Math.tan(-degToRad * viewer.fov);\n        var halfWidth = device.widthMeters / 4;\n        var halfHeight = device.heightMeters / 2;\n        var verticalLensOffset = viewer.baselineLensDistance - device.bevelMeters - halfHeight;\n        var centerX = viewer.interLensDistance / 2 - halfWidth;\n        var centerY = -verticalLensOffset;\n        var centerZ = viewer.screenLensDistance;\n        var screenLeft = distortion.distort((centerX - halfWidth) / centerZ);\n        var screenTop = distortion.distort((centerY + halfHeight) / centerZ);\n        var screenRight = distortion.distort((centerX + halfWidth) / centerZ);\n        var screenBottom = distortion.distort((centerY - halfHeight) / centerZ);\n        var result = new Float32Array(4);\n        result[0] = Math.max(fovLeft, screenLeft);\n        result[1] = Math.min(fovTop, screenTop);\n        result[2] = Math.min(fovRight, screenRight);\n        result[3] = Math.max(fovBottom, screenBottom);\n        return result;\n      };\n\n      DeviceInfo.prototype.getLeftEyeNoLensTanAngles = function () {\n        var viewer = this.viewer;\n        var device = this.device;\n        var distortion = this.distortion;\n        var result = new Float32Array(4);\n        var fovLeft = distortion.distortInverse(Math.tan(-degToRad * viewer.fov));\n        var fovTop = distortion.distortInverse(Math.tan(degToRad * viewer.fov));\n        var fovRight = distortion.distortInverse(Math.tan(degToRad * viewer.fov));\n        var fovBottom = distortion.distortInverse(Math.tan(-degToRad * viewer.fov));\n        var halfWidth = device.widthMeters / 4;\n        var halfHeight = device.heightMeters / 2;\n        var verticalLensOffset = viewer.baselineLensDistance - device.bevelMeters - halfHeight;\n        var centerX = viewer.interLensDistance / 2 - halfWidth;\n        var centerY = -verticalLensOffset;\n        var centerZ = viewer.screenLensDistance;\n        var screenLeft = (centerX - halfWidth) / centerZ;\n        var screenTop = (centerY + halfHeight) / centerZ;\n        var screenRight = (centerX + halfWidth) / centerZ;\n        var screenBottom = (centerY - halfHeight) / centerZ;\n        result[0] = Math.max(fovLeft, screenLeft);\n        result[1] = Math.min(fovTop, screenTop);\n        result[2] = Math.min(fovRight, screenRight);\n        result[3] = Math.max(fovBottom, screenBottom);\n        return result;\n      };\n\n      DeviceInfo.prototype.getLeftEyeVisibleScreenRect = function (undistortedFrustum) {\n        var viewer = this.viewer;\n        var device = this.device;\n        var dist = viewer.screenLensDistance;\n        var eyeX = (device.widthMeters - viewer.interLensDistance) / 2;\n        var eyeY = viewer.baselineLensDistance - device.bevelMeters;\n        var left = (undistortedFrustum[0] * dist + eyeX) / device.widthMeters;\n        var top = (undistortedFrustum[1] * dist + eyeY) / device.heightMeters;\n        var right = (undistortedFrustum[2] * dist + eyeX) / device.widthMeters;\n        var bottom = (undistortedFrustum[3] * dist + eyeY) / device.heightMeters;\n        return {\n          x: left,\n          y: bottom,\n          width: right - left,\n          height: top - bottom\n        };\n      };\n\n      DeviceInfo.prototype.getFieldOfViewLeftEye = function (opt_isUndistorted) {\n        return opt_isUndistorted ? this.getUndistortedFieldOfViewLeftEye() : this.getDistortedFieldOfViewLeftEye();\n      };\n\n      DeviceInfo.prototype.getFieldOfViewRightEye = function (opt_isUndistorted) {\n        var fov = this.getFieldOfViewLeftEye(opt_isUndistorted);\n        return {\n          leftDegrees: fov.rightDegrees,\n          rightDegrees: fov.leftDegrees,\n          upDegrees: fov.upDegrees,\n          downDegrees: fov.downDegrees\n        };\n      };\n\n      DeviceInfo.prototype.getUndistortedFieldOfViewLeftEye = function () {\n        var p = this.getUndistortedParams_();\n        return {\n          leftDegrees: radToDeg * Math.atan(p.outerDist),\n          rightDegrees: radToDeg * Math.atan(p.innerDist),\n          downDegrees: radToDeg * Math.atan(p.bottomDist),\n          upDegrees: radToDeg * Math.atan(p.topDist)\n        };\n      };\n\n      DeviceInfo.prototype.getUndistortedViewportLeftEye = function () {\n        var p = this.getUndistortedParams_();\n        var viewer = this.viewer;\n        var device = this.device;\n        var eyeToScreenDistance = viewer.screenLensDistance;\n        var screenWidth = device.widthMeters / eyeToScreenDistance;\n        var screenHeight = device.heightMeters / eyeToScreenDistance;\n        var xPxPerTanAngle = device.width / screenWidth;\n        var yPxPerTanAngle = device.height / screenHeight;\n        var x = Math.round((p.eyePosX - p.outerDist) * xPxPerTanAngle);\n        var y = Math.round((p.eyePosY - p.bottomDist) * yPxPerTanAngle);\n        return {\n          x: x,\n          y: y,\n          width: Math.round((p.eyePosX + p.innerDist) * xPxPerTanAngle) - x,\n          height: Math.round((p.eyePosY + p.topDist) * yPxPerTanAngle) - y\n        };\n      };\n\n      DeviceInfo.prototype.getUndistortedParams_ = function () {\n        var viewer = this.viewer;\n        var device = this.device;\n        var distortion = this.distortion;\n        var eyeToScreenDistance = viewer.screenLensDistance;\n        var halfLensDistance = viewer.interLensDistance / 2 / eyeToScreenDistance;\n        var screenWidth = device.widthMeters / eyeToScreenDistance;\n        var screenHeight = device.heightMeters / eyeToScreenDistance;\n        var eyePosX = screenWidth / 2 - halfLensDistance;\n        var eyePosY = (viewer.baselineLensDistance - device.bevelMeters) / eyeToScreenDistance;\n        var maxFov = viewer.fov;\n        var viewerMax = distortion.distortInverse(Math.tan(degToRad * maxFov));\n        var outerDist = Math.min(eyePosX, viewerMax);\n        var innerDist = Math.min(halfLensDistance, viewerMax);\n        var bottomDist = Math.min(eyePosY, viewerMax);\n        var topDist = Math.min(screenHeight - eyePosY, viewerMax);\n        return {\n          outerDist: outerDist,\n          innerDist: innerDist,\n          topDist: topDist,\n          bottomDist: bottomDist,\n          eyePosX: eyePosX,\n          eyePosY: eyePosY\n        };\n      };\n\n      function CardboardViewer(params) {\n        this.id = params.id;\n        this.label = params.label;\n        this.fov = params.fov;\n        this.interLensDistance = params.interLensDistance;\n        this.baselineLensDistance = params.baselineLensDistance;\n        this.screenLensDistance = params.screenLensDistance;\n        this.distortionCoefficients = params.distortionCoefficients;\n        this.inverseCoefficients = params.inverseCoefficients;\n      }\n\n      DeviceInfo.Viewers = Viewers;\n      var format = 1;\n      var last_updated = \"2018-12-10T17:01:42Z\";\n      var devices = [{\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"asus/*/Nexus 7/*\"\n        }, {\n          \"ua\": \"Nexus 7\"\n        }],\n        \"dpi\": [320.8, 323],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"asus/*/ASUS_Z00AD/*\"\n        }, {\n          \"ua\": \"ASUS_Z00AD\"\n        }],\n        \"dpi\": [403, 404.6],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Google/*/Pixel 2 XL/*\"\n        }, {\n          \"ua\": \"Pixel 2 XL\"\n        }],\n        \"dpi\": 537.9,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Google/*/Pixel 3 XL/*\"\n        }, {\n          \"ua\": \"Pixel 3 XL\"\n        }],\n        \"dpi\": [558.5, 553.8],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Google/*/Pixel XL/*\"\n        }, {\n          \"ua\": \"Pixel XL\"\n        }],\n        \"dpi\": [537.9, 533],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Google/*/Pixel 3/*\"\n        }, {\n          \"ua\": \"Pixel 3\"\n        }],\n        \"dpi\": 442.4,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Google/*/Pixel 2/*\"\n        }, {\n          \"ua\": \"Pixel 2\"\n        }],\n        \"dpi\": 441,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Google/*/Pixel/*\"\n        }, {\n          \"ua\": \"Pixel\"\n        }],\n        \"dpi\": [432.6, 436.7],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"HTC/*/HTC6435LVW/*\"\n        }, {\n          \"ua\": \"HTC6435LVW\"\n        }],\n        \"dpi\": [449.7, 443.3],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"HTC/*/HTC One XL/*\"\n        }, {\n          \"ua\": \"HTC One XL\"\n        }],\n        \"dpi\": [315.3, 314.6],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"htc/*/Nexus 9/*\"\n        }, {\n          \"ua\": \"Nexus 9\"\n        }],\n        \"dpi\": 289,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"HTC/*/HTC One M9/*\"\n        }, {\n          \"ua\": \"HTC One M9\"\n        }],\n        \"dpi\": [442.5, 443.3],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"HTC/*/HTC One_M8/*\"\n        }, {\n          \"ua\": \"HTC One_M8\"\n        }],\n        \"dpi\": [449.7, 447.4],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"HTC/*/HTC One/*\"\n        }, {\n          \"ua\": \"HTC One\"\n        }],\n        \"dpi\": 472.8,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Huawei/*/Nexus 6P/*\"\n        }, {\n          \"ua\": \"Nexus 6P\"\n        }],\n        \"dpi\": [515.1, 518],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Huawei/*/BLN-L24/*\"\n        }, {\n          \"ua\": \"HONORBLN-L24\"\n        }],\n        \"dpi\": 480,\n        \"bw\": 4,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Huawei/*/BKL-L09/*\"\n        }, {\n          \"ua\": \"BKL-L09\"\n        }],\n        \"dpi\": 403,\n        \"bw\": 3.47,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LENOVO/*/Lenovo PB2-690Y/*\"\n        }, {\n          \"ua\": \"Lenovo PB2-690Y\"\n        }],\n        \"dpi\": [457.2, 454.713],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/Nexus 5X/*\"\n        }, {\n          \"ua\": \"Nexus 5X\"\n        }],\n        \"dpi\": [422, 419.9],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/LGMS345/*\"\n        }, {\n          \"ua\": \"LGMS345\"\n        }],\n        \"dpi\": [221.7, 219.1],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/LG-D800/*\"\n        }, {\n          \"ua\": \"LG-D800\"\n        }],\n        \"dpi\": [422, 424.1],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/LG-D850/*\"\n        }, {\n          \"ua\": \"LG-D850\"\n        }],\n        \"dpi\": [537.9, 541.9],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/VS985 4G/*\"\n        }, {\n          \"ua\": \"VS985 4G\"\n        }],\n        \"dpi\": [537.9, 535.6],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/Nexus 5/*\"\n        }, {\n          \"ua\": \"Nexus 5 B\"\n        }],\n        \"dpi\": [442.4, 444.8],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/Nexus 4/*\"\n        }, {\n          \"ua\": \"Nexus 4\"\n        }],\n        \"dpi\": [319.8, 318.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/LG-P769/*\"\n        }, {\n          \"ua\": \"LG-P769\"\n        }],\n        \"dpi\": [240.6, 247.5],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/LGMS323/*\"\n        }, {\n          \"ua\": \"LGMS323\"\n        }],\n        \"dpi\": [206.6, 204.6],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"LGE/*/LGLS996/*\"\n        }, {\n          \"ua\": \"LGLS996\"\n        }],\n        \"dpi\": [403.4, 401.5],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Micromax/*/4560MMX/*\"\n        }, {\n          \"ua\": \"4560MMX\"\n        }],\n        \"dpi\": [240, 219.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Micromax/*/A250/*\"\n        }, {\n          \"ua\": \"Micromax A250\"\n        }],\n        \"dpi\": [480, 446.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Micromax/*/Micromax AQ4501/*\"\n        }, {\n          \"ua\": \"Micromax AQ4501\"\n        }],\n        \"dpi\": 240,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/G5/*\"\n        }, {\n          \"ua\": \"Moto G (5) Plus\"\n        }],\n        \"dpi\": [403.4, 403],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/DROID RAZR/*\"\n        }, {\n          \"ua\": \"DROID RAZR\"\n        }],\n        \"dpi\": [368.1, 256.7],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT830C/*\"\n        }, {\n          \"ua\": \"XT830C\"\n        }],\n        \"dpi\": [254, 255.9],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1021/*\"\n        }, {\n          \"ua\": \"XT1021\"\n        }],\n        \"dpi\": [254, 256.7],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1023/*\"\n        }, {\n          \"ua\": \"XT1023\"\n        }],\n        \"dpi\": [254, 256.7],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1028/*\"\n        }, {\n          \"ua\": \"XT1028\"\n        }],\n        \"dpi\": [326.6, 327.6],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1034/*\"\n        }, {\n          \"ua\": \"XT1034\"\n        }],\n        \"dpi\": [326.6, 328.4],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1053/*\"\n        }, {\n          \"ua\": \"XT1053\"\n        }],\n        \"dpi\": [315.3, 316.1],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1562/*\"\n        }, {\n          \"ua\": \"XT1562\"\n        }],\n        \"dpi\": [403.4, 402.7],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/Nexus 6/*\"\n        }, {\n          \"ua\": \"Nexus 6 B\"\n        }],\n        \"dpi\": [494.3, 489.7],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1063/*\"\n        }, {\n          \"ua\": \"XT1063\"\n        }],\n        \"dpi\": [295, 296.6],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1064/*\"\n        }, {\n          \"ua\": \"XT1064\"\n        }],\n        \"dpi\": [295, 295.6],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1092/*\"\n        }, {\n          \"ua\": \"XT1092\"\n        }],\n        \"dpi\": [422, 424.1],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/XT1095/*\"\n        }, {\n          \"ua\": \"XT1095\"\n        }],\n        \"dpi\": [422, 423.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"motorola/*/G4/*\"\n        }, {\n          \"ua\": \"Moto G (4)\"\n        }],\n        \"dpi\": 401,\n        \"bw\": 4,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"OnePlus/*/A0001/*\"\n        }, {\n          \"ua\": \"A0001\"\n        }],\n        \"dpi\": [403.4, 401],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"OnePlus/*/ONE E1005/*\"\n        }, {\n          \"ua\": \"ONE E1005\"\n        }],\n        \"dpi\": [442.4, 441.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"OnePlus/*/ONE A2005/*\"\n        }, {\n          \"ua\": \"ONE A2005\"\n        }],\n        \"dpi\": [391.9, 405.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"OnePlus/*/ONEPLUS A5000/*\"\n        }, {\n          \"ua\": \"ONEPLUS A5000 \"\n        }],\n        \"dpi\": [403.411, 399.737],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"OnePlus/*/ONE A5010/*\"\n        }, {\n          \"ua\": \"ONEPLUS A5010\"\n        }],\n        \"dpi\": [403, 400],\n        \"bw\": 2,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"OPPO/*/X909/*\"\n        }, {\n          \"ua\": \"X909\"\n        }],\n        \"dpi\": [442.4, 444.1],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/GT-I9082/*\"\n        }, {\n          \"ua\": \"GT-I9082\"\n        }],\n        \"dpi\": [184.7, 185.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G360P/*\"\n        }, {\n          \"ua\": \"SM-G360P\"\n        }],\n        \"dpi\": [196.7, 205.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/Nexus S/*\"\n        }, {\n          \"ua\": \"Nexus S\"\n        }],\n        \"dpi\": [234.5, 229.8],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/GT-I9300/*\"\n        }, {\n          \"ua\": \"GT-I9300\"\n        }],\n        \"dpi\": [304.8, 303.9],\n        \"bw\": 5,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-T230NU/*\"\n        }, {\n          \"ua\": \"SM-T230NU\"\n        }],\n        \"dpi\": 216,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SGH-T399/*\"\n        }, {\n          \"ua\": \"SGH-T399\"\n        }],\n        \"dpi\": [217.7, 231.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SGH-M919/*\"\n        }, {\n          \"ua\": \"SGH-M919\"\n        }],\n        \"dpi\": [440.8, 437.7],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-N9005/*\"\n        }, {\n          \"ua\": \"SM-N9005\"\n        }],\n        \"dpi\": [386.4, 387],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SAMSUNG-SM-N900A/*\"\n        }, {\n          \"ua\": \"SAMSUNG-SM-N900A\"\n        }],\n        \"dpi\": [386.4, 387.7],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/GT-I9500/*\"\n        }, {\n          \"ua\": \"GT-I9500\"\n        }],\n        \"dpi\": [442.5, 443.3],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/GT-I9505/*\"\n        }, {\n          \"ua\": \"GT-I9505\"\n        }],\n        \"dpi\": 439.4,\n        \"bw\": 4,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G900F/*\"\n        }, {\n          \"ua\": \"SM-G900F\"\n        }],\n        \"dpi\": [415.6, 431.6],\n        \"bw\": 5,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G900M/*\"\n        }, {\n          \"ua\": \"SM-G900M\"\n        }],\n        \"dpi\": [415.6, 431.6],\n        \"bw\": 5,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G800F/*\"\n        }, {\n          \"ua\": \"SM-G800F\"\n        }],\n        \"dpi\": 326.8,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G906S/*\"\n        }, {\n          \"ua\": \"SM-G906S\"\n        }],\n        \"dpi\": [562.7, 572.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/GT-I9300/*\"\n        }, {\n          \"ua\": \"GT-I9300\"\n        }],\n        \"dpi\": [306.7, 304.8],\n        \"bw\": 5,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-T535/*\"\n        }, {\n          \"ua\": \"SM-T535\"\n        }],\n        \"dpi\": [142.6, 136.4],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-N920C/*\"\n        }, {\n          \"ua\": \"SM-N920C\"\n        }],\n        \"dpi\": [515.1, 518.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-N920P/*\"\n        }, {\n          \"ua\": \"SM-N920P\"\n        }],\n        \"dpi\": [386.3655, 390.144],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-N920W8/*\"\n        }, {\n          \"ua\": \"SM-N920W8\"\n        }],\n        \"dpi\": [515.1, 518.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/GT-I9300I/*\"\n        }, {\n          \"ua\": \"GT-I9300I\"\n        }],\n        \"dpi\": [304.8, 305.8],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/GT-I9195/*\"\n        }, {\n          \"ua\": \"GT-I9195\"\n        }],\n        \"dpi\": [249.4, 256.7],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SPH-L520/*\"\n        }, {\n          \"ua\": \"SPH-L520\"\n        }],\n        \"dpi\": [249.4, 255.9],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SAMSUNG-SGH-I717/*\"\n        }, {\n          \"ua\": \"SAMSUNG-SGH-I717\"\n        }],\n        \"dpi\": 285.8,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SPH-D710/*\"\n        }, {\n          \"ua\": \"SPH-D710\"\n        }],\n        \"dpi\": [217.7, 204.2],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/GT-N7100/*\"\n        }, {\n          \"ua\": \"GT-N7100\"\n        }],\n        \"dpi\": 265.1,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SCH-I605/*\"\n        }, {\n          \"ua\": \"SCH-I605\"\n        }],\n        \"dpi\": 265.1,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/Galaxy Nexus/*\"\n        }, {\n          \"ua\": \"Galaxy Nexus\"\n        }],\n        \"dpi\": [315.3, 314.2],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-N910H/*\"\n        }, {\n          \"ua\": \"SM-N910H\"\n        }],\n        \"dpi\": [515.1, 518],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-N910C/*\"\n        }, {\n          \"ua\": \"SM-N910C\"\n        }],\n        \"dpi\": [515.2, 520.2],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G130M/*\"\n        }, {\n          \"ua\": \"SM-G130M\"\n        }],\n        \"dpi\": [165.9, 164.8],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G928I/*\"\n        }, {\n          \"ua\": \"SM-G928I\"\n        }],\n        \"dpi\": [515.1, 518.4],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G920F/*\"\n        }, {\n          \"ua\": \"SM-G920F\"\n        }],\n        \"dpi\": 580.6,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G920P/*\"\n        }, {\n          \"ua\": \"SM-G920P\"\n        }],\n        \"dpi\": [522.5, 577],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G925F/*\"\n        }, {\n          \"ua\": \"SM-G925F\"\n        }],\n        \"dpi\": 580.6,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G925V/*\"\n        }, {\n          \"ua\": \"SM-G925V\"\n        }],\n        \"dpi\": [522.5, 576.6],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G930F/*\"\n        }, {\n          \"ua\": \"SM-G930F\"\n        }],\n        \"dpi\": 576.6,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G935F/*\"\n        }, {\n          \"ua\": \"SM-G935F\"\n        }],\n        \"dpi\": 533,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G950F/*\"\n        }, {\n          \"ua\": \"SM-G950F\"\n        }],\n        \"dpi\": [562.707, 565.293],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G955U/*\"\n        }, {\n          \"ua\": \"SM-G955U\"\n        }],\n        \"dpi\": [522.514, 525.762],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"samsung/*/SM-G955F/*\"\n        }, {\n          \"ua\": \"SM-G955F\"\n        }],\n        \"dpi\": [522.514, 525.762],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Sony/*/C6903/*\"\n        }, {\n          \"ua\": \"C6903\"\n        }],\n        \"dpi\": [442.5, 443.3],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Sony/*/D6653/*\"\n        }, {\n          \"ua\": \"D6653\"\n        }],\n        \"dpi\": [428.6, 427.6],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Sony/*/E6653/*\"\n        }, {\n          \"ua\": \"E6653\"\n        }],\n        \"dpi\": [428.6, 425.7],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Sony/*/E6853/*\"\n        }, {\n          \"ua\": \"E6853\"\n        }],\n        \"dpi\": [403.4, 401.9],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Sony/*/SGP321/*\"\n        }, {\n          \"ua\": \"SGP321\"\n        }],\n        \"dpi\": [224.7, 224.1],\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"TCT/*/ALCATEL ONE TOUCH Fierce/*\"\n        }, {\n          \"ua\": \"ALCATEL ONE TOUCH Fierce\"\n        }],\n        \"dpi\": [240, 247.5],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"THL/*/thl 5000/*\"\n        }, {\n          \"ua\": \"thl 5000\"\n        }],\n        \"dpi\": [480, 443.3],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"Fly/*/IQ4412/*\"\n        }, {\n          \"ua\": \"IQ4412\"\n        }],\n        \"dpi\": 307.9,\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"ZTE/*/ZTE Blade L2/*\"\n        }, {\n          \"ua\": \"ZTE Blade L2\"\n        }],\n        \"dpi\": 240,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"android\",\n        \"rules\": [{\n          \"mdmh\": \"BENEVE/*/VR518/*\"\n        }, {\n          \"ua\": \"VR518\"\n        }],\n        \"dpi\": 480,\n        \"bw\": 3,\n        \"ac\": 500\n      }, {\n        \"type\": \"ios\",\n        \"rules\": [{\n          \"res\": [640, 960]\n        }],\n        \"dpi\": [325.1, 328.4],\n        \"bw\": 4,\n        \"ac\": 1000\n      }, {\n        \"type\": \"ios\",\n        \"rules\": [{\n          \"res\": [640, 1136]\n        }],\n        \"dpi\": [317.1, 320.2],\n        \"bw\": 3,\n        \"ac\": 1000\n      }, {\n        \"type\": \"ios\",\n        \"rules\": [{\n          \"res\": [750, 1334]\n        }],\n        \"dpi\": 326.4,\n        \"bw\": 4,\n        \"ac\": 1000\n      }, {\n        \"type\": \"ios\",\n        \"rules\": [{\n          \"res\": [1242, 2208]\n        }],\n        \"dpi\": [453.6, 458.4],\n        \"bw\": 4,\n        \"ac\": 1000\n      }, {\n        \"type\": \"ios\",\n        \"rules\": [{\n          \"res\": [1125, 2001]\n        }],\n        \"dpi\": [410.9, 415.4],\n        \"bw\": 4,\n        \"ac\": 1000\n      }, {\n        \"type\": \"ios\",\n        \"rules\": [{\n          \"res\": [1125, 2436]\n        }],\n        \"dpi\": 458,\n        \"bw\": 4,\n        \"ac\": 1000\n      }];\n      var DPDB_CACHE = {\n        format: format,\n        last_updated: last_updated,\n        devices: devices\n      };\n\n      function Dpdb(url, onDeviceParamsUpdated) {\n        this.dpdb = DPDB_CACHE;\n        this.recalculateDeviceParams_();\n\n        if (url) {\n          this.onDeviceParamsUpdated = onDeviceParamsUpdated;\n          var xhr = new XMLHttpRequest();\n          var obj = this;\n          xhr.open('GET', url, true);\n          xhr.addEventListener('load', function () {\n            obj.loading = false;\n\n            if (xhr.status >= 200 && xhr.status <= 299) {\n              obj.dpdb = JSON.parse(xhr.response);\n              obj.recalculateDeviceParams_();\n            } else {\n              console.error('Error loading online DPDB!');\n            }\n          });\n          xhr.send();\n        }\n      }\n\n      Dpdb.prototype.getDeviceParams = function () {\n        return this.deviceParams;\n      };\n\n      Dpdb.prototype.recalculateDeviceParams_ = function () {\n        var newDeviceParams = this.calcDeviceParams_();\n\n        if (newDeviceParams) {\n          this.deviceParams = newDeviceParams;\n\n          if (this.onDeviceParamsUpdated) {\n            this.onDeviceParamsUpdated(this.deviceParams);\n          }\n        } else {\n          console.error('Failed to recalculate device parameters.');\n        }\n      };\n\n      Dpdb.prototype.calcDeviceParams_ = function () {\n        var db = this.dpdb;\n\n        if (!db) {\n          console.error('DPDB not available.');\n          return null;\n        }\n\n        if (db.format != 1) {\n          console.error('DPDB has unexpected format version.');\n          return null;\n        }\n\n        if (!db.devices || !db.devices.length) {\n          console.error('DPDB does not have a devices section.');\n          return null;\n        }\n\n        var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n        var width = getScreenWidth();\n        var height = getScreenHeight();\n\n        if (!db.devices) {\n          console.error('DPDB has no devices section.');\n          return null;\n        }\n\n        for (var i = 0; i < db.devices.length; i++) {\n          var device = db.devices[i];\n\n          if (!device.rules) {\n            console.warn('Device[' + i + '] has no rules section.');\n            continue;\n          }\n\n          if (device.type != 'ios' && device.type != 'android') {\n            console.warn('Device[' + i + '] has invalid type.');\n            continue;\n          }\n\n          if (isIOS() != (device.type == 'ios')) continue;\n          var matched = false;\n\n          for (var j = 0; j < device.rules.length; j++) {\n            var rule = device.rules[j];\n\n            if (this.ruleMatches_(rule, userAgent, width, height)) {\n              matched = true;\n              break;\n            }\n          }\n\n          if (!matched) continue;\n          var xdpi = device.dpi[0] || device.dpi;\n          var ydpi = device.dpi[1] || device.dpi;\n          return new DeviceParams({\n            xdpi: xdpi,\n            ydpi: ydpi,\n            bevelMm: device.bw\n          });\n        }\n\n        console.warn('No DPDB device match.');\n        return null;\n      };\n\n      Dpdb.prototype.ruleMatches_ = function (rule, ua, screenWidth, screenHeight) {\n        if (!rule.ua && !rule.res) return false;\n        if (rule.ua && rule.ua.substring(0, 2) === 'SM') rule.ua = rule.ua.substring(0, 7);\n        if (rule.ua && ua.indexOf(rule.ua) < 0) return false;\n\n        if (rule.res) {\n          if (!rule.res[0] || !rule.res[1]) return false;\n          var resX = rule.res[0];\n          var resY = rule.res[1];\n\n          if (Math.min(screenWidth, screenHeight) != Math.min(resX, resY) || Math.max(screenWidth, screenHeight) != Math.max(resX, resY)) {\n            return false;\n          }\n        }\n\n        return true;\n      };\n\n      function DeviceParams(params) {\n        this.xdpi = params.xdpi;\n        this.ydpi = params.ydpi;\n        this.bevelMm = params.bevelMm;\n      }\n\n      function SensorSample(sample, timestampS) {\n        this.set(sample, timestampS);\n      }\n\n      SensorSample.prototype.set = function (sample, timestampS) {\n        this.sample = sample;\n        this.timestampS = timestampS;\n      };\n\n      SensorSample.prototype.copy = function (sensorSample) {\n        this.set(sensorSample.sample, sensorSample.timestampS);\n      };\n\n      function ComplementaryFilter(kFilter, isDebug) {\n        this.kFilter = kFilter;\n        this.isDebug = isDebug;\n        this.currentAccelMeasurement = new SensorSample();\n        this.currentGyroMeasurement = new SensorSample();\n        this.previousGyroMeasurement = new SensorSample();\n\n        if (isIOS()) {\n          this.filterQ = new Quaternion(-1, 0, 0, 1);\n        } else {\n          this.filterQ = new Quaternion(1, 0, 0, 1);\n        }\n\n        this.previousFilterQ = new Quaternion();\n        this.previousFilterQ.copy(this.filterQ);\n        this.accelQ = new Quaternion();\n        this.isOrientationInitialized = false;\n        this.estimatedGravity = new Vector3();\n        this.measuredGravity = new Vector3();\n        this.gyroIntegralQ = new Quaternion();\n      }\n\n      ComplementaryFilter.prototype.addAccelMeasurement = function (vector, timestampS) {\n        this.currentAccelMeasurement.set(vector, timestampS);\n      };\n\n      ComplementaryFilter.prototype.addGyroMeasurement = function (vector, timestampS) {\n        this.currentGyroMeasurement.set(vector, timestampS);\n        var deltaT = timestampS - this.previousGyroMeasurement.timestampS;\n\n        if (isTimestampDeltaValid(deltaT)) {\n          this.run_();\n        }\n\n        this.previousGyroMeasurement.copy(this.currentGyroMeasurement);\n      };\n\n      ComplementaryFilter.prototype.run_ = function () {\n        if (!this.isOrientationInitialized) {\n          this.accelQ = this.accelToQuaternion_(this.currentAccelMeasurement.sample);\n          this.previousFilterQ.copy(this.accelQ);\n          this.isOrientationInitialized = true;\n          return;\n        }\n\n        var deltaT = this.currentGyroMeasurement.timestampS - this.previousGyroMeasurement.timestampS;\n        var gyroDeltaQ = this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample, deltaT);\n        this.gyroIntegralQ.multiply(gyroDeltaQ);\n        this.filterQ.copy(this.previousFilterQ);\n        this.filterQ.multiply(gyroDeltaQ);\n        var invFilterQ = new Quaternion();\n        invFilterQ.copy(this.filterQ);\n        invFilterQ.inverse();\n        this.estimatedGravity.set(0, 0, -1);\n        this.estimatedGravity.applyQuaternion(invFilterQ);\n        this.estimatedGravity.normalize();\n        this.measuredGravity.copy(this.currentAccelMeasurement.sample);\n        this.measuredGravity.normalize();\n        var deltaQ = new Quaternion();\n        deltaQ.setFromUnitVectors(this.estimatedGravity, this.measuredGravity);\n        deltaQ.inverse();\n\n        if (this.isDebug) {\n          console.log('Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)', radToDeg * getQuaternionAngle(deltaQ), this.estimatedGravity.x.toFixed(1), this.estimatedGravity.y.toFixed(1), this.estimatedGravity.z.toFixed(1), this.measuredGravity.x.toFixed(1), this.measuredGravity.y.toFixed(1), this.measuredGravity.z.toFixed(1));\n        }\n\n        var targetQ = new Quaternion();\n        targetQ.copy(this.filterQ);\n        targetQ.multiply(deltaQ);\n        this.filterQ.slerp(targetQ, 1 - this.kFilter);\n        this.previousFilterQ.copy(this.filterQ);\n      };\n\n      ComplementaryFilter.prototype.getOrientation = function () {\n        return this.filterQ;\n      };\n\n      ComplementaryFilter.prototype.accelToQuaternion_ = function (accel) {\n        var normAccel = new Vector3();\n        normAccel.copy(accel);\n        normAccel.normalize();\n        var quat = new Quaternion();\n        quat.setFromUnitVectors(new Vector3(0, 0, -1), normAccel);\n        quat.inverse();\n        return quat;\n      };\n\n      ComplementaryFilter.prototype.gyroToQuaternionDelta_ = function (gyro, dt) {\n        var quat = new Quaternion();\n        var axis = new Vector3();\n        axis.copy(gyro);\n        axis.normalize();\n        quat.setFromAxisAngle(axis, gyro.length() * dt);\n        return quat;\n      };\n\n      function PosePredictor(predictionTimeS, isDebug) {\n        this.predictionTimeS = predictionTimeS;\n        this.isDebug = isDebug;\n        this.previousQ = new Quaternion();\n        this.previousTimestampS = null;\n        this.deltaQ = new Quaternion();\n        this.outQ = new Quaternion();\n      }\n\n      PosePredictor.prototype.getPrediction = function (currentQ, gyro, timestampS) {\n        if (!this.previousTimestampS) {\n          this.previousQ.copy(currentQ);\n          this.previousTimestampS = timestampS;\n          return currentQ;\n        }\n\n        var axis = new Vector3();\n        axis.copy(gyro);\n        axis.normalize();\n        var angularSpeed = gyro.length();\n\n        if (angularSpeed < degToRad * 20) {\n          if (this.isDebug) {\n            console.log('Moving slowly, at %s deg/s: no prediction', (radToDeg * angularSpeed).toFixed(1));\n          }\n\n          this.outQ.copy(currentQ);\n          this.previousQ.copy(currentQ);\n          return this.outQ;\n        }\n\n        var predictAngle = angularSpeed * this.predictionTimeS;\n        this.deltaQ.setFromAxisAngle(axis, predictAngle);\n        this.outQ.copy(this.previousQ);\n        this.outQ.multiply(this.deltaQ);\n        this.previousQ.copy(currentQ);\n        this.previousTimestampS = timestampS;\n        return this.outQ;\n      };\n\n      function FusionPoseSensor(kFilter, predictionTime, yawOnly, isDebug) {\n        this.yawOnly = yawOnly;\n        this.accelerometer = new Vector3();\n        this.gyroscope = new Vector3();\n        this.filter = new ComplementaryFilter(kFilter, isDebug);\n        this.posePredictor = new PosePredictor(predictionTime, isDebug);\n        this.isFirefoxAndroid = isFirefoxAndroid();\n        this.isIOS = isIOS();\n        var chromeVersion = getChromeVersion();\n        this.isDeviceMotionInRadians = !this.isIOS && chromeVersion && chromeVersion < 66;\n        this.isWithoutDeviceMotion = isChromeWithoutDeviceMotion();\n        this.filterToWorldQ = new Quaternion();\n\n        if (isIOS()) {\n          this.filterToWorldQ.setFromAxisAngle(new Vector3(1, 0, 0), Math.PI / 2);\n        } else {\n          this.filterToWorldQ.setFromAxisAngle(new Vector3(1, 0, 0), -Math.PI / 2);\n        }\n\n        this.inverseWorldToScreenQ = new Quaternion();\n        this.worldToScreenQ = new Quaternion();\n        this.originalPoseAdjustQ = new Quaternion();\n        this.originalPoseAdjustQ.setFromAxisAngle(new Vector3(0, 0, 1), -window.orientation * Math.PI / 180);\n        this.setScreenTransform_();\n\n        if (isLandscapeMode()) {\n          this.filterToWorldQ.multiply(this.inverseWorldToScreenQ);\n        }\n\n        this.resetQ = new Quaternion();\n        this.orientationOut_ = new Float32Array(4);\n        this.start();\n      }\n\n      FusionPoseSensor.prototype.getPosition = function () {\n        return null;\n      };\n\n      FusionPoseSensor.prototype.getOrientation = function () {\n        var orientation = void 0;\n\n        if (this.isWithoutDeviceMotion && this._deviceOrientationQ) {\n          this.deviceOrientationFixQ = this.deviceOrientationFixQ || function () {\n            var z = new Quaternion().setFromAxisAngle(new Vector3(0, 0, -1), 0);\n            var y = new Quaternion();\n\n            if (window.orientation === -90) {\n              y.setFromAxisAngle(new Vector3(0, 1, 0), Math.PI / -2);\n            } else {\n              y.setFromAxisAngle(new Vector3(0, 1, 0), Math.PI / 2);\n            }\n\n            return z.multiply(y);\n          }();\n\n          this.deviceOrientationFilterToWorldQ = this.deviceOrientationFilterToWorldQ || function () {\n            var q = new Quaternion();\n            q.setFromAxisAngle(new Vector3(1, 0, 0), -Math.PI / 2);\n            return q;\n          }();\n\n          orientation = this._deviceOrientationQ;\n          var out = new Quaternion();\n          out.copy(orientation);\n          out.multiply(this.deviceOrientationFilterToWorldQ);\n          out.multiply(this.resetQ);\n          out.multiply(this.worldToScreenQ);\n          out.multiplyQuaternions(this.deviceOrientationFixQ, out);\n\n          if (this.yawOnly) {\n            out.x = 0;\n            out.z = 0;\n            out.normalize();\n          }\n\n          this.orientationOut_[0] = out.x;\n          this.orientationOut_[1] = out.y;\n          this.orientationOut_[2] = out.z;\n          this.orientationOut_[3] = out.w;\n          return this.orientationOut_;\n        } else {\n          var filterOrientation = this.filter.getOrientation();\n          orientation = this.posePredictor.getPrediction(filterOrientation, this.gyroscope, this.previousTimestampS);\n        }\n\n        var out = new Quaternion();\n        out.copy(this.filterToWorldQ);\n        out.multiply(this.resetQ);\n        out.multiply(orientation);\n        out.multiply(this.worldToScreenQ);\n\n        if (this.yawOnly) {\n          out.x = 0;\n          out.z = 0;\n          out.normalize();\n        }\n\n        this.orientationOut_[0] = out.x;\n        this.orientationOut_[1] = out.y;\n        this.orientationOut_[2] = out.z;\n        this.orientationOut_[3] = out.w;\n        return this.orientationOut_;\n      };\n\n      FusionPoseSensor.prototype.resetPose = function () {\n        this.resetQ.copy(this.filter.getOrientation());\n        this.resetQ.x = 0;\n        this.resetQ.y = 0;\n        this.resetQ.z *= -1;\n        this.resetQ.normalize();\n\n        if (isLandscapeMode()) {\n          this.resetQ.multiply(this.inverseWorldToScreenQ);\n        }\n\n        this.resetQ.multiply(this.originalPoseAdjustQ);\n      };\n\n      FusionPoseSensor.prototype.onDeviceOrientation_ = function (e) {\n        this._deviceOrientationQ = this._deviceOrientationQ || new Quaternion();\n        var alpha = e.alpha,\n            beta = e.beta,\n            gamma = e.gamma;\n        alpha = (alpha || 0) * Math.PI / 180;\n        beta = (beta || 0) * Math.PI / 180;\n        gamma = (gamma || 0) * Math.PI / 180;\n\n        this._deviceOrientationQ.setFromEulerYXZ(beta, alpha, -gamma);\n      };\n\n      FusionPoseSensor.prototype.onDeviceMotion_ = function (deviceMotion) {\n        this.updateDeviceMotion_(deviceMotion);\n      };\n\n      FusionPoseSensor.prototype.updateDeviceMotion_ = function (deviceMotion) {\n        var accGravity = deviceMotion.accelerationIncludingGravity;\n        var rotRate = deviceMotion.rotationRate;\n        var timestampS = deviceMotion.timeStamp / 1000;\n        var deltaS = timestampS - this.previousTimestampS;\n\n        if (deltaS < 0) {\n          warnOnce('fusion-pose-sensor:invalid:non-monotonic', 'Invalid timestamps detected: non-monotonic timestamp from devicemotion');\n          this.previousTimestampS = timestampS;\n          return;\n        } else if (deltaS <= MIN_TIMESTEP || deltaS > MAX_TIMESTEP) {\n          warnOnce('fusion-pose-sensor:invalid:outside-threshold', 'Invalid timestamps detected: Timestamp from devicemotion outside expected range.');\n          this.previousTimestampS = timestampS;\n          return;\n        }\n\n        this.accelerometer.set(-accGravity.x, -accGravity.y, -accGravity.z);\n\n        if (isR7()) {\n          this.gyroscope.set(-rotRate.beta, rotRate.alpha, rotRate.gamma);\n        } else {\n          this.gyroscope.set(rotRate.alpha, rotRate.beta, rotRate.gamma);\n        }\n\n        if (!this.isDeviceMotionInRadians) {\n          this.gyroscope.multiplyScalar(Math.PI / 180);\n        }\n\n        this.filter.addAccelMeasurement(this.accelerometer, timestampS);\n        this.filter.addGyroMeasurement(this.gyroscope, timestampS);\n        this.previousTimestampS = timestampS;\n      };\n\n      FusionPoseSensor.prototype.onOrientationChange_ = function (screenOrientation) {\n        this.setScreenTransform_();\n      };\n\n      FusionPoseSensor.prototype.onMessage_ = function (event) {\n        var message = event.data;\n\n        if (!message || !message.type) {\n          return;\n        }\n\n        var type = message.type.toLowerCase();\n\n        if (type !== 'devicemotion') {\n          return;\n        }\n\n        this.updateDeviceMotion_(message.deviceMotionEvent);\n      };\n\n      FusionPoseSensor.prototype.setScreenTransform_ = function () {\n        this.worldToScreenQ.set(0, 0, 0, 1);\n\n        switch (window.orientation) {\n          case 0:\n            break;\n\n          case 90:\n            this.worldToScreenQ.setFromAxisAngle(new Vector3(0, 0, 1), -Math.PI / 2);\n            break;\n\n          case -90:\n            this.worldToScreenQ.setFromAxisAngle(new Vector3(0, 0, 1), Math.PI / 2);\n            break;\n\n          case 180:\n            break;\n        }\n\n        this.inverseWorldToScreenQ.copy(this.worldToScreenQ);\n        this.inverseWorldToScreenQ.inverse();\n      };\n\n      FusionPoseSensor.prototype.start = function () {\n        this.onDeviceMotionCallback_ = this.onDeviceMotion_.bind(this);\n        this.onOrientationChangeCallback_ = this.onOrientationChange_.bind(this);\n        this.onMessageCallback_ = this.onMessage_.bind(this);\n        this.onDeviceOrientationCallback_ = this.onDeviceOrientation_.bind(this);\n\n        if (isIOS() && isInsideCrossOriginIFrame()) {\n          window.addEventListener('message', this.onMessageCallback_);\n        }\n\n        window.addEventListener('orientationchange', this.onOrientationChangeCallback_);\n\n        if (this.isWithoutDeviceMotion) {\n          window.addEventListener('deviceorientation', this.onDeviceOrientationCallback_);\n        } else {\n          window.addEventListener('devicemotion', this.onDeviceMotionCallback_);\n        }\n      };\n\n      FusionPoseSensor.prototype.stop = function () {\n        window.removeEventListener('devicemotion', this.onDeviceMotionCallback_);\n        window.removeEventListener('deviceorientation', this.onDeviceOrientationCallback_);\n        window.removeEventListener('orientationchange', this.onOrientationChangeCallback_);\n        window.removeEventListener('message', this.onMessageCallback_);\n      };\n\n      var SENSOR_FREQUENCY = 60;\n      var X_AXIS = new Vector3(1, 0, 0);\n      var Z_AXIS = new Vector3(0, 0, 1);\n      var SENSOR_TO_VR = new Quaternion();\n      SENSOR_TO_VR.setFromAxisAngle(X_AXIS, -Math.PI / 2);\n      SENSOR_TO_VR.multiply(new Quaternion().setFromAxisAngle(Z_AXIS, Math.PI / 2));\n\n      var PoseSensor = function () {\n        function PoseSensor(config) {\n          classCallCheck(this, PoseSensor);\n          this.config = config;\n          this.sensor = null;\n          this.fusionSensor = null;\n          this._out = new Float32Array(4);\n          this.api = null;\n          this.errors = [];\n          this._sensorQ = new Quaternion();\n          this._outQ = new Quaternion();\n          this._onSensorRead = this._onSensorRead.bind(this);\n          this._onSensorError = this._onSensorError.bind(this);\n          this.init();\n        }\n\n        createClass(PoseSensor, [{\n          key: 'init',\n          value: function init() {\n            var sensor = null;\n\n            try {\n              sensor = new RelativeOrientationSensor({\n                frequency: SENSOR_FREQUENCY,\n                referenceFrame: 'screen'\n              });\n              sensor.addEventListener('error', this._onSensorError);\n            } catch (error) {\n              this.errors.push(error);\n\n              if (error.name === 'SecurityError') {\n                console.error('Cannot construct sensors due to the Feature Policy');\n                console.warn('Attempting to fall back using \"devicemotion\"; however this will ' + 'fail in the future without correct permissions.');\n                this.useDeviceMotion();\n              } else if (error.name === 'ReferenceError') {\n                this.useDeviceMotion();\n              } else {\n                console.error(error);\n              }\n            }\n\n            if (sensor) {\n              this.api = 'sensor';\n              this.sensor = sensor;\n              this.sensor.addEventListener('reading', this._onSensorRead);\n              this.sensor.start();\n            }\n          }\n        }, {\n          key: 'useDeviceMotion',\n          value: function useDeviceMotion() {\n            this.api = 'devicemotion';\n            this.fusionSensor = new FusionPoseSensor(this.config.K_FILTER, this.config.PREDICTION_TIME_S, this.config.YAW_ONLY, this.config.DEBUG);\n\n            if (this.sensor) {\n              this.sensor.removeEventListener('reading', this._onSensorRead);\n              this.sensor.removeEventListener('error', this._onSensorError);\n              this.sensor = null;\n            }\n          }\n        }, {\n          key: 'getOrientation',\n          value: function getOrientation() {\n            if (this.fusionSensor) {\n              return this.fusionSensor.getOrientation();\n            }\n\n            if (!this.sensor || !this.sensor.quaternion) {\n              this._out[0] = this._out[1] = this._out[2] = 0;\n              this._out[3] = 1;\n              return this._out;\n            }\n\n            var q = this.sensor.quaternion;\n\n            this._sensorQ.set(q[0], q[1], q[2], q[3]);\n\n            var out = this._outQ;\n            out.copy(SENSOR_TO_VR);\n            out.multiply(this._sensorQ);\n\n            if (this.config.YAW_ONLY) {\n              out.x = out.z = 0;\n              out.normalize();\n            }\n\n            this._out[0] = out.x;\n            this._out[1] = out.y;\n            this._out[2] = out.z;\n            this._out[3] = out.w;\n            return this._out;\n          }\n        }, {\n          key: '_onSensorError',\n          value: function _onSensorError(event) {\n            this.errors.push(event.error);\n\n            if (event.error.name === 'NotAllowedError') {\n              console.error('Permission to access sensor was denied');\n            } else if (event.error.name === 'NotReadableError') {\n              console.error('Sensor could not be read');\n            } else {\n              console.error(event.error);\n            }\n\n            this.useDeviceMotion();\n          }\n        }, {\n          key: '_onSensorRead',\n          value: function _onSensorRead() {}\n        }]);\n        return PoseSensor;\n      }();\n\n      var rotateInstructionsAsset = \"<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>\";\n\n      function RotateInstructions() {\n        this.loadIcon_();\n        var overlay = document.createElement('div');\n        var s = overlay.style;\n        s.position = 'fixed';\n        s.top = 0;\n        s.right = 0;\n        s.bottom = 0;\n        s.left = 0;\n        s.backgroundColor = 'gray';\n        s.fontFamily = 'sans-serif';\n        s.zIndex = 1000000;\n        var img = document.createElement('img');\n        img.src = this.icon;\n        var s = img.style;\n        s.marginLeft = '25%';\n        s.marginTop = '25%';\n        s.width = '50%';\n        overlay.appendChild(img);\n        var text = document.createElement('div');\n        var s = text.style;\n        s.textAlign = 'center';\n        s.fontSize = '16px';\n        s.lineHeight = '24px';\n        s.margin = '24px 25%';\n        s.width = '50%';\n        text.innerHTML = 'Place your phone into your Cardboard viewer.';\n        overlay.appendChild(text);\n        var snackbar = document.createElement('div');\n        var s = snackbar.style;\n        s.backgroundColor = '#CFD8DC';\n        s.position = 'fixed';\n        s.bottom = 0;\n        s.width = '100%';\n        s.height = '48px';\n        s.padding = '14px 24px';\n        s.boxSizing = 'border-box';\n        s.color = '#656A6B';\n        overlay.appendChild(snackbar);\n        var snackbarText = document.createElement('div');\n        snackbarText.style.float = 'left';\n        snackbarText.innerHTML = 'No Cardboard viewer?';\n        var snackbarButton = document.createElement('a');\n        snackbarButton.href = 'https://www.google.com/get/cardboard/get-cardboard/';\n        snackbarButton.innerHTML = 'get one';\n        snackbarButton.target = '_blank';\n        var s = snackbarButton.style;\n        s.float = 'right';\n        s.fontWeight = 600;\n        s.textTransform = 'uppercase';\n        s.borderLeft = '1px solid gray';\n        s.paddingLeft = '24px';\n        s.textDecoration = 'none';\n        s.color = '#656A6B';\n        snackbar.appendChild(snackbarText);\n        snackbar.appendChild(snackbarButton);\n        this.overlay = overlay;\n        this.text = text;\n        this.hide();\n      }\n\n      RotateInstructions.prototype.show = function (parent) {\n        if (!parent && !this.overlay.parentElement) {\n          document.body.appendChild(this.overlay);\n        } else if (parent) {\n          if (this.overlay.parentElement && this.overlay.parentElement != parent) this.overlay.parentElement.removeChild(this.overlay);\n          parent.appendChild(this.overlay);\n        }\n\n        this.overlay.style.display = 'block';\n        var img = this.overlay.querySelector('img');\n        var s = img.style;\n\n        if (isLandscapeMode()) {\n          s.width = '20%';\n          s.marginLeft = '40%';\n          s.marginTop = '3%';\n        } else {\n          s.width = '50%';\n          s.marginLeft = '25%';\n          s.marginTop = '25%';\n        }\n      };\n\n      RotateInstructions.prototype.hide = function () {\n        this.overlay.style.display = 'none';\n      };\n\n      RotateInstructions.prototype.showTemporarily = function (ms, parent) {\n        this.show(parent);\n        this.timer = setTimeout(this.hide.bind(this), ms);\n      };\n\n      RotateInstructions.prototype.disableShowTemporarily = function () {\n        clearTimeout(this.timer);\n      };\n\n      RotateInstructions.prototype.update = function () {\n        this.disableShowTemporarily();\n\n        if (!isLandscapeMode() && isMobile()) {\n          this.show();\n        } else {\n          this.hide();\n        }\n      };\n\n      RotateInstructions.prototype.loadIcon_ = function () {\n        this.icon = dataUri('image/svg+xml', rotateInstructionsAsset);\n      };\n\n      var DEFAULT_VIEWER = 'CardboardV1';\n      var VIEWER_KEY = 'WEBVR_CARDBOARD_VIEWER';\n      var CLASS_NAME = 'webvr-polyfill-viewer-selector';\n\n      function ViewerSelector(defaultViewer) {\n        try {\n          this.selectedKey = localStorage.getItem(VIEWER_KEY);\n        } catch (error) {\n          console.error('Failed to load viewer profile: %s', error);\n        }\n\n        if (!this.selectedKey) {\n          this.selectedKey = defaultViewer || DEFAULT_VIEWER;\n        }\n\n        this.dialog = this.createDialog_(DeviceInfo.Viewers);\n        this.root = null;\n        this.onChangeCallbacks_ = [];\n      }\n\n      ViewerSelector.prototype.show = function (root) {\n        this.root = root;\n        root.appendChild(this.dialog);\n        var selected = this.dialog.querySelector('#' + this.selectedKey);\n        selected.checked = true;\n        this.dialog.style.display = 'block';\n      };\n\n      ViewerSelector.prototype.hide = function () {\n        if (this.root && this.root.contains(this.dialog)) {\n          this.root.removeChild(this.dialog);\n        }\n\n        this.dialog.style.display = 'none';\n      };\n\n      ViewerSelector.prototype.getCurrentViewer = function () {\n        return DeviceInfo.Viewers[this.selectedKey];\n      };\n\n      ViewerSelector.prototype.getSelectedKey_ = function () {\n        var input = this.dialog.querySelector('input[name=field]:checked');\n\n        if (input) {\n          return input.id;\n        }\n\n        return null;\n      };\n\n      ViewerSelector.prototype.onChange = function (cb) {\n        this.onChangeCallbacks_.push(cb);\n      };\n\n      ViewerSelector.prototype.fireOnChange_ = function (viewer) {\n        for (var i = 0; i < this.onChangeCallbacks_.length; i++) {\n          this.onChangeCallbacks_[i](viewer);\n        }\n      };\n\n      ViewerSelector.prototype.onSave_ = function () {\n        this.selectedKey = this.getSelectedKey_();\n\n        if (!this.selectedKey || !DeviceInfo.Viewers[this.selectedKey]) {\n          console.error('ViewerSelector.onSave_: this should never happen!');\n          return;\n        }\n\n        this.fireOnChange_(DeviceInfo.Viewers[this.selectedKey]);\n\n        try {\n          localStorage.setItem(VIEWER_KEY, this.selectedKey);\n        } catch (error) {\n          console.error('Failed to save viewer profile: %s', error);\n        }\n\n        this.hide();\n      };\n\n      ViewerSelector.prototype.createDialog_ = function (options) {\n        var container = document.createElement('div');\n        container.classList.add(CLASS_NAME);\n        container.style.display = 'none';\n        var overlay = document.createElement('div');\n        var s = overlay.style;\n        s.position = 'fixed';\n        s.left = 0;\n        s.top = 0;\n        s.width = '100%';\n        s.height = '100%';\n        s.background = 'rgba(0, 0, 0, 0.3)';\n        overlay.addEventListener('click', this.hide.bind(this));\n        var width = 280;\n        var dialog = document.createElement('div');\n        var s = dialog.style;\n        s.boxSizing = 'border-box';\n        s.position = 'fixed';\n        s.top = '24px';\n        s.left = '50%';\n        s.marginLeft = -width / 2 + 'px';\n        s.width = width + 'px';\n        s.padding = '24px';\n        s.overflow = 'hidden';\n        s.background = '#fafafa';\n        s.fontFamily = \"'Roboto', sans-serif\";\n        s.boxShadow = '0px 5px 20px #666';\n        dialog.appendChild(this.createH1_('Select your viewer'));\n\n        for (var id in options) {\n          dialog.appendChild(this.createChoice_(id, options[id].label));\n        }\n\n        dialog.appendChild(this.createButton_('Save', this.onSave_.bind(this)));\n        container.appendChild(overlay);\n        container.appendChild(dialog);\n        return container;\n      };\n\n      ViewerSelector.prototype.createH1_ = function (name) {\n        var h1 = document.createElement('h1');\n        var s = h1.style;\n        s.color = 'black';\n        s.fontSize = '20px';\n        s.fontWeight = 'bold';\n        s.marginTop = 0;\n        s.marginBottom = '24px';\n        h1.innerHTML = name;\n        return h1;\n      };\n\n      ViewerSelector.prototype.createChoice_ = function (id, name) {\n        var div = document.createElement('div');\n        div.style.marginTop = '8px';\n        div.style.color = 'black';\n        var input = document.createElement('input');\n        input.style.fontSize = '30px';\n        input.setAttribute('id', id);\n        input.setAttribute('type', 'radio');\n        input.setAttribute('value', id);\n        input.setAttribute('name', 'field');\n        var label = document.createElement('label');\n        label.style.marginLeft = '4px';\n        label.setAttribute('for', id);\n        label.innerHTML = name;\n        div.appendChild(input);\n        div.appendChild(label);\n        return div;\n      };\n\n      ViewerSelector.prototype.createButton_ = function (label, onclick) {\n        var button = document.createElement('button');\n        button.innerHTML = label;\n        var s = button.style;\n        s.float = 'right';\n        s.textTransform = 'uppercase';\n        s.color = '#1094f7';\n        s.fontSize = '14px';\n        s.letterSpacing = 0;\n        s.border = 0;\n        s.background = 'none';\n        s.marginTop = '16px';\n        button.addEventListener('click', onclick);\n        return button;\n      };\n\n      var commonjsGlobal$$1 = typeof window !== 'undefined' ? window : typeof commonjsGlobal !== 'undefined' ? commonjsGlobal : typeof self !== 'undefined' ? self : {};\n\n      function unwrapExports$$1(x) {\n        return x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n      }\n\n      function createCommonjsModule$$1(fn, module) {\n        return module = {\n          exports: {}\n        }, fn(module, module.exports), module.exports;\n      }\n\n      var NoSleep = createCommonjsModule$$1(function (module, exports) {\n        (function webpackUniversalModuleDefinition(root, factory) {\n          module.exports = factory();\n        })(commonjsGlobal$$1, function () {\n          return function (modules) {\n            var installedModules = {};\n\n            function __webpack_require__(moduleId) {\n              if (installedModules[moduleId]) {\n                return installedModules[moduleId].exports;\n              }\n\n              var module = installedModules[moduleId] = {\n                i: moduleId,\n                l: false,\n                exports: {}\n              };\n              modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n              module.l = true;\n              return module.exports;\n            }\n\n            __webpack_require__.m = modules;\n            __webpack_require__.c = installedModules;\n\n            __webpack_require__.d = function (exports, name, getter) {\n              if (!__webpack_require__.o(exports, name)) {\n                Object.defineProperty(exports, name, {\n                  configurable: false,\n                  enumerable: true,\n                  get: getter\n                });\n              }\n            };\n\n            __webpack_require__.n = function (module) {\n              var getter = module && module.__esModule ? function getDefault() {\n                return module['default'];\n              } : function getModuleExports() {\n                return module;\n              };\n\n              __webpack_require__.d(getter, 'a', getter);\n\n              return getter;\n            };\n\n            __webpack_require__.o = function (object, property) {\n              return Object.prototype.hasOwnProperty.call(object, property);\n            };\n\n            __webpack_require__.p = \"\";\n            return __webpack_require__(__webpack_require__.s = 0);\n          }([function (module, exports, __webpack_require__) {\n            var _createClass = function () {\n              function defineProperties(target, props) {\n                for (var i = 0; i < props.length; i++) {\n                  var descriptor = props[i];\n                  descriptor.enumerable = descriptor.enumerable || false;\n                  descriptor.configurable = true;\n                  if (\"value\" in descriptor) descriptor.writable = true;\n                  Object.defineProperty(target, descriptor.key, descriptor);\n                }\n              }\n\n              return function (Constructor, protoProps, staticProps) {\n                if (protoProps) defineProperties(Constructor.prototype, protoProps);\n                if (staticProps) defineProperties(Constructor, staticProps);\n                return Constructor;\n              };\n            }();\n\n            function _classCallCheck(instance, Constructor) {\n              if (!(instance instanceof Constructor)) {\n                throw new TypeError(\"Cannot call a class as a function\");\n              }\n            }\n\n            var mediaFile = __webpack_require__(1);\n\n            var oldIOS = typeof navigator !== 'undefined' && parseFloat(('' + (/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0, ''])[1]).replace('undefined', '3_2').replace('_', '.').replace('_', '')) < 10 && !window.MSStream;\n\n            var NoSleep = function () {\n              function NoSleep() {\n                _classCallCheck(this, NoSleep);\n\n                if (oldIOS) {\n                  this.noSleepTimer = null;\n                } else {\n                  this.noSleepVideo = document.createElement('video');\n                  this.noSleepVideo.setAttribute('playsinline', '');\n                  this.noSleepVideo.setAttribute('src', mediaFile);\n                  this.noSleepVideo.addEventListener('timeupdate', function (e) {\n                    if (this.noSleepVideo.currentTime > 0.5) {\n                      this.noSleepVideo.currentTime = Math.random();\n                    }\n                  }.bind(this));\n                }\n              }\n\n              _createClass(NoSleep, [{\n                key: 'enable',\n                value: function enable() {\n                  if (oldIOS) {\n                    this.disable();\n                    this.noSleepTimer = window.setInterval(function () {\n                      window.location.href = '/';\n                      window.setTimeout(window.stop, 0);\n                    }, 15000);\n                  } else {\n                    this.noSleepVideo.play();\n                  }\n                }\n              }, {\n                key: 'disable',\n                value: function disable() {\n                  if (oldIOS) {\n                    if (this.noSleepTimer) {\n                      window.clearInterval(this.noSleepTimer);\n                      this.noSleepTimer = null;\n                    }\n                  } else {\n                    this.noSleepVideo.pause();\n                  }\n                }\n              }]);\n\n              return NoSleep;\n            }();\n\n            module.exports = NoSleep;\n          }, function (module, exports, __webpack_require__) {\n            module.exports = 'data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQAD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';\n          }]);\n        });\n      });\n      var NoSleep$1 = unwrapExports$$1(NoSleep);\n      var nextDisplayId = 1000;\n      var defaultLeftBounds = [0, 0, 0.5, 1];\n      var defaultRightBounds = [0.5, 0, 0.5, 1];\n      var raf = window.requestAnimationFrame;\n      var caf = window.cancelAnimationFrame;\n\n      function VRFrameData() {\n        this.leftProjectionMatrix = new Float32Array(16);\n        this.leftViewMatrix = new Float32Array(16);\n        this.rightProjectionMatrix = new Float32Array(16);\n        this.rightViewMatrix = new Float32Array(16);\n        this.pose = null;\n      }\n\n      function VRDisplayCapabilities(config) {\n        Object.defineProperties(this, {\n          hasPosition: {\n            writable: false,\n            enumerable: true,\n            value: config.hasPosition\n          },\n          hasExternalDisplay: {\n            writable: false,\n            enumerable: true,\n            value: config.hasExternalDisplay\n          },\n          canPresent: {\n            writable: false,\n            enumerable: true,\n            value: config.canPresent\n          },\n          maxLayers: {\n            writable: false,\n            enumerable: true,\n            value: config.maxLayers\n          },\n          hasOrientation: {\n            enumerable: true,\n            get: function get() {\n              deprecateWarning('VRDisplayCapabilities.prototype.hasOrientation', 'VRDisplay.prototype.getFrameData');\n              return config.hasOrientation;\n            }\n          }\n        });\n      }\n\n      function VRDisplay(config) {\n        config = config || {};\n        var USE_WAKELOCK = 'wakelock' in config ? config.wakelock : true;\n        this.isPolyfilled = true;\n        this.displayId = nextDisplayId++;\n        this.displayName = '';\n        this.depthNear = 0.01;\n        this.depthFar = 10000.0;\n        this.isPresenting = false;\n        Object.defineProperty(this, 'isConnected', {\n          get: function get() {\n            deprecateWarning('VRDisplay.prototype.isConnected', 'VRDisplayCapabilities.prototype.hasExternalDisplay');\n            return false;\n          }\n        });\n        this.capabilities = new VRDisplayCapabilities({\n          hasPosition: false,\n          hasOrientation: false,\n          hasExternalDisplay: false,\n          canPresent: false,\n          maxLayers: 1\n        });\n        this.stageParameters = null;\n        this.waitingForPresent_ = false;\n        this.layer_ = null;\n        this.originalParent_ = null;\n        this.fullscreenElement_ = null;\n        this.fullscreenWrapper_ = null;\n        this.fullscreenElementCachedStyle_ = null;\n        this.fullscreenEventTarget_ = null;\n        this.fullscreenChangeHandler_ = null;\n        this.fullscreenErrorHandler_ = null;\n\n        if (USE_WAKELOCK && isMobile()) {\n          this.wakelock_ = new NoSleep$1();\n        }\n      }\n\n      VRDisplay.prototype.getFrameData = function (frameData) {\n        return frameDataFromPose(frameData, this._getPose(), this);\n      };\n\n      VRDisplay.prototype.getPose = function () {\n        deprecateWarning('VRDisplay.prototype.getPose', 'VRDisplay.prototype.getFrameData');\n        return this._getPose();\n      };\n\n      VRDisplay.prototype.resetPose = function () {\n        deprecateWarning('VRDisplay.prototype.resetPose');\n        return this._resetPose();\n      };\n\n      VRDisplay.prototype.getImmediatePose = function () {\n        deprecateWarning('VRDisplay.prototype.getImmediatePose', 'VRDisplay.prototype.getFrameData');\n        return this._getPose();\n      };\n\n      VRDisplay.prototype.requestAnimationFrame = function (callback) {\n        return raf(callback);\n      };\n\n      VRDisplay.prototype.cancelAnimationFrame = function (id) {\n        return caf(id);\n      };\n\n      VRDisplay.prototype.wrapForFullscreen = function (element) {\n        if (isIOS()) {\n          return element;\n        }\n\n        if (!this.fullscreenWrapper_) {\n          this.fullscreenWrapper_ = document.createElement('div');\n          var cssProperties = ['height: ' + Math.min(screen.height, screen.width) + 'px !important', 'top: 0 !important', 'left: 0 !important', 'right: 0 !important', 'border: 0', 'margin: 0', 'padding: 0', 'z-index: 999999 !important', 'position: fixed'];\n          this.fullscreenWrapper_.setAttribute('style', cssProperties.join('; ') + ';');\n          this.fullscreenWrapper_.classList.add('webvr-polyfill-fullscreen-wrapper');\n        }\n\n        if (this.fullscreenElement_ == element) {\n          return this.fullscreenWrapper_;\n        }\n\n        if (this.fullscreenElement_) {\n          if (this.originalParent_) {\n            this.originalParent_.appendChild(this.fullscreenElement_);\n          } else {\n            this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_);\n          }\n        }\n\n        this.fullscreenElement_ = element;\n        this.originalParent_ = element.parentElement;\n\n        if (!this.originalParent_) {\n          document.body.appendChild(element);\n        }\n\n        if (!this.fullscreenWrapper_.parentElement) {\n          var parent = this.fullscreenElement_.parentElement;\n          parent.insertBefore(this.fullscreenWrapper_, this.fullscreenElement_);\n          parent.removeChild(this.fullscreenElement_);\n        }\n\n        this.fullscreenWrapper_.insertBefore(this.fullscreenElement_, this.fullscreenWrapper_.firstChild);\n        this.fullscreenElementCachedStyle_ = this.fullscreenElement_.getAttribute('style');\n        var self = this;\n\n        function applyFullscreenElementStyle() {\n          if (!self.fullscreenElement_) {\n            return;\n          }\n\n          var cssProperties = ['position: absolute', 'top: 0', 'left: 0', 'width: ' + Math.max(screen.width, screen.height) + 'px', 'height: ' + Math.min(screen.height, screen.width) + 'px', 'border: 0', 'margin: 0', 'padding: 0'];\n          self.fullscreenElement_.setAttribute('style', cssProperties.join('; ') + ';');\n        }\n\n        applyFullscreenElementStyle();\n        return this.fullscreenWrapper_;\n      };\n\n      VRDisplay.prototype.removeFullscreenWrapper = function () {\n        if (!this.fullscreenElement_) {\n          return;\n        }\n\n        var element = this.fullscreenElement_;\n\n        if (this.fullscreenElementCachedStyle_) {\n          element.setAttribute('style', this.fullscreenElementCachedStyle_);\n        } else {\n          element.removeAttribute('style');\n        }\n\n        this.fullscreenElement_ = null;\n        this.fullscreenElementCachedStyle_ = null;\n        var parent = this.fullscreenWrapper_.parentElement;\n        this.fullscreenWrapper_.removeChild(element);\n\n        if (this.originalParent_ === parent) {\n          parent.insertBefore(element, this.fullscreenWrapper_);\n        } else if (this.originalParent_) {\n          this.originalParent_.appendChild(element);\n        }\n\n        parent.removeChild(this.fullscreenWrapper_);\n        return element;\n      };\n\n      VRDisplay.prototype.requestPresent = function (layers) {\n        var wasPresenting = this.isPresenting;\n        var self = this;\n\n        if (!(layers instanceof Array)) {\n          deprecateWarning('VRDisplay.prototype.requestPresent with non-array argument', 'an array of VRLayers as the first argument');\n          layers = [layers];\n        }\n\n        return new Promise(function (resolve, reject) {\n          if (!self.capabilities.canPresent) {\n            reject(new Error('VRDisplay is not capable of presenting.'));\n            return;\n          }\n\n          if (layers.length == 0 || layers.length > self.capabilities.maxLayers) {\n            reject(new Error('Invalid number of layers.'));\n            return;\n          }\n\n          var incomingLayer = layers[0];\n\n          if (!incomingLayer.source) {\n            resolve();\n            return;\n          }\n\n          var leftBounds = incomingLayer.leftBounds || defaultLeftBounds;\n          var rightBounds = incomingLayer.rightBounds || defaultRightBounds;\n\n          if (wasPresenting) {\n            var layer = self.layer_;\n\n            if (layer.source !== incomingLayer.source) {\n              layer.source = incomingLayer.source;\n            }\n\n            for (var i = 0; i < 4; i++) {\n              layer.leftBounds[i] = leftBounds[i];\n              layer.rightBounds[i] = rightBounds[i];\n            }\n\n            self.wrapForFullscreen(self.layer_.source);\n            self.updatePresent_();\n            resolve();\n            return;\n          }\n\n          self.layer_ = {\n            predistorted: incomingLayer.predistorted,\n            source: incomingLayer.source,\n            leftBounds: leftBounds.slice(0),\n            rightBounds: rightBounds.slice(0)\n          };\n          self.waitingForPresent_ = false;\n\n          if (self.layer_ && self.layer_.source) {\n            var fullscreenElement = self.wrapForFullscreen(self.layer_.source);\n\n            var onFullscreenChange = function onFullscreenChange() {\n              var actualFullscreenElement = getFullscreenElement();\n              self.isPresenting = fullscreenElement === actualFullscreenElement;\n\n              if (self.isPresenting) {\n                if (screen.orientation && screen.orientation.lock) {\n                  screen.orientation.lock('landscape-primary').catch(function (error) {\n                    console.error('screen.orientation.lock() failed due to', error.message);\n                  });\n                }\n\n                self.waitingForPresent_ = false;\n                self.beginPresent_();\n                resolve();\n              } else {\n                if (screen.orientation && screen.orientation.unlock) {\n                  screen.orientation.unlock();\n                }\n\n                self.removeFullscreenWrapper();\n                self.disableWakeLock();\n                self.endPresent_();\n                self.removeFullscreenListeners_();\n              }\n\n              self.fireVRDisplayPresentChange_();\n            };\n\n            var onFullscreenError = function onFullscreenError() {\n              if (!self.waitingForPresent_) {\n                return;\n              }\n\n              self.removeFullscreenWrapper();\n              self.removeFullscreenListeners_();\n              self.disableWakeLock();\n              self.waitingForPresent_ = false;\n              self.isPresenting = false;\n              reject(new Error('Unable to present.'));\n            };\n\n            self.addFullscreenListeners_(fullscreenElement, onFullscreenChange, onFullscreenError);\n\n            if (requestFullscreen(fullscreenElement)) {\n              self.enableWakeLock();\n              self.waitingForPresent_ = true;\n            } else if (isIOS() || isWebViewAndroid()) {\n              self.enableWakeLock();\n              self.isPresenting = true;\n              self.beginPresent_();\n              self.fireVRDisplayPresentChange_();\n              resolve();\n            }\n          }\n\n          if (!self.waitingForPresent_ && !isIOS()) {\n            exitFullscreen();\n            reject(new Error('Unable to present.'));\n          }\n        });\n      };\n\n      VRDisplay.prototype.exitPresent = function () {\n        var wasPresenting = this.isPresenting;\n        var self = this;\n        this.isPresenting = false;\n        this.layer_ = null;\n        this.disableWakeLock();\n        return new Promise(function (resolve, reject) {\n          if (wasPresenting) {\n            if (!exitFullscreen() && isIOS()) {\n              self.endPresent_();\n              self.fireVRDisplayPresentChange_();\n            }\n\n            if (isWebViewAndroid()) {\n              self.removeFullscreenWrapper();\n              self.removeFullscreenListeners_();\n              self.endPresent_();\n              self.fireVRDisplayPresentChange_();\n            }\n\n            resolve();\n          } else {\n            reject(new Error('Was not presenting to VRDisplay.'));\n          }\n        });\n      };\n\n      VRDisplay.prototype.getLayers = function () {\n        if (this.layer_) {\n          return [this.layer_];\n        }\n\n        return [];\n      };\n\n      VRDisplay.prototype.fireVRDisplayPresentChange_ = function () {\n        var event = new CustomEvent('vrdisplaypresentchange', {\n          detail: {\n            display: this\n          }\n        });\n        window.dispatchEvent(event);\n      };\n\n      VRDisplay.prototype.fireVRDisplayConnect_ = function () {\n        var event = new CustomEvent('vrdisplayconnect', {\n          detail: {\n            display: this\n          }\n        });\n        window.dispatchEvent(event);\n      };\n\n      VRDisplay.prototype.addFullscreenListeners_ = function (element, changeHandler, errorHandler) {\n        this.removeFullscreenListeners_();\n        this.fullscreenEventTarget_ = element;\n        this.fullscreenChangeHandler_ = changeHandler;\n        this.fullscreenErrorHandler_ = errorHandler;\n\n        if (changeHandler) {\n          if (document.fullscreenEnabled) {\n            element.addEventListener('fullscreenchange', changeHandler, false);\n          } else if (document.webkitFullscreenEnabled) {\n            element.addEventListener('webkitfullscreenchange', changeHandler, false);\n          } else if (document.mozFullScreenEnabled) {\n            document.addEventListener('mozfullscreenchange', changeHandler, false);\n          } else if (document.msFullscreenEnabled) {\n            element.addEventListener('msfullscreenchange', changeHandler, false);\n          }\n        }\n\n        if (errorHandler) {\n          if (document.fullscreenEnabled) {\n            element.addEventListener('fullscreenerror', errorHandler, false);\n          } else if (document.webkitFullscreenEnabled) {\n            element.addEventListener('webkitfullscreenerror', errorHandler, false);\n          } else if (document.mozFullScreenEnabled) {\n            document.addEventListener('mozfullscreenerror', errorHandler, false);\n          } else if (document.msFullscreenEnabled) {\n            element.addEventListener('msfullscreenerror', errorHandler, false);\n          }\n        }\n      };\n\n      VRDisplay.prototype.removeFullscreenListeners_ = function () {\n        if (!this.fullscreenEventTarget_) return;\n        var element = this.fullscreenEventTarget_;\n\n        if (this.fullscreenChangeHandler_) {\n          var changeHandler = this.fullscreenChangeHandler_;\n          element.removeEventListener('fullscreenchange', changeHandler, false);\n          element.removeEventListener('webkitfullscreenchange', changeHandler, false);\n          document.removeEventListener('mozfullscreenchange', changeHandler, false);\n          element.removeEventListener('msfullscreenchange', changeHandler, false);\n        }\n\n        if (this.fullscreenErrorHandler_) {\n          var errorHandler = this.fullscreenErrorHandler_;\n          element.removeEventListener('fullscreenerror', errorHandler, false);\n          element.removeEventListener('webkitfullscreenerror', errorHandler, false);\n          document.removeEventListener('mozfullscreenerror', errorHandler, false);\n          element.removeEventListener('msfullscreenerror', errorHandler, false);\n        }\n\n        this.fullscreenEventTarget_ = null;\n        this.fullscreenChangeHandler_ = null;\n        this.fullscreenErrorHandler_ = null;\n      };\n\n      VRDisplay.prototype.enableWakeLock = function () {\n        if (this.wakelock_) {\n          this.wakelock_.enable();\n        }\n      };\n\n      VRDisplay.prototype.disableWakeLock = function () {\n        if (this.wakelock_) {\n          this.wakelock_.disable();\n        }\n      };\n\n      VRDisplay.prototype.beginPresent_ = function () {};\n\n      VRDisplay.prototype.endPresent_ = function () {};\n\n      VRDisplay.prototype.submitFrame = function (pose) {};\n\n      VRDisplay.prototype.getEyeParameters = function (whichEye) {\n        return null;\n      };\n\n      var config = {\n        ADDITIONAL_VIEWERS: [],\n        DEFAULT_VIEWER: '',\n        MOBILE_WAKE_LOCK: true,\n        DEBUG: false,\n        DPDB_URL: 'https://dpdb.webvr.rocks/dpdb.json',\n        K_FILTER: 0.98,\n        PREDICTION_TIME_S: 0.040,\n        CARDBOARD_UI_DISABLED: false,\n        ROTATE_INSTRUCTIONS_DISABLED: false,\n        YAW_ONLY: false,\n        BUFFER_SCALE: 0.5,\n        DIRTY_SUBMIT_FRAME_BINDINGS: false\n      };\n      var Eye = {\n        LEFT: 'left',\n        RIGHT: 'right'\n      };\n\n      function CardboardVRDisplay(config$$1) {\n        var defaults = extend({}, config);\n        config$$1 = extend(defaults, config$$1 || {});\n        VRDisplay.call(this, {\n          wakelock: config$$1.MOBILE_WAKE_LOCK\n        });\n        this.config = config$$1;\n        this.displayName = 'Cardboard VRDisplay';\n        this.capabilities = new VRDisplayCapabilities({\n          hasPosition: false,\n          hasOrientation: true,\n          hasExternalDisplay: false,\n          canPresent: true,\n          maxLayers: 1\n        });\n        this.stageParameters = null;\n        this.bufferScale_ = this.config.BUFFER_SCALE;\n        this.poseSensor_ = new PoseSensor(this.config);\n        this.distorter_ = null;\n        this.cardboardUI_ = null;\n        this.dpdb_ = new Dpdb(this.config.DPDB_URL, this.onDeviceParamsUpdated_.bind(this));\n        this.deviceInfo_ = new DeviceInfo(this.dpdb_.getDeviceParams(), config$$1.ADDITIONAL_VIEWERS);\n        this.viewerSelector_ = new ViewerSelector(config$$1.DEFAULT_VIEWER);\n        this.viewerSelector_.onChange(this.onViewerChanged_.bind(this));\n        this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer());\n\n        if (!this.config.ROTATE_INSTRUCTIONS_DISABLED) {\n          this.rotateInstructions_ = new RotateInstructions();\n        }\n\n        if (isIOS()) {\n          window.addEventListener('resize', this.onResize_.bind(this));\n        }\n      }\n\n      CardboardVRDisplay.prototype = Object.create(VRDisplay.prototype);\n\n      CardboardVRDisplay.prototype._getPose = function () {\n        return {\n          position: null,\n          orientation: this.poseSensor_.getOrientation(),\n          linearVelocity: null,\n          linearAcceleration: null,\n          angularVelocity: null,\n          angularAcceleration: null\n        };\n      };\n\n      CardboardVRDisplay.prototype._resetPose = function () {\n        if (this.poseSensor_.resetPose) {\n          this.poseSensor_.resetPose();\n        }\n      };\n\n      CardboardVRDisplay.prototype._getFieldOfView = function (whichEye) {\n        var fieldOfView;\n\n        if (whichEye == Eye.LEFT) {\n          fieldOfView = this.deviceInfo_.getFieldOfViewLeftEye();\n        } else if (whichEye == Eye.RIGHT) {\n          fieldOfView = this.deviceInfo_.getFieldOfViewRightEye();\n        } else {\n          console.error('Invalid eye provided: %s', whichEye);\n          return null;\n        }\n\n        return fieldOfView;\n      };\n\n      CardboardVRDisplay.prototype._getEyeOffset = function (whichEye) {\n        var offset;\n\n        if (whichEye == Eye.LEFT) {\n          offset = [-this.deviceInfo_.viewer.interLensDistance * 0.5, 0.0, 0.0];\n        } else if (whichEye == Eye.RIGHT) {\n          offset = [this.deviceInfo_.viewer.interLensDistance * 0.5, 0.0, 0.0];\n        } else {\n          console.error('Invalid eye provided: %s', whichEye);\n          return null;\n        }\n\n        return offset;\n      };\n\n      CardboardVRDisplay.prototype.getEyeParameters = function (whichEye) {\n        var offset = this._getEyeOffset(whichEye);\n\n        var fieldOfView = this._getFieldOfView(whichEye);\n\n        var eyeParams = {\n          offset: offset,\n          renderWidth: this.deviceInfo_.device.width * 0.5 * this.bufferScale_,\n          renderHeight: this.deviceInfo_.device.height * this.bufferScale_\n        };\n        Object.defineProperty(eyeParams, 'fieldOfView', {\n          enumerable: true,\n          get: function get() {\n            deprecateWarning('VRFieldOfView', 'VRFrameData\\'s projection matrices');\n            return fieldOfView;\n          }\n        });\n        return eyeParams;\n      };\n\n      CardboardVRDisplay.prototype.onDeviceParamsUpdated_ = function (newParams) {\n        if (this.config.DEBUG) {\n          console.log('DPDB reported that device params were updated.');\n        }\n\n        this.deviceInfo_.updateDeviceParams(newParams);\n\n        if (this.distorter_) {\n          this.distorter_.updateDeviceInfo(this.deviceInfo_);\n        }\n      };\n\n      CardboardVRDisplay.prototype.updateBounds_ = function () {\n        if (this.layer_ && this.distorter_ && (this.layer_.leftBounds || this.layer_.rightBounds)) {\n          this.distorter_.setTextureBounds(this.layer_.leftBounds, this.layer_.rightBounds);\n        }\n      };\n\n      CardboardVRDisplay.prototype.beginPresent_ = function () {\n        var gl = this.layer_.source.getContext('webgl');\n        if (!gl) gl = this.layer_.source.getContext('experimental-webgl');\n        if (!gl) gl = this.layer_.source.getContext('webgl2');\n        if (!gl) return;\n\n        if (this.layer_.predistorted) {\n          if (!this.config.CARDBOARD_UI_DISABLED) {\n            gl.canvas.width = getScreenWidth() * this.bufferScale_;\n            gl.canvas.height = getScreenHeight() * this.bufferScale_;\n            this.cardboardUI_ = new CardboardUI(gl);\n          }\n        } else {\n          if (!this.config.CARDBOARD_UI_DISABLED) {\n            this.cardboardUI_ = new CardboardUI(gl);\n          }\n\n          this.distorter_ = new CardboardDistorter(gl, this.cardboardUI_, this.config.BUFFER_SCALE, this.config.DIRTY_SUBMIT_FRAME_BINDINGS);\n          this.distorter_.updateDeviceInfo(this.deviceInfo_);\n        }\n\n        if (this.cardboardUI_) {\n          this.cardboardUI_.listen(function (e) {\n            this.viewerSelector_.show(this.layer_.source.parentElement);\n            e.stopPropagation();\n            e.preventDefault();\n          }.bind(this), function (e) {\n            this.exitPresent();\n            e.stopPropagation();\n            e.preventDefault();\n          }.bind(this));\n        }\n\n        if (this.rotateInstructions_) {\n          if (isLandscapeMode() && isMobile()) {\n            this.rotateInstructions_.showTemporarily(3000, this.layer_.source.parentElement);\n          } else {\n            this.rotateInstructions_.update();\n          }\n        }\n\n        this.orientationHandler = this.onOrientationChange_.bind(this);\n        window.addEventListener('orientationchange', this.orientationHandler);\n        this.vrdisplaypresentchangeHandler = this.updateBounds_.bind(this);\n        window.addEventListener('vrdisplaypresentchange', this.vrdisplaypresentchangeHandler);\n        this.fireVRDisplayDeviceParamsChange_();\n      };\n\n      CardboardVRDisplay.prototype.endPresent_ = function () {\n        if (this.distorter_) {\n          this.distorter_.destroy();\n          this.distorter_ = null;\n        }\n\n        if (this.cardboardUI_) {\n          this.cardboardUI_.destroy();\n          this.cardboardUI_ = null;\n        }\n\n        if (this.rotateInstructions_) {\n          this.rotateInstructions_.hide();\n        }\n\n        this.viewerSelector_.hide();\n        window.removeEventListener('orientationchange', this.orientationHandler);\n        window.removeEventListener('vrdisplaypresentchange', this.vrdisplaypresentchangeHandler);\n      };\n\n      CardboardVRDisplay.prototype.updatePresent_ = function () {\n        this.endPresent_();\n        this.beginPresent_();\n      };\n\n      CardboardVRDisplay.prototype.submitFrame = function (pose) {\n        if (this.distorter_) {\n          this.updateBounds_();\n          this.distorter_.submitFrame();\n        } else if (this.cardboardUI_ && this.layer_) {\n          var canvas = this.layer_.source.getContext('webgl').canvas;\n\n          if (canvas.width != this.lastWidth || canvas.height != this.lastHeight) {\n            this.cardboardUI_.onResize();\n          }\n\n          this.lastWidth = canvas.width;\n          this.lastHeight = canvas.height;\n          this.cardboardUI_.render();\n        }\n      };\n\n      CardboardVRDisplay.prototype.onOrientationChange_ = function (e) {\n        this.viewerSelector_.hide();\n\n        if (this.rotateInstructions_) {\n          this.rotateInstructions_.update();\n        }\n\n        this.onResize_();\n      };\n\n      CardboardVRDisplay.prototype.onResize_ = function (e) {\n        if (this.layer_) {\n          var gl = this.layer_.source.getContext('webgl');\n          var cssProperties = ['position: absolute', 'top: 0', 'left: 0', 'width: 100vw', 'height: 100vh', 'border: 0', 'margin: 0', 'padding: 0px', 'box-sizing: content-box'];\n          gl.canvas.setAttribute('style', cssProperties.join('; ') + ';');\n          safariCssSizeWorkaround(gl.canvas);\n        }\n      };\n\n      CardboardVRDisplay.prototype.onViewerChanged_ = function (viewer) {\n        this.deviceInfo_.setViewer(viewer);\n\n        if (this.distorter_) {\n          this.distorter_.updateDeviceInfo(this.deviceInfo_);\n        }\n\n        this.fireVRDisplayDeviceParamsChange_();\n      };\n\n      CardboardVRDisplay.prototype.fireVRDisplayDeviceParamsChange_ = function () {\n        var event = new CustomEvent('vrdisplaydeviceparamschange', {\n          detail: {\n            vrdisplay: this,\n            deviceInfo: this.deviceInfo_\n          }\n        });\n        window.dispatchEvent(event);\n      };\n\n      CardboardVRDisplay.VRFrameData = VRFrameData;\n      CardboardVRDisplay.VRDisplay = VRDisplay;\n      return CardboardVRDisplay;\n    });\n  });\n  var CardboardVRDisplay = unwrapExports(cardboardVrDisplay);\n\n  class XRDevice extends EventTarget {\n    constructor(global) {\n      super();\n      this.global = global;\n      this.onWindowResize = this.onWindowResize.bind(this);\n      this.global.window.addEventListener('resize', this.onWindowResize);\n      this.environmentBlendMode = 'opaque';\n    }\n\n    get depthNear() {\n      throw new Error('Not implemented');\n    }\n\n    set depthNear(val) {\n      throw new Error('Not implemented');\n    }\n\n    get depthFar() {\n      throw new Error('Not implemented');\n    }\n\n    set depthFar(val) {\n      throw new Error('Not implemented');\n    }\n\n    onBaseLayerSet(sessionId, layer) {\n      throw new Error('Not implemented');\n    }\n\n    onInlineVerticalFieldOfViewSet(sessionId, value) {\n      throw new Error('Not implemented');\n    }\n\n    supportsSession(mode) {\n      throw new Error('Not implemented');\n    }\n\n    async requestSession(mode) {\n      throw new Error('Not implemented');\n    }\n\n    requestAnimationFrame(callback) {\n      throw new Error('Not implemented');\n    }\n\n    onFrameStart(sessionId) {\n      throw new Error('Not implemented');\n    }\n\n    onFrameEnd(sessionId) {\n      throw new Error('Not implemented');\n    }\n\n    requestStageBounds() {\n      throw new Error('Not implemented');\n    }\n\n    async requestFrameOfReferenceTransform(type, options) {\n      return undefined;\n    }\n\n    cancelAnimationFrame(handle) {\n      throw new Error('Not implemented');\n    }\n\n    endSession(sessionId) {\n      throw new Error('Not implemented');\n    }\n\n    getViewport(sessionId, eye, layer, target) {\n      throw new Error('Not implemented');\n    }\n\n    getProjectionMatrix(eye) {\n      throw new Error('Not implemented');\n    }\n\n    getBasePoseMatrix() {\n      throw new Error('Not implemented');\n    }\n\n    getBaseViewMatrix(eye) {\n      throw new Error('Not implemented');\n    }\n\n    getInputSources() {\n      throw new Error('Not implemented');\n    }\n\n    getInputPose(inputSource, coordinateSystem, poseType) {\n      throw new Error('Not implemented');\n    }\n\n    onWindowResize() {\n      this.onWindowResize();\n    }\n\n  }\n\n  let oculusGo = {\n    mapping: 'xr-standard',\n    profiles: ['oculus-go', 'touchpad-controller'],\n    buttons: {\n      length: 3,\n      0: 1,\n      1: null,\n      2: 0\n    },\n    gripTransform: {\n      orientation: [Math.PI * 0.11, 0, 0, 1]\n    }\n  };\n  let oculusTouch = {\n    mapping: 'xr-standard',\n    displayProfiles: {\n      'Oculus Quest': ['oculus-quest', 'oculus-touch', 'thumbstick-controller']\n    },\n    profiles: ['oculus-touch', 'thumbstick-controller'],\n    axes: {\n      length: 4,\n      0: null,\n      1: null,\n      2: 0,\n      3: 1\n    },\n    buttons: {\n      length: 6,\n      0: 1,\n      1: 2,\n      2: null,\n      3: 0,\n      4: 3,\n      5: 4\n    },\n    gripTransform: {\n      position: [0, -0.02, 0.04, 1],\n      orientation: [Math.PI * 0.11, 0, 0, 1]\n    }\n  };\n  let openVr = {\n    mapping: 'xr-standard',\n    profiles: ['openvr-controller', 'touchpad-controller'],\n    displayProfiles: {\n      'HTC Vive': ['htc-vive', 'touchpad-controller'],\n      'HTC Vive DVT': ['htc-vive', 'touchpad-controller']\n    },\n    buttons: {\n      length: 3,\n      0: 1,\n      1: 2,\n      2: 0\n    },\n    gripTransform: {\n      position: [0, 0, 0.05, 1]\n    },\n    targetRayTransform: {\n      orientation: [Math.PI * -0.08, 0, 0, 1]\n    }\n  };\n  let windowsMixedReality = {\n    mapping: 'xr-standard',\n    profiles: ['windows-mixed-reality', 'touchpad-thumbstick-controller'],\n    buttons: {\n      length: 4,\n      0: 1,\n      1: 0,\n      2: 2,\n      3: 4\n    },\n    gripTransform: {\n      position: [0, -0.02, 0.04, 1],\n      orientation: [Math.PI * 0.11, 0, 0, 1]\n    }\n  };\n  let GamepadMappings = {\n    'Oculus Go Controller': oculusGo,\n    'Oculus Touch (Right)': oculusTouch,\n    'Oculus Touch (Left)': oculusTouch,\n    'OpenVR Gamepad': openVr,\n    'Windows Mixed Reality (Right)': windowsMixedReality,\n    'Windows Mixed Reality (Left)': windowsMixedReality\n  };\n  const HEAD_ELBOW_OFFSET_RIGHTHANDED = fromValues$1(0.155, -0.465, -0.15);\n  const HEAD_ELBOW_OFFSET_LEFTHANDED = fromValues$1(-0.155, -0.465, -0.15);\n  const ELBOW_WRIST_OFFSET = fromValues$1(0, 0, -0.25);\n  const WRIST_CONTROLLER_OFFSET = fromValues$1(0, 0, 0.05);\n  const ARM_EXTENSION_OFFSET = fromValues$1(-0.08, 0.14, 0.08);\n  const ELBOW_BEND_RATIO = 0.4;\n  const EXTENSION_RATIO_WEIGHT = 0.4;\n  const MIN_ANGULAR_SPEED = 0.61;\n  const MIN_ANGLE_DELTA = 0.175;\n  const MIN_EXTENSION_COS = 0.12;\n  const MAX_EXTENSION_COS = 0.87;\n  const RAD_TO_DEG = 180 / Math.PI;\n\n  function eulerFromQuaternion(out, q, order) {\n    function clamp(value, min$$1, max$$1) {\n      return value < min$$1 ? min$$1 : value > max$$1 ? max$$1 : value;\n    }\n\n    var sqx = q[0] * q[0];\n    var sqy = q[1] * q[1];\n    var sqz = q[2] * q[2];\n    var sqw = q[3] * q[3];\n\n    if (order === 'XYZ') {\n      out[0] = Math.atan2(2 * (q[0] * q[3] - q[1] * q[2]), sqw - sqx - sqy + sqz);\n      out[1] = Math.asin(clamp(2 * (q[0] * q[2] + q[1] * q[3]), -1, 1));\n      out[2] = Math.atan2(2 * (q[2] * q[3] - q[0] * q[1]), sqw + sqx - sqy - sqz);\n    } else if (order === 'YXZ') {\n      out[0] = Math.asin(clamp(2 * (q[0] * q[3] - q[1] * q[2]), -1, 1));\n      out[1] = Math.atan2(2 * (q[0] * q[2] + q[1] * q[3]), sqw - sqx - sqy + sqz);\n      out[2] = Math.atan2(2 * (q[0] * q[1] + q[2] * q[3]), sqw - sqx + sqy - sqz);\n    } else if (order === 'ZXY') {\n      out[0] = Math.asin(clamp(2 * (q[0] * q[3] + q[1] * q[2]), -1, 1));\n      out[1] = Math.atan2(2 * (q[1] * q[3] - q[2] * q[0]), sqw - sqx - sqy + sqz);\n      out[2] = Math.atan2(2 * (q[2] * q[3] - q[0] * q[1]), sqw - sqx + sqy - sqz);\n    } else if (order === 'ZYX') {\n      out[0] = Math.atan2(2 * (q[0] * q[3] + q[2] * q[1]), sqw - sqx - sqy + sqz);\n      out[1] = Math.asin(clamp(2 * (q[1] * q[3] - q[0] * q[2]), -1, 1));\n      out[2] = Math.atan2(2 * (q[0] * q[1] + q[2] * q[3]), sqw + sqx - sqy - sqz);\n    } else if (order === 'YZX') {\n      out[0] = Math.atan2(2 * (q[0] * q[3] - q[2] * q[1]), sqw - sqx + sqy - sqz);\n      out[1] = Math.atan2(2 * (q[1] * q[3] - q[0] * q[2]), sqw + sqx - sqy - sqz);\n      out[2] = Math.asin(clamp(2 * (q[0] * q[1] + q[2] * q[3]), -1, 1));\n    } else if (order === 'XZY') {\n      out[0] = Math.atan2(2 * (q[0] * q[3] + q[1] * q[2]), sqw - sqx + sqy - sqz);\n      out[1] = Math.atan2(2 * (q[0] * q[2] + q[1] * q[3]), sqw + sqx - sqy - sqz);\n      out[2] = Math.asin(clamp(2 * (q[2] * q[3] - q[0] * q[1]), -1, 1));\n    } else {\n      console.log('No order given for quaternion to euler conversion.');\n      return;\n    }\n  }\n\n  class OrientationArmModel {\n    constructor() {\n      this.hand = 'right';\n      this.headElbowOffset = HEAD_ELBOW_OFFSET_RIGHTHANDED;\n      this.controllerQ = create$4();\n      this.lastControllerQ = create$4();\n      this.headQ = create$4();\n      this.headPos = create$1();\n      this.elbowPos = create$1();\n      this.wristPos = create$1();\n      this.time = null;\n      this.lastTime = null;\n      this.rootQ = create$4();\n      this.position = create$1();\n    }\n\n    setHandedness(hand) {\n      if (this.hand != hand) {\n        this.hand = hand;\n\n        if (this.hand == 'left') {\n          this.headElbowOffset = HEAD_ELBOW_OFFSET_LEFTHANDED;\n        } else {\n          this.headElbowOffset = HEAD_ELBOW_OFFSET_RIGHTHANDED;\n        }\n      }\n    }\n\n    update(controllerOrientation, headPoseMatrix) {\n      this.time = now$1();\n\n      if (controllerOrientation) {\n        copy$4(this.lastControllerQ, this.controllerQ);\n        copy$4(this.controllerQ, controllerOrientation);\n      }\n\n      if (headPoseMatrix) {\n        getTranslation(this.headPos, headPoseMatrix);\n        getRotation(this.headQ, headPoseMatrix);\n      }\n\n      let headYawQ = this.getHeadYawOrientation_();\n      let angleDelta = this.quatAngle_(this.lastControllerQ, this.controllerQ);\n      let timeDelta = (this.time - this.lastTime) / 1000;\n      let controllerAngularSpeed = angleDelta / timeDelta;\n\n      if (controllerAngularSpeed > MIN_ANGULAR_SPEED) {\n        slerp(this.rootQ, this.rootQ, headYawQ, Math.min(angleDelta / MIN_ANGLE_DELTA, 1.0));\n      } else {\n        copy$4(this.rootQ, headYawQ);\n      }\n\n      let controllerForward = fromValues$1(0, 0, -1.0);\n      transformQuat(controllerForward, controllerForward, this.controllerQ);\n      let controllerDotY = dot(controllerForward, [0, 1, 0]);\n      let extensionRatio = this.clamp_((controllerDotY - MIN_EXTENSION_COS) / MAX_EXTENSION_COS, 0.0, 1.0);\n      let controllerCameraQ = clone$4(this.rootQ);\n      invert$2(controllerCameraQ, controllerCameraQ);\n      multiply$4(controllerCameraQ, controllerCameraQ, this.controllerQ);\n      let elbowPos = this.elbowPos;\n      copy$1(elbowPos, this.headPos);\n      add$1(elbowPos, elbowPos, this.headElbowOffset);\n      let elbowOffset = clone$1(ARM_EXTENSION_OFFSET);\n      scale$1(elbowOffset, elbowOffset, extensionRatio);\n      add$1(elbowPos, elbowPos, elbowOffset);\n      let totalAngle = this.quatAngle_(controllerCameraQ, create$4());\n      let totalAngleDeg = totalAngle * RAD_TO_DEG;\n      let lerpSuppression = 1 - Math.pow(totalAngleDeg / 180, 4);\n      let elbowRatio = ELBOW_BEND_RATIO;\n      let wristRatio = 1 - ELBOW_BEND_RATIO;\n      let lerpValue = lerpSuppression * (elbowRatio + wristRatio * extensionRatio * EXTENSION_RATIO_WEIGHT);\n      let wristQ = create$4();\n      slerp(wristQ, wristQ, controllerCameraQ, lerpValue);\n      let invWristQ = invert$2(create$4(), wristQ);\n      let elbowQ = clone$4(controllerCameraQ);\n      multiply$4(elbowQ, elbowQ, invWristQ);\n      let wristPos = this.wristPos;\n      copy$1(wristPos, WRIST_CONTROLLER_OFFSET);\n      transformQuat(wristPos, wristPos, wristQ);\n      add$1(wristPos, wristPos, ELBOW_WRIST_OFFSET);\n      transformQuat(wristPos, wristPos, elbowQ);\n      add$1(wristPos, wristPos, elbowPos);\n      let offset = clone$1(ARM_EXTENSION_OFFSET);\n      scale$1(offset, offset, extensionRatio);\n      add$1(this.position, this.wristPos, offset);\n      transformQuat(this.position, this.position, this.rootQ);\n      this.lastTime = this.time;\n    }\n\n    getPosition() {\n      return this.position;\n    }\n\n    getHeadYawOrientation_() {\n      let headEuler = create$1();\n      eulerFromQuaternion(headEuler, this.headQ, 'YXZ');\n      let destinationQ = fromEuler(create$4(), 0, headEuler[1] * RAD_TO_DEG, 0);\n      return destinationQ;\n    }\n\n    clamp_(value, min$$1, max$$1) {\n      return Math.min(Math.max(value, min$$1), max$$1);\n    }\n\n    quatAngle_(q1, q2) {\n      let vec1 = [0, 0, -1];\n      let vec2 = [0, 0, -1];\n      transformQuat(vec1, vec1, q1);\n      transformQuat(vec2, vec2, q2);\n      return angle(vec1, vec2);\n    }\n\n  }\n\n  const PRIVATE$14 = Symbol('@@webxr-polyfill/XRRemappedGamepad');\n  const PLACEHOLDER_BUTTON = {\n    pressed: false,\n    touched: false,\n    value: 0.0\n  };\n  Object.freeze(PLACEHOLDER_BUTTON);\n\n  class XRRemappedGamepad {\n    constructor(gamepad, display, map) {\n      if (!map) {\n        map = {};\n      }\n\n      let axes = new Array(map.axes && map.axes.length ? map.axes.length : gamepad.axes.length);\n      let buttons = new Array(map.buttons && map.buttons.length ? map.buttons.length : gamepad.buttons.length);\n      let gripTransform = null;\n\n      if (map.gripTransform) {\n        let orientation = map.gripTransform.orientation || [0, 0, 0, 1];\n        gripTransform = create();\n        fromRotationTranslation(gripTransform, normalize$2(orientation, orientation), map.gripTransform.position || [0, 0, 0]);\n      }\n\n      let targetRayTransform = null;\n\n      if (map.targetRayTransform) {\n        let orientation = map.targetRayTransform.orientation || [0, 0, 0, 1];\n        targetRayTransform = create();\n        fromRotationTranslation(targetRayTransform, normalize$2(orientation, orientation), map.targetRayTransform.position || [0, 0, 0]);\n      }\n\n      let profiles = map.profiles;\n\n      if (map.displayProfiles) {\n        if (display.displayName in map.displayProfiles) {\n          profiles = map.displayProfiles[display.displayName];\n        }\n      }\n\n      this[PRIVATE$14] = {\n        gamepad,\n        map,\n        profiles: profiles || [gamepad.id],\n        mapping: map.mapping || gamepad.mapping,\n        axes,\n        buttons,\n        gripTransform,\n        targetRayTransform\n      };\n\n      this._update();\n    }\n\n    _update() {\n      let gamepad = this[PRIVATE$14].gamepad;\n      let map = this[PRIVATE$14].map;\n      let axes = this[PRIVATE$14].axes;\n\n      for (let i = 0; i < axes.length; ++i) {\n        if (map.axes && i in map.axes) {\n          if (map.axes[i] === null) {\n            axes[i] = 0;\n          } else {\n            axes[i] = gamepad.axes[map.axes[i]];\n          }\n        } else {\n          axes[i] = gamepad.axes[i];\n        }\n      }\n\n      if (map.axes && map.axes.invert) {\n        for (let axis of map.axes.invert) {\n          axes[axis] *= -1;\n        }\n      }\n\n      let buttons = this[PRIVATE$14].buttons;\n\n      for (let i = 0; i < buttons.length; ++i) {\n        if (map.buttons && i in map.buttons) {\n          if (map.buttons[i] === null) {\n            buttons[i] = PLACEHOLDER_BUTTON;\n          } else {\n            buttons[i] = gamepad.buttons[map.buttons[i]];\n          }\n        } else {\n          buttons[i] = gamepad.buttons[i];\n        }\n      }\n    }\n\n    get id() {\n      return '';\n    }\n\n    get _profiles() {\n      return this[PRIVATE$14].profiles;\n    }\n\n    get index() {\n      return -1;\n    }\n\n    get connected() {\n      return this[PRIVATE$14].gamepad.connected;\n    }\n\n    get timestamp() {\n      return this[PRIVATE$14].gamepad.timestamp;\n    }\n\n    get mapping() {\n      return this[PRIVATE$14].mapping;\n    }\n\n    get axes() {\n      return this[PRIVATE$14].axes;\n    }\n\n    get buttons() {\n      return this[PRIVATE$14].buttons;\n    }\n\n  }\n\n  class GamepadXRInputSource {\n    constructor(polyfill, display, primaryButtonIndex = 0) {\n      this.polyfill = polyfill;\n      this.display = display;\n      this.nativeGamepad = null;\n      this.gamepad = null;\n      this.inputSource = new XRInputSource(this);\n      this.lastPosition = create$1();\n      this.emulatedPosition = false;\n      this.basePoseMatrix = create();\n      this.outputMatrix = create();\n      this.primaryButtonIndex = primaryButtonIndex;\n      this.primaryActionPressed = false;\n      this.handedness = '';\n      this.targetRayMode = 'gaze';\n      this.armModel = null;\n    }\n\n    get profiles() {\n      return this.gamepad ? this.gamepad._profiles : [];\n    }\n\n    updateFromGamepad(gamepad) {\n      if (this.nativeGamepad !== gamepad) {\n        this.nativeGamepad = gamepad;\n\n        if (gamepad) {\n          this.gamepad = new XRRemappedGamepad(gamepad, this.display, GamepadMappings[gamepad.id]);\n        } else {\n          this.gamepad = null;\n        }\n      }\n\n      this.handedness = gamepad.hand;\n\n      if (this.gamepad) {\n        this.gamepad._update();\n      }\n\n      if (gamepad.pose) {\n        this.targetRayMode = 'tracked-pointer';\n        this.emulatedPosition = !gamepad.pose.hasPosition;\n      } else if (gamepad.hand === '') {\n        this.targetRayMode = 'gaze';\n        this.emulatedPosition = false;\n      }\n    }\n\n    updateBasePoseMatrix() {\n      if (this.nativeGamepad && this.nativeGamepad.pose) {\n        let pose = this.nativeGamepad.pose;\n        let position = pose.position;\n        let orientation = pose.orientation;\n\n        if (!position && !orientation) {\n          return;\n        }\n\n        if (!position) {\n          if (!pose.hasPosition) {\n            if (!this.armModel) {\n              this.armModel = new OrientationArmModel();\n            }\n\n            this.armModel.setHandedness(this.nativeGamepad.hand);\n            this.armModel.update(orientation, this.polyfill.getBasePoseMatrix());\n            position = this.armModel.getPosition();\n          } else {\n            position = this.lastPosition;\n          }\n        } else {\n          this.lastPosition[0] = position[0];\n          this.lastPosition[1] = position[1];\n          this.lastPosition[2] = position[2];\n        }\n\n        fromRotationTranslation(this.basePoseMatrix, orientation, position);\n      } else {\n        copy(this.basePoseMatrix, this.polyfill.getBasePoseMatrix());\n      }\n\n      return this.basePoseMatrix;\n    }\n\n    getXRPose(coordinateSystem, poseType) {\n      this.updateBasePoseMatrix();\n\n      switch (poseType) {\n        case \"target-ray\":\n          coordinateSystem._transformBasePoseMatrix(this.outputMatrix, this.basePoseMatrix);\n\n          if (this.gamepad && this.gamepad[PRIVATE$14].targetRayTransform) {\n            multiply(this.outputMatrix, this.outputMatrix, this.gamepad[PRIVATE$14].targetRayTransform);\n          }\n\n          break;\n\n        case \"grip\":\n          if (!this.nativeGamepad || !this.nativeGamepad.pose) {\n            return null;\n          }\n\n          coordinateSystem._transformBasePoseMatrix(this.outputMatrix, this.basePoseMatrix);\n\n          if (this.gamepad && this.gamepad[PRIVATE$14].gripTransform) {\n            multiply(this.outputMatrix, this.outputMatrix, this.gamepad[PRIVATE$14].gripTransform);\n          }\n\n          break;\n\n        default:\n          return null;\n      }\n\n      coordinateSystem._adjustForOriginOffset(this.outputMatrix);\n\n      return new XRPose(new XRRigidTransform(this.outputMatrix), this.emulatedPosition);\n    }\n\n  }\n\n  const TEST_ENV = \"production\" === 'test';\n  const EXTRA_PRESENTATION_ATTRIBUTES = {\n    highRefreshRate: true\n  };\n  const PRIMARY_BUTTON_MAP = {\n    oculus: 1,\n    openvr: 1,\n    'spatial controller (spatial interaction source)': 1\n  };\n  let SESSION_ID = 0;\n\n  class Session {\n    constructor(mode, polyfillOptions = {}) {\n      this.mode = mode;\n      this.outputContext = null;\n      this.immersive = mode == 'immersive-vr' || mode == 'immersive-ar';\n      this.ended = null;\n      this.baseLayer = null;\n      this.inlineVerticalFieldOfView = Math.PI * 0.5;\n      this.id = ++SESSION_ID;\n      this.modifiedCanvasLayer = false;\n\n      if (this.outputContext && !TEST_ENV) {\n        const renderContextType = polyfillOptions.renderContextType || '2d';\n        this.renderContext = this.outputContext.canvas.getContext(renderContextType);\n      }\n    }\n\n  }\n\n  class WebVRDevice extends XRDevice {\n    constructor(global, display) {\n      const canPresent = display.capabilities.canPresent;\n      super(global);\n      this.display = display;\n      this.frame = new global.VRFrameData();\n      this.sessions = new Map();\n      this.immersiveSession = null;\n      this.canPresent = canPresent;\n      this.baseModelMatrix = create();\n      this.gamepadInputSources = {};\n      this.tempVec3 = new Float32Array(3);\n      this.onVRDisplayPresentChange = this.onVRDisplayPresentChange.bind(this);\n      global.window.addEventListener('vrdisplaypresentchange', this.onVRDisplayPresentChange);\n      this.CAN_USE_GAMEPAD = global.navigator && 'getGamepads' in global.navigator;\n      this.HAS_BITMAP_SUPPORT = isImageBitmapSupported(global);\n    }\n\n    get depthNear() {\n      return this.display.depthNear;\n    }\n\n    set depthNear(val) {\n      this.display.depthNear = val;\n    }\n\n    get depthFar() {\n      return this.display.depthFar;\n    }\n\n    set depthFar(val) {\n      this.display.depthFar = val;\n    }\n\n    onBaseLayerSet(sessionId, layer) {\n      const session = this.sessions.get(sessionId);\n      const canvas = layer.context.canvas;\n\n      if (session.immersive) {\n        const left = this.display.getEyeParameters('left');\n        const right = this.display.getEyeParameters('right');\n        canvas.width = Math.max(left.renderWidth, right.renderWidth) * 2;\n        canvas.height = Math.max(left.renderHeight, right.renderHeight);\n        this.display.requestPresent([{\n          source: canvas,\n          attributes: EXTRA_PRESENTATION_ATTRIBUTES\n        }]).then(() => {\n          if (!TEST_ENV && !this.global.document.body.contains(canvas)) {\n            session.modifiedCanvasLayer = true;\n            this.global.document.body.appendChild(canvas);\n            applyCanvasStylesForMinimalRendering(canvas);\n          }\n\n          session.baseLayer = layer;\n        });\n      } else {\n        session.baseLayer = layer;\n      }\n    }\n\n    onInlineVerticalFieldOfViewSet(sessionId, value) {\n      const session = this.sessions.get(sessionId);\n      session.inlineVerticalFieldOfView = value;\n    }\n\n    supportsSession(mode) {\n      if (XRSessionModes.indexOf(mode) == -1) {\n        throw new TypeError(\"The provided value '\".concat(mode, \"' is not a valid enum value of type XRSessionMode\"));\n      }\n\n      if (mode == 'immersive-ar') {\n        return false;\n      }\n\n      if (mode == 'immersive-vr' && this.canPresent === false) {\n        return false;\n      }\n\n      return true;\n    }\n\n    async requestSession(mode) {\n      if (!this.supportsSession(mode)) {\n        return Promise.reject();\n      }\n\n      let immersive = mode == 'immersive-vr';\n\n      if (immersive) {\n        const canvas = this.global.document.createElement('canvas');\n\n        if (!TEST_ENV) {\n          const ctx = canvas.getContext('webgl');\n        }\n\n        await this.display.requestPresent([{\n          source: canvas,\n          attributes: EXTRA_PRESENTATION_ATTRIBUTES\n        }]);\n      }\n\n      const session = new Session(mode, {\n        renderContextType: this.HAS_BITMAP_SUPPORT ? 'bitmaprenderer' : '2d'\n      });\n      this.sessions.set(session.id, session);\n\n      if (immersive) {\n        this.immersiveSession = session;\n        this.dispatchEvent('@@webxr-polyfill/vr-present-start', session.id);\n      }\n\n      return Promise.resolve(session.id);\n    }\n\n    requestAnimationFrame(callback) {\n      return this.display.requestAnimationFrame(callback);\n    }\n\n    getPrimaryButtonIndex(gamepad) {\n      let primaryButton = 0;\n      let name = gamepad.id.toLowerCase();\n\n      for (let key in PRIMARY_BUTTON_MAP) {\n        if (name.includes(key)) {\n          primaryButton = PRIMARY_BUTTON_MAP[key];\n          break;\n        }\n      }\n\n      return Math.min(primaryButton, gamepad.buttons.length - 1);\n    }\n\n    onFrameStart(sessionId) {\n      this.display.getFrameData(this.frame);\n      const session = this.sessions.get(sessionId);\n\n      if (session.immersive && this.CAN_USE_GAMEPAD) {\n        let prevInputSources = this.gamepadInputSources;\n        this.gamepadInputSources = {};\n        let gamepads = this.global.navigator.getGamepads();\n\n        for (let i = 0; i < gamepads.length; ++i) {\n          let gamepad = gamepads[i];\n\n          if (gamepad && gamepad.displayId > 0) {\n            let inputSourceImpl = prevInputSources[i];\n\n            if (!inputSourceImpl) {\n              inputSourceImpl = new GamepadXRInputSource(this, this.display, this.getPrimaryButtonIndex(gamepad));\n            }\n\n            inputSourceImpl.updateFromGamepad(gamepad);\n            this.gamepadInputSources[i] = inputSourceImpl;\n\n            if (inputSourceImpl.primaryButtonIndex != -1) {\n              let primaryActionPressed = gamepad.buttons[inputSourceImpl.primaryButtonIndex].pressed;\n\n              if (primaryActionPressed && !inputSourceImpl.primaryActionPressed) {\n                this.dispatchEvent('@@webxr-polyfill/input-select-start', {\n                  sessionId: session.id,\n                  inputSource: inputSourceImpl.inputSource\n                });\n              } else if (!primaryActionPressed && inputSourceImpl.primaryActionPressed) {\n                this.dispatchEvent('@@webxr-polyfill/input-select-end', {\n                  sessionId: session.id,\n                  inputSource: inputSourceImpl.inputSource\n                });\n              }\n\n              inputSourceImpl.primaryActionPressed = primaryActionPressed;\n            }\n          }\n        }\n      }\n\n      if (TEST_ENV) {\n        return;\n      }\n\n      if (!session.immersive && session.baseLayer) {\n        const canvas = session.baseLayer.context.canvas;\n        perspective(this.frame.leftProjectionMatrix, session.inlineVerticalFieldOfView, canvas.width / canvas.height, this.depthNear, this.depthFar);\n      }\n    }\n\n    onFrameEnd(sessionId) {\n      const session = this.sessions.get(sessionId);\n\n      if (session.ended || !session.baseLayer) {\n        return;\n      }\n\n      if (session.outputContext && !(session.immersive && !this.display.capabilities.hasExternalDisplay)) {\n        const mirroring = session.immersive && this.display.capabilities.hasExternalDisplay;\n        const iCanvas = session.baseLayer.context.canvas;\n        const iWidth = mirroring ? iCanvas.width / 2 : iCanvas.width;\n        const iHeight = iCanvas.height;\n\n        if (!TEST_ENV) {\n          const oCanvas = session.outputContext.canvas;\n          const oWidth = oCanvas.width;\n          const oHeight = oCanvas.height;\n          const renderContext = session.renderContext;\n\n          if (this.HAS_BITMAP_SUPPORT) {\n            if (iCanvas.transferToImageBitmap) {\n              renderContext.transferFromImageBitmap(iCanvas.transferToImageBitmap());\n            } else {\n              this.global.createImageBitmap(iCanvas, 0, 0, iWidth, iHeight, {\n                resizeWidth: oWidth,\n                resizeHeight: oHeight\n              }).then(bitmap => renderContext.transferFromImageBitmap(bitmap));\n            }\n          } else {\n            renderContext.drawImage(iCanvas, 0, 0, iWidth, iHeight, 0, 0, oWidth, oHeight);\n          }\n        }\n      }\n\n      if (session.immersive && session.baseLayer) {\n        this.display.submitFrame();\n      }\n    }\n\n    cancelAnimationFrame(handle) {\n      this.display.cancelAnimationFrame(handle);\n    }\n\n    async endSession(sessionId) {\n      const session = this.sessions.get(sessionId);\n\n      if (session.ended) {\n        return;\n      }\n\n      if (session.immersive) {\n        return this.display.exitPresent();\n      } else {\n        session.ended = true;\n      }\n    }\n\n    requestStageBounds() {\n      if (this.display.stageParameters) {\n        const width = this.display.stageParameters.sizeX;\n        const depth = this.display.stageParameters.sizeZ;\n        const data = [];\n        data.push(-width / 2);\n        data.push(-depth / 2);\n        data.push(width / 2);\n        data.push(-depth / 2);\n        data.push(width / 2);\n        data.push(depth / 2);\n        data.push(-width / 2);\n        data.push(depth / 2);\n        return data;\n      }\n\n      return null;\n    }\n\n    async requestFrameOfReferenceTransform(type, options) {\n      if ((type === 'local-floor' || type === 'bounded-floor') && this.display.stageParameters && this.display.stageParameters.sittingToStandingTransform) {\n        return this.display.stageParameters.sittingToStandingTransform;\n      }\n\n      return null;\n    }\n\n    getProjectionMatrix(eye) {\n      if (eye === 'left') {\n        return this.frame.leftProjectionMatrix;\n      } else if (eye === 'right') {\n        return this.frame.rightProjectionMatrix;\n      } else if (eye === 'none') {\n        return this.frame.leftProjectionMatrix;\n      } else {\n        throw new Error(\"eye must be of type 'left' or 'right'\");\n      }\n    }\n\n    getViewport(sessionId, eye, layer, target) {\n      const session = this.sessions.get(sessionId);\n      const _layer$context$canvas = layer.context.canvas,\n            width = _layer$context$canvas.width,\n            height = _layer$context$canvas.height;\n\n      if (!session.immersive) {\n        target.x = target.y = 0;\n        target.width = width;\n        target.height = height;\n        return true;\n      }\n\n      if (eye === 'left') {\n        target.x = 0;\n      } else if (eye === 'right') {\n        target.x = width / 2;\n      } else {\n        return false;\n      }\n\n      target.y = 0;\n      target.width = width / 2;\n      target.height = height;\n      return true;\n    }\n\n    getBasePoseMatrix() {\n      let _this$frame$pose = this.frame.pose,\n          position = _this$frame$pose.position,\n          orientation = _this$frame$pose.orientation;\n\n      if (!position && !orientation) {\n        return this.baseModelMatrix;\n      }\n\n      if (!position) {\n        position = this.tempVec3;\n        position[0] = position[1] = position[2] = 0;\n      }\n\n      fromRotationTranslation(this.baseModelMatrix, orientation, position);\n      return this.baseModelMatrix;\n    }\n\n    getBaseViewMatrix(eye) {\n      if (eye === 'left') {\n        return this.frame.leftViewMatrix;\n      } else if (eye === 'right') {\n        return this.frame.rightViewMatrix;\n      } else {\n        throw new Error(\"eye must be of type 'left' or 'right'\");\n      }\n    }\n\n    getInputSources() {\n      let inputSources = [];\n\n      for (let i in this.gamepadInputSources) {\n        inputSources.push(this.gamepadInputSources[i].inputSource);\n      }\n\n      return inputSources;\n    }\n\n    getInputPose(inputSource, coordinateSystem, poseType) {\n      if (!coordinateSystem) {\n        return null;\n      }\n\n      for (let i in this.gamepadInputSources) {\n        let inputSourceImpl = this.gamepadInputSources[i];\n\n        if (inputSourceImpl.inputSource === inputSource) {\n          return inputSourceImpl.getXRPose(coordinateSystem, poseType);\n        }\n      }\n\n      return null;\n    }\n\n    onWindowResize() {}\n\n    onVRDisplayPresentChange(e) {\n      if (!this.display.isPresenting) {\n        this.sessions.forEach(session => {\n          if (session.immersive && !session.ended) {\n            if (session.modifiedCanvasLayer) {\n              const canvas = session.baseLayer.context.canvas;\n              document.body.removeChild(canvas);\n              canvas.setAttribute('style', '');\n            }\n\n            if (this.immersiveSession === session) {\n              this.immersiveSession = null;\n            }\n\n            this.dispatchEvent('@@webxr-polyfill/vr-present-end', session.id);\n          }\n        });\n      }\n    }\n\n  }\n\n  class CardboardXRDevice extends WebVRDevice {\n    constructor(global, cardboardConfig) {\n      const display = new CardboardVRDisplay(cardboardConfig || {});\n      super(global, display);\n      this.display = display;\n      this.frame = {\n        rightViewMatrix: new Float32Array(16),\n        leftViewMatrix: new Float32Array(16),\n        rightProjectionMatrix: new Float32Array(16),\n        leftProjectionMatrix: new Float32Array(16),\n        pose: null,\n        timestamp: null\n      };\n    }\n\n  }\n\n  const getWebVRDevice = async function (global) {\n    let device = null;\n\n    if ('getVRDisplays' in global.navigator) {\n      try {\n        const displays = await global.navigator.getVRDisplays();\n\n        if (displays && displays.length) {\n          device = new WebVRDevice(global, displays[0]);\n        }\n      } catch (e) {}\n    }\n\n    return device;\n  };\n\n  const requestXRDevice = async function (global, config) {\n    if (config.webvr) {\n      let xr = await getWebVRDevice(global);\n\n      if (xr) {\n        return xr;\n      }\n    }\n\n    if (!global.VRFrameData) {\n      global.VRFrameData = function () {\n        this.rightViewMatrix = new Float32Array(16);\n        this.leftViewMatrix = new Float32Array(16);\n        this.rightProjectionMatrix = new Float32Array(16);\n        this.leftProjectionMatrix = new Float32Array(16);\n        this.pose = null;\n      };\n    }\n\n    return new CardboardXRDevice(global, config.cardboardConfig);\n  };\n\n  const CONFIG_DEFAULTS = {\n    global: _global,\n    webvr: true,\n    cardboard: true,\n    cardboardConfig: null,\n    allowCardboardOnDesktop: false\n  };\n  const partials = ['navigator', 'HTMLCanvasElement', 'WebGLRenderingContext'];\n\n  class WebXRPolyfill {\n    constructor(config = {}) {\n      this.config = Object.freeze(Object.assign({}, CONFIG_DEFAULTS, config));\n      this.global = this.config.global;\n      this.nativeWebXR = 'xr' in this.global.navigator;\n      this.injected = false;\n\n      if (!this.nativeWebXR) {\n        this._injectPolyfill(this.global);\n      } else {\n        this._injectCompatibilityShims(this.global);\n      }\n    }\n\n    _injectPolyfill(global) {\n      if (!partials.every(iface => !!global[iface])) {\n        throw new Error(\"Global must have the following attributes : \".concat(partials));\n      }\n\n      for (const className of Object.keys(API)) {\n        if (global[className] !== undefined) {\n          console.warn(\"\".concat(className, \" already defined on global.\"));\n        } else {\n          global[className] = API[className];\n        }\n      }\n\n      {\n        const polyfilledCtx = polyfillMakeXRCompatible(global.WebGLRenderingContext);\n\n        if (polyfilledCtx) {\n          polyfillGetContext(global.HTMLCanvasElement);\n\n          if (global.OffscreenCanvas) {\n            polyfillGetContext(global.OffscreenCanvas);\n          }\n\n          if (global.WebGL2RenderingContext) {\n            polyfillMakeXRCompatible(global.WebGL2RenderingContext);\n          }\n        }\n      }\n      this.injected = true;\n\n      this._patchNavigatorXR();\n    }\n\n    _patchNavigatorXR() {\n      let devicePromise = requestXRDevice(this.global, this.config);\n      this.xr = new XR(devicePromise);\n      Object.defineProperty(this.global.navigator, 'xr', {\n        value: this.xr,\n        configurable: true\n      });\n    }\n\n    _injectCompatibilityShims(global) {\n      if (!partials.every(iface => !!global[iface])) {\n        throw new Error(\"Global must have the following attributes : \".concat(partials));\n      }\n\n      if (global.XRWebGLLayer) {\n        let originalRequestSession = global.navigator.xr.requestSession;\n\n        global.navigator.xr.requestSession = function (mode, options) {\n          return originalRequestSession.call(this, mode, options).then(session => {\n            session._session_mode = mode;\n            return session;\n          });\n        };\n\n        var originalXRLayer = global.XRWebGLLayer;\n\n        global.XRWebGLLayer = function (session, gl, options) {\n          if (!options) {\n            options = {};\n          }\n\n          options.compositionDisabled = session._session_mode === \"inline\";\n          return new originalXRLayer(session, gl, options);\n        };\n      }\n    }\n\n  }\n\n  new WebXRPolyfill();\n}","map":{"version":3,"sources":["/Users/chris/Documents/Github/test-react/src/WebXRApps/webxr-polyfill.module.js"],"names":["test","navigator","userAgent","_global","global","self","window","PRIVATE","Symbol","EventTarget","constructor","listeners","Map","addEventListener","type","listener","Error","typedListeners","get","push","set","removeEventListener","i","length","pop","dispatchEvent","event","queue","PRIVATE$1","XRSessionModes","POLYFILL_REQUEST_SESSION_ERROR","XR$1","devicePromise","device","immersiveSession","inlineSessions","Set","then","supportsSession","mode","Promise","reject","resolve","requestSession","sessionId","session","XRSession","add","onSessionEnd","delete","now","startTime","Date","performance","now$1","PRIVATE$2","XRPose$1","transform","emulatedPosition","_setTransform","EPSILON","ARRAY_TYPE","Float32Array","Array","degree","Math","PI","create","out","copy","a","identity","invert","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","multiply","b","b0","b1","b2","b3","fromRotationTranslation","q","v","x","y","z","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","getTranslation","mat","getRotation","trace","S","sqrt","perspective","fovy","aspect","near","far","f","tan","nf","Infinity","create$1","clone$1","fromValues$1","copy$1","add$1","scale$1","normalize","len","dot","cross","ax","ay","az","bx","by","bz","transformQuat","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","angle","tempA","tempB","cosine","acos","forEach","vec","stride","offset","count","fn","arg","l","min","create$2","create$3","clone$3","fromValues$3","copy$3","normalize$1","forEach$1","create$4","setAxisAngle","axis","rad","s","sin","cos","multiply$4","aw","bw","slerp","t","omega","cosom","sinom","scale0","scale1","invert$2","a0","a1","a2","a3","dot$$1","invDot","fromMat3","m","fTrace","fRoot","j","k","fromEuler","halfToRad","sx","cx","sy","cy","sz","cz","clone$4","fromValues$4","copy$4","normalize$2","rotationTo","tmpvec3","xUnitVec3","yUnitVec3","sqlerp","temp1","temp2","c","d","setAxes","matr","view","right","up","PRIVATE$3","XRRigidTransform$1","matrix","position","orientation","inverse","arguments","_getPoint","DOMPointReadOnly","fromPoint","invMatrix","PRIVATE$4","XRViewerPose","views","leftViewMatrix","rightViewMatrix","poseModelMatrix","_updateFromReferenceSpace","refSpace","pose","getBasePoseMatrix","getBaseViewMatrix","_transformBasePoseMatrix","_adjustForOriginOffset","_transformBaseViewMatrix","_originOffsetMatrix","eye","_updateViewMatrix","PRIVATE$5","XRViewport","target","width","height","XREyes","PRIVATE$6","XRView","includes","temp","Object","viewport","projectionMatrix","getProjectionMatrix","viewMatrix","_getViewport","layer","getViewport","undefined","EPSILON$1","ARRAY_TYPE$1","degree$1","create$7","create$9","length$3","fromValues$9","normalize$3","dot$3","cross$1","len$3","forEach$2","create$10","normalize$4","forEach$3","create$11","setAxisAngle$1","slerp$1","fromMat3$1","normalize$5","rotationTo$1","sqlerp$1","setAxes$1","create$13","forEach$4","PRIVATE$7","XRFrame","immersive","viewerPose","getViewerPose","space","getPose","baseSpace","_specialType","XRPose","XRRigidTransform","getInputPose","_inputSource","PRIVATE$8","XRSpace","specialType","inputSource","DEFAULT_EMULATION_HEIGHT","PRIVATE$9","XRReferenceSpaceTypes","isFloor","XRReferenceSpace","originOffset","transformMatrix","inverseOriginOffsetMatrix","getOffsetReferenceSpace","additionalOffset","newSpace","bounds","POLYFILLED_XR_COMPATIBLE","XR_COMPATIBLE","PRIVATE$10","XRWebGLLayerInit","freeze","antialias","depth","stencil","alpha","multiview","ignoreDepthValues","framebufferScaleFactor","XRWebGLLayer","context","layerInit","config","assign","XRSession$1","ended","framebuffer","getParameter","FRAMEBUFFER_BINDING","framebufferWidth","drawingBufferWidth","framebufferHeight","drawingBufferHeight","_session","PRIVATE$11","id","outputContext","suspended","suspendedCallback","activeRenderState","pendingRenderState","frame","onPresentationEnd","requestAnimationFrame","onPresentationStart","onSelectStart","onSelectEnd","evt","onblur","onfocus","onresetpose","onend","onselect","onselectstart","onselectend","renderState","depthNear","value","depthFar","environmentBlendMode","baseLayer","onBaseLayerSet","requestReferenceSpace","NotSupportedError","TypeError","requestFrameOfReferenceTransform","requestStageBounds","callback","inlineVerticalFieldOfView","onInlineVerticalFieldOfViewSet","onFrameStart","onFrameEnd","cancelAnimationFrame","handle","inputSources","getInputSources","end","endSession","updateRenderState","newState","message","fovSet","max","PRIVATE$12","XRInputSource","impl","gripSpace","targetRaySpace","handedness","targetRayMode","profiles","gamepad","PRIVATE$13","XRRenderStateInit","XRRenderState","stateInit","API","XR","polyfillMakeXRCompatible","Context","prototype","makeXRCompatible","polyfillGetContext","Canvas","getContext","contextType","glAttribs","ctx","call","xrCompatible","isImageBitmapSupported","ImageBitmapRenderingContext","createImageBitmap","applyCanvasStylesForMinimalRendering","canvas","style","display","top","left","commonjsGlobal","unwrapExports","__esModule","hasOwnProperty","createCommonjsModule","module","exports","cardboardVrDisplay","factory","classCallCheck","instance","Constructor","createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","key","protoProps","staticProps","slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_i","iterator","_s","next","done","err","isArray","MIN_TIMESTEP","MAX_TIMESTEP","dataUri","mimeType","svg","encodeURIComponent","lerp","isIOS","platform","isWebViewAndroid","indexOf","isSafari","isFirefoxAndroid","getChromeVersion","match","parseInt","isChromeWithoutDeviceMotion","_match$1$split","split","_match$1$split2","major","minor","branch","build","isR7","isLandscapeMode","rtn","isTimestampDeltaValid","timestampDeltaS","isNaN","getScreenWidth","screen","devicePixelRatio","getScreenHeight","requestFullscreen","element","webkitRequestFullscreen","mozRequestFullScreen","msRequestFullscreen","exitFullscreen","document","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","getFullscreenElement","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","linkProgram","gl","vertexSource","fragmentSource","attribLocationMap","vertexShader","createShader","VERTEX_SHADER","shaderSource","compileShader","fragmentShader","FRAGMENT_SHADER","program","createProgram","attachShader","attribName","bindAttribLocation","deleteShader","getProgramUniforms","uniforms","uniformCount","getProgramParameter","ACTIVE_UNIFORMS","uniformName","uniformInfo","getActiveUniform","name","replace","getUniformLocation","orthoMatrix","bottom","lr","bt","isMobile","check","substr","vendor","opera","extend","dest","src","safariCssSizeWorkaround","setTimeout","frameDataFromPose","piOver180","rad45","mat4_perspectiveFromFieldOfView","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","mat4_fromRotationTranslation","mat4_translate","mat4_invert","defaultOrientation","defaultPosition","updateEyeMatrices","projection","vrDisplay","frameData","timestamp","leftProjectionMatrix","_getFieldOfView","_getEyeOffset","rightProjectionMatrix","isInsideCrossOriginIFrame","isFramed","refOrigin","getOriginFromUrl","referrer","thisOrigin","location","href","url","domainIdx","protoSepIdx","domainEndIdx","substring","getQuaternionAngle","quat","console","warn","warnOnce","observedWarnings","deprecateWarning","deprecated","suggested","alternative","WGLUPreserveGLState","bindings","boundValues","activeTexture","binding","TEXTURE_BINDING_2D","TEXTURE_BINDING_CUBE_MAP","textureUnit","TEXTURE0","TEXTURE31","error","ACTIVE_TEXTURE","boundValue","ARRAY_BUFFER_BINDING","bindBuffer","ARRAY_BUFFER","COLOR_CLEAR_VALUE","clearColor","COLOR_WRITEMASK","colorMask","CURRENT_PROGRAM","useProgram","ELEMENT_ARRAY_BUFFER_BINDING","ELEMENT_ARRAY_BUFFER","bindFramebuffer","FRAMEBUFFER","RENDERBUFFER_BINDING","bindRenderbuffer","RENDERBUFFER","bindTexture","TEXTURE_2D","TEXTURE_CUBE_MAP","VIEWPORT","BLEND","CULL_FACE","DEPTH_TEST","SCISSOR_TEST","STENCIL_TEST","enable","disable","log","toString","glPreserveState","distortionVS","join","distortionFS","CardboardDistorter","cardboardUI","bufferScale","dirtySubmitFrameBindings","ctxAttribs","getContextAttributes","meshWidth","meshHeight","bufferWidth","bufferHeight","realBindFramebuffer","realEnable","realDisable","realColorMask","realClearColor","realViewport","realCanvasWidth","getOwnPropertyDescriptor","__proto__","realCanvasHeight","isPatched","lastBoundFramebuffer","cullFace","depthTest","blend","scissorTest","stencilTest","attribs","texCoord","viewportOffsetScale","setTextureBounds","vertexBuffer","createBuffer","indexBuffer","indexCount","renderTarget","createTexture","createFramebuffer","depthStencilBuffer","depthBuffer","stencilBuffer","createRenderbuffer","patch","onResize","destroy","unpatch","deleteProgram","deleteBuffer","deleteTexture","deleteFramebuffer","deleteRenderbuffer","glState","clear","COLOR_BUFFER_BIT","texImage2D","RGBA","RGB","UNSIGNED_BYTE","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","framebufferTexture2D","COLOR_ATTACHMENT0","renderbufferStorage","DEPTH_STENCIL","framebufferRenderbuffer","DEPTH_STENCIL_ATTACHMENT","DEPTH_COMPONENT16","DEPTH_ATTACHMENT","STENCIL_INDEX8","STENCIL_ATTACHMENT","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","apply","pname","r","g","h","leftBounds","rightBounds","submitFrame","enableVertexAttribArray","vertexAttribPointer","FLOAT","uniform1i","diffuse","uniform4fv","drawElements","TRIANGLES","UNSIGNED_SHORT","renderNoState","preserveDrawingBuffer","updateDeviceInfo","deviceInfo","vertices","computeMeshVertices_","bufferData","STATIC_DRAW","indices","computeMeshIndices_","lensFrustum","getLeftEyeVisibleTanAngles","noLensFrustum","getLeftEyeNoLensTanAngles","getLeftEyeVisibleScreenRect","vidx","e","u","distortion","distortInverse","p","Uint16Array","halfwidth","halfheight","iidx","getOwnPropertyDescriptor_","proto","attrName","getAttribute","val","setAttribute","uiVS","uiFS","DEG2RAD","kAnglePerGearSection","kOuterRimEndAngle","kInnerRimBeginAngle","kOuterRadius","kMiddleRadius","kInnerRadius","kCenterLineThicknessDp","kButtonWidthDp","kTouchSlopFactor","CardboardUI","gearOffset","gearVertexCount","arrowOffset","arrowVertexCount","projMat","listen","optionsCallback","backCallback","midline","clientWidth","buttonSize","clientX","clientY","clientHeight","physicalPixels","scalingRatio","dps","lineWidth","buttonScale","buttonBorder","addGearSegment","theta","segmentTheta","addArrowVertex","angledLineWidth","render","uniform4f","color","uniformMatrix4fv","projectionMat","drawArrays","TRIANGLE_STRIP","Distortion","coefficients","radius","r0","r1","dr0","distort","abs","dr1","r2","ret","degToRad","radToDeg","Vector3","scalar","invScalar","multiplyScalar","applyQuaternion","ix","iy","iz","iw","crossVectors","Quaternion","quaternion","setFromEulerXYZ","c1","c2","c3","s1","s2","s3","setFromEulerYXZ","setFromAxisAngle","halfAngle","multiplyQuaternions","qax","qay","qaz","qaw","qbx","qby","qbz","qbw","qb","cosHalfTheta","halfTheta","sinHalfTheta","ratioA","ratioB","setFromUnitVectors","v1","EPS","vFrom","vTo","Device","params","widthMeters","heightMeters","bevelMeters","DEFAULT_ANDROID","DEFAULT_IOS","Viewers","CardboardV1","CardboardViewer","label","interLensDistance","baselineLensDistance","screenLensDistance","distortionCoefficients","inverseCoefficients","CardboardV2","DeviceInfo","deviceParams","additionalViewers","viewer","updateDeviceParams","determineDevice_","getDevice","setViewer","METERS_PER_INCH","metersPerPixelX","xdpi","metersPerPixelY","ydpi","bevelMm","getDistortedFieldOfViewLeftEye","eyeToScreenDistance","outerDist","innerDist","bottomDist","topDist","outerAngle","atan","innerAngle","bottomAngle","topAngle","fovLeft","fovTop","fovRight","fovBottom","halfWidth","halfHeight","verticalLensOffset","centerX","centerY","centerZ","screenLeft","screenTop","screenRight","screenBottom","result","undistortedFrustum","dist","eyeX","eyeY","getFieldOfViewLeftEye","opt_isUndistorted","getUndistortedFieldOfViewLeftEye","getFieldOfViewRightEye","getUndistortedParams_","getUndistortedViewportLeftEye","screenWidth","screenHeight","xPxPerTanAngle","yPxPerTanAngle","round","eyePosX","eyePosY","halfLensDistance","maxFov","viewerMax","format","last_updated","devices","DPDB_CACHE","Dpdb","onDeviceParamsUpdated","dpdb","recalculateDeviceParams_","xhr","XMLHttpRequest","obj","open","loading","status","JSON","parse","response","send","getDeviceParams","newDeviceParams","calcDeviceParams_","db","rules","matched","rule","ruleMatches_","dpi","DeviceParams","ua","res","resX","resY","SensorSample","sample","timestampS","sensorSample","ComplementaryFilter","kFilter","isDebug","currentAccelMeasurement","currentGyroMeasurement","previousGyroMeasurement","filterQ","previousFilterQ","accelQ","isOrientationInitialized","estimatedGravity","measuredGravity","gyroIntegralQ","addAccelMeasurement","vector","addGyroMeasurement","deltaT","run_","accelToQuaternion_","gyroDeltaQ","gyroToQuaternionDelta_","invFilterQ","deltaQ","toFixed","targetQ","getOrientation","accel","normAccel","gyro","dt","PosePredictor","predictionTimeS","previousQ","previousTimestampS","outQ","getPrediction","currentQ","angularSpeed","predictAngle","FusionPoseSensor","predictionTime","yawOnly","accelerometer","gyroscope","filter","posePredictor","chromeVersion","isDeviceMotionInRadians","isWithoutDeviceMotion","filterToWorldQ","inverseWorldToScreenQ","worldToScreenQ","originalPoseAdjustQ","setScreenTransform_","resetQ","orientationOut_","start","getPosition","_deviceOrientationQ","deviceOrientationFixQ","deviceOrientationFilterToWorldQ","filterOrientation","resetPose","onDeviceOrientation_","beta","gamma","onDeviceMotion_","deviceMotion","updateDeviceMotion_","accGravity","accelerationIncludingGravity","rotRate","rotationRate","timeStamp","deltaS","onOrientationChange_","screenOrientation","onMessage_","data","toLowerCase","deviceMotionEvent","onDeviceMotionCallback_","bind","onOrientationChangeCallback_","onMessageCallback_","onDeviceOrientationCallback_","stop","SENSOR_FREQUENCY","X_AXIS","Z_AXIS","SENSOR_TO_VR","PoseSensor","sensor","fusionSensor","_out","api","errors","_sensorQ","_outQ","_onSensorRead","_onSensorError","init","RelativeOrientationSensor","frequency","referenceFrame","useDeviceMotion","K_FILTER","PREDICTION_TIME_S","YAW_ONLY","DEBUG","rotateInstructionsAsset","RotateInstructions","loadIcon_","overlay","createElement","backgroundColor","fontFamily","zIndex","img","icon","marginLeft","marginTop","appendChild","text","textAlign","fontSize","lineHeight","margin","innerHTML","snackbar","padding","boxSizing","snackbarText","float","snackbarButton","fontWeight","textTransform","borderLeft","paddingLeft","textDecoration","hide","show","parent","parentElement","body","removeChild","querySelector","showTemporarily","ms","timer","disableShowTemporarily","clearTimeout","update","DEFAULT_VIEWER","VIEWER_KEY","CLASS_NAME","ViewerSelector","defaultViewer","selectedKey","localStorage","getItem","dialog","createDialog_","root","onChangeCallbacks_","selected","checked","contains","getCurrentViewer","getSelectedKey_","input","onChange","cb","fireOnChange_","onSave_","setItem","options","container","classList","background","overflow","boxShadow","createH1_","createChoice_","createButton_","h1","marginBottom","div","onclick","button","letterSpacing","border","commonjsGlobal$$1","unwrapExports$$1","createCommonjsModule$$1","NoSleep","webpackUniversalModuleDefinition","modules","installedModules","__webpack_require__","moduleId","getter","o","n","getDefault","getModuleExports","object","property","_createClass","_classCallCheck","mediaFile","oldIOS","parseFloat","exec","MSStream","noSleepTimer","noSleepVideo","currentTime","random","setInterval","play","clearInterval","pause","NoSleep$1","nextDisplayId","defaultLeftBounds","defaultRightBounds","raf","caf","VRFrameData","VRDisplayCapabilities","hasPosition","hasExternalDisplay","canPresent","maxLayers","hasOrientation","VRDisplay","USE_WAKELOCK","wakelock","isPolyfilled","displayId","displayName","isPresenting","capabilities","stageParameters","waitingForPresent_","layer_","originalParent_","fullscreenElement_","fullscreenWrapper_","fullscreenElementCachedStyle_","fullscreenEventTarget_","fullscreenChangeHandler_","fullscreenErrorHandler_","wakelock_","getFrameData","_getPose","_resetPose","getImmediatePose","wrapForFullscreen","cssProperties","insertBefore","firstChild","applyFullscreenElementStyle","removeFullscreenWrapper","removeAttribute","requestPresent","layers","wasPresenting","incomingLayer","source","updatePresent_","predistorted","slice","onFullscreenChange","actualFullscreenElement","lock","catch","beginPresent_","unlock","disableWakeLock","endPresent_","removeFullscreenListeners_","fireVRDisplayPresentChange_","onFullscreenError","addFullscreenListeners_","enableWakeLock","exitPresent","getLayers","CustomEvent","detail","fireVRDisplayConnect_","changeHandler","errorHandler","fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled","getEyeParameters","whichEye","ADDITIONAL_VIEWERS","MOBILE_WAKE_LOCK","DPDB_URL","CARDBOARD_UI_DISABLED","ROTATE_INSTRUCTIONS_DISABLED","BUFFER_SCALE","DIRTY_SUBMIT_FRAME_BINDINGS","Eye","LEFT","RIGHT","CardboardVRDisplay","config$$1","defaults","bufferScale_","poseSensor_","distorter_","cardboardUI_","dpdb_","onDeviceParamsUpdated_","deviceInfo_","viewerSelector_","onViewerChanged_","rotateInstructions_","onResize_","linearVelocity","linearAcceleration","angularVelocity","angularAcceleration","fieldOfView","eyeParams","renderWidth","renderHeight","newParams","updateBounds_","stopPropagation","preventDefault","orientationHandler","vrdisplaypresentchangeHandler","fireVRDisplayDeviceParamsChange_","lastWidth","lastHeight","vrdisplay","XRDevice","onWindowResize","coordinateSystem","poseType","oculusGo","mapping","buttons","gripTransform","oculusTouch","displayProfiles","axes","openVr","targetRayTransform","windowsMixedReality","GamepadMappings","HEAD_ELBOW_OFFSET_RIGHTHANDED","HEAD_ELBOW_OFFSET_LEFTHANDED","ELBOW_WRIST_OFFSET","WRIST_CONTROLLER_OFFSET","ARM_EXTENSION_OFFSET","ELBOW_BEND_RATIO","EXTENSION_RATIO_WEIGHT","MIN_ANGULAR_SPEED","MIN_ANGLE_DELTA","MIN_EXTENSION_COS","MAX_EXTENSION_COS","RAD_TO_DEG","eulerFromQuaternion","order","clamp","min$$1","max$$1","sqx","sqy","sqz","sqw","atan2","asin","OrientationArmModel","hand","headElbowOffset","controllerQ","lastControllerQ","headQ","headPos","elbowPos","wristPos","time","lastTime","rootQ","setHandedness","controllerOrientation","headPoseMatrix","headYawQ","getHeadYawOrientation_","angleDelta","quatAngle_","timeDelta","controllerAngularSpeed","controllerForward","controllerDotY","extensionRatio","clamp_","controllerCameraQ","elbowOffset","totalAngle","totalAngleDeg","lerpSuppression","pow","elbowRatio","wristRatio","lerpValue","wristQ","invWristQ","elbowQ","headEuler","destinationQ","q1","q2","vec1","vec2","PRIVATE$14","PLACEHOLDER_BUTTON","pressed","touched","XRRemappedGamepad","map","_update","_profiles","index","connected","GamepadXRInputSource","polyfill","primaryButtonIndex","nativeGamepad","lastPosition","basePoseMatrix","outputMatrix","primaryActionPressed","armModel","updateFromGamepad","updateBasePoseMatrix","getXRPose","TEST_ENV","EXTRA_PRESENTATION_ATTRIBUTES","highRefreshRate","PRIMARY_BUTTON_MAP","oculus","openvr","SESSION_ID","Session","polyfillOptions","modifiedCanvasLayer","renderContextType","renderContext","WebVRDevice","sessions","baseModelMatrix","gamepadInputSources","tempVec3","onVRDisplayPresentChange","CAN_USE_GAMEPAD","HAS_BITMAP_SUPPORT","attributes","getPrimaryButtonIndex","primaryButton","prevInputSources","gamepads","getGamepads","inputSourceImpl","mirroring","iCanvas","iWidth","iHeight","oCanvas","oWidth","oHeight","transferToImageBitmap","transferFromImageBitmap","resizeWidth","resizeHeight","bitmap","drawImage","sizeX","sizeZ","sittingToStandingTransform","CardboardXRDevice","cardboardConfig","getWebVRDevice","displays","getVRDisplays","requestXRDevice","webvr","xr","CONFIG_DEFAULTS","cardboard","allowCardboardOnDesktop","partials","WebXRPolyfill","nativeWebXR","injected","_injectPolyfill","_injectCompatibilityShims","every","iface","className","keys","polyfilledCtx","WebGLRenderingContext","HTMLCanvasElement","OffscreenCanvas","WebGL2RenderingContext","_patchNavigatorXR","originalRequestSession","_session_mode","originalXRLayer","compositionDisabled"],"mappings":"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","sourcesContent":["/* eslint-disable */\n\n/**\n * @license\n * webxr-polyfill\n * Copyright (c) 2017 Google\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @license\n * cardboard-vr-display\n * Copyright (c) 2015-2017 Google\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @license\n * webvr-polyfill-dpdb \n * Copyright (c) 2017 Google\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @license\n * wglu-preserve-state\n * Copyright (c) 2016, Brandon Jones.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\n/**\n * @license\n * nosleep.js\n * Copyright (c) 2017, Rich Tibbett\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\n\nif (!/(Helio)/g.test(navigator.userAgent)) {\n\nconst _global = typeof global !== 'undefined' ? global :\n                typeof self !== 'undefined' ? self :\n                typeof window !== 'undefined' ? window : {};\n\nconst PRIVATE = Symbol('@@webxr-polyfill/EventTarget');\nclass EventTarget {\n  constructor() {\n    this[PRIVATE] = {\n      listeners: new Map(),\n    };\n  }\n  addEventListener(type, listener) {\n    if (typeof type !== 'string') { throw new Error('`type` must be a string'); }\n    if (typeof listener !== 'function') { throw new Error('`listener` must be a function'); }\n    const typedListeners = this[PRIVATE].listeners.get(type) || [];\n    typedListeners.push(listener);\n    this[PRIVATE].listeners.set(type, typedListeners);\n  }\n  removeEventListener(type, listener) {\n    if (typeof type !== 'string') { throw new Error('`type` must be a string'); }\n    if (typeof listener !== 'function') { throw new Error('`listener` must be a function'); }\n    const typedListeners = this[PRIVATE].listeners.get(type) || [];\n    for (let i = typedListeners.length; i >= 0; i--) {\n      if (typedListeners[i] === listener) {\n        typedListeners.pop();\n      }\n    }\n  }\n  dispatchEvent(type, event) {\n    const typedListeners = this[PRIVATE].listeners.get(type) || [];\n    const queue = [];\n    for (let i = 0; i < typedListeners.length; i++) {\n      queue[i] = typedListeners[i];\n    }\n    for (let listener of queue) {\n      listener(event);\n    }\n    if (typeof this[`on${type}`] === 'function') {\n      this[`on${type}`](event);\n    }\n  }\n}\n\nconst PRIVATE$1 = Symbol('@@webxr-polyfill/XR');\nconst XRSessionModes = ['inline', 'immersive-vr', 'immersive-ar'];\nconst POLYFILL_REQUEST_SESSION_ERROR =\n`Polyfill Error: Must call navigator.xr.supportsSession() with any XRSessionMode\nor navigator.xr.requestSession('inline') prior to requesting an immersive\nsession. This is a limitation specific to the WebXR Polyfill and does not apply\nto native implementations of the API.`;\nclass XR$1 extends EventTarget {\n  constructor(devicePromise) {\n    super();\n    this[PRIVATE$1] = {\n      device: null,\n      devicePromise,\n      immersiveSession: null,\n      inlineSessions: new Set(),\n    };\n    devicePromise.then((device) => { this[PRIVATE$1].device = device; });\n  }\n  async supportsSession(mode) {\n    if (!this[PRIVATE$1].device) {\n      await this[PRIVATE$1].devicePromise;\n    }\n    if (mode != 'inline') {\n      if (!this[PRIVATE$1].device.supportsSession(mode)) {\n        return Promise.reject(null);\n      }\n    }\n    return Promise.resolve(null);\n  }\n  async requestSession(mode) {\n    if (!this[PRIVATE$1].device) {\n      if (mode != 'inline') {\n        throw new Error(POLYFILL_REQUEST_SESSION_ERROR);\n      } else {\n        await this[PRIVATE$1].devicePromise;\n      }\n    }\n    const sessionId = await this[PRIVATE$1].device.requestSession(mode);\n    const session = new XRSession(this[PRIVATE$1].device, mode, sessionId);\n    if (mode == 'inline') {\n      this[PRIVATE$1].inlineSessions.add(session);\n    } else {\n      this[PRIVATE$1].immersiveSession = session;\n    }\n    const onSessionEnd = () => {\n      if (mode == 'inline') {\n        this[PRIVATE$1].inlineSessions.delete(session);\n      } else {\n        this[PRIVATE$1].immersiveSession = null;\n      }\n      session.removeEventListener('end', onSessionEnd);\n    };\n    session.addEventListener('end', onSessionEnd);\n    return session;\n  }\n}\n\nlet now;\nif ('performance' in _global === false) {\n  let startTime = Date.now();\n  now = () => Date.now() - startTime;\n} else {\n  now = () => performance.now();\n}\nvar now$1 = now;\n\nconst PRIVATE$2 = Symbol('@@webxr-polyfill/XRPose');\nclass XRPose$1 {\n  constructor(transform, emulatedPosition) {\n    this[PRIVATE$2] = {\n      transform,\n      emulatedPosition,\n    };\n  }\n  get transform() { return this[PRIVATE$2].transform; }\n  get emulatedPosition() { return this[PRIVATE$2].emulatedPosition; }\n  _setTransform(transform) { this[PRIVATE$2].transform = transform; }\n}\n\nconst EPSILON = 0.000001;\nlet ARRAY_TYPE = (typeof Float32Array !== 'undefined') ? Float32Array : Array;\n\n\nconst degree = Math.PI / 180;\n\nfunction create() {\n  let out = new ARRAY_TYPE(16);\n  if(ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n\nfunction copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n\n\nfunction identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n\nfunction invert(out, a) {\n  let a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n  let a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n  let a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n  let a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n  let b00 = a00 * a11 - a01 * a10;\n  let b01 = a00 * a12 - a02 * a10;\n  let b02 = a00 * a13 - a03 * a10;\n  let b03 = a01 * a12 - a02 * a11;\n  let b04 = a01 * a13 - a03 * a11;\n  let b05 = a02 * a13 - a03 * a12;\n  let b06 = a20 * a31 - a21 * a30;\n  let b07 = a20 * a32 - a22 * a30;\n  let b08 = a20 * a33 - a23 * a30;\n  let b09 = a21 * a32 - a22 * a31;\n  let b10 = a21 * a33 - a23 * a31;\n  let b11 = a22 * a33 - a23 * a32;\n  let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n  if (!det) {\n    return null;\n  }\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n\n\nfunction multiply(out, a, b) {\n  let a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n  let a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n  let a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n  let a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n  let b0  = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\n  out[0] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n  out[1] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n  out[2] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n  out[3] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n  b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\n  out[4] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n  out[5] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n  out[6] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n  out[7] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n  b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\n  out[8] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n  out[9] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n  out[10] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n  out[11] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n  b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\n  out[12] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\n  out[13] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\n  out[14] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\n  out[15] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\nfunction fromRotationTranslation(out, q, v) {\n  let x = q[0], y = q[1], z = q[2], w = q[3];\n  let x2 = x + x;\n  let y2 = y + y;\n  let z2 = z + z;\n  let xx = x * x2;\n  let xy = x * y2;\n  let xz = x * z2;\n  let yy = y * y2;\n  let yz = y * z2;\n  let zz = z * z2;\n  let wx = w * x2;\n  let wy = w * y2;\n  let wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n\nfunction getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n\nfunction getRotation(out, mat) {\n  let trace = mat[0] + mat[5] + mat[10];\n  let S = 0;\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (mat[6] - mat[9]) / S;\n    out[1] = (mat[8] - mat[2]) / S;\n    out[2] = (mat[1] - mat[4]) / S;\n  } else if ((mat[0] > mat[5]) && (mat[0] > mat[10])) {\n    S = Math.sqrt(1.0 + mat[0] - mat[5] - mat[10]) * 2;\n    out[3] = (mat[6] - mat[9]) / S;\n    out[0] = 0.25 * S;\n    out[1] = (mat[1] + mat[4]) / S;\n    out[2] = (mat[8] + mat[2]) / S;\n  } else if (mat[5] > mat[10]) {\n    S = Math.sqrt(1.0 + mat[5] - mat[0] - mat[10]) * 2;\n    out[3] = (mat[8] - mat[2]) / S;\n    out[0] = (mat[1] + mat[4]) / S;\n    out[1] = 0.25 * S;\n    out[2] = (mat[6] + mat[9]) / S;\n  } else {\n    S = Math.sqrt(1.0 + mat[10] - mat[0] - mat[5]) * 2;\n    out[3] = (mat[1] - mat[4]) / S;\n    out[0] = (mat[8] + mat[2]) / S;\n    out[1] = (mat[6] + mat[9]) / S;\n    out[2] = 0.25 * S;\n  }\n  return out;\n}\n\n\n\n\nfunction perspective(out, fovy, aspect, near, far) {\n  let f = 1.0 / Math.tan(fovy / 2), nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = (2 * far * near) * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n  return out;\n}\n\nfunction create$1() {\n  let out = new ARRAY_TYPE(3);\n  if(ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  return out;\n}\nfunction clone$1(a) {\n  var out = new ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\nfunction length(a) {\n  let x = a[0];\n  let y = a[1];\n  let z = a[2];\n  return Math.sqrt(x*x + y*y + z*z);\n}\nfunction fromValues$1(x, y, z) {\n  let out = new ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\nfunction copy$1(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\nfunction add$1(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\n\n\n\n\n\n\n\nfunction scale$1(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n\n\n\n\n\n\nfunction normalize(out, a) {\n  let x = a[0];\n  let y = a[1];\n  let z = a[2];\n  let len = x*x + y*y + z*z;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n    out[2] = a[2] * len;\n  }\n  return out;\n}\nfunction dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\nfunction cross(out, a, b) {\n  let ax = a[0], ay = a[1], az = a[2];\n  let bx = b[0], by = b[1], bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\n\n\n\n\n\nfunction transformQuat(out, a, q) {\n    let qx = q[0], qy = q[1], qz = q[2], qw = q[3];\n    let x = a[0], y = a[1], z = a[2];\n    let uvx = qy * z - qz * y,\n        uvy = qz * x - qx * z,\n        uvz = qx * y - qy * x;\n    let uuvx = qy * uvz - qz * uvy,\n        uuvy = qz * uvx - qx * uvz,\n        uuvz = qx * uvy - qy * uvx;\n    let w2 = qw * 2;\n    uvx *= w2;\n    uvy *= w2;\n    uvz *= w2;\n    uuvx *= 2;\n    uuvy *= 2;\n    uuvz *= 2;\n    out[0] = x + uvx + uuvx;\n    out[1] = y + uvy + uuvy;\n    out[2] = z + uvz + uuvz;\n    return out;\n}\n\n\n\nfunction angle(a, b) {\n  let tempA = fromValues$1(a[0], a[1], a[2]);\n  let tempB = fromValues$1(b[0], b[1], b[2]);\n  normalize(tempA, tempA);\n  normalize(tempB, tempB);\n  let cosine = dot(tempA, tempB);\n  if(cosine > 1.0) {\n    return 0;\n  }\n  else if(cosine < -1.0) {\n    return Math.PI;\n  } else {\n    return Math.acos(cosine);\n  }\n}\n\n\n\n\n\n\n\n\nconst len = length;\n\nconst forEach = (function() {\n  let vec = create$1();\n  return function(a, stride, offset, count, fn, arg) {\n    let i, l;\n    if(!stride) {\n      stride = 3;\n    }\n    if(!offset) {\n      offset = 0;\n    }\n    if(count) {\n      l = Math.min((count * stride) + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for(i = offset; i < l; i += stride) {\n      vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\n      fn(vec, vec, arg);\n      a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\n    }\n    return a;\n  };\n})();\n\nfunction create$2() {\n  let out = new ARRAY_TYPE(9);\n  if(ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n\nfunction create$3() {\n  let out = new ARRAY_TYPE(4);\n  if(ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n  return out;\n}\nfunction clone$3(a) {\n  let out = new ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\nfunction fromValues$3(x, y, z, w) {\n  let out = new ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\nfunction copy$3(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction normalize$1(out, a) {\n  let x = a[0];\n  let y = a[1];\n  let z = a[2];\n  let w = a[3];\n  let len = x*x + y*y + z*z + w*w;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = x * len;\n    out[1] = y * len;\n    out[2] = z * len;\n    out[3] = w * len;\n  }\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst forEach$1 = (function() {\n  let vec = create$3();\n  return function(a, stride, offset, count, fn, arg) {\n    let i, l;\n    if(!stride) {\n      stride = 4;\n    }\n    if(!offset) {\n      offset = 0;\n    }\n    if(count) {\n      l = Math.min((count * stride) + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for(i = offset; i < l; i += stride) {\n      vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2]; vec[3] = a[i+3];\n      fn(vec, vec, arg);\n      a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2]; a[i+3] = vec[3];\n    }\n    return a;\n  };\n})();\n\nfunction create$4() {\n  let out = new ARRAY_TYPE(4);\n  if(ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  out[3] = 1;\n  return out;\n}\n\nfunction setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  let s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n\nfunction multiply$4(out, a, b) {\n  let ax = a[0], ay = a[1], az = a[2], aw = a[3];\n  let bx = b[0], by = b[1], bz = b[2], bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n\n\n\n\nfunction slerp(out, a, b, t) {\n  let ax = a[0], ay = a[1], az = a[2], aw = a[3];\n  let bx = b[0], by = b[1], bz = b[2], bw = b[3];\n  let omega, cosom, sinom, scale0, scale1;\n  cosom = ax * bx + ay * by + az * bz + aw * bw;\n  if ( cosom < 0.0 ) {\n    cosom = -cosom;\n    bx = - bx;\n    by = - by;\n    bz = - bz;\n    bw = - bw;\n  }\n  if ( (1.0 - cosom) > EPSILON ) {\n    omega  = Math.acos(cosom);\n    sinom  = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    scale0 = 1.0 - t;\n    scale1 = t;\n  }\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n\nfunction invert$2(out, a) {\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\n  let dot$$1 = a0*a0 + a1*a1 + a2*a2 + a3*a3;\n  let invDot = dot$$1 ? 1.0/dot$$1 : 0;\n  out[0] = -a0*invDot;\n  out[1] = -a1*invDot;\n  out[2] = -a2*invDot;\n  out[3] = a3*invDot;\n  return out;\n}\n\nfunction fromMat3(out, m) {\n  let fTrace = m[0] + m[4] + m[8];\n  let fRoot;\n  if ( fTrace > 0.0 ) {\n    fRoot = Math.sqrt(fTrace + 1.0);\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5/fRoot;\n    out[0] = (m[5]-m[7])*fRoot;\n    out[1] = (m[6]-m[2])*fRoot;\n    out[2] = (m[1]-m[3])*fRoot;\n  } else {\n    let i = 0;\n    if ( m[4] > m[0] )\n      i = 1;\n    if ( m[8] > m[i*3+i] )\n      i = 2;\n    let j = (i+1)%3;\n    let k = (i+2)%3;\n    fRoot = Math.sqrt(m[i*3+i]-m[j*3+j]-m[k*3+k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j*3+k] - m[k*3+j]) * fRoot;\n    out[j] = (m[j*3+i] + m[i*3+j]) * fRoot;\n    out[k] = (m[k*3+i] + m[i*3+k]) * fRoot;\n  }\n  return out;\n}\nfunction fromEuler(out, x, y, z) {\n    let halfToRad = 0.5 * Math.PI / 180.0;\n    x *= halfToRad;\n    y *= halfToRad;\n    z *= halfToRad;\n    let sx = Math.sin(x);\n    let cx = Math.cos(x);\n    let sy = Math.sin(y);\n    let cy = Math.cos(y);\n    let sz = Math.sin(z);\n    let cz = Math.cos(z);\n    out[0] = sx * cy * cz - cx * sy * sz;\n    out[1] = cx * sy * cz + sx * cy * sz;\n    out[2] = cx * cy * sz - sx * sy * cz;\n    out[3] = cx * cy * cz + sx * sy * sz;\n    return out;\n}\n\nconst clone$4 = clone$3;\nconst fromValues$4 = fromValues$3;\nconst copy$4 = copy$3;\n\n\n\n\n\n\n\n\n\n\nconst normalize$2 = normalize$1;\n\n\nconst rotationTo = (function() {\n  let tmpvec3 = create$1();\n  let xUnitVec3 = fromValues$1(1,0,0);\n  let yUnitVec3 = fromValues$1(0,1,0);\n  return function(out, a, b) {\n    let dot$$1 = dot(a, b);\n    if (dot$$1 < -0.999999) {\n      cross(tmpvec3, xUnitVec3, a);\n      if (len(tmpvec3) < 0.000001)\n        cross(tmpvec3, yUnitVec3, a);\n      normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot$$1 > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot$$1;\n      return normalize$2(out, out);\n    }\n  };\n})();\nconst sqlerp = (function () {\n  let temp1 = create$4();\n  let temp2 = create$4();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}());\nconst setAxes = (function() {\n  let matr = create$2();\n  return function(out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize$2(out, fromMat3(out, matr));\n  };\n})();\n\nconst PRIVATE$3 = Symbol('@@webxr-polyfill/XRRigidTransform');\nclass XRRigidTransform$1 {\n  constructor() {\n    this[PRIVATE$3] = {\n      matrix: null,\n      position: null,\n      orientation: null,\n      inverse: null,\n    };\n    if (arguments.length === 0) {\n      this[PRIVATE$3].matrix = identity(new Float32Array(16));\n    } else if (arguments.length === 1) {\n      if (arguments[0] instanceof Float32Array) {\n        this[PRIVATE$3].matrix = arguments[0];\n      } else {\n        this[PRIVATE$3].position = this._getPoint(arguments[0]);\n        this[PRIVATE$3].orientation = DOMPointReadOnly.fromPoint({\n            x: 0, y: 0, z: 0, w: 1\n        });\n      }\n    } else if (arguments.length === 2) {\n      this[PRIVATE$3].position = this._getPoint(arguments[0]);\n      this[PRIVATE$3].orientation = this._getPoint(arguments[1]);\n    } else {\n      throw new Error(\"Too many arguments!\");\n    }\n    if (this[PRIVATE$3].matrix) {\n        let position = create$1();\n        getTranslation(position, this[PRIVATE$3].matrix);\n        this[PRIVATE$3].position = DOMPointReadOnly.fromPoint({\n            x: position[0],\n            y: position[1],\n            z: position[2]\n        });\n        let orientation = create$4();\n        getRotation(orientation, this[PRIVATE$3].matrix);\n        this[PRIVATE$3].orientation = DOMPointReadOnly.fromPoint({\n          x: orientation[0],\n          y: orientation[1],\n          z: orientation[2],\n          w: orientation[3]\n        });\n    } else {\n        this[PRIVATE$3].matrix = identity(new Float32Array(16));\n        fromRotationTranslation(\n          this[PRIVATE$3].matrix,\n          fromValues$4(\n            this[PRIVATE$3].orientation.x,\n            this[PRIVATE$3].orientation.y,\n            this[PRIVATE$3].orientation.z,\n            this[PRIVATE$3].orientation.w),\n          fromValues$1(\n            this[PRIVATE$3].position.x,\n            this[PRIVATE$3].position.y,\n            this[PRIVATE$3].position.z)\n        );\n    }\n  }\n  _getPoint(arg) {\n    if (arg instanceof DOMPointReadOnly) {\n      return arg;\n    }\n    return DOMPointReadOnly.fromPoint(arg);\n  }\n  get matrix() { return this[PRIVATE$3].matrix; }\n  get position() { return this[PRIVATE$3].position; }\n  get orientation() { return this[PRIVATE$3].orientation; }\n  get inverse() {\n    if (this[PRIVATE$3].inverse === null) {\n      let invMatrix = identity(new Float32Array(16));\n      invert(invMatrix, this[PRIVATE$3].matrix);\n      this[PRIVATE$3].inverse = new XRRigidTransform$1(invMatrix);\n      this[PRIVATE$3].inverse[PRIVATE$3].inverse = this;\n    }\n    return this[PRIVATE$3].inverse;\n  }\n}\n\nconst PRIVATE$4 = Symbol('@@webxr-polyfill/XRViewerPose');\nclass XRViewerPose extends XRPose$1 {\n  constructor(device, views) {\n    super(new XRRigidTransform$1(), false);\n    this[PRIVATE$4] = {\n      device,\n      views,\n      leftViewMatrix: identity(new Float32Array(16)),\n      rightViewMatrix: identity(new Float32Array(16)),\n      poseModelMatrix: identity(new Float32Array(16)),\n    };\n  }\n  get poseModelMatrix() { return this[PRIVATE$4].poseModelMatrix; }\n  get views() {\n    return this[PRIVATE$4].views;\n  }\n  _updateFromReferenceSpace(refSpace) {\n    const pose = this[PRIVATE$4].device.getBasePoseMatrix();\n    const leftViewMatrix = this[PRIVATE$4].device.getBaseViewMatrix('left');\n    const rightViewMatrix = this[PRIVATE$4].device.getBaseViewMatrix('right');\n    if (pose) {\n      refSpace._transformBasePoseMatrix(this[PRIVATE$4].poseModelMatrix, pose);\n      refSpace._adjustForOriginOffset(this[PRIVATE$4].poseModelMatrix);\n      super._setTransform(new XRRigidTransform$1(this[PRIVATE$4].poseModelMatrix));\n    }\n    if (leftViewMatrix) {\n      refSpace._transformBaseViewMatrix(\n        this[PRIVATE$4].leftViewMatrix,\n        leftViewMatrix,\n        this[PRIVATE$4].poseModelMatrix);\n      multiply(\n        this[PRIVATE$4].leftViewMatrix,\n        this[PRIVATE$4].leftViewMatrix,\n        refSpace._originOffsetMatrix());\n    }\n    if (rightViewMatrix) {\n      refSpace._transformBaseViewMatrix(\n        this[PRIVATE$4].rightViewMatrix,\n        rightViewMatrix,\n        this[PRIVATE$4].poseModelMatrix);\n      multiply(\n        this[PRIVATE$4].rightViewMatrix,\n        this[PRIVATE$4].rightViewMatrix,\n        refSpace._originOffsetMatrix());\n    }\n    for (let view of this[PRIVATE$4].views) {\n      if (view.eye == \"left\") {\n        view._updateViewMatrix(this[PRIVATE$4].leftViewMatrix);\n      } else if (view.eye == \"right\") {\n        view._updateViewMatrix(this[PRIVATE$4].rightViewMatrix);\n      }\n    }\n  }\n}\n\nconst PRIVATE$5 = Symbol('@@webxr-polyfill/XRViewport');\nclass XRViewport {\n  constructor(target) {\n    this[PRIVATE$5] = { target };\n  }\n  get x() { return this[PRIVATE$5].target.x; }\n  get y() { return this[PRIVATE$5].target.y; }\n  get width() { return this[PRIVATE$5].target.width; }\n  get height() { return this[PRIVATE$5].target.height; }\n}\n\nconst XREyes = ['left', 'right'];\nconst PRIVATE$6 = Symbol('@@webxr-polyfill/XRView');\nclass XRView {\n  constructor(device, eye, sessionId) {\n    if (!XREyes.includes(eye)) {\n      throw new Error(`XREye must be one of: ${XREyes}`);\n    }\n    const temp = Object.create(null);\n    const viewport = new XRViewport(temp);\n    this[PRIVATE$6] = {\n      device,\n      eye,\n      viewport,\n      temp,\n      sessionId,\n      transform: null,\n    };\n  }\n  get eye() { return this[PRIVATE$6].eye; }\n  get projectionMatrix() { return this[PRIVATE$6].device.getProjectionMatrix(this.eye); }\n  get transform() { return this[PRIVATE$6].transform; }\n  _updateViewMatrix(viewMatrix) {\n    let invMatrix = identity(new Float32Array(16));\n    invert(invMatrix, viewMatrix);\n    this[PRIVATE$6].transform = new XRRigidTransform$1(invMatrix);\n  }\n  _getViewport(layer) {\n    if (this[PRIVATE$6].device.getViewport(this[PRIVATE$6].sessionId,\n                                           this.eye,\n                                           layer,\n                                           this[PRIVATE$6].temp)) {\n      return this[PRIVATE$6].viewport;\n    }\n    return undefined;\n  }\n}\n\nvar EPSILON$1 = 0.000001;\nvar ARRAY_TYPE$1 = typeof Float32Array !== 'undefined' ? Float32Array : Array;\n\n\nvar degree$1 = Math.PI / 180;\n\nfunction create$7() {\n  var out = new ARRAY_TYPE$1(9);\n  if (ARRAY_TYPE$1 != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n\nfunction create$9() {\n  var out = new ARRAY_TYPE$1(3);\n  if (ARRAY_TYPE$1 != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  return out;\n}\n\nfunction length$3(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.sqrt(x * x + y * y + z * z);\n}\nfunction fromValues$9(x, y, z) {\n  var out = new ARRAY_TYPE$1(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction normalize$3(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = a[0] * len;\n    out[1] = a[1] * len;\n    out[2] = a[2] * len;\n  }\n  return out;\n}\nfunction dot$3(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\nfunction cross$1(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar len$3 = length$3;\n\nvar forEach$2 = function () {\n  var vec = create$9();\n  return function (a, stride, offset, count, fn, arg) {\n    var i = void 0,\n        l = void 0;\n    if (!stride) {\n      stride = 3;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];vec[1] = a[i + 1];vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];a[i + 1] = vec[1];a[i + 2] = vec[2];\n    }\n    return a;\n  };\n}();\n\nfunction create$10() {\n  var out = new ARRAY_TYPE$1(4);\n  if (ARRAY_TYPE$1 != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction normalize$4(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    out[0] = x * len;\n    out[1] = y * len;\n    out[2] = z * len;\n    out[3] = w * len;\n  }\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar forEach$3 = function () {\n  var vec = create$10();\n  return function (a, stride, offset, count, fn, arg) {\n    var i = void 0,\n        l = void 0;\n    if (!stride) {\n      stride = 4;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];vec[1] = a[i + 1];vec[2] = a[i + 2];vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];a[i + 1] = vec[1];a[i + 2] = vec[2];a[i + 3] = vec[3];\n    }\n    return a;\n  };\n}();\n\nfunction create$11() {\n  var out = new ARRAY_TYPE$1(4);\n  if (ARRAY_TYPE$1 != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n  out[3] = 1;\n  return out;\n}\n\nfunction setAxisAngle$1(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n\n\n\n\n\n\nfunction slerp$1(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega = void 0,\n      cosom = void 0,\n      sinom = void 0,\n      scale0 = void 0,\n      scale1 = void 0;\n  cosom = ax * bx + ay * by + az * bz + aw * bw;\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  }\n  if (1.0 - cosom > EPSILON$1) {\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    scale0 = 1.0 - t;\n    scale1 = t;\n  }\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n\n\n\nfunction fromMat3$1(out, m) {\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot = void 0;\n  if (fTrace > 0.0) {\n    fRoot = Math.sqrt(fTrace + 1.0);\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar normalize$5 = normalize$4;\n\n\nvar rotationTo$1 = function () {\n  var tmpvec3 = create$9();\n  var xUnitVec3 = fromValues$9(1, 0, 0);\n  var yUnitVec3 = fromValues$9(0, 1, 0);\n  return function (out, a, b) {\n    var dot = dot$3(a, b);\n    if (dot < -0.999999) {\n      cross$1(tmpvec3, xUnitVec3, a);\n      if (len$3(tmpvec3) < 0.000001) cross$1(tmpvec3, yUnitVec3, a);\n      normalize$3(tmpvec3, tmpvec3);\n      setAxisAngle$1(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      cross$1(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize$5(out, out);\n    }\n  };\n}();\nvar sqlerp$1 = function () {\n  var temp1 = create$11();\n  var temp2 = create$11();\n  return function (out, a, b, c, d, t) {\n    slerp$1(temp1, a, d, t);\n    slerp$1(temp2, b, c, t);\n    slerp$1(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\nvar setAxes$1 = function () {\n  var matr = create$7();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize$5(out, fromMat3$1(out, matr));\n  };\n}();\n\nfunction create$13() {\n  var out = new ARRAY_TYPE$1(2);\n  if (ARRAY_TYPE$1 != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n  return out;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar forEach$4 = function () {\n  var vec = create$13();\n  return function (a, stride, offset, count, fn, arg) {\n    var i = void 0,\n        l = void 0;\n    if (!stride) {\n      stride = 2;\n    }\n    if (!offset) {\n      offset = 0;\n    }\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];a[i + 1] = vec[1];\n    }\n    return a;\n  };\n}();\n\nconst PRIVATE$7 = Symbol('@@webxr-polyfill/XRFrame');\nclass XRFrame {\n  constructor(device, session, sessionId) {\n    const views = [\n      new XRView(device, 'left', sessionId),\n    ];\n    if (session.immersive) {\n      views.push(new XRView(device, 'right', sessionId));\n    }\n    this[PRIVATE$7] = {\n      device,\n      viewerPose: new XRViewerPose(device, views),\n      views,\n      session,\n    };\n  }\n  get session() { return this[PRIVATE$7].session; }\n  getViewerPose(space) {\n    this[PRIVATE$7].viewerPose._updateFromReferenceSpace(space);\n    return this[PRIVATE$7].viewerPose;\n  }\n  getPose(space, baseSpace) {\n    if (space._specialType === \"viewer\") {\n      let viewerPose = this.getViewerPose(baseSpace);\n      return new XRPose(\n        new XRRigidTransform(viewerPose.poseModelMatrix),\n        viewerPose.emulatedPosition);\n    }\n    if (space._specialType === \"target-ray\" || space._specialType === \"grip\") {\n      return this[PRIVATE$7].device.getInputPose(\n        space._inputSource, baseSpace, space._specialType);\n    }\n    return null;\n  }\n}\n\nconst PRIVATE$8 = Symbol('@@webxr-polyfill/XRSpace');\n\nclass XRSpace {\n  constructor(specialType = null, inputSource = null) {\n    this[PRIVATE$8] = {\n      specialType,\n      inputSource,\n    };\n  }\n  get _specialType() {\n    return this[PRIVATE$8].specialType;\n  }\n  get _inputSource() {\n    return this[PRIVATE$8].inputSource;\n  }\n}\n\nconst DEFAULT_EMULATION_HEIGHT = 1.6;\nconst PRIVATE$9 = Symbol('@@webxr-polyfill/XRReferenceSpace');\nconst XRReferenceSpaceTypes = [\n  'viewer',\n  'local',\n  'local-floor',\n  'bounded-floor',\n  'unbounded'\n];\nfunction isFloor(type) {\n  return type === 'bounded-floor' || type === 'local-floor';\n}\nclass XRReferenceSpace extends XRSpace {\n  constructor(device, type, transform) {\n    if (!XRReferenceSpaceTypes.includes(type)) {\n      throw new Error(`XRReferenceSpaceType must be one of ${XRReferenceSpaceTypes}`);\n    }\n    super((type === 'viewer') ? 'viewer' : null);\n    if (type === 'bounded-floor' && !transform) {\n      throw new Error(`XRReferenceSpace cannot use 'bounded-floor' type if the platform does not provide the floor level`);\n    }\n    if (isFloor(type) && !transform) {\n      transform = identity(new Float32Array(16));\n      transform[13] = DEFAULT_EMULATION_HEIGHT;\n    }\n    if (!transform) {\n      transform = identity(new Float32Array(16));\n    }\n    this[PRIVATE$9] = {\n      type,\n      transform,\n      device,\n      originOffset : identity(new Float32Array(16)),\n    };\n  }\n  _transformBasePoseMatrix(out, pose) {\n    multiply(out, this[PRIVATE$9].transform, pose);\n  }\n  _transformBaseViewMatrix(out, view) {\n    invert(out, this[PRIVATE$9].transform);\n    multiply(out, view, out);\n  }\n  _originOffsetMatrix() {\n    return this[PRIVATE$9].originOffset;\n  }\n  _adjustForOriginOffset(transformMatrix) {\n    let inverseOriginOffsetMatrix = identity(new Float32Array(16));\n    invert(inverseOriginOffsetMatrix, this[PRIVATE$9].originOffset);\n    multiply(transformMatrix, inverseOriginOffsetMatrix, transformMatrix);\n  }\n  getOffsetReferenceSpace(additionalOffset) {\n    let newSpace = new XRReferenceSpace(\n      this[PRIVATE$9].device,\n      this[PRIVATE$9].type,\n      this[PRIVATE$9].transform,\n      this[PRIVATE$9].bounds);\n    multiply(newSpace[PRIVATE$9].originOffset, this[PRIVATE$9].originOffset, additionalOffset.matrix);\n    return newSpace;\n  }\n}\n\nconst POLYFILLED_XR_COMPATIBLE = Symbol('@@webxr-polyfill/polyfilled-xr-compatible');\nconst XR_COMPATIBLE = Symbol('@@webxr-polyfill/xr-compatible');\n\nconst PRIVATE$10 = Symbol('@@webxr-polyfill/XRWebGLLayer');\nconst XRWebGLLayerInit = Object.freeze({\n  antialias: true,\n  depth: false,\n  stencil: false,\n  alpha: true,\n  multiview: false,\n  ignoreDepthValues: false,\n  framebufferScaleFactor: 1.0,\n});\nclass XRWebGLLayer {\n  constructor(session, context, layerInit={}) {\n    const config = Object.assign({}, XRWebGLLayerInit, layerInit);\n    if (!(session instanceof XRSession$1)) {\n      throw new Error('session must be a XRSession');\n    }\n    if (session.ended) {\n      throw new Error(`InvalidStateError`);\n    }\n    if (context[POLYFILLED_XR_COMPATIBLE]) {\n      if (context[XR_COMPATIBLE] !== true) {\n        throw new Error(`InvalidStateError`);\n      }\n    }\n    const framebuffer = context.getParameter(context.FRAMEBUFFER_BINDING);\n    this[PRIVATE$10] = {\n      context,\n      config,\n      framebuffer,\n      session,\n    };\n  }\n  get context() { return this[PRIVATE$10].context; }\n  get antialias() { return this[PRIVATE$10].config.antialias; }\n  get ignoreDepthValues() { return true; }\n  get framebuffer() { return this[PRIVATE$10].framebuffer; }\n  get framebufferWidth() { return this[PRIVATE$10].context.drawingBufferWidth; }\n  get framebufferHeight() { return this[PRIVATE$10].context.drawingBufferHeight; }\n  get _session() { return this[PRIVATE$10].session; }\n  getViewport(view) {\n    return view._getViewport(this);\n  }\n}\n\nconst PRIVATE$11 = Symbol('@@webxr-polyfill/XRSession');\nclass XRSession$1 extends EventTarget {\n  constructor(device, mode, id) {\n    super();\n    let immersive = mode != 'inline';\n    let outputContext = null;\n    this[PRIVATE$11] = {\n      device,\n      mode,\n      immersive,\n      outputContext,\n      ended: false,\n      suspended: false,\n      suspendedCallback: null,\n      id,\n      activeRenderState: null,\n      pendingRenderState: null,\n    };\n    const frame = new XRFrame(device, this, this[PRIVATE$11].id);\n    this[PRIVATE$11].frame = frame;\n    this[PRIVATE$11].onPresentationEnd = sessionId => {\n      if (sessionId !== this[PRIVATE$11].id) {\n        this[PRIVATE$11].suspended = false;\n        this.dispatchEvent('focus', { session: this });\n        const suspendedCallback = this[PRIVATE$11].suspendedCallback;\n        this[PRIVATE$11].suspendedCallback = null;\n        if (suspendedCallback) {\n          this.requestAnimationFrame(suspendedCallback);\n        }\n        return;\n      }\n      this[PRIVATE$11].ended = true;\n      device.removeEventListener('@webvr-polyfill/vr-present-end', this[PRIVATE$11].onPresentationEnd);\n      device.removeEventListener('@webvr-polyfill/vr-present-start', this[PRIVATE$11].onPresentationStart);\n      device.removeEventListener('@@webvr-polyfill/input-select-start', this[PRIVATE$11].onSelectStart);\n      device.removeEventListener('@@webvr-polyfill/input-select-end', this[PRIVATE$11].onSelectEnd);\n      this.dispatchEvent('end', { session: this });\n    };\n    device.addEventListener('@@webxr-polyfill/vr-present-end', this[PRIVATE$11].onPresentationEnd);\n    this[PRIVATE$11].onPresentationStart = sessionId => {\n      if (sessionId === this[PRIVATE$11].id) {\n        return;\n      }\n      this[PRIVATE$11].suspended = true;\n      this.dispatchEvent('blur', { session: this });\n    };\n    device.addEventListener('@@webxr-polyfill/vr-present-start', this[PRIVATE$11].onPresentationStart);\n    this[PRIVATE$11].onSelectStart = evt => {\n      if (evt.sessionId !== this[PRIVATE$11].id) {\n        return;\n      }\n      this.dispatchEvent('selectstart', {\n        frame: this[PRIVATE$11].frame,\n        inputSource: evt.inputSource\n      });\n    };\n    device.addEventListener('@@webxr-polyfill/input-select-start', this[PRIVATE$11].onSelectStart);\n    this[PRIVATE$11].onSelectEnd = evt => {\n      if (evt.sessionId !== this[PRIVATE$11].id) {\n        return;\n      }\n      this.dispatchEvent('selectend', {\n        frame: this[PRIVATE$11].frame,\n        inputSource: evt.inputSource\n      });\n      this.dispatchEvent('select',  {\n        frame: this[PRIVATE$11].frame,\n        inputSource: evt.inputSource\n      });\n    };\n    device.addEventListener('@@webxr-polyfill/input-select-end', this[PRIVATE$11].onSelectEnd);\n    this.onblur = undefined;\n    this.onfocus = undefined;\n    this.onresetpose = undefined;\n    this.onend = undefined;\n    this.onselect = undefined;\n    this.onselectstart = undefined;\n    this.onselectend = undefined;\n  }\n  get renderState() { return this[PRIVATE$11].activeRenderState; }\n  get immersive() { return this[PRIVATE$11].immersive; }\n  get outputContext() { return this[PRIVATE$11].outputContext; }\n  get depthNear() { return this[PRIVATE$11].device.depthNear; }\n  set depthNear(value) { this[PRIVATE$11].device.depthNear = value; }\n  get depthFar() { return this[PRIVATE$11].device.depthFar; }\n  set depthFar(value) { this[PRIVATE$11].device.depthFar = value; }\n  get environmentBlendMode() {\n    return this[PRIVATE$11].device.environmentBlendMode || 'opaque';\n  }\n  get baseLayer() { return this[PRIVATE$11].baseLayer; }\n  set baseLayer(value) {\n    if (this[PRIVATE$11].ended) {\n      return;\n    }\n    this[PRIVATE$11].baseLayer = value;\n    this[PRIVATE$11].device.onBaseLayerSet(this[PRIVATE$11].id, value);\n  }\n  async requestReferenceSpace(type) {\n    if (this[PRIVATE$11].ended) {\n      return;\n    }\n    if (type === 'unbounded') {\n      throw new NotSupportedError(`The WebXR polyfill does not support the ${type} reference space`);\n    }\n    if (!XRReferenceSpaceTypes.includes(type)) {\n      throw new TypeError(`XRReferenceSpaceType must be one of ${XRReferenceSpaceTypes}`);\n    }\n    let transform = await this[PRIVATE$11].device.requestFrameOfReferenceTransform(type);\n    if (type === 'bounded-floor') {\n      if (!transform) {\n        throw new NotSupportedError(`${type} XRReferenceSpace not supported by this device.`);\n      }\n      let bounds = this[PRIVATE$11].device.requestStageBounds();\n      if (!bounds) {\n        throw new NotSupportedError(`${type} XRReferenceSpace not supported by this device.`);\n      }\n      throw new NotSupportedError(`The WebXR polyfill does not support the ${type} reference space yet.`);\n    }\n    return new XRReferenceSpace(this[PRIVATE$11].device, type, transform);\n  }\n  requestAnimationFrame(callback) {\n    if (this[PRIVATE$11].ended) {\n      return;\n    }\n    if (this[PRIVATE$11].suspended && this[PRIVATE$11].suspendedCallback) {\n      return;\n    }\n    if (this[PRIVATE$11].suspended && !this[PRIVATE$11].suspendedCallback) {\n      this[PRIVATE$11].suspendedCallback = callback;\n    }\n    return this[PRIVATE$11].device.requestAnimationFrame(() => {\n      if (this[PRIVATE$11].pendingRenderState !== null) {\n        this[PRIVATE$11].activeRenderState = this[PRIVATE$11].pendingRenderState;\n        this[PRIVATE$11].pendingRenderState = null;\n        if (this[PRIVATE$11].activeRenderState.baseLayer) {\n          this[PRIVATE$11].device.onBaseLayerSet(\n            this[PRIVATE$11].id,\n            this[PRIVATE$11].activeRenderState.baseLayer);\n        }\n        if (this[PRIVATE$11].activeRenderState.inlineVerticalFieldOfView) {\n          this[PRIVATE$11].device.onInlineVerticalFieldOfViewSet(\n            this[PRIVATE$11].id,\n            this[PRIVATE$11].activeRenderState.inlineVerticalFieldOfView);\n        }\n      }\n      this[PRIVATE$11].device.onFrameStart(this[PRIVATE$11].id);\n      callback(now$1(), this[PRIVATE$11].frame);\n      this[PRIVATE$11].device.onFrameEnd(this[PRIVATE$11].id);\n    });\n  }\n  cancelAnimationFrame(handle) {\n    if (this[PRIVATE$11].ended) {\n      return;\n    }\n    this[PRIVATE$11].device.cancelAnimationFrame(handle);\n  }\n  get inputSources() {\n    return this[PRIVATE$11].device.getInputSources();\n  }\n  async end() {\n    if (this[PRIVATE$11].ended) {\n      return;\n    }\n    if (!this.immersive) {\n      this[PRIVATE$11].ended = true;\n      this[PRIVATE$11].device.removeEventListener('@@webvr-polyfill/vr-present-start',\n                                                 this[PRIVATE$11].onPresentationStart);\n      this[PRIVATE$11].device.removeEventListener('@@webvr-polyfill/vr-present-end',\n                                                 this[PRIVATE$11].onPresentationEnd);\n      this[PRIVATE$11].device.removeEventListener('@@webvr-polyfill/input-select-start',\n                                                 this[PRIVATE$11].onSelectStart);\n      this[PRIVATE$11].device.removeEventListener('@@webvr-polyfill/input-select-end',\n                                                 this[PRIVATE$11].onSelectEnd);\n      this.dispatchEvent('end', { session: this });\n    }\n    return this[PRIVATE$11].device.endSession(this[PRIVATE$11].id);\n  }\n  updateRenderState(newState) {\n    if (this[PRIVATE$11].ended) {\n      const message = \"Can't call updateRenderState on an XRSession \" +\n                      \"that has already ended.\";\n      throw new Error(message);\n    }\n    if (newState.baseLayer && (newState.baseLayer._session !== this)) {\n      const message = \"Called updateRenderState with a base layer that was \" +\n                      \"created by a different session.\";\n      throw new Error(message);\n    }\n    const fovSet = (newState.inlineVerticalFieldOfView !== null) &&\n                   (newState.inlineVerticalFieldOfView !== undefined);\n    if (fovSet) {\n      if (this[PRIVATE$11].immersive) {\n        const message = \"inlineVerticalFieldOfView must not be set for an \" +\n                        \"XRRenderState passed to updateRenderState for an \" +\n                        \"immersive session.\";\n        throw new Error(message);\n      } else {\n        newState.inlineVerticalFieldOfView = Math.min(\n          3.13, Math.max(0.01, newState.inlineVerticalFieldOfView));\n      }\n    }\n    if (this[PRIVATE$11].pendingRenderState === null) {\n      this[PRIVATE$11].pendingRenderState = Object.assign(\n        {}, this[PRIVATE$11].activeRenderState, newState);\n    }\n  }\n}\n\nconst PRIVATE$12 = Symbol('@@webxr-polyfill/XRInputSource');\nclass XRInputSource {\n  constructor(impl) {\n    this[PRIVATE$12] = {\n      impl,\n      gripSpace: new XRSpace(\"grip\", this),\n      targetRaySpace: new XRSpace(\"target-ray\", this)\n    };\n  }\n  get handedness() { return this[PRIVATE$12].impl.handedness; }\n  get targetRayMode() { return this[PRIVATE$12].impl.targetRayMode; }\n  get gripSpace() {\n    let mode = this[PRIVATE$12].impl.targetRayMode;\n    if (mode === \"gaze\" || mode === \"screen\") {\n      return null;\n    }\n    return this[PRIVATE$12].gripSpace;\n  }\n  get targetRaySpace() { return this[PRIVATE$12].targetRaySpace; }\n  get profiles() { return this[PRIVATE$12].impl.profiles; }\n  get gamepad() { return this[PRIVATE$12].impl.gamepad; }\n}\n\nconst PRIVATE$13 = Symbol('@@webxr-polyfill/XRRenderState');\nconst XRRenderStateInit = Object.freeze({\n  depthNear: 0.1,\n  depthFar: 1000.0,\n  inlineVerticalFieldOfView: null,\n  baseLayer: null\n});\nclass XRRenderState {\n  constructor(stateInit = {}) {\n    const config = Object.assign({}, XRRenderStateInit, stateInit);\n    this[PRIVATE$13] = { config };\n  }\n  get depthNear() { return this[PRIVATE$13].depthNear; }\n  get depthFar() { return this[PRIVATE$13].depthFar; }\n  get inlineVerticalFieldOfView() { return this[PRIVATE$13].inlineVerticalFieldOfView; }\n  get baseLayer() { return this[PRIVATE$13].baseLayer; }\n}\n\nvar API = {\n  XR: XR$1,\n  XRSession: XRSession$1,\n  XRFrame,\n  XRView,\n  XRViewport,\n  XRViewerPose,\n  XRWebGLLayer,\n  XRSpace,\n  XRReferenceSpace,\n  XRInputSource,\n  XRRenderState,\n  XRRigidTransform: XRRigidTransform$1,\n  XRPose: XRPose$1,\n};\n\nconst polyfillMakeXRCompatible = Context => {\n  if (typeof Context.prototype.makeXRCompatible === 'function') {\n    return false;\n  }\n  Context.prototype.makeXRCompatible = function () {\n    this[XR_COMPATIBLE] = true;\n    return Promise.resolve();\n  };\n  return true;\n};\nconst polyfillGetContext = (Canvas) => {\n  const getContext = Canvas.prototype.getContext;\n  Canvas.prototype.getContext = function (contextType, glAttribs) {\n    const ctx = getContext.call(this, contextType, glAttribs);\n    if (ctx) {\n      ctx[POLYFILLED_XR_COMPATIBLE] = true;\n      if (glAttribs && ('xrCompatible' in glAttribs)) {\n        ctx[XR_COMPATIBLE] = glAttribs.xrCompatible;\n      }\n    }\n    return ctx;\n  };\n};\n\nconst isImageBitmapSupported = global =>\n  !!(global.ImageBitmapRenderingContext &&\n     global.createImageBitmap);\n\nconst applyCanvasStylesForMinimalRendering = canvas => {\n  canvas.style.display = 'block';\n  canvas.style.position = 'absolute';\n  canvas.style.width = canvas.style.height = '1px';\n  canvas.style.top = canvas.style.left = '0px';\n};\n\nvar commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\n\n\nfunction unwrapExports (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar cardboardVrDisplay = createCommonjsModule(function (module, exports) {\n(function (global, factory) {\n\tmodule.exports = factory();\n}(commonjsGlobal, (function () { var classCallCheck = function (instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\nvar slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\nvar MIN_TIMESTEP = 0.001;\nvar MAX_TIMESTEP = 1;\nvar dataUri = function dataUri(mimeType, svg) {\n  return 'data:' + mimeType + ',' + encodeURIComponent(svg);\n};\nvar lerp = function lerp(a, b, t) {\n  return a + (b - a) * t;\n};\nvar isIOS = function () {\n  var isIOS = /iPad|iPhone|iPod/.test(navigator.platform);\n  return function () {\n    return isIOS;\n  };\n}();\nvar isWebViewAndroid = function () {\n  var isWebViewAndroid = navigator.userAgent.indexOf('Version') !== -1 && navigator.userAgent.indexOf('Android') !== -1 && navigator.userAgent.indexOf('Chrome') !== -1;\n  return function () {\n    return isWebViewAndroid;\n  };\n}();\nvar isSafari = function () {\n  var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n  return function () {\n    return isSafari;\n  };\n}();\nvar isFirefoxAndroid = function () {\n  var isFirefoxAndroid = navigator.userAgent.indexOf('Firefox') !== -1 && navigator.userAgent.indexOf('Android') !== -1;\n  return function () {\n    return isFirefoxAndroid;\n  };\n}();\nvar getChromeVersion = function () {\n  var match = navigator.userAgent.match(/.*Chrome\\/([0-9]+)/);\n  var value = match ? parseInt(match[1], 10) : null;\n  return function () {\n    return value;\n  };\n}();\nvar isChromeWithoutDeviceMotion = function () {\n  var value = false;\n  if (getChromeVersion() === 65) {\n    var match = navigator.userAgent.match(/.*Chrome\\/([0-9\\.]*)/);\n    if (match) {\n      var _match$1$split = match[1].split('.'),\n          _match$1$split2 = slicedToArray(_match$1$split, 4),\n          major = _match$1$split2[0],\n          minor = _match$1$split2[1],\n          branch = _match$1$split2[2],\n          build = _match$1$split2[3];\n      value = parseInt(branch, 10) === 3325 && parseInt(build, 10) < 148;\n    }\n  }\n  return function () {\n    return value;\n  };\n}();\nvar isR7 = function () {\n  var isR7 = navigator.userAgent.indexOf('R7 Build') !== -1;\n  return function () {\n    return isR7;\n  };\n}();\nvar isLandscapeMode = function isLandscapeMode() {\n  var rtn = window.orientation == 90 || window.orientation == -90;\n  return isR7() ? !rtn : rtn;\n};\nvar isTimestampDeltaValid = function isTimestampDeltaValid(timestampDeltaS) {\n  if (isNaN(timestampDeltaS)) {\n    return false;\n  }\n  if (timestampDeltaS <= MIN_TIMESTEP) {\n    return false;\n  }\n  if (timestampDeltaS > MAX_TIMESTEP) {\n    return false;\n  }\n  return true;\n};\nvar getScreenWidth = function getScreenWidth() {\n  return Math.max(window.screen.width, window.screen.height) * window.devicePixelRatio;\n};\nvar getScreenHeight = function getScreenHeight() {\n  return Math.min(window.screen.width, window.screen.height) * window.devicePixelRatio;\n};\nvar requestFullscreen = function requestFullscreen(element) {\n  if (isWebViewAndroid()) {\n    return false;\n  }\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    element.mozRequestFullScreen();\n  } else if (element.msRequestFullscreen) {\n    element.msRequestFullscreen();\n  } else {\n    return false;\n  }\n  return true;\n};\nvar exitFullscreen = function exitFullscreen() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen();\n  } else if (document.msExitFullscreen) {\n    document.msExitFullscreen();\n  } else {\n    return false;\n  }\n  return true;\n};\nvar getFullscreenElement = function getFullscreenElement() {\n  return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;\n};\nvar linkProgram = function linkProgram(gl, vertexSource, fragmentSource, attribLocationMap) {\n  var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n  gl.shaderSource(vertexShader, vertexSource);\n  gl.compileShader(vertexShader);\n  var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n  gl.shaderSource(fragmentShader, fragmentSource);\n  gl.compileShader(fragmentShader);\n  var program = gl.createProgram();\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  for (var attribName in attribLocationMap) {\n    gl.bindAttribLocation(program, attribLocationMap[attribName], attribName);\n  }gl.linkProgram(program);\n  gl.deleteShader(vertexShader);\n  gl.deleteShader(fragmentShader);\n  return program;\n};\nvar getProgramUniforms = function getProgramUniforms(gl, program) {\n  var uniforms = {};\n  var uniformCount = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n  var uniformName = '';\n  for (var i = 0; i < uniformCount; i++) {\n    var uniformInfo = gl.getActiveUniform(program, i);\n    uniformName = uniformInfo.name.replace('[0]', '');\n    uniforms[uniformName] = gl.getUniformLocation(program, uniformName);\n  }\n  return uniforms;\n};\nvar orthoMatrix = function orthoMatrix(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right),\n      bt = 1 / (bottom - top),\n      nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n};\nvar isMobile = function isMobile() {\n  var check = false;\n  (function (a) {\n    if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4))) check = true;\n  })(navigator.userAgent || navigator.vendor || window.opera);\n  return check;\n};\nvar extend = function extend(dest, src) {\n  for (var key in src) {\n    if (src.hasOwnProperty(key)) {\n      dest[key] = src[key];\n    }\n  }\n  return dest;\n};\nvar safariCssSizeWorkaround = function safariCssSizeWorkaround(canvas) {\n  if (isIOS()) {\n    var width = canvas.style.width;\n    var height = canvas.style.height;\n    canvas.style.width = parseInt(width) + 1 + 'px';\n    canvas.style.height = parseInt(height) + 'px';\n    setTimeout(function () {\n      canvas.style.width = width;\n      canvas.style.height = height;\n    }, 100);\n  }\n  window.canvas = canvas;\n};\nvar frameDataFromPose = function () {\n  var piOver180 = Math.PI / 180.0;\n  var rad45 = Math.PI * 0.25;\n  function mat4_perspectiveFromFieldOfView(out, fov, near, far) {\n    var upTan = Math.tan(fov ? fov.upDegrees * piOver180 : rad45),\n        downTan = Math.tan(fov ? fov.downDegrees * piOver180 : rad45),\n        leftTan = Math.tan(fov ? fov.leftDegrees * piOver180 : rad45),\n        rightTan = Math.tan(fov ? fov.rightDegrees * piOver180 : rad45),\n        xScale = 2.0 / (leftTan + rightTan),\n        yScale = 2.0 / (upTan + downTan);\n    out[0] = xScale;\n    out[1] = 0.0;\n    out[2] = 0.0;\n    out[3] = 0.0;\n    out[4] = 0.0;\n    out[5] = yScale;\n    out[6] = 0.0;\n    out[7] = 0.0;\n    out[8] = -((leftTan - rightTan) * xScale * 0.5);\n    out[9] = (upTan - downTan) * yScale * 0.5;\n    out[10] = far / (near - far);\n    out[11] = -1.0;\n    out[12] = 0.0;\n    out[13] = 0.0;\n    out[14] = far * near / (near - far);\n    out[15] = 0.0;\n    return out;\n  }\n  function mat4_fromRotationTranslation(out, q, v) {\n    var x = q[0],\n        y = q[1],\n        z = q[2],\n        w = q[3],\n        x2 = x + x,\n        y2 = y + y,\n        z2 = z + z,\n        xx = x * x2,\n        xy = x * y2,\n        xz = x * z2,\n        yy = y * y2,\n        yz = y * z2,\n        zz = z * z2,\n        wx = w * x2,\n        wy = w * y2,\n        wz = w * z2;\n    out[0] = 1 - (yy + zz);\n    out[1] = xy + wz;\n    out[2] = xz - wy;\n    out[3] = 0;\n    out[4] = xy - wz;\n    out[5] = 1 - (xx + zz);\n    out[6] = yz + wx;\n    out[7] = 0;\n    out[8] = xz + wy;\n    out[9] = yz - wx;\n    out[10] = 1 - (xx + yy);\n    out[11] = 0;\n    out[12] = v[0];\n    out[13] = v[1];\n    out[14] = v[2];\n    out[15] = 1;\n    return out;\n  }\n  function mat4_translate(out, a, v) {\n    var x = v[0],\n        y = v[1],\n        z = v[2],\n        a00,\n        a01,\n        a02,\n        a03,\n        a10,\n        a11,\n        a12,\n        a13,\n        a20,\n        a21,\n        a22,\n        a23;\n    if (a === out) {\n      out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n      out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n      out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n      out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n    } else {\n      a00 = a[0];a01 = a[1];a02 = a[2];a03 = a[3];\n      a10 = a[4];a11 = a[5];a12 = a[6];a13 = a[7];\n      a20 = a[8];a21 = a[9];a22 = a[10];a23 = a[11];\n      out[0] = a00;out[1] = a01;out[2] = a02;out[3] = a03;\n      out[4] = a10;out[5] = a11;out[6] = a12;out[7] = a13;\n      out[8] = a20;out[9] = a21;out[10] = a22;out[11] = a23;\n      out[12] = a00 * x + a10 * y + a20 * z + a[12];\n      out[13] = a01 * x + a11 * y + a21 * z + a[13];\n      out[14] = a02 * x + a12 * y + a22 * z + a[14];\n      out[15] = a03 * x + a13 * y + a23 * z + a[15];\n    }\n    return out;\n  }\n  function mat4_invert(out, a) {\n    var a00 = a[0],\n        a01 = a[1],\n        a02 = a[2],\n        a03 = a[3],\n        a10 = a[4],\n        a11 = a[5],\n        a12 = a[6],\n        a13 = a[7],\n        a20 = a[8],\n        a21 = a[9],\n        a22 = a[10],\n        a23 = a[11],\n        a30 = a[12],\n        a31 = a[13],\n        a32 = a[14],\n        a33 = a[15],\n        b00 = a00 * a11 - a01 * a10,\n        b01 = a00 * a12 - a02 * a10,\n        b02 = a00 * a13 - a03 * a10,\n        b03 = a01 * a12 - a02 * a11,\n        b04 = a01 * a13 - a03 * a11,\n        b05 = a02 * a13 - a03 * a12,\n        b06 = a20 * a31 - a21 * a30,\n        b07 = a20 * a32 - a22 * a30,\n        b08 = a20 * a33 - a23 * a30,\n        b09 = a21 * a32 - a22 * a31,\n        b10 = a21 * a33 - a23 * a31,\n        b11 = a22 * a33 - a23 * a32,\n    det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n    if (!det) {\n      return null;\n    }\n    det = 1.0 / det;\n    out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n    out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n    out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n    out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n    out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n    out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n    out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n    out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n    out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n    out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n    out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n    out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n    out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n    out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n    out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n    out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n    return out;\n  }\n  var defaultOrientation = new Float32Array([0, 0, 0, 1]);\n  var defaultPosition = new Float32Array([0, 0, 0]);\n  function updateEyeMatrices(projection, view, pose, fov, offset, vrDisplay) {\n    mat4_perspectiveFromFieldOfView(projection, fov || null, vrDisplay.depthNear, vrDisplay.depthFar);\n    var orientation = pose.orientation || defaultOrientation;\n    var position = pose.position || defaultPosition;\n    mat4_fromRotationTranslation(view, orientation, position);\n    if (offset) mat4_translate(view, view, offset);\n    mat4_invert(view, view);\n  }\n  return function (frameData, pose, vrDisplay) {\n    if (!frameData || !pose) return false;\n    frameData.pose = pose;\n    frameData.timestamp = pose.timestamp;\n    updateEyeMatrices(frameData.leftProjectionMatrix, frameData.leftViewMatrix, pose, vrDisplay._getFieldOfView(\"left\"), vrDisplay._getEyeOffset(\"left\"), vrDisplay);\n    updateEyeMatrices(frameData.rightProjectionMatrix, frameData.rightViewMatrix, pose, vrDisplay._getFieldOfView(\"right\"), vrDisplay._getEyeOffset(\"right\"), vrDisplay);\n    return true;\n  };\n}();\nvar isInsideCrossOriginIFrame = function isInsideCrossOriginIFrame() {\n  var isFramed = window.self !== window.top;\n  var refOrigin = getOriginFromUrl(document.referrer);\n  var thisOrigin = getOriginFromUrl(window.location.href);\n  return isFramed && refOrigin !== thisOrigin;\n};\nvar getOriginFromUrl = function getOriginFromUrl(url) {\n  var domainIdx;\n  var protoSepIdx = url.indexOf(\"://\");\n  if (protoSepIdx !== -1) {\n    domainIdx = protoSepIdx + 3;\n  } else {\n    domainIdx = 0;\n  }\n  var domainEndIdx = url.indexOf('/', domainIdx);\n  if (domainEndIdx === -1) {\n    domainEndIdx = url.length;\n  }\n  return url.substring(0, domainEndIdx);\n};\nvar getQuaternionAngle = function getQuaternionAngle(quat) {\n  if (quat.w > 1) {\n    console.warn('getQuaternionAngle: w > 1');\n    return 0;\n  }\n  var angle = 2 * Math.acos(quat.w);\n  return angle;\n};\nvar warnOnce = function () {\n  var observedWarnings = {};\n  return function (key, message) {\n    if (observedWarnings[key] === undefined) {\n      console.warn('webvr-polyfill: ' + message);\n      observedWarnings[key] = true;\n    }\n  };\n}();\nvar deprecateWarning = function deprecateWarning(deprecated, suggested) {\n  var alternative = suggested ? 'Please use ' + suggested + ' instead.' : '';\n  warnOnce(deprecated, deprecated + ' has been deprecated. ' + 'This may not work on native WebVR displays. ' + alternative);\n};\nfunction WGLUPreserveGLState(gl, bindings, callback) {\n  if (!bindings) {\n    callback(gl);\n    return;\n  }\n  var boundValues = [];\n  var activeTexture = null;\n  for (var i = 0; i < bindings.length; ++i) {\n    var binding = bindings[i];\n    switch (binding) {\n      case gl.TEXTURE_BINDING_2D:\n      case gl.TEXTURE_BINDING_CUBE_MAP:\n        var textureUnit = bindings[++i];\n        if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31) {\n          console.error(\"TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit\");\n          boundValues.push(null, null);\n          break;\n        }\n        if (!activeTexture) {\n          activeTexture = gl.getParameter(gl.ACTIVE_TEXTURE);\n        }\n        gl.activeTexture(textureUnit);\n        boundValues.push(gl.getParameter(binding), null);\n        break;\n      case gl.ACTIVE_TEXTURE:\n        activeTexture = gl.getParameter(gl.ACTIVE_TEXTURE);\n        boundValues.push(null);\n        break;\n      default:\n        boundValues.push(gl.getParameter(binding));\n        break;\n    }\n  }\n  callback(gl);\n  for (var i = 0; i < bindings.length; ++i) {\n    var binding = bindings[i];\n    var boundValue = boundValues[i];\n    switch (binding) {\n      case gl.ACTIVE_TEXTURE:\n        break;\n      case gl.ARRAY_BUFFER_BINDING:\n        gl.bindBuffer(gl.ARRAY_BUFFER, boundValue);\n        break;\n      case gl.COLOR_CLEAR_VALUE:\n        gl.clearColor(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n        break;\n      case gl.COLOR_WRITEMASK:\n        gl.colorMask(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n        break;\n      case gl.CURRENT_PROGRAM:\n        gl.useProgram(boundValue);\n        break;\n      case gl.ELEMENT_ARRAY_BUFFER_BINDING:\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, boundValue);\n        break;\n      case gl.FRAMEBUFFER_BINDING:\n        gl.bindFramebuffer(gl.FRAMEBUFFER, boundValue);\n        break;\n      case gl.RENDERBUFFER_BINDING:\n        gl.bindRenderbuffer(gl.RENDERBUFFER, boundValue);\n        break;\n      case gl.TEXTURE_BINDING_2D:\n        var textureUnit = bindings[++i];\n        if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31)\n          break;\n        gl.activeTexture(textureUnit);\n        gl.bindTexture(gl.TEXTURE_2D, boundValue);\n        break;\n      case gl.TEXTURE_BINDING_CUBE_MAP:\n        var textureUnit = bindings[++i];\n        if (textureUnit < gl.TEXTURE0 || textureUnit > gl.TEXTURE31)\n          break;\n        gl.activeTexture(textureUnit);\n        gl.bindTexture(gl.TEXTURE_CUBE_MAP, boundValue);\n        break;\n      case gl.VIEWPORT:\n        gl.viewport(boundValue[0], boundValue[1], boundValue[2], boundValue[3]);\n        break;\n      case gl.BLEND:\n      case gl.CULL_FACE:\n      case gl.DEPTH_TEST:\n      case gl.SCISSOR_TEST:\n      case gl.STENCIL_TEST:\n        if (boundValue) {\n          gl.enable(binding);\n        } else {\n          gl.disable(binding);\n        }\n        break;\n      default:\n        console.log(\"No GL restore behavior for 0x\" + binding.toString(16));\n        break;\n    }\n    if (activeTexture) {\n      gl.activeTexture(activeTexture);\n    }\n  }\n}\nvar glPreserveState = WGLUPreserveGLState;\nvar distortionVS = ['attribute vec2 position;', 'attribute vec3 texCoord;', 'varying vec2 vTexCoord;', 'uniform vec4 viewportOffsetScale[2];', 'void main() {', '  vec4 viewport = viewportOffsetScale[int(texCoord.z)];', '  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;', '  gl_Position = vec4( position, 1.0, 1.0 );', '}'].join('\\n');\nvar distortionFS = ['precision mediump float;', 'uniform sampler2D diffuse;', 'varying vec2 vTexCoord;', 'void main() {', '  gl_FragColor = texture2D(diffuse, vTexCoord);', '}'].join('\\n');\nfunction CardboardDistorter(gl, cardboardUI, bufferScale, dirtySubmitFrameBindings) {\n  this.gl = gl;\n  this.cardboardUI = cardboardUI;\n  this.bufferScale = bufferScale;\n  this.dirtySubmitFrameBindings = dirtySubmitFrameBindings;\n  this.ctxAttribs = gl.getContextAttributes();\n  this.meshWidth = 20;\n  this.meshHeight = 20;\n  this.bufferWidth = gl.drawingBufferWidth;\n  this.bufferHeight = gl.drawingBufferHeight;\n  this.realBindFramebuffer = gl.bindFramebuffer;\n  this.realEnable = gl.enable;\n  this.realDisable = gl.disable;\n  this.realColorMask = gl.colorMask;\n  this.realClearColor = gl.clearColor;\n  this.realViewport = gl.viewport;\n  if (!isIOS()) {\n    this.realCanvasWidth = Object.getOwnPropertyDescriptor(gl.canvas.__proto__, 'width');\n    this.realCanvasHeight = Object.getOwnPropertyDescriptor(gl.canvas.__proto__, 'height');\n  }\n  this.isPatched = false;\n  this.lastBoundFramebuffer = null;\n  this.cullFace = false;\n  this.depthTest = false;\n  this.blend = false;\n  this.scissorTest = false;\n  this.stencilTest = false;\n  this.viewport = [0, 0, 0, 0];\n  this.colorMask = [true, true, true, true];\n  this.clearColor = [0, 0, 0, 0];\n  this.attribs = {\n    position: 0,\n    texCoord: 1\n  };\n  this.program = linkProgram(gl, distortionVS, distortionFS, this.attribs);\n  this.uniforms = getProgramUniforms(gl, this.program);\n  this.viewportOffsetScale = new Float32Array(8);\n  this.setTextureBounds();\n  this.vertexBuffer = gl.createBuffer();\n  this.indexBuffer = gl.createBuffer();\n  this.indexCount = 0;\n  this.renderTarget = gl.createTexture();\n  this.framebuffer = gl.createFramebuffer();\n  this.depthStencilBuffer = null;\n  this.depthBuffer = null;\n  this.stencilBuffer = null;\n  if (this.ctxAttribs.depth && this.ctxAttribs.stencil) {\n    this.depthStencilBuffer = gl.createRenderbuffer();\n  } else if (this.ctxAttribs.depth) {\n    this.depthBuffer = gl.createRenderbuffer();\n  } else if (this.ctxAttribs.stencil) {\n    this.stencilBuffer = gl.createRenderbuffer();\n  }\n  this.patch();\n  this.onResize();\n}\nCardboardDistorter.prototype.destroy = function () {\n  var gl = this.gl;\n  this.unpatch();\n  gl.deleteProgram(this.program);\n  gl.deleteBuffer(this.vertexBuffer);\n  gl.deleteBuffer(this.indexBuffer);\n  gl.deleteTexture(this.renderTarget);\n  gl.deleteFramebuffer(this.framebuffer);\n  if (this.depthStencilBuffer) {\n    gl.deleteRenderbuffer(this.depthStencilBuffer);\n  }\n  if (this.depthBuffer) {\n    gl.deleteRenderbuffer(this.depthBuffer);\n  }\n  if (this.stencilBuffer) {\n    gl.deleteRenderbuffer(this.stencilBuffer);\n  }\n  if (this.cardboardUI) {\n    this.cardboardUI.destroy();\n  }\n};\nCardboardDistorter.prototype.onResize = function () {\n  var gl = this.gl;\n  var self = this;\n  var glState = [gl.RENDERBUFFER_BINDING, gl.TEXTURE_BINDING_2D, gl.TEXTURE0];\n  glPreserveState(gl, glState, function (gl) {\n    self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, null);\n    if (self.scissorTest) {\n      self.realDisable.call(gl, gl.SCISSOR_TEST);\n    }\n    self.realColorMask.call(gl, true, true, true, true);\n    self.realViewport.call(gl, 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    self.realClearColor.call(gl, 0, 0, 0, 1);\n    gl.clear(gl.COLOR_BUFFER_BIT);\n    self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.framebuffer);\n    gl.bindTexture(gl.TEXTURE_2D, self.renderTarget);\n    gl.texImage2D(gl.TEXTURE_2D, 0, self.ctxAttribs.alpha ? gl.RGBA : gl.RGB, self.bufferWidth, self.bufferHeight, 0, self.ctxAttribs.alpha ? gl.RGBA : gl.RGB, gl.UNSIGNED_BYTE, null);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, self.renderTarget, 0);\n    if (self.ctxAttribs.depth && self.ctxAttribs.stencil) {\n      gl.bindRenderbuffer(gl.RENDERBUFFER, self.depthStencilBuffer);\n      gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, self.bufferWidth, self.bufferHeight);\n      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, self.depthStencilBuffer);\n    } else if (self.ctxAttribs.depth) {\n      gl.bindRenderbuffer(gl.RENDERBUFFER, self.depthBuffer);\n      gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, self.bufferWidth, self.bufferHeight);\n      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, self.depthBuffer);\n    } else if (self.ctxAttribs.stencil) {\n      gl.bindRenderbuffer(gl.RENDERBUFFER, self.stencilBuffer);\n      gl.renderbufferStorage(gl.RENDERBUFFER, gl.STENCIL_INDEX8, self.bufferWidth, self.bufferHeight);\n      gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.STENCIL_ATTACHMENT, gl.RENDERBUFFER, self.stencilBuffer);\n    }\n    if (!gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\n      console.error('Framebuffer incomplete!');\n    }\n    self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.lastBoundFramebuffer);\n    if (self.scissorTest) {\n      self.realEnable.call(gl, gl.SCISSOR_TEST);\n    }\n    self.realColorMask.apply(gl, self.colorMask);\n    self.realViewport.apply(gl, self.viewport);\n    self.realClearColor.apply(gl, self.clearColor);\n  });\n  if (this.cardboardUI) {\n    this.cardboardUI.onResize();\n  }\n};\nCardboardDistorter.prototype.patch = function () {\n  if (this.isPatched) {\n    return;\n  }\n  var self = this;\n  var canvas = this.gl.canvas;\n  var gl = this.gl;\n  if (!isIOS()) {\n    canvas.width = getScreenWidth() * this.bufferScale;\n    canvas.height = getScreenHeight() * this.bufferScale;\n    Object.defineProperty(canvas, 'width', {\n      configurable: true,\n      enumerable: true,\n      get: function get() {\n        return self.bufferWidth;\n      },\n      set: function set(value) {\n        self.bufferWidth = value;\n        self.realCanvasWidth.set.call(canvas, value);\n        self.onResize();\n      }\n    });\n    Object.defineProperty(canvas, 'height', {\n      configurable: true,\n      enumerable: true,\n      get: function get() {\n        return self.bufferHeight;\n      },\n      set: function set(value) {\n        self.bufferHeight = value;\n        self.realCanvasHeight.set.call(canvas, value);\n        self.onResize();\n      }\n    });\n  }\n  this.lastBoundFramebuffer = gl.getParameter(gl.FRAMEBUFFER_BINDING);\n  if (this.lastBoundFramebuffer == null) {\n    this.lastBoundFramebuffer = this.framebuffer;\n    this.gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\n  }\n  this.gl.bindFramebuffer = function (target, framebuffer) {\n    self.lastBoundFramebuffer = framebuffer ? framebuffer : self.framebuffer;\n    self.realBindFramebuffer.call(gl, target, self.lastBoundFramebuffer);\n  };\n  this.cullFace = gl.getParameter(gl.CULL_FACE);\n  this.depthTest = gl.getParameter(gl.DEPTH_TEST);\n  this.blend = gl.getParameter(gl.BLEND);\n  this.scissorTest = gl.getParameter(gl.SCISSOR_TEST);\n  this.stencilTest = gl.getParameter(gl.STENCIL_TEST);\n  gl.enable = function (pname) {\n    switch (pname) {\n      case gl.CULL_FACE:\n        self.cullFace = true;break;\n      case gl.DEPTH_TEST:\n        self.depthTest = true;break;\n      case gl.BLEND:\n        self.blend = true;break;\n      case gl.SCISSOR_TEST:\n        self.scissorTest = true;break;\n      case gl.STENCIL_TEST:\n        self.stencilTest = true;break;\n    }\n    self.realEnable.call(gl, pname);\n  };\n  gl.disable = function (pname) {\n    switch (pname) {\n      case gl.CULL_FACE:\n        self.cullFace = false;break;\n      case gl.DEPTH_TEST:\n        self.depthTest = false;break;\n      case gl.BLEND:\n        self.blend = false;break;\n      case gl.SCISSOR_TEST:\n        self.scissorTest = false;break;\n      case gl.STENCIL_TEST:\n        self.stencilTest = false;break;\n    }\n    self.realDisable.call(gl, pname);\n  };\n  this.colorMask = gl.getParameter(gl.COLOR_WRITEMASK);\n  gl.colorMask = function (r, g, b, a) {\n    self.colorMask[0] = r;\n    self.colorMask[1] = g;\n    self.colorMask[2] = b;\n    self.colorMask[3] = a;\n    self.realColorMask.call(gl, r, g, b, a);\n  };\n  this.clearColor = gl.getParameter(gl.COLOR_CLEAR_VALUE);\n  gl.clearColor = function (r, g, b, a) {\n    self.clearColor[0] = r;\n    self.clearColor[1] = g;\n    self.clearColor[2] = b;\n    self.clearColor[3] = a;\n    self.realClearColor.call(gl, r, g, b, a);\n  };\n  this.viewport = gl.getParameter(gl.VIEWPORT);\n  gl.viewport = function (x, y, w, h) {\n    self.viewport[0] = x;\n    self.viewport[1] = y;\n    self.viewport[2] = w;\n    self.viewport[3] = h;\n    self.realViewport.call(gl, x, y, w, h);\n  };\n  this.isPatched = true;\n  safariCssSizeWorkaround(canvas);\n};\nCardboardDistorter.prototype.unpatch = function () {\n  if (!this.isPatched) {\n    return;\n  }\n  var gl = this.gl;\n  var canvas = this.gl.canvas;\n  if (!isIOS()) {\n    Object.defineProperty(canvas, 'width', this.realCanvasWidth);\n    Object.defineProperty(canvas, 'height', this.realCanvasHeight);\n  }\n  canvas.width = this.bufferWidth;\n  canvas.height = this.bufferHeight;\n  gl.bindFramebuffer = this.realBindFramebuffer;\n  gl.enable = this.realEnable;\n  gl.disable = this.realDisable;\n  gl.colorMask = this.realColorMask;\n  gl.clearColor = this.realClearColor;\n  gl.viewport = this.realViewport;\n  if (this.lastBoundFramebuffer == this.framebuffer) {\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n  }\n  this.isPatched = false;\n  setTimeout(function () {\n    safariCssSizeWorkaround(canvas);\n  }, 1);\n};\nCardboardDistorter.prototype.setTextureBounds = function (leftBounds, rightBounds) {\n  if (!leftBounds) {\n    leftBounds = [0, 0, 0.5, 1];\n  }\n  if (!rightBounds) {\n    rightBounds = [0.5, 0, 0.5, 1];\n  }\n  this.viewportOffsetScale[0] = leftBounds[0];\n  this.viewportOffsetScale[1] = leftBounds[1];\n  this.viewportOffsetScale[2] = leftBounds[2];\n  this.viewportOffsetScale[3] = leftBounds[3];\n  this.viewportOffsetScale[4] = rightBounds[0];\n  this.viewportOffsetScale[5] = rightBounds[1];\n  this.viewportOffsetScale[6] = rightBounds[2];\n  this.viewportOffsetScale[7] = rightBounds[3];\n};\nCardboardDistorter.prototype.submitFrame = function () {\n  var gl = this.gl;\n  var self = this;\n  var glState = [];\n  if (!this.dirtySubmitFrameBindings) {\n    glState.push(gl.CURRENT_PROGRAM, gl.ARRAY_BUFFER_BINDING, gl.ELEMENT_ARRAY_BUFFER_BINDING, gl.TEXTURE_BINDING_2D, gl.TEXTURE0);\n  }\n  glPreserveState(gl, glState, function (gl) {\n    self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, null);\n    if (self.cullFace) {\n      self.realDisable.call(gl, gl.CULL_FACE);\n    }\n    if (self.depthTest) {\n      self.realDisable.call(gl, gl.DEPTH_TEST);\n    }\n    if (self.blend) {\n      self.realDisable.call(gl, gl.BLEND);\n    }\n    if (self.scissorTest) {\n      self.realDisable.call(gl, gl.SCISSOR_TEST);\n    }\n    if (self.stencilTest) {\n      self.realDisable.call(gl, gl.STENCIL_TEST);\n    }\n    self.realColorMask.call(gl, true, true, true, true);\n    self.realViewport.call(gl, 0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    if (self.ctxAttribs.alpha || isIOS()) {\n      self.realClearColor.call(gl, 0, 0, 0, 1);\n      gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n    gl.useProgram(self.program);\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, self.indexBuffer);\n    gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n    gl.enableVertexAttribArray(self.attribs.position);\n    gl.enableVertexAttribArray(self.attribs.texCoord);\n    gl.vertexAttribPointer(self.attribs.position, 2, gl.FLOAT, false, 20, 0);\n    gl.vertexAttribPointer(self.attribs.texCoord, 3, gl.FLOAT, false, 20, 8);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.uniform1i(self.uniforms.diffuse, 0);\n    gl.bindTexture(gl.TEXTURE_2D, self.renderTarget);\n    gl.uniform4fv(self.uniforms.viewportOffsetScale, self.viewportOffsetScale);\n    gl.drawElements(gl.TRIANGLES, self.indexCount, gl.UNSIGNED_SHORT, 0);\n    if (self.cardboardUI) {\n      self.cardboardUI.renderNoState();\n    }\n    self.realBindFramebuffer.call(self.gl, gl.FRAMEBUFFER, self.framebuffer);\n    if (!self.ctxAttribs.preserveDrawingBuffer) {\n      self.realClearColor.call(gl, 0, 0, 0, 0);\n      gl.clear(gl.COLOR_BUFFER_BIT);\n    }\n    if (!self.dirtySubmitFrameBindings) {\n      self.realBindFramebuffer.call(gl, gl.FRAMEBUFFER, self.lastBoundFramebuffer);\n    }\n    if (self.cullFace) {\n      self.realEnable.call(gl, gl.CULL_FACE);\n    }\n    if (self.depthTest) {\n      self.realEnable.call(gl, gl.DEPTH_TEST);\n    }\n    if (self.blend) {\n      self.realEnable.call(gl, gl.BLEND);\n    }\n    if (self.scissorTest) {\n      self.realEnable.call(gl, gl.SCISSOR_TEST);\n    }\n    if (self.stencilTest) {\n      self.realEnable.call(gl, gl.STENCIL_TEST);\n    }\n    self.realColorMask.apply(gl, self.colorMask);\n    self.realViewport.apply(gl, self.viewport);\n    if (self.ctxAttribs.alpha || !self.ctxAttribs.preserveDrawingBuffer) {\n      self.realClearColor.apply(gl, self.clearColor);\n    }\n  });\n  if (isIOS()) {\n    var canvas = gl.canvas;\n    if (canvas.width != self.bufferWidth || canvas.height != self.bufferHeight) {\n      self.bufferWidth = canvas.width;\n      self.bufferHeight = canvas.height;\n      self.onResize();\n    }\n  }\n};\nCardboardDistorter.prototype.updateDeviceInfo = function (deviceInfo) {\n  var gl = this.gl;\n  var self = this;\n  var glState = [gl.ARRAY_BUFFER_BINDING, gl.ELEMENT_ARRAY_BUFFER_BINDING];\n  glPreserveState(gl, glState, function (gl) {\n    var vertices = self.computeMeshVertices_(self.meshWidth, self.meshHeight, deviceInfo);\n    gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n    if (!self.indexCount) {\n      var indices = self.computeMeshIndices_(self.meshWidth, self.meshHeight);\n      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, self.indexBuffer);\n      gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, indices, gl.STATIC_DRAW);\n      self.indexCount = indices.length;\n    }\n  });\n};\nCardboardDistorter.prototype.computeMeshVertices_ = function (width, height, deviceInfo) {\n  var vertices = new Float32Array(2 * width * height * 5);\n  var lensFrustum = deviceInfo.getLeftEyeVisibleTanAngles();\n  var noLensFrustum = deviceInfo.getLeftEyeNoLensTanAngles();\n  var viewport = deviceInfo.getLeftEyeVisibleScreenRect(noLensFrustum);\n  var vidx = 0;\n  for (var e = 0; e < 2; e++) {\n    for (var j = 0; j < height; j++) {\n      for (var i = 0; i < width; i++, vidx++) {\n        var u = i / (width - 1);\n        var v = j / (height - 1);\n        var s = u;\n        var t = v;\n        var x = lerp(lensFrustum[0], lensFrustum[2], u);\n        var y = lerp(lensFrustum[3], lensFrustum[1], v);\n        var d = Math.sqrt(x * x + y * y);\n        var r = deviceInfo.distortion.distortInverse(d);\n        var p = x * r / d;\n        var q = y * r / d;\n        u = (p - noLensFrustum[0]) / (noLensFrustum[2] - noLensFrustum[0]);\n        v = (q - noLensFrustum[3]) / (noLensFrustum[1] - noLensFrustum[3]);\n        u = (viewport.x + u * viewport.width - 0.5) * 2.0;\n        v = (viewport.y + v * viewport.height - 0.5) * 2.0;\n        vertices[vidx * 5 + 0] = u;\n        vertices[vidx * 5 + 1] = v;\n        vertices[vidx * 5 + 2] = s;\n        vertices[vidx * 5 + 3] = t;\n        vertices[vidx * 5 + 4] = e;\n      }\n    }\n    var w = lensFrustum[2] - lensFrustum[0];\n    lensFrustum[0] = -(w + lensFrustum[0]);\n    lensFrustum[2] = w - lensFrustum[2];\n    w = noLensFrustum[2] - noLensFrustum[0];\n    noLensFrustum[0] = -(w + noLensFrustum[0]);\n    noLensFrustum[2] = w - noLensFrustum[2];\n    viewport.x = 1 - (viewport.x + viewport.width);\n  }\n  return vertices;\n};\nCardboardDistorter.prototype.computeMeshIndices_ = function (width, height) {\n  var indices = new Uint16Array(2 * (width - 1) * (height - 1) * 6);\n  var halfwidth = width / 2;\n  var halfheight = height / 2;\n  var vidx = 0;\n  var iidx = 0;\n  for (var e = 0; e < 2; e++) {\n    for (var j = 0; j < height; j++) {\n      for (var i = 0; i < width; i++, vidx++) {\n        if (i == 0 || j == 0) continue;\n        if (i <= halfwidth == j <= halfheight) {\n          indices[iidx++] = vidx;\n          indices[iidx++] = vidx - width - 1;\n          indices[iidx++] = vidx - width;\n          indices[iidx++] = vidx - width - 1;\n          indices[iidx++] = vidx;\n          indices[iidx++] = vidx - 1;\n        } else {\n          indices[iidx++] = vidx - 1;\n          indices[iidx++] = vidx - width;\n          indices[iidx++] = vidx;\n          indices[iidx++] = vidx - width;\n          indices[iidx++] = vidx - 1;\n          indices[iidx++] = vidx - width - 1;\n        }\n      }\n    }\n  }\n  return indices;\n};\nCardboardDistorter.prototype.getOwnPropertyDescriptor_ = function (proto, attrName) {\n  var descriptor = Object.getOwnPropertyDescriptor(proto, attrName);\n  if (descriptor.get === undefined || descriptor.set === undefined) {\n    descriptor.configurable = true;\n    descriptor.enumerable = true;\n    descriptor.get = function () {\n      return this.getAttribute(attrName);\n    };\n    descriptor.set = function (val) {\n      this.setAttribute(attrName, val);\n    };\n  }\n  return descriptor;\n};\nvar uiVS = ['attribute vec2 position;', 'uniform mat4 projectionMat;', 'void main() {', '  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );', '}'].join('\\n');\nvar uiFS = ['precision mediump float;', 'uniform vec4 color;', 'void main() {', '  gl_FragColor = color;', '}'].join('\\n');\nvar DEG2RAD = Math.PI / 180.0;\nvar kAnglePerGearSection = 60;\nvar kOuterRimEndAngle = 12;\nvar kInnerRimBeginAngle = 20;\nvar kOuterRadius = 1;\nvar kMiddleRadius = 0.75;\nvar kInnerRadius = 0.3125;\nvar kCenterLineThicknessDp = 4;\nvar kButtonWidthDp = 28;\nvar kTouchSlopFactor = 1.5;\nfunction CardboardUI(gl) {\n  this.gl = gl;\n  this.attribs = {\n    position: 0\n  };\n  this.program = linkProgram(gl, uiVS, uiFS, this.attribs);\n  this.uniforms = getProgramUniforms(gl, this.program);\n  this.vertexBuffer = gl.createBuffer();\n  this.gearOffset = 0;\n  this.gearVertexCount = 0;\n  this.arrowOffset = 0;\n  this.arrowVertexCount = 0;\n  this.projMat = new Float32Array(16);\n  this.listener = null;\n  this.onResize();\n}\nCardboardUI.prototype.destroy = function () {\n  var gl = this.gl;\n  if (this.listener) {\n    gl.canvas.removeEventListener('click', this.listener, false);\n  }\n  gl.deleteProgram(this.program);\n  gl.deleteBuffer(this.vertexBuffer);\n};\nCardboardUI.prototype.listen = function (optionsCallback, backCallback) {\n  var canvas = this.gl.canvas;\n  this.listener = function (event) {\n    var midline = canvas.clientWidth / 2;\n    var buttonSize = kButtonWidthDp * kTouchSlopFactor;\n    if (event.clientX > midline - buttonSize && event.clientX < midline + buttonSize && event.clientY > canvas.clientHeight - buttonSize) {\n      optionsCallback(event);\n    }\n    else if (event.clientX < buttonSize && event.clientY < buttonSize) {\n        backCallback(event);\n      }\n  };\n  canvas.addEventListener('click', this.listener, false);\n};\nCardboardUI.prototype.onResize = function () {\n  var gl = this.gl;\n  var self = this;\n  var glState = [gl.ARRAY_BUFFER_BINDING];\n  glPreserveState(gl, glState, function (gl) {\n    var vertices = [];\n    var midline = gl.drawingBufferWidth / 2;\n    var physicalPixels = Math.max(screen.width, screen.height) * window.devicePixelRatio;\n    var scalingRatio = gl.drawingBufferWidth / physicalPixels;\n    var dps = scalingRatio * window.devicePixelRatio;\n    var lineWidth = kCenterLineThicknessDp * dps / 2;\n    var buttonSize = kButtonWidthDp * kTouchSlopFactor * dps;\n    var buttonScale = kButtonWidthDp * dps / 2;\n    var buttonBorder = (kButtonWidthDp * kTouchSlopFactor - kButtonWidthDp) * dps;\n    vertices.push(midline - lineWidth, buttonSize);\n    vertices.push(midline - lineWidth, gl.drawingBufferHeight);\n    vertices.push(midline + lineWidth, buttonSize);\n    vertices.push(midline + lineWidth, gl.drawingBufferHeight);\n    self.gearOffset = vertices.length / 2;\n    function addGearSegment(theta, r) {\n      var angle = (90 - theta) * DEG2RAD;\n      var x = Math.cos(angle);\n      var y = Math.sin(angle);\n      vertices.push(kInnerRadius * x * buttonScale + midline, kInnerRadius * y * buttonScale + buttonScale);\n      vertices.push(r * x * buttonScale + midline, r * y * buttonScale + buttonScale);\n    }\n    for (var i = 0; i <= 6; i++) {\n      var segmentTheta = i * kAnglePerGearSection;\n      addGearSegment(segmentTheta, kOuterRadius);\n      addGearSegment(segmentTheta + kOuterRimEndAngle, kOuterRadius);\n      addGearSegment(segmentTheta + kInnerRimBeginAngle, kMiddleRadius);\n      addGearSegment(segmentTheta + (kAnglePerGearSection - kInnerRimBeginAngle), kMiddleRadius);\n      addGearSegment(segmentTheta + (kAnglePerGearSection - kOuterRimEndAngle), kOuterRadius);\n    }\n    self.gearVertexCount = vertices.length / 2 - self.gearOffset;\n    self.arrowOffset = vertices.length / 2;\n    function addArrowVertex(x, y) {\n      vertices.push(buttonBorder + x, gl.drawingBufferHeight - buttonBorder - y);\n    }\n    var angledLineWidth = lineWidth / Math.sin(45 * DEG2RAD);\n    addArrowVertex(0, buttonScale);\n    addArrowVertex(buttonScale, 0);\n    addArrowVertex(buttonScale + angledLineWidth, angledLineWidth);\n    addArrowVertex(angledLineWidth, buttonScale + angledLineWidth);\n    addArrowVertex(angledLineWidth, buttonScale - angledLineWidth);\n    addArrowVertex(0, buttonScale);\n    addArrowVertex(buttonScale, buttonScale * 2);\n    addArrowVertex(buttonScale + angledLineWidth, buttonScale * 2 - angledLineWidth);\n    addArrowVertex(angledLineWidth, buttonScale - angledLineWidth);\n    addArrowVertex(0, buttonScale);\n    addArrowVertex(angledLineWidth, buttonScale - lineWidth);\n    addArrowVertex(kButtonWidthDp * dps, buttonScale - lineWidth);\n    addArrowVertex(angledLineWidth, buttonScale + lineWidth);\n    addArrowVertex(kButtonWidthDp * dps, buttonScale + lineWidth);\n    self.arrowVertexCount = vertices.length / 2 - self.arrowOffset;\n    gl.bindBuffer(gl.ARRAY_BUFFER, self.vertexBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n  });\n};\nCardboardUI.prototype.render = function () {\n  var gl = this.gl;\n  var self = this;\n  var glState = [gl.CULL_FACE, gl.DEPTH_TEST, gl.BLEND, gl.SCISSOR_TEST, gl.STENCIL_TEST, gl.COLOR_WRITEMASK, gl.VIEWPORT, gl.CURRENT_PROGRAM, gl.ARRAY_BUFFER_BINDING];\n  glPreserveState(gl, glState, function (gl) {\n    gl.disable(gl.CULL_FACE);\n    gl.disable(gl.DEPTH_TEST);\n    gl.disable(gl.BLEND);\n    gl.disable(gl.SCISSOR_TEST);\n    gl.disable(gl.STENCIL_TEST);\n    gl.colorMask(true, true, true, true);\n    gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    self.renderNoState();\n  });\n};\nCardboardUI.prototype.renderNoState = function () {\n  var gl = this.gl;\n  gl.useProgram(this.program);\n  gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n  gl.enableVertexAttribArray(this.attribs.position);\n  gl.vertexAttribPointer(this.attribs.position, 2, gl.FLOAT, false, 8, 0);\n  gl.uniform4f(this.uniforms.color, 1.0, 1.0, 1.0, 1.0);\n  orthoMatrix(this.projMat, 0, gl.drawingBufferWidth, 0, gl.drawingBufferHeight, 0.1, 1024.0);\n  gl.uniformMatrix4fv(this.uniforms.projectionMat, false, this.projMat);\n  gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n  gl.drawArrays(gl.TRIANGLE_STRIP, this.gearOffset, this.gearVertexCount);\n  gl.drawArrays(gl.TRIANGLE_STRIP, this.arrowOffset, this.arrowVertexCount);\n};\nfunction Distortion(coefficients) {\n  this.coefficients = coefficients;\n}\nDistortion.prototype.distortInverse = function (radius) {\n  var r0 = 0;\n  var r1 = 1;\n  var dr0 = radius - this.distort(r0);\n  while (Math.abs(r1 - r0) > 0.0001             ) {\n    var dr1 = radius - this.distort(r1);\n    var r2 = r1 - dr1 * ((r1 - r0) / (dr1 - dr0));\n    r0 = r1;\n    r1 = r2;\n    dr0 = dr1;\n  }\n  return r1;\n};\nDistortion.prototype.distort = function (radius) {\n  var r2 = radius * radius;\n  var ret = 0;\n  for (var i = 0; i < this.coefficients.length; i++) {\n    ret = r2 * (ret + this.coefficients[i]);\n  }\n  return (ret + 1) * radius;\n};\nvar degToRad = Math.PI / 180;\nvar radToDeg = 180 / Math.PI;\nvar Vector3 = function Vector3(x, y, z) {\n  this.x = x || 0;\n  this.y = y || 0;\n  this.z = z || 0;\n};\nVector3.prototype = {\n  constructor: Vector3,\n  set: function set(x, y, z) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    return this;\n  },\n  copy: function copy(v) {\n    this.x = v.x;\n    this.y = v.y;\n    this.z = v.z;\n    return this;\n  },\n  length: function length() {\n    return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\n  },\n  normalize: function normalize() {\n    var scalar = this.length();\n    if (scalar !== 0) {\n      var invScalar = 1 / scalar;\n      this.multiplyScalar(invScalar);\n    } else {\n      this.x = 0;\n      this.y = 0;\n      this.z = 0;\n    }\n    return this;\n  },\n  multiplyScalar: function multiplyScalar(scalar) {\n    this.x *= scalar;\n    this.y *= scalar;\n    this.z *= scalar;\n  },\n  applyQuaternion: function applyQuaternion(q) {\n    var x = this.x;\n    var y = this.y;\n    var z = this.z;\n    var qx = q.x;\n    var qy = q.y;\n    var qz = q.z;\n    var qw = q.w;\n    var ix = qw * x + qy * z - qz * y;\n    var iy = qw * y + qz * x - qx * z;\n    var iz = qw * z + qx * y - qy * x;\n    var iw = -qx * x - qy * y - qz * z;\n    this.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n    this.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n    this.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n    return this;\n  },\n  dot: function dot(v) {\n    return this.x * v.x + this.y * v.y + this.z * v.z;\n  },\n  crossVectors: function crossVectors(a, b) {\n    var ax = a.x,\n        ay = a.y,\n        az = a.z;\n    var bx = b.x,\n        by = b.y,\n        bz = b.z;\n    this.x = ay * bz - az * by;\n    this.y = az * bx - ax * bz;\n    this.z = ax * by - ay * bx;\n    return this;\n  }\n};\nvar Quaternion = function Quaternion(x, y, z, w) {\n  this.x = x || 0;\n  this.y = y || 0;\n  this.z = z || 0;\n  this.w = w !== undefined ? w : 1;\n};\nQuaternion.prototype = {\n  constructor: Quaternion,\n  set: function set(x, y, z, w) {\n    this.x = x;\n    this.y = y;\n    this.z = z;\n    this.w = w;\n    return this;\n  },\n  copy: function copy(quaternion) {\n    this.x = quaternion.x;\n    this.y = quaternion.y;\n    this.z = quaternion.z;\n    this.w = quaternion.w;\n    return this;\n  },\n  setFromEulerXYZ: function setFromEulerXYZ(x, y, z) {\n    var c1 = Math.cos(x / 2);\n    var c2 = Math.cos(y / 2);\n    var c3 = Math.cos(z / 2);\n    var s1 = Math.sin(x / 2);\n    var s2 = Math.sin(y / 2);\n    var s3 = Math.sin(z / 2);\n    this.x = s1 * c2 * c3 + c1 * s2 * s3;\n    this.y = c1 * s2 * c3 - s1 * c2 * s3;\n    this.z = c1 * c2 * s3 + s1 * s2 * c3;\n    this.w = c1 * c2 * c3 - s1 * s2 * s3;\n    return this;\n  },\n  setFromEulerYXZ: function setFromEulerYXZ(x, y, z) {\n    var c1 = Math.cos(x / 2);\n    var c2 = Math.cos(y / 2);\n    var c3 = Math.cos(z / 2);\n    var s1 = Math.sin(x / 2);\n    var s2 = Math.sin(y / 2);\n    var s3 = Math.sin(z / 2);\n    this.x = s1 * c2 * c3 + c1 * s2 * s3;\n    this.y = c1 * s2 * c3 - s1 * c2 * s3;\n    this.z = c1 * c2 * s3 - s1 * s2 * c3;\n    this.w = c1 * c2 * c3 + s1 * s2 * s3;\n    return this;\n  },\n  setFromAxisAngle: function setFromAxisAngle(axis, angle) {\n    var halfAngle = angle / 2,\n        s = Math.sin(halfAngle);\n    this.x = axis.x * s;\n    this.y = axis.y * s;\n    this.z = axis.z * s;\n    this.w = Math.cos(halfAngle);\n    return this;\n  },\n  multiply: function multiply(q) {\n    return this.multiplyQuaternions(this, q);\n  },\n  multiplyQuaternions: function multiplyQuaternions(a, b) {\n    var qax = a.x,\n        qay = a.y,\n        qaz = a.z,\n        qaw = a.w;\n    var qbx = b.x,\n        qby = b.y,\n        qbz = b.z,\n        qbw = b.w;\n    this.x = qax * qbw + qaw * qbx + qay * qbz - qaz * qby;\n    this.y = qay * qbw + qaw * qby + qaz * qbx - qax * qbz;\n    this.z = qaz * qbw + qaw * qbz + qax * qby - qay * qbx;\n    this.w = qaw * qbw - qax * qbx - qay * qby - qaz * qbz;\n    return this;\n  },\n  inverse: function inverse() {\n    this.x *= -1;\n    this.y *= -1;\n    this.z *= -1;\n    this.normalize();\n    return this;\n  },\n  normalize: function normalize() {\n    var l = Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);\n    if (l === 0) {\n      this.x = 0;\n      this.y = 0;\n      this.z = 0;\n      this.w = 1;\n    } else {\n      l = 1 / l;\n      this.x = this.x * l;\n      this.y = this.y * l;\n      this.z = this.z * l;\n      this.w = this.w * l;\n    }\n    return this;\n  },\n  slerp: function slerp(qb, t) {\n    if (t === 0) return this;\n    if (t === 1) return this.copy(qb);\n    var x = this.x,\n        y = this.y,\n        z = this.z,\n        w = this.w;\n    var cosHalfTheta = w * qb.w + x * qb.x + y * qb.y + z * qb.z;\n    if (cosHalfTheta < 0) {\n      this.w = -qb.w;\n      this.x = -qb.x;\n      this.y = -qb.y;\n      this.z = -qb.z;\n      cosHalfTheta = -cosHalfTheta;\n    } else {\n      this.copy(qb);\n    }\n    if (cosHalfTheta >= 1.0) {\n      this.w = w;\n      this.x = x;\n      this.y = y;\n      this.z = z;\n      return this;\n    }\n    var halfTheta = Math.acos(cosHalfTheta);\n    var sinHalfTheta = Math.sqrt(1.0 - cosHalfTheta * cosHalfTheta);\n    if (Math.abs(sinHalfTheta) < 0.001) {\n      this.w = 0.5 * (w + this.w);\n      this.x = 0.5 * (x + this.x);\n      this.y = 0.5 * (y + this.y);\n      this.z = 0.5 * (z + this.z);\n      return this;\n    }\n    var ratioA = Math.sin((1 - t) * halfTheta) / sinHalfTheta,\n        ratioB = Math.sin(t * halfTheta) / sinHalfTheta;\n    this.w = w * ratioA + this.w * ratioB;\n    this.x = x * ratioA + this.x * ratioB;\n    this.y = y * ratioA + this.y * ratioB;\n    this.z = z * ratioA + this.z * ratioB;\n    return this;\n  },\n  setFromUnitVectors: function () {\n    var v1, r;\n    var EPS = 0.000001;\n    return function (vFrom, vTo) {\n      if (v1 === undefined) v1 = new Vector3();\n      r = vFrom.dot(vTo) + 1;\n      if (r < EPS) {\n        r = 0;\n        if (Math.abs(vFrom.x) > Math.abs(vFrom.z)) {\n          v1.set(-vFrom.y, vFrom.x, 0);\n        } else {\n          v1.set(0, -vFrom.z, vFrom.y);\n        }\n      } else {\n        v1.crossVectors(vFrom, vTo);\n      }\n      this.x = v1.x;\n      this.y = v1.y;\n      this.z = v1.z;\n      this.w = r;\n      this.normalize();\n      return this;\n    };\n  }()\n};\nfunction Device(params) {\n  this.width = params.width || getScreenWidth();\n  this.height = params.height || getScreenHeight();\n  this.widthMeters = params.widthMeters;\n  this.heightMeters = params.heightMeters;\n  this.bevelMeters = params.bevelMeters;\n}\nvar DEFAULT_ANDROID = new Device({\n  widthMeters: 0.110,\n  heightMeters: 0.062,\n  bevelMeters: 0.004\n});\nvar DEFAULT_IOS = new Device({\n  widthMeters: 0.1038,\n  heightMeters: 0.0584,\n  bevelMeters: 0.004\n});\nvar Viewers = {\n  CardboardV1: new CardboardViewer({\n    id: 'CardboardV1',\n    label: 'Cardboard I/O 2014',\n    fov: 40,\n    interLensDistance: 0.060,\n    baselineLensDistance: 0.035,\n    screenLensDistance: 0.042,\n    distortionCoefficients: [0.441, 0.156],\n    inverseCoefficients: [-0.4410035, 0.42756155, -0.4804439, 0.5460139, -0.58821183, 0.5733938, -0.48303202, 0.33299083, -0.17573841, 0.0651772, -0.01488963, 0.001559834]\n  }),\n  CardboardV2: new CardboardViewer({\n    id: 'CardboardV2',\n    label: 'Cardboard I/O 2015',\n    fov: 60,\n    interLensDistance: 0.064,\n    baselineLensDistance: 0.035,\n    screenLensDistance: 0.039,\n    distortionCoefficients: [0.34, 0.55],\n    inverseCoefficients: [-0.33836704, -0.18162185, 0.862655, -1.2462051, 1.0560602, -0.58208317, 0.21609078, -0.05444823, 0.009177956, -9.904169E-4, 6.183535E-5, -1.6981803E-6]\n  })\n};\nfunction DeviceInfo(deviceParams, additionalViewers) {\n  this.viewer = Viewers.CardboardV2;\n  this.updateDeviceParams(deviceParams);\n  this.distortion = new Distortion(this.viewer.distortionCoefficients);\n  for (var i = 0; i < additionalViewers.length; i++) {\n    var viewer = additionalViewers[i];\n    Viewers[viewer.id] = new CardboardViewer(viewer);\n  }\n}\nDeviceInfo.prototype.updateDeviceParams = function (deviceParams) {\n  this.device = this.determineDevice_(deviceParams) || this.device;\n};\nDeviceInfo.prototype.getDevice = function () {\n  return this.device;\n};\nDeviceInfo.prototype.setViewer = function (viewer) {\n  this.viewer = viewer;\n  this.distortion = new Distortion(this.viewer.distortionCoefficients);\n};\nDeviceInfo.prototype.determineDevice_ = function (deviceParams) {\n  if (!deviceParams) {\n    if (isIOS()) {\n      console.warn('Using fallback iOS device measurements.');\n      return DEFAULT_IOS;\n    } else {\n      console.warn('Using fallback Android device measurements.');\n      return DEFAULT_ANDROID;\n    }\n  }\n  var METERS_PER_INCH = 0.0254;\n  var metersPerPixelX = METERS_PER_INCH / deviceParams.xdpi;\n  var metersPerPixelY = METERS_PER_INCH / deviceParams.ydpi;\n  var width = getScreenWidth();\n  var height = getScreenHeight();\n  return new Device({\n    widthMeters: metersPerPixelX * width,\n    heightMeters: metersPerPixelY * height,\n    bevelMeters: deviceParams.bevelMm * 0.001\n  });\n};\nDeviceInfo.prototype.getDistortedFieldOfViewLeftEye = function () {\n  var viewer = this.viewer;\n  var device = this.device;\n  var distortion = this.distortion;\n  var eyeToScreenDistance = viewer.screenLensDistance;\n  var outerDist = (device.widthMeters - viewer.interLensDistance) / 2;\n  var innerDist = viewer.interLensDistance / 2;\n  var bottomDist = viewer.baselineLensDistance - device.bevelMeters;\n  var topDist = device.heightMeters - bottomDist;\n  var outerAngle = radToDeg * Math.atan(distortion.distort(outerDist / eyeToScreenDistance));\n  var innerAngle = radToDeg * Math.atan(distortion.distort(innerDist / eyeToScreenDistance));\n  var bottomAngle = radToDeg * Math.atan(distortion.distort(bottomDist / eyeToScreenDistance));\n  var topAngle = radToDeg * Math.atan(distortion.distort(topDist / eyeToScreenDistance));\n  return {\n    leftDegrees: Math.min(outerAngle, viewer.fov),\n    rightDegrees: Math.min(innerAngle, viewer.fov),\n    downDegrees: Math.min(bottomAngle, viewer.fov),\n    upDegrees: Math.min(topAngle, viewer.fov)\n  };\n};\nDeviceInfo.prototype.getLeftEyeVisibleTanAngles = function () {\n  var viewer = this.viewer;\n  var device = this.device;\n  var distortion = this.distortion;\n  var fovLeft = Math.tan(-degToRad * viewer.fov);\n  var fovTop = Math.tan(degToRad * viewer.fov);\n  var fovRight = Math.tan(degToRad * viewer.fov);\n  var fovBottom = Math.tan(-degToRad * viewer.fov);\n  var halfWidth = device.widthMeters / 4;\n  var halfHeight = device.heightMeters / 2;\n  var verticalLensOffset = viewer.baselineLensDistance - device.bevelMeters - halfHeight;\n  var centerX = viewer.interLensDistance / 2 - halfWidth;\n  var centerY = -verticalLensOffset;\n  var centerZ = viewer.screenLensDistance;\n  var screenLeft = distortion.distort((centerX - halfWidth) / centerZ);\n  var screenTop = distortion.distort((centerY + halfHeight) / centerZ);\n  var screenRight = distortion.distort((centerX + halfWidth) / centerZ);\n  var screenBottom = distortion.distort((centerY - halfHeight) / centerZ);\n  var result = new Float32Array(4);\n  result[0] = Math.max(fovLeft, screenLeft);\n  result[1] = Math.min(fovTop, screenTop);\n  result[2] = Math.min(fovRight, screenRight);\n  result[3] = Math.max(fovBottom, screenBottom);\n  return result;\n};\nDeviceInfo.prototype.getLeftEyeNoLensTanAngles = function () {\n  var viewer = this.viewer;\n  var device = this.device;\n  var distortion = this.distortion;\n  var result = new Float32Array(4);\n  var fovLeft = distortion.distortInverse(Math.tan(-degToRad * viewer.fov));\n  var fovTop = distortion.distortInverse(Math.tan(degToRad * viewer.fov));\n  var fovRight = distortion.distortInverse(Math.tan(degToRad * viewer.fov));\n  var fovBottom = distortion.distortInverse(Math.tan(-degToRad * viewer.fov));\n  var halfWidth = device.widthMeters / 4;\n  var halfHeight = device.heightMeters / 2;\n  var verticalLensOffset = viewer.baselineLensDistance - device.bevelMeters - halfHeight;\n  var centerX = viewer.interLensDistance / 2 - halfWidth;\n  var centerY = -verticalLensOffset;\n  var centerZ = viewer.screenLensDistance;\n  var screenLeft = (centerX - halfWidth) / centerZ;\n  var screenTop = (centerY + halfHeight) / centerZ;\n  var screenRight = (centerX + halfWidth) / centerZ;\n  var screenBottom = (centerY - halfHeight) / centerZ;\n  result[0] = Math.max(fovLeft, screenLeft);\n  result[1] = Math.min(fovTop, screenTop);\n  result[2] = Math.min(fovRight, screenRight);\n  result[3] = Math.max(fovBottom, screenBottom);\n  return result;\n};\nDeviceInfo.prototype.getLeftEyeVisibleScreenRect = function (undistortedFrustum) {\n  var viewer = this.viewer;\n  var device = this.device;\n  var dist = viewer.screenLensDistance;\n  var eyeX = (device.widthMeters - viewer.interLensDistance) / 2;\n  var eyeY = viewer.baselineLensDistance - device.bevelMeters;\n  var left = (undistortedFrustum[0] * dist + eyeX) / device.widthMeters;\n  var top = (undistortedFrustum[1] * dist + eyeY) / device.heightMeters;\n  var right = (undistortedFrustum[2] * dist + eyeX) / device.widthMeters;\n  var bottom = (undistortedFrustum[3] * dist + eyeY) / device.heightMeters;\n  return {\n    x: left,\n    y: bottom,\n    width: right - left,\n    height: top - bottom\n  };\n};\nDeviceInfo.prototype.getFieldOfViewLeftEye = function (opt_isUndistorted) {\n  return opt_isUndistorted ? this.getUndistortedFieldOfViewLeftEye() : this.getDistortedFieldOfViewLeftEye();\n};\nDeviceInfo.prototype.getFieldOfViewRightEye = function (opt_isUndistorted) {\n  var fov = this.getFieldOfViewLeftEye(opt_isUndistorted);\n  return {\n    leftDegrees: fov.rightDegrees,\n    rightDegrees: fov.leftDegrees,\n    upDegrees: fov.upDegrees,\n    downDegrees: fov.downDegrees\n  };\n};\nDeviceInfo.prototype.getUndistortedFieldOfViewLeftEye = function () {\n  var p = this.getUndistortedParams_();\n  return {\n    leftDegrees: radToDeg * Math.atan(p.outerDist),\n    rightDegrees: radToDeg * Math.atan(p.innerDist),\n    downDegrees: radToDeg * Math.atan(p.bottomDist),\n    upDegrees: radToDeg * Math.atan(p.topDist)\n  };\n};\nDeviceInfo.prototype.getUndistortedViewportLeftEye = function () {\n  var p = this.getUndistortedParams_();\n  var viewer = this.viewer;\n  var device = this.device;\n  var eyeToScreenDistance = viewer.screenLensDistance;\n  var screenWidth = device.widthMeters / eyeToScreenDistance;\n  var screenHeight = device.heightMeters / eyeToScreenDistance;\n  var xPxPerTanAngle = device.width / screenWidth;\n  var yPxPerTanAngle = device.height / screenHeight;\n  var x = Math.round((p.eyePosX - p.outerDist) * xPxPerTanAngle);\n  var y = Math.round((p.eyePosY - p.bottomDist) * yPxPerTanAngle);\n  return {\n    x: x,\n    y: y,\n    width: Math.round((p.eyePosX + p.innerDist) * xPxPerTanAngle) - x,\n    height: Math.round((p.eyePosY + p.topDist) * yPxPerTanAngle) - y\n  };\n};\nDeviceInfo.prototype.getUndistortedParams_ = function () {\n  var viewer = this.viewer;\n  var device = this.device;\n  var distortion = this.distortion;\n  var eyeToScreenDistance = viewer.screenLensDistance;\n  var halfLensDistance = viewer.interLensDistance / 2 / eyeToScreenDistance;\n  var screenWidth = device.widthMeters / eyeToScreenDistance;\n  var screenHeight = device.heightMeters / eyeToScreenDistance;\n  var eyePosX = screenWidth / 2 - halfLensDistance;\n  var eyePosY = (viewer.baselineLensDistance - device.bevelMeters) / eyeToScreenDistance;\n  var maxFov = viewer.fov;\n  var viewerMax = distortion.distortInverse(Math.tan(degToRad * maxFov));\n  var outerDist = Math.min(eyePosX, viewerMax);\n  var innerDist = Math.min(halfLensDistance, viewerMax);\n  var bottomDist = Math.min(eyePosY, viewerMax);\n  var topDist = Math.min(screenHeight - eyePosY, viewerMax);\n  return {\n    outerDist: outerDist,\n    innerDist: innerDist,\n    topDist: topDist,\n    bottomDist: bottomDist,\n    eyePosX: eyePosX,\n    eyePosY: eyePosY\n  };\n};\nfunction CardboardViewer(params) {\n  this.id = params.id;\n  this.label = params.label;\n  this.fov = params.fov;\n  this.interLensDistance = params.interLensDistance;\n  this.baselineLensDistance = params.baselineLensDistance;\n  this.screenLensDistance = params.screenLensDistance;\n  this.distortionCoefficients = params.distortionCoefficients;\n  this.inverseCoefficients = params.inverseCoefficients;\n}\nDeviceInfo.Viewers = Viewers;\nvar format = 1;\nvar last_updated = \"2018-12-10T17:01:42Z\";\nvar devices = [{\"type\":\"android\",\"rules\":[{\"mdmh\":\"asus/*/Nexus 7/*\"},{\"ua\":\"Nexus 7\"}],\"dpi\":[320.8,323],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"asus/*/ASUS_Z00AD/*\"},{\"ua\":\"ASUS_Z00AD\"}],\"dpi\":[403,404.6],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Google/*/Pixel 2 XL/*\"},{\"ua\":\"Pixel 2 XL\"}],\"dpi\":537.9,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Google/*/Pixel 3 XL/*\"},{\"ua\":\"Pixel 3 XL\"}],\"dpi\":[558.5,553.8],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Google/*/Pixel XL/*\"},{\"ua\":\"Pixel XL\"}],\"dpi\":[537.9,533],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Google/*/Pixel 3/*\"},{\"ua\":\"Pixel 3\"}],\"dpi\":442.4,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Google/*/Pixel 2/*\"},{\"ua\":\"Pixel 2\"}],\"dpi\":441,\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Google/*/Pixel/*\"},{\"ua\":\"Pixel\"}],\"dpi\":[432.6,436.7],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"HTC/*/HTC6435LVW/*\"},{\"ua\":\"HTC6435LVW\"}],\"dpi\":[449.7,443.3],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"HTC/*/HTC One XL/*\"},{\"ua\":\"HTC One XL\"}],\"dpi\":[315.3,314.6],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"htc/*/Nexus 9/*\"},{\"ua\":\"Nexus 9\"}],\"dpi\":289,\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"HTC/*/HTC One M9/*\"},{\"ua\":\"HTC One M9\"}],\"dpi\":[442.5,443.3],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"HTC/*/HTC One_M8/*\"},{\"ua\":\"HTC One_M8\"}],\"dpi\":[449.7,447.4],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"HTC/*/HTC One/*\"},{\"ua\":\"HTC One\"}],\"dpi\":472.8,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Huawei/*/Nexus 6P/*\"},{\"ua\":\"Nexus 6P\"}],\"dpi\":[515.1,518],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Huawei/*/BLN-L24/*\"},{\"ua\":\"HONORBLN-L24\"}],\"dpi\":480,\"bw\":4,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Huawei/*/BKL-L09/*\"},{\"ua\":\"BKL-L09\"}],\"dpi\":403,\"bw\":3.47,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LENOVO/*/Lenovo PB2-690Y/*\"},{\"ua\":\"Lenovo PB2-690Y\"}],\"dpi\":[457.2,454.713],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/Nexus 5X/*\"},{\"ua\":\"Nexus 5X\"}],\"dpi\":[422,419.9],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/LGMS345/*\"},{\"ua\":\"LGMS345\"}],\"dpi\":[221.7,219.1],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/LG-D800/*\"},{\"ua\":\"LG-D800\"}],\"dpi\":[422,424.1],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/LG-D850/*\"},{\"ua\":\"LG-D850\"}],\"dpi\":[537.9,541.9],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/VS985 4G/*\"},{\"ua\":\"VS985 4G\"}],\"dpi\":[537.9,535.6],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/Nexus 5/*\"},{\"ua\":\"Nexus 5 B\"}],\"dpi\":[442.4,444.8],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/Nexus 4/*\"},{\"ua\":\"Nexus 4\"}],\"dpi\":[319.8,318.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/LG-P769/*\"},{\"ua\":\"LG-P769\"}],\"dpi\":[240.6,247.5],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/LGMS323/*\"},{\"ua\":\"LGMS323\"}],\"dpi\":[206.6,204.6],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"LGE/*/LGLS996/*\"},{\"ua\":\"LGLS996\"}],\"dpi\":[403.4,401.5],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Micromax/*/4560MMX/*\"},{\"ua\":\"4560MMX\"}],\"dpi\":[240,219.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Micromax/*/A250/*\"},{\"ua\":\"Micromax A250\"}],\"dpi\":[480,446.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Micromax/*/Micromax AQ4501/*\"},{\"ua\":\"Micromax AQ4501\"}],\"dpi\":240,\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/G5/*\"},{\"ua\":\"Moto G (5) Plus\"}],\"dpi\":[403.4,403],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/DROID RAZR/*\"},{\"ua\":\"DROID RAZR\"}],\"dpi\":[368.1,256.7],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT830C/*\"},{\"ua\":\"XT830C\"}],\"dpi\":[254,255.9],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1021/*\"},{\"ua\":\"XT1021\"}],\"dpi\":[254,256.7],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1023/*\"},{\"ua\":\"XT1023\"}],\"dpi\":[254,256.7],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1028/*\"},{\"ua\":\"XT1028\"}],\"dpi\":[326.6,327.6],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1034/*\"},{\"ua\":\"XT1034\"}],\"dpi\":[326.6,328.4],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1053/*\"},{\"ua\":\"XT1053\"}],\"dpi\":[315.3,316.1],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1562/*\"},{\"ua\":\"XT1562\"}],\"dpi\":[403.4,402.7],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/Nexus 6/*\"},{\"ua\":\"Nexus 6 B\"}],\"dpi\":[494.3,489.7],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1063/*\"},{\"ua\":\"XT1063\"}],\"dpi\":[295,296.6],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1064/*\"},{\"ua\":\"XT1064\"}],\"dpi\":[295,295.6],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1092/*\"},{\"ua\":\"XT1092\"}],\"dpi\":[422,424.1],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/XT1095/*\"},{\"ua\":\"XT1095\"}],\"dpi\":[422,423.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"motorola/*/G4/*\"},{\"ua\":\"Moto G (4)\"}],\"dpi\":401,\"bw\":4,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"OnePlus/*/A0001/*\"},{\"ua\":\"A0001\"}],\"dpi\":[403.4,401],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"OnePlus/*/ONE E1005/*\"},{\"ua\":\"ONE E1005\"}],\"dpi\":[442.4,441.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"OnePlus/*/ONE A2005/*\"},{\"ua\":\"ONE A2005\"}],\"dpi\":[391.9,405.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"OnePlus/*/ONEPLUS A5000/*\"},{\"ua\":\"ONEPLUS A5000 \"}],\"dpi\":[403.411,399.737],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"OnePlus/*/ONE A5010/*\"},{\"ua\":\"ONEPLUS A5010\"}],\"dpi\":[403,400],\"bw\":2,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"OPPO/*/X909/*\"},{\"ua\":\"X909\"}],\"dpi\":[442.4,444.1],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/GT-I9082/*\"},{\"ua\":\"GT-I9082\"}],\"dpi\":[184.7,185.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G360P/*\"},{\"ua\":\"SM-G360P\"}],\"dpi\":[196.7,205.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/Nexus S/*\"},{\"ua\":\"Nexus S\"}],\"dpi\":[234.5,229.8],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/GT-I9300/*\"},{\"ua\":\"GT-I9300\"}],\"dpi\":[304.8,303.9],\"bw\":5,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-T230NU/*\"},{\"ua\":\"SM-T230NU\"}],\"dpi\":216,\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SGH-T399/*\"},{\"ua\":\"SGH-T399\"}],\"dpi\":[217.7,231.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SGH-M919/*\"},{\"ua\":\"SGH-M919\"}],\"dpi\":[440.8,437.7],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-N9005/*\"},{\"ua\":\"SM-N9005\"}],\"dpi\":[386.4,387],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SAMSUNG-SM-N900A/*\"},{\"ua\":\"SAMSUNG-SM-N900A\"}],\"dpi\":[386.4,387.7],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/GT-I9500/*\"},{\"ua\":\"GT-I9500\"}],\"dpi\":[442.5,443.3],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/GT-I9505/*\"},{\"ua\":\"GT-I9505\"}],\"dpi\":439.4,\"bw\":4,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G900F/*\"},{\"ua\":\"SM-G900F\"}],\"dpi\":[415.6,431.6],\"bw\":5,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G900M/*\"},{\"ua\":\"SM-G900M\"}],\"dpi\":[415.6,431.6],\"bw\":5,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G800F/*\"},{\"ua\":\"SM-G800F\"}],\"dpi\":326.8,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G906S/*\"},{\"ua\":\"SM-G906S\"}],\"dpi\":[562.7,572.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/GT-I9300/*\"},{\"ua\":\"GT-I9300\"}],\"dpi\":[306.7,304.8],\"bw\":5,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-T535/*\"},{\"ua\":\"SM-T535\"}],\"dpi\":[142.6,136.4],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-N920C/*\"},{\"ua\":\"SM-N920C\"}],\"dpi\":[515.1,518.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-N920P/*\"},{\"ua\":\"SM-N920P\"}],\"dpi\":[386.3655,390.144],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-N920W8/*\"},{\"ua\":\"SM-N920W8\"}],\"dpi\":[515.1,518.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/GT-I9300I/*\"},{\"ua\":\"GT-I9300I\"}],\"dpi\":[304.8,305.8],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/GT-I9195/*\"},{\"ua\":\"GT-I9195\"}],\"dpi\":[249.4,256.7],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SPH-L520/*\"},{\"ua\":\"SPH-L520\"}],\"dpi\":[249.4,255.9],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SAMSUNG-SGH-I717/*\"},{\"ua\":\"SAMSUNG-SGH-I717\"}],\"dpi\":285.8,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SPH-D710/*\"},{\"ua\":\"SPH-D710\"}],\"dpi\":[217.7,204.2],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/GT-N7100/*\"},{\"ua\":\"GT-N7100\"}],\"dpi\":265.1,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SCH-I605/*\"},{\"ua\":\"SCH-I605\"}],\"dpi\":265.1,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/Galaxy Nexus/*\"},{\"ua\":\"Galaxy Nexus\"}],\"dpi\":[315.3,314.2],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-N910H/*\"},{\"ua\":\"SM-N910H\"}],\"dpi\":[515.1,518],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-N910C/*\"},{\"ua\":\"SM-N910C\"}],\"dpi\":[515.2,520.2],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G130M/*\"},{\"ua\":\"SM-G130M\"}],\"dpi\":[165.9,164.8],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G928I/*\"},{\"ua\":\"SM-G928I\"}],\"dpi\":[515.1,518.4],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G920F/*\"},{\"ua\":\"SM-G920F\"}],\"dpi\":580.6,\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G920P/*\"},{\"ua\":\"SM-G920P\"}],\"dpi\":[522.5,577],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G925F/*\"},{\"ua\":\"SM-G925F\"}],\"dpi\":580.6,\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G925V/*\"},{\"ua\":\"SM-G925V\"}],\"dpi\":[522.5,576.6],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G930F/*\"},{\"ua\":\"SM-G930F\"}],\"dpi\":576.6,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G935F/*\"},{\"ua\":\"SM-G935F\"}],\"dpi\":533,\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G950F/*\"},{\"ua\":\"SM-G950F\"}],\"dpi\":[562.707,565.293],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G955U/*\"},{\"ua\":\"SM-G955U\"}],\"dpi\":[522.514,525.762],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"samsung/*/SM-G955F/*\"},{\"ua\":\"SM-G955F\"}],\"dpi\":[522.514,525.762],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Sony/*/C6903/*\"},{\"ua\":\"C6903\"}],\"dpi\":[442.5,443.3],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Sony/*/D6653/*\"},{\"ua\":\"D6653\"}],\"dpi\":[428.6,427.6],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Sony/*/E6653/*\"},{\"ua\":\"E6653\"}],\"dpi\":[428.6,425.7],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Sony/*/E6853/*\"},{\"ua\":\"E6853\"}],\"dpi\":[403.4,401.9],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Sony/*/SGP321/*\"},{\"ua\":\"SGP321\"}],\"dpi\":[224.7,224.1],\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"TCT/*/ALCATEL ONE TOUCH Fierce/*\"},{\"ua\":\"ALCATEL ONE TOUCH Fierce\"}],\"dpi\":[240,247.5],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"THL/*/thl 5000/*\"},{\"ua\":\"thl 5000\"}],\"dpi\":[480,443.3],\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"Fly/*/IQ4412/*\"},{\"ua\":\"IQ4412\"}],\"dpi\":307.9,\"bw\":3,\"ac\":1000},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"ZTE/*/ZTE Blade L2/*\"},{\"ua\":\"ZTE Blade L2\"}],\"dpi\":240,\"bw\":3,\"ac\":500},{\"type\":\"android\",\"rules\":[{\"mdmh\":\"BENEVE/*/VR518/*\"},{\"ua\":\"VR518\"}],\"dpi\":480,\"bw\":3,\"ac\":500},{\"type\":\"ios\",\"rules\":[{\"res\":[640,960]}],\"dpi\":[325.1,328.4],\"bw\":4,\"ac\":1000},{\"type\":\"ios\",\"rules\":[{\"res\":[640,1136]}],\"dpi\":[317.1,320.2],\"bw\":3,\"ac\":1000},{\"type\":\"ios\",\"rules\":[{\"res\":[750,1334]}],\"dpi\":326.4,\"bw\":4,\"ac\":1000},{\"type\":\"ios\",\"rules\":[{\"res\":[1242,2208]}],\"dpi\":[453.6,458.4],\"bw\":4,\"ac\":1000},{\"type\":\"ios\",\"rules\":[{\"res\":[1125,2001]}],\"dpi\":[410.9,415.4],\"bw\":4,\"ac\":1000},{\"type\":\"ios\",\"rules\":[{\"res\":[1125,2436]}],\"dpi\":458,\"bw\":4,\"ac\":1000}];\nvar DPDB_CACHE = {\n\tformat: format,\n\tlast_updated: last_updated,\n\tdevices: devices\n};\nfunction Dpdb(url, onDeviceParamsUpdated) {\n  this.dpdb = DPDB_CACHE;\n  this.recalculateDeviceParams_();\n  if (url) {\n    this.onDeviceParamsUpdated = onDeviceParamsUpdated;\n    var xhr = new XMLHttpRequest();\n    var obj = this;\n    xhr.open('GET', url, true);\n    xhr.addEventListener('load', function () {\n      obj.loading = false;\n      if (xhr.status >= 200 && xhr.status <= 299) {\n        obj.dpdb = JSON.parse(xhr.response);\n        obj.recalculateDeviceParams_();\n      } else {\n        console.error('Error loading online DPDB!');\n      }\n    });\n    xhr.send();\n  }\n}\nDpdb.prototype.getDeviceParams = function () {\n  return this.deviceParams;\n};\nDpdb.prototype.recalculateDeviceParams_ = function () {\n  var newDeviceParams = this.calcDeviceParams_();\n  if (newDeviceParams) {\n    this.deviceParams = newDeviceParams;\n    if (this.onDeviceParamsUpdated) {\n      this.onDeviceParamsUpdated(this.deviceParams);\n    }\n  } else {\n    console.error('Failed to recalculate device parameters.');\n  }\n};\nDpdb.prototype.calcDeviceParams_ = function () {\n  var db = this.dpdb;\n  if (!db) {\n    console.error('DPDB not available.');\n    return null;\n  }\n  if (db.format != 1) {\n    console.error('DPDB has unexpected format version.');\n    return null;\n  }\n  if (!db.devices || !db.devices.length) {\n    console.error('DPDB does not have a devices section.');\n    return null;\n  }\n  var userAgent = navigator.userAgent || navigator.vendor || window.opera;\n  var width = getScreenWidth();\n  var height = getScreenHeight();\n  if (!db.devices) {\n    console.error('DPDB has no devices section.');\n    return null;\n  }\n  for (var i = 0; i < db.devices.length; i++) {\n    var device = db.devices[i];\n    if (!device.rules) {\n      console.warn('Device[' + i + '] has no rules section.');\n      continue;\n    }\n    if (device.type != 'ios' && device.type != 'android') {\n      console.warn('Device[' + i + '] has invalid type.');\n      continue;\n    }\n    if (isIOS() != (device.type == 'ios')) continue;\n    var matched = false;\n    for (var j = 0; j < device.rules.length; j++) {\n      var rule = device.rules[j];\n      if (this.ruleMatches_(rule, userAgent, width, height)) {\n        matched = true;\n        break;\n      }\n    }\n    if (!matched) continue;\n    var xdpi = device.dpi[0] || device.dpi;\n    var ydpi = device.dpi[1] || device.dpi;\n    return new DeviceParams({ xdpi: xdpi, ydpi: ydpi, bevelMm: device.bw });\n  }\n  console.warn('No DPDB device match.');\n  return null;\n};\nDpdb.prototype.ruleMatches_ = function (rule, ua, screenWidth, screenHeight) {\n  if (!rule.ua && !rule.res) return false;\n  if (rule.ua && rule.ua.substring(0, 2) === 'SM') rule.ua = rule.ua.substring(0, 7);\n  if (rule.ua && ua.indexOf(rule.ua) < 0) return false;\n  if (rule.res) {\n    if (!rule.res[0] || !rule.res[1]) return false;\n    var resX = rule.res[0];\n    var resY = rule.res[1];\n    if (Math.min(screenWidth, screenHeight) != Math.min(resX, resY) || Math.max(screenWidth, screenHeight) != Math.max(resX, resY)) {\n      return false;\n    }\n  }\n  return true;\n};\nfunction DeviceParams(params) {\n  this.xdpi = params.xdpi;\n  this.ydpi = params.ydpi;\n  this.bevelMm = params.bevelMm;\n}\nfunction SensorSample(sample, timestampS) {\n  this.set(sample, timestampS);\n}\nSensorSample.prototype.set = function (sample, timestampS) {\n  this.sample = sample;\n  this.timestampS = timestampS;\n};\nSensorSample.prototype.copy = function (sensorSample) {\n  this.set(sensorSample.sample, sensorSample.timestampS);\n};\nfunction ComplementaryFilter(kFilter, isDebug) {\n  this.kFilter = kFilter;\n  this.isDebug = isDebug;\n  this.currentAccelMeasurement = new SensorSample();\n  this.currentGyroMeasurement = new SensorSample();\n  this.previousGyroMeasurement = new SensorSample();\n  if (isIOS()) {\n    this.filterQ = new Quaternion(-1, 0, 0, 1);\n  } else {\n    this.filterQ = new Quaternion(1, 0, 0, 1);\n  }\n  this.previousFilterQ = new Quaternion();\n  this.previousFilterQ.copy(this.filterQ);\n  this.accelQ = new Quaternion();\n  this.isOrientationInitialized = false;\n  this.estimatedGravity = new Vector3();\n  this.measuredGravity = new Vector3();\n  this.gyroIntegralQ = new Quaternion();\n}\nComplementaryFilter.prototype.addAccelMeasurement = function (vector, timestampS) {\n  this.currentAccelMeasurement.set(vector, timestampS);\n};\nComplementaryFilter.prototype.addGyroMeasurement = function (vector, timestampS) {\n  this.currentGyroMeasurement.set(vector, timestampS);\n  var deltaT = timestampS - this.previousGyroMeasurement.timestampS;\n  if (isTimestampDeltaValid(deltaT)) {\n    this.run_();\n  }\n  this.previousGyroMeasurement.copy(this.currentGyroMeasurement);\n};\nComplementaryFilter.prototype.run_ = function () {\n  if (!this.isOrientationInitialized) {\n    this.accelQ = this.accelToQuaternion_(this.currentAccelMeasurement.sample);\n    this.previousFilterQ.copy(this.accelQ);\n    this.isOrientationInitialized = true;\n    return;\n  }\n  var deltaT = this.currentGyroMeasurement.timestampS - this.previousGyroMeasurement.timestampS;\n  var gyroDeltaQ = this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample, deltaT);\n  this.gyroIntegralQ.multiply(gyroDeltaQ);\n  this.filterQ.copy(this.previousFilterQ);\n  this.filterQ.multiply(gyroDeltaQ);\n  var invFilterQ = new Quaternion();\n  invFilterQ.copy(this.filterQ);\n  invFilterQ.inverse();\n  this.estimatedGravity.set(0, 0, -1);\n  this.estimatedGravity.applyQuaternion(invFilterQ);\n  this.estimatedGravity.normalize();\n  this.measuredGravity.copy(this.currentAccelMeasurement.sample);\n  this.measuredGravity.normalize();\n  var deltaQ = new Quaternion();\n  deltaQ.setFromUnitVectors(this.estimatedGravity, this.measuredGravity);\n  deltaQ.inverse();\n  if (this.isDebug) {\n    console.log('Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)', radToDeg * getQuaternionAngle(deltaQ), this.estimatedGravity.x.toFixed(1), this.estimatedGravity.y.toFixed(1), this.estimatedGravity.z.toFixed(1), this.measuredGravity.x.toFixed(1), this.measuredGravity.y.toFixed(1), this.measuredGravity.z.toFixed(1));\n  }\n  var targetQ = new Quaternion();\n  targetQ.copy(this.filterQ);\n  targetQ.multiply(deltaQ);\n  this.filterQ.slerp(targetQ, 1 - this.kFilter);\n  this.previousFilterQ.copy(this.filterQ);\n};\nComplementaryFilter.prototype.getOrientation = function () {\n  return this.filterQ;\n};\nComplementaryFilter.prototype.accelToQuaternion_ = function (accel) {\n  var normAccel = new Vector3();\n  normAccel.copy(accel);\n  normAccel.normalize();\n  var quat = new Quaternion();\n  quat.setFromUnitVectors(new Vector3(0, 0, -1), normAccel);\n  quat.inverse();\n  return quat;\n};\nComplementaryFilter.prototype.gyroToQuaternionDelta_ = function (gyro, dt) {\n  var quat = new Quaternion();\n  var axis = new Vector3();\n  axis.copy(gyro);\n  axis.normalize();\n  quat.setFromAxisAngle(axis, gyro.length() * dt);\n  return quat;\n};\nfunction PosePredictor(predictionTimeS, isDebug) {\n  this.predictionTimeS = predictionTimeS;\n  this.isDebug = isDebug;\n  this.previousQ = new Quaternion();\n  this.previousTimestampS = null;\n  this.deltaQ = new Quaternion();\n  this.outQ = new Quaternion();\n}\nPosePredictor.prototype.getPrediction = function (currentQ, gyro, timestampS) {\n  if (!this.previousTimestampS) {\n    this.previousQ.copy(currentQ);\n    this.previousTimestampS = timestampS;\n    return currentQ;\n  }\n  var axis = new Vector3();\n  axis.copy(gyro);\n  axis.normalize();\n  var angularSpeed = gyro.length();\n  if (angularSpeed < degToRad * 20) {\n    if (this.isDebug) {\n      console.log('Moving slowly, at %s deg/s: no prediction', (radToDeg * angularSpeed).toFixed(1));\n    }\n    this.outQ.copy(currentQ);\n    this.previousQ.copy(currentQ);\n    return this.outQ;\n  }\n  var predictAngle = angularSpeed * this.predictionTimeS;\n  this.deltaQ.setFromAxisAngle(axis, predictAngle);\n  this.outQ.copy(this.previousQ);\n  this.outQ.multiply(this.deltaQ);\n  this.previousQ.copy(currentQ);\n  this.previousTimestampS = timestampS;\n  return this.outQ;\n};\nfunction FusionPoseSensor(kFilter, predictionTime, yawOnly, isDebug) {\n  this.yawOnly = yawOnly;\n  this.accelerometer = new Vector3();\n  this.gyroscope = new Vector3();\n  this.filter = new ComplementaryFilter(kFilter, isDebug);\n  this.posePredictor = new PosePredictor(predictionTime, isDebug);\n  this.isFirefoxAndroid = isFirefoxAndroid();\n  this.isIOS = isIOS();\n  var chromeVersion = getChromeVersion();\n  this.isDeviceMotionInRadians = !this.isIOS && chromeVersion && chromeVersion < 66;\n  this.isWithoutDeviceMotion = isChromeWithoutDeviceMotion();\n  this.filterToWorldQ = new Quaternion();\n  if (isIOS()) {\n    this.filterToWorldQ.setFromAxisAngle(new Vector3(1, 0, 0), Math.PI / 2);\n  } else {\n    this.filterToWorldQ.setFromAxisAngle(new Vector3(1, 0, 0), -Math.PI / 2);\n  }\n  this.inverseWorldToScreenQ = new Quaternion();\n  this.worldToScreenQ = new Quaternion();\n  this.originalPoseAdjustQ = new Quaternion();\n  this.originalPoseAdjustQ.setFromAxisAngle(new Vector3(0, 0, 1), -window.orientation * Math.PI / 180);\n  this.setScreenTransform_();\n  if (isLandscapeMode()) {\n    this.filterToWorldQ.multiply(this.inverseWorldToScreenQ);\n  }\n  this.resetQ = new Quaternion();\n  this.orientationOut_ = new Float32Array(4);\n  this.start();\n}\nFusionPoseSensor.prototype.getPosition = function () {\n  return null;\n};\nFusionPoseSensor.prototype.getOrientation = function () {\n  var orientation = void 0;\n  if (this.isWithoutDeviceMotion && this._deviceOrientationQ) {\n    this.deviceOrientationFixQ = this.deviceOrientationFixQ || function () {\n      var z = new Quaternion().setFromAxisAngle(new Vector3(0, 0, -1), 0);\n      var y = new Quaternion();\n      if (window.orientation === -90) {\n        y.setFromAxisAngle(new Vector3(0, 1, 0), Math.PI / -2);\n      } else {\n        y.setFromAxisAngle(new Vector3(0, 1, 0), Math.PI / 2);\n      }\n      return z.multiply(y);\n    }();\n    this.deviceOrientationFilterToWorldQ = this.deviceOrientationFilterToWorldQ || function () {\n      var q = new Quaternion();\n      q.setFromAxisAngle(new Vector3(1, 0, 0), -Math.PI / 2);\n      return q;\n    }();\n    orientation = this._deviceOrientationQ;\n    var out = new Quaternion();\n    out.copy(orientation);\n    out.multiply(this.deviceOrientationFilterToWorldQ);\n    out.multiply(this.resetQ);\n    out.multiply(this.worldToScreenQ);\n    out.multiplyQuaternions(this.deviceOrientationFixQ, out);\n    if (this.yawOnly) {\n      out.x = 0;\n      out.z = 0;\n      out.normalize();\n    }\n    this.orientationOut_[0] = out.x;\n    this.orientationOut_[1] = out.y;\n    this.orientationOut_[2] = out.z;\n    this.orientationOut_[3] = out.w;\n    return this.orientationOut_;\n  } else {\n    var filterOrientation = this.filter.getOrientation();\n    orientation = this.posePredictor.getPrediction(filterOrientation, this.gyroscope, this.previousTimestampS);\n  }\n  var out = new Quaternion();\n  out.copy(this.filterToWorldQ);\n  out.multiply(this.resetQ);\n  out.multiply(orientation);\n  out.multiply(this.worldToScreenQ);\n  if (this.yawOnly) {\n    out.x = 0;\n    out.z = 0;\n    out.normalize();\n  }\n  this.orientationOut_[0] = out.x;\n  this.orientationOut_[1] = out.y;\n  this.orientationOut_[2] = out.z;\n  this.orientationOut_[3] = out.w;\n  return this.orientationOut_;\n};\nFusionPoseSensor.prototype.resetPose = function () {\n  this.resetQ.copy(this.filter.getOrientation());\n  this.resetQ.x = 0;\n  this.resetQ.y = 0;\n  this.resetQ.z *= -1;\n  this.resetQ.normalize();\n  if (isLandscapeMode()) {\n    this.resetQ.multiply(this.inverseWorldToScreenQ);\n  }\n  this.resetQ.multiply(this.originalPoseAdjustQ);\n};\nFusionPoseSensor.prototype.onDeviceOrientation_ = function (e) {\n  this._deviceOrientationQ = this._deviceOrientationQ || new Quaternion();\n  var alpha = e.alpha,\n      beta = e.beta,\n      gamma = e.gamma;\n  alpha = (alpha || 0) * Math.PI / 180;\n  beta = (beta || 0) * Math.PI / 180;\n  gamma = (gamma || 0) * Math.PI / 180;\n  this._deviceOrientationQ.setFromEulerYXZ(beta, alpha, -gamma);\n};\nFusionPoseSensor.prototype.onDeviceMotion_ = function (deviceMotion) {\n  this.updateDeviceMotion_(deviceMotion);\n};\nFusionPoseSensor.prototype.updateDeviceMotion_ = function (deviceMotion) {\n  var accGravity = deviceMotion.accelerationIncludingGravity;\n  var rotRate = deviceMotion.rotationRate;\n  var timestampS = deviceMotion.timeStamp / 1000;\n  var deltaS = timestampS - this.previousTimestampS;\n  if (deltaS < 0) {\n    warnOnce('fusion-pose-sensor:invalid:non-monotonic', 'Invalid timestamps detected: non-monotonic timestamp from devicemotion');\n    this.previousTimestampS = timestampS;\n    return;\n  } else if (deltaS <= MIN_TIMESTEP || deltaS > MAX_TIMESTEP) {\n    warnOnce('fusion-pose-sensor:invalid:outside-threshold', 'Invalid timestamps detected: Timestamp from devicemotion outside expected range.');\n    this.previousTimestampS = timestampS;\n    return;\n  }\n  this.accelerometer.set(-accGravity.x, -accGravity.y, -accGravity.z);\n  if (isR7()) {\n    this.gyroscope.set(-rotRate.beta, rotRate.alpha, rotRate.gamma);\n  } else {\n    this.gyroscope.set(rotRate.alpha, rotRate.beta, rotRate.gamma);\n  }\n  if (!this.isDeviceMotionInRadians) {\n    this.gyroscope.multiplyScalar(Math.PI / 180);\n  }\n  this.filter.addAccelMeasurement(this.accelerometer, timestampS);\n  this.filter.addGyroMeasurement(this.gyroscope, timestampS);\n  this.previousTimestampS = timestampS;\n};\nFusionPoseSensor.prototype.onOrientationChange_ = function (screenOrientation) {\n  this.setScreenTransform_();\n};\nFusionPoseSensor.prototype.onMessage_ = function (event) {\n  var message = event.data;\n  if (!message || !message.type) {\n    return;\n  }\n  var type = message.type.toLowerCase();\n  if (type !== 'devicemotion') {\n    return;\n  }\n  this.updateDeviceMotion_(message.deviceMotionEvent);\n};\nFusionPoseSensor.prototype.setScreenTransform_ = function () {\n  this.worldToScreenQ.set(0, 0, 0, 1);\n  switch (window.orientation) {\n    case 0:\n      break;\n    case 90:\n      this.worldToScreenQ.setFromAxisAngle(new Vector3(0, 0, 1), -Math.PI / 2);\n      break;\n    case -90:\n      this.worldToScreenQ.setFromAxisAngle(new Vector3(0, 0, 1), Math.PI / 2);\n      break;\n    case 180:\n      break;\n  }\n  this.inverseWorldToScreenQ.copy(this.worldToScreenQ);\n  this.inverseWorldToScreenQ.inverse();\n};\nFusionPoseSensor.prototype.start = function () {\n  this.onDeviceMotionCallback_ = this.onDeviceMotion_.bind(this);\n  this.onOrientationChangeCallback_ = this.onOrientationChange_.bind(this);\n  this.onMessageCallback_ = this.onMessage_.bind(this);\n  this.onDeviceOrientationCallback_ = this.onDeviceOrientation_.bind(this);\n  if (isIOS() && isInsideCrossOriginIFrame()) {\n    window.addEventListener('message', this.onMessageCallback_);\n  }\n  window.addEventListener('orientationchange', this.onOrientationChangeCallback_);\n  if (this.isWithoutDeviceMotion) {\n    window.addEventListener('deviceorientation', this.onDeviceOrientationCallback_);\n  } else {\n    window.addEventListener('devicemotion', this.onDeviceMotionCallback_);\n  }\n};\nFusionPoseSensor.prototype.stop = function () {\n  window.removeEventListener('devicemotion', this.onDeviceMotionCallback_);\n  window.removeEventListener('deviceorientation', this.onDeviceOrientationCallback_);\n  window.removeEventListener('orientationchange', this.onOrientationChangeCallback_);\n  window.removeEventListener('message', this.onMessageCallback_);\n};\nvar SENSOR_FREQUENCY = 60;\nvar X_AXIS = new Vector3(1, 0, 0);\nvar Z_AXIS = new Vector3(0, 0, 1);\nvar SENSOR_TO_VR = new Quaternion();\nSENSOR_TO_VR.setFromAxisAngle(X_AXIS, -Math.PI / 2);\nSENSOR_TO_VR.multiply(new Quaternion().setFromAxisAngle(Z_AXIS, Math.PI / 2));\nvar PoseSensor = function () {\n  function PoseSensor(config) {\n    classCallCheck(this, PoseSensor);\n    this.config = config;\n    this.sensor = null;\n    this.fusionSensor = null;\n    this._out = new Float32Array(4);\n    this.api = null;\n    this.errors = [];\n    this._sensorQ = new Quaternion();\n    this._outQ = new Quaternion();\n    this._onSensorRead = this._onSensorRead.bind(this);\n    this._onSensorError = this._onSensorError.bind(this);\n    this.init();\n  }\n  createClass(PoseSensor, [{\n    key: 'init',\n    value: function init() {\n      var sensor = null;\n      try {\n        sensor = new RelativeOrientationSensor({\n          frequency: SENSOR_FREQUENCY,\n          referenceFrame: 'screen'\n        });\n        sensor.addEventListener('error', this._onSensorError);\n      } catch (error) {\n        this.errors.push(error);\n        if (error.name === 'SecurityError') {\n          console.error('Cannot construct sensors due to the Feature Policy');\n          console.warn('Attempting to fall back using \"devicemotion\"; however this will ' + 'fail in the future without correct permissions.');\n          this.useDeviceMotion();\n        } else if (error.name === 'ReferenceError') {\n          this.useDeviceMotion();\n        } else {\n          console.error(error);\n        }\n      }\n      if (sensor) {\n        this.api = 'sensor';\n        this.sensor = sensor;\n        this.sensor.addEventListener('reading', this._onSensorRead);\n        this.sensor.start();\n      }\n    }\n  }, {\n    key: 'useDeviceMotion',\n    value: function useDeviceMotion() {\n      this.api = 'devicemotion';\n      this.fusionSensor = new FusionPoseSensor(this.config.K_FILTER, this.config.PREDICTION_TIME_S, this.config.YAW_ONLY, this.config.DEBUG);\n      if (this.sensor) {\n        this.sensor.removeEventListener('reading', this._onSensorRead);\n        this.sensor.removeEventListener('error', this._onSensorError);\n        this.sensor = null;\n      }\n    }\n  }, {\n    key: 'getOrientation',\n    value: function getOrientation() {\n      if (this.fusionSensor) {\n        return this.fusionSensor.getOrientation();\n      }\n      if (!this.sensor || !this.sensor.quaternion) {\n        this._out[0] = this._out[1] = this._out[2] = 0;\n        this._out[3] = 1;\n        return this._out;\n      }\n      var q = this.sensor.quaternion;\n      this._sensorQ.set(q[0], q[1], q[2], q[3]);\n      var out = this._outQ;\n      out.copy(SENSOR_TO_VR);\n      out.multiply(this._sensorQ);\n      if (this.config.YAW_ONLY) {\n        out.x = out.z = 0;\n        out.normalize();\n      }\n      this._out[0] = out.x;\n      this._out[1] = out.y;\n      this._out[2] = out.z;\n      this._out[3] = out.w;\n      return this._out;\n    }\n  }, {\n    key: '_onSensorError',\n    value: function _onSensorError(event) {\n      this.errors.push(event.error);\n      if (event.error.name === 'NotAllowedError') {\n        console.error('Permission to access sensor was denied');\n      } else if (event.error.name === 'NotReadableError') {\n        console.error('Sensor could not be read');\n      } else {\n        console.error(event.error);\n      }\n      this.useDeviceMotion();\n    }\n  }, {\n    key: '_onSensorRead',\n    value: function _onSensorRead() {}\n  }]);\n  return PoseSensor;\n}();\nvar rotateInstructionsAsset = \"<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>\";\nfunction RotateInstructions() {\n  this.loadIcon_();\n  var overlay = document.createElement('div');\n  var s = overlay.style;\n  s.position = 'fixed';\n  s.top = 0;\n  s.right = 0;\n  s.bottom = 0;\n  s.left = 0;\n  s.backgroundColor = 'gray';\n  s.fontFamily = 'sans-serif';\n  s.zIndex = 1000000;\n  var img = document.createElement('img');\n  img.src = this.icon;\n  var s = img.style;\n  s.marginLeft = '25%';\n  s.marginTop = '25%';\n  s.width = '50%';\n  overlay.appendChild(img);\n  var text = document.createElement('div');\n  var s = text.style;\n  s.textAlign = 'center';\n  s.fontSize = '16px';\n  s.lineHeight = '24px';\n  s.margin = '24px 25%';\n  s.width = '50%';\n  text.innerHTML = 'Place your phone into your Cardboard viewer.';\n  overlay.appendChild(text);\n  var snackbar = document.createElement('div');\n  var s = snackbar.style;\n  s.backgroundColor = '#CFD8DC';\n  s.position = 'fixed';\n  s.bottom = 0;\n  s.width = '100%';\n  s.height = '48px';\n  s.padding = '14px 24px';\n  s.boxSizing = 'border-box';\n  s.color = '#656A6B';\n  overlay.appendChild(snackbar);\n  var snackbarText = document.createElement('div');\n  snackbarText.style.float = 'left';\n  snackbarText.innerHTML = 'No Cardboard viewer?';\n  var snackbarButton = document.createElement('a');\n  snackbarButton.href = 'https://www.google.com/get/cardboard/get-cardboard/';\n  snackbarButton.innerHTML = 'get one';\n  snackbarButton.target = '_blank';\n  var s = snackbarButton.style;\n  s.float = 'right';\n  s.fontWeight = 600;\n  s.textTransform = 'uppercase';\n  s.borderLeft = '1px solid gray';\n  s.paddingLeft = '24px';\n  s.textDecoration = 'none';\n  s.color = '#656A6B';\n  snackbar.appendChild(snackbarText);\n  snackbar.appendChild(snackbarButton);\n  this.overlay = overlay;\n  this.text = text;\n  this.hide();\n}\nRotateInstructions.prototype.show = function (parent) {\n  if (!parent && !this.overlay.parentElement) {\n    document.body.appendChild(this.overlay);\n  } else if (parent) {\n    if (this.overlay.parentElement && this.overlay.parentElement != parent) this.overlay.parentElement.removeChild(this.overlay);\n    parent.appendChild(this.overlay);\n  }\n  this.overlay.style.display = 'block';\n  var img = this.overlay.querySelector('img');\n  var s = img.style;\n  if (isLandscapeMode()) {\n    s.width = '20%';\n    s.marginLeft = '40%';\n    s.marginTop = '3%';\n  } else {\n    s.width = '50%';\n    s.marginLeft = '25%';\n    s.marginTop = '25%';\n  }\n};\nRotateInstructions.prototype.hide = function () {\n  this.overlay.style.display = 'none';\n};\nRotateInstructions.prototype.showTemporarily = function (ms, parent) {\n  this.show(parent);\n  this.timer = setTimeout(this.hide.bind(this), ms);\n};\nRotateInstructions.prototype.disableShowTemporarily = function () {\n  clearTimeout(this.timer);\n};\nRotateInstructions.prototype.update = function () {\n  this.disableShowTemporarily();\n  if (!isLandscapeMode() && isMobile()) {\n    this.show();\n  } else {\n    this.hide();\n  }\n};\nRotateInstructions.prototype.loadIcon_ = function () {\n  this.icon = dataUri('image/svg+xml', rotateInstructionsAsset);\n};\nvar DEFAULT_VIEWER = 'CardboardV1';\nvar VIEWER_KEY = 'WEBVR_CARDBOARD_VIEWER';\nvar CLASS_NAME = 'webvr-polyfill-viewer-selector';\nfunction ViewerSelector(defaultViewer) {\n  try {\n    this.selectedKey = localStorage.getItem(VIEWER_KEY);\n  } catch (error) {\n    console.error('Failed to load viewer profile: %s', error);\n  }\n  if (!this.selectedKey) {\n    this.selectedKey = defaultViewer || DEFAULT_VIEWER;\n  }\n  this.dialog = this.createDialog_(DeviceInfo.Viewers);\n  this.root = null;\n  this.onChangeCallbacks_ = [];\n}\nViewerSelector.prototype.show = function (root) {\n  this.root = root;\n  root.appendChild(this.dialog);\n  var selected = this.dialog.querySelector('#' + this.selectedKey);\n  selected.checked = true;\n  this.dialog.style.display = 'block';\n};\nViewerSelector.prototype.hide = function () {\n  if (this.root && this.root.contains(this.dialog)) {\n    this.root.removeChild(this.dialog);\n  }\n  this.dialog.style.display = 'none';\n};\nViewerSelector.prototype.getCurrentViewer = function () {\n  return DeviceInfo.Viewers[this.selectedKey];\n};\nViewerSelector.prototype.getSelectedKey_ = function () {\n  var input = this.dialog.querySelector('input[name=field]:checked');\n  if (input) {\n    return input.id;\n  }\n  return null;\n};\nViewerSelector.prototype.onChange = function (cb) {\n  this.onChangeCallbacks_.push(cb);\n};\nViewerSelector.prototype.fireOnChange_ = function (viewer) {\n  for (var i = 0; i < this.onChangeCallbacks_.length; i++) {\n    this.onChangeCallbacks_[i](viewer);\n  }\n};\nViewerSelector.prototype.onSave_ = function () {\n  this.selectedKey = this.getSelectedKey_();\n  if (!this.selectedKey || !DeviceInfo.Viewers[this.selectedKey]) {\n    console.error('ViewerSelector.onSave_: this should never happen!');\n    return;\n  }\n  this.fireOnChange_(DeviceInfo.Viewers[this.selectedKey]);\n  try {\n    localStorage.setItem(VIEWER_KEY, this.selectedKey);\n  } catch (error) {\n    console.error('Failed to save viewer profile: %s', error);\n  }\n  this.hide();\n};\nViewerSelector.prototype.createDialog_ = function (options) {\n  var container = document.createElement('div');\n  container.classList.add(CLASS_NAME);\n  container.style.display = 'none';\n  var overlay = document.createElement('div');\n  var s = overlay.style;\n  s.position = 'fixed';\n  s.left = 0;\n  s.top = 0;\n  s.width = '100%';\n  s.height = '100%';\n  s.background = 'rgba(0, 0, 0, 0.3)';\n  overlay.addEventListener('click', this.hide.bind(this));\n  var width = 280;\n  var dialog = document.createElement('div');\n  var s = dialog.style;\n  s.boxSizing = 'border-box';\n  s.position = 'fixed';\n  s.top = '24px';\n  s.left = '50%';\n  s.marginLeft = -width / 2 + 'px';\n  s.width = width + 'px';\n  s.padding = '24px';\n  s.overflow = 'hidden';\n  s.background = '#fafafa';\n  s.fontFamily = \"'Roboto', sans-serif\";\n  s.boxShadow = '0px 5px 20px #666';\n  dialog.appendChild(this.createH1_('Select your viewer'));\n  for (var id in options) {\n    dialog.appendChild(this.createChoice_(id, options[id].label));\n  }\n  dialog.appendChild(this.createButton_('Save', this.onSave_.bind(this)));\n  container.appendChild(overlay);\n  container.appendChild(dialog);\n  return container;\n};\nViewerSelector.prototype.createH1_ = function (name) {\n  var h1 = document.createElement('h1');\n  var s = h1.style;\n  s.color = 'black';\n  s.fontSize = '20px';\n  s.fontWeight = 'bold';\n  s.marginTop = 0;\n  s.marginBottom = '24px';\n  h1.innerHTML = name;\n  return h1;\n};\nViewerSelector.prototype.createChoice_ = function (id, name) {\n  var div = document.createElement('div');\n  div.style.marginTop = '8px';\n  div.style.color = 'black';\n  var input = document.createElement('input');\n  input.style.fontSize = '30px';\n  input.setAttribute('id', id);\n  input.setAttribute('type', 'radio');\n  input.setAttribute('value', id);\n  input.setAttribute('name', 'field');\n  var label = document.createElement('label');\n  label.style.marginLeft = '4px';\n  label.setAttribute('for', id);\n  label.innerHTML = name;\n  div.appendChild(input);\n  div.appendChild(label);\n  return div;\n};\nViewerSelector.prototype.createButton_ = function (label, onclick) {\n  var button = document.createElement('button');\n  button.innerHTML = label;\n  var s = button.style;\n  s.float = 'right';\n  s.textTransform = 'uppercase';\n  s.color = '#1094f7';\n  s.fontSize = '14px';\n  s.letterSpacing = 0;\n  s.border = 0;\n  s.background = 'none';\n  s.marginTop = '16px';\n  button.addEventListener('click', onclick);\n  return button;\n};\nvar commonjsGlobal$$1 = typeof window !== 'undefined' ? window : typeof commonjsGlobal !== 'undefined' ? commonjsGlobal : typeof self !== 'undefined' ? self : {};\nfunction unwrapExports$$1 (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\nfunction createCommonjsModule$$1(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\nvar NoSleep = createCommonjsModule$$1(function (module, exports) {\n(function webpackUniversalModuleDefinition(root, factory) {\n\tmodule.exports = factory();\n})(commonjsGlobal$$1, function() {\nreturn          (function(modules) {\n         \tvar installedModules = {};\n         \tfunction __webpack_require__(moduleId) {\n         \t\tif(installedModules[moduleId]) {\n         \t\t\treturn installedModules[moduleId].exports;\n         \t\t}\n         \t\tvar module = installedModules[moduleId] = {\n         \t\t\ti: moduleId,\n         \t\t\tl: false,\n         \t\t\texports: {}\n         \t\t};\n         \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n         \t\tmodule.l = true;\n         \t\treturn module.exports;\n         \t}\n         \t__webpack_require__.m = modules;\n         \t__webpack_require__.c = installedModules;\n         \t__webpack_require__.d = function(exports, name, getter) {\n         \t\tif(!__webpack_require__.o(exports, name)) {\n         \t\t\tObject.defineProperty(exports, name, {\n         \t\t\t\tconfigurable: false,\n         \t\t\t\tenumerable: true,\n         \t\t\t\tget: getter\n         \t\t\t});\n         \t\t}\n         \t};\n         \t__webpack_require__.n = function(module) {\n         \t\tvar getter = module && module.__esModule ?\n         \t\t\tfunction getDefault() { return module['default']; } :\n         \t\t\tfunction getModuleExports() { return module; };\n         \t\t__webpack_require__.d(getter, 'a', getter);\n         \t\treturn getter;\n         \t};\n         \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n         \t__webpack_require__.p = \"\";\n         \treturn __webpack_require__(__webpack_require__.s = 0);\n         })\n         ([\n      (function(module, exports, __webpack_require__) {\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nvar mediaFile = __webpack_require__(1);\nvar oldIOS = typeof navigator !== 'undefined' && parseFloat(('' + (/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent) || [0, ''])[1]).replace('undefined', '3_2').replace('_', '.').replace('_', '')) < 10 && !window.MSStream;\nvar NoSleep = function () {\n  function NoSleep() {\n    _classCallCheck(this, NoSleep);\n    if (oldIOS) {\n      this.noSleepTimer = null;\n    } else {\n      this.noSleepVideo = document.createElement('video');\n      this.noSleepVideo.setAttribute('playsinline', '');\n      this.noSleepVideo.setAttribute('src', mediaFile);\n      this.noSleepVideo.addEventListener('timeupdate', function (e) {\n        if (this.noSleepVideo.currentTime > 0.5) {\n          this.noSleepVideo.currentTime = Math.random();\n        }\n      }.bind(this));\n    }\n  }\n  _createClass(NoSleep, [{\n    key: 'enable',\n    value: function enable() {\n      if (oldIOS) {\n        this.disable();\n        this.noSleepTimer = window.setInterval(function () {\n          window.location.href = '/';\n          window.setTimeout(window.stop, 0);\n        }, 15000);\n      } else {\n        this.noSleepVideo.play();\n      }\n    }\n  }, {\n    key: 'disable',\n    value: function disable() {\n      if (oldIOS) {\n        if (this.noSleepTimer) {\n          window.clearInterval(this.noSleepTimer);\n          this.noSleepTimer = null;\n        }\n      } else {\n        this.noSleepVideo.pause();\n      }\n    }\n  }]);\n  return NoSleep;\n}();\nmodule.exports = NoSleep;\n      }),\n      (function(module, exports, __webpack_require__) {\nmodule.exports = 'data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQAD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';\n      })\n         ]);\n});\n});\nvar NoSleep$1 = unwrapExports$$1(NoSleep);\nvar nextDisplayId = 1000;\nvar defaultLeftBounds = [0, 0, 0.5, 1];\nvar defaultRightBounds = [0.5, 0, 0.5, 1];\nvar raf = window.requestAnimationFrame;\nvar caf = window.cancelAnimationFrame;\nfunction VRFrameData() {\n  this.leftProjectionMatrix = new Float32Array(16);\n  this.leftViewMatrix = new Float32Array(16);\n  this.rightProjectionMatrix = new Float32Array(16);\n  this.rightViewMatrix = new Float32Array(16);\n  this.pose = null;\n}\nfunction VRDisplayCapabilities(config) {\n  Object.defineProperties(this, {\n    hasPosition: {\n      writable: false, enumerable: true, value: config.hasPosition\n    },\n    hasExternalDisplay: {\n      writable: false, enumerable: true, value: config.hasExternalDisplay\n    },\n    canPresent: {\n      writable: false, enumerable: true, value: config.canPresent\n    },\n    maxLayers: {\n      writable: false, enumerable: true, value: config.maxLayers\n    },\n    hasOrientation: {\n      enumerable: true, get: function get() {\n        deprecateWarning('VRDisplayCapabilities.prototype.hasOrientation', 'VRDisplay.prototype.getFrameData');\n        return config.hasOrientation;\n      }\n    }\n  });\n}\nfunction VRDisplay(config) {\n  config = config || {};\n  var USE_WAKELOCK = 'wakelock' in config ? config.wakelock : true;\n  this.isPolyfilled = true;\n  this.displayId = nextDisplayId++;\n  this.displayName = '';\n  this.depthNear = 0.01;\n  this.depthFar = 10000.0;\n  this.isPresenting = false;\n  Object.defineProperty(this, 'isConnected', {\n    get: function get() {\n      deprecateWarning('VRDisplay.prototype.isConnected', 'VRDisplayCapabilities.prototype.hasExternalDisplay');\n      return false;\n    }\n  });\n  this.capabilities = new VRDisplayCapabilities({\n    hasPosition: false,\n    hasOrientation: false,\n    hasExternalDisplay: false,\n    canPresent: false,\n    maxLayers: 1\n  });\n  this.stageParameters = null;\n  this.waitingForPresent_ = false;\n  this.layer_ = null;\n  this.originalParent_ = null;\n  this.fullscreenElement_ = null;\n  this.fullscreenWrapper_ = null;\n  this.fullscreenElementCachedStyle_ = null;\n  this.fullscreenEventTarget_ = null;\n  this.fullscreenChangeHandler_ = null;\n  this.fullscreenErrorHandler_ = null;\n  if (USE_WAKELOCK && isMobile()) {\n    this.wakelock_ = new NoSleep$1();\n  }\n}\nVRDisplay.prototype.getFrameData = function (frameData) {\n  return frameDataFromPose(frameData, this._getPose(), this);\n};\nVRDisplay.prototype.getPose = function () {\n  deprecateWarning('VRDisplay.prototype.getPose', 'VRDisplay.prototype.getFrameData');\n  return this._getPose();\n};\nVRDisplay.prototype.resetPose = function () {\n  deprecateWarning('VRDisplay.prototype.resetPose');\n  return this._resetPose();\n};\nVRDisplay.prototype.getImmediatePose = function () {\n  deprecateWarning('VRDisplay.prototype.getImmediatePose', 'VRDisplay.prototype.getFrameData');\n  return this._getPose();\n};\nVRDisplay.prototype.requestAnimationFrame = function (callback) {\n  return raf(callback);\n};\nVRDisplay.prototype.cancelAnimationFrame = function (id) {\n  return caf(id);\n};\nVRDisplay.prototype.wrapForFullscreen = function (element) {\n  if (isIOS()) {\n    return element;\n  }\n  if (!this.fullscreenWrapper_) {\n    this.fullscreenWrapper_ = document.createElement('div');\n    var cssProperties = ['height: ' + Math.min(screen.height, screen.width) + 'px !important', 'top: 0 !important', 'left: 0 !important', 'right: 0 !important', 'border: 0', 'margin: 0', 'padding: 0', 'z-index: 999999 !important', 'position: fixed'];\n    this.fullscreenWrapper_.setAttribute('style', cssProperties.join('; ') + ';');\n    this.fullscreenWrapper_.classList.add('webvr-polyfill-fullscreen-wrapper');\n  }\n  if (this.fullscreenElement_ == element) {\n    return this.fullscreenWrapper_;\n  }\n  if (this.fullscreenElement_) {\n    if (this.originalParent_) {\n      this.originalParent_.appendChild(this.fullscreenElement_);\n    } else {\n      this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_);\n    }\n  }\n  this.fullscreenElement_ = element;\n  this.originalParent_ = element.parentElement;\n  if (!this.originalParent_) {\n    document.body.appendChild(element);\n  }\n  if (!this.fullscreenWrapper_.parentElement) {\n    var parent = this.fullscreenElement_.parentElement;\n    parent.insertBefore(this.fullscreenWrapper_, this.fullscreenElement_);\n    parent.removeChild(this.fullscreenElement_);\n  }\n  this.fullscreenWrapper_.insertBefore(this.fullscreenElement_, this.fullscreenWrapper_.firstChild);\n  this.fullscreenElementCachedStyle_ = this.fullscreenElement_.getAttribute('style');\n  var self = this;\n  function applyFullscreenElementStyle() {\n    if (!self.fullscreenElement_) {\n      return;\n    }\n    var cssProperties = ['position: absolute', 'top: 0', 'left: 0', 'width: ' + Math.max(screen.width, screen.height) + 'px', 'height: ' + Math.min(screen.height, screen.width) + 'px', 'border: 0', 'margin: 0', 'padding: 0'];\n    self.fullscreenElement_.setAttribute('style', cssProperties.join('; ') + ';');\n  }\n  applyFullscreenElementStyle();\n  return this.fullscreenWrapper_;\n};\nVRDisplay.prototype.removeFullscreenWrapper = function () {\n  if (!this.fullscreenElement_) {\n    return;\n  }\n  var element = this.fullscreenElement_;\n  if (this.fullscreenElementCachedStyle_) {\n    element.setAttribute('style', this.fullscreenElementCachedStyle_);\n  } else {\n    element.removeAttribute('style');\n  }\n  this.fullscreenElement_ = null;\n  this.fullscreenElementCachedStyle_ = null;\n  var parent = this.fullscreenWrapper_.parentElement;\n  this.fullscreenWrapper_.removeChild(element);\n  if (this.originalParent_ === parent) {\n    parent.insertBefore(element, this.fullscreenWrapper_);\n  }\n  else if (this.originalParent_) {\n      this.originalParent_.appendChild(element);\n    }\n  parent.removeChild(this.fullscreenWrapper_);\n  return element;\n};\nVRDisplay.prototype.requestPresent = function (layers) {\n  var wasPresenting = this.isPresenting;\n  var self = this;\n  if (!(layers instanceof Array)) {\n    deprecateWarning('VRDisplay.prototype.requestPresent with non-array argument', 'an array of VRLayers as the first argument');\n    layers = [layers];\n  }\n  return new Promise(function (resolve, reject) {\n    if (!self.capabilities.canPresent) {\n      reject(new Error('VRDisplay is not capable of presenting.'));\n      return;\n    }\n    if (layers.length == 0 || layers.length > self.capabilities.maxLayers) {\n      reject(new Error('Invalid number of layers.'));\n      return;\n    }\n    var incomingLayer = layers[0];\n    if (!incomingLayer.source) {\n      resolve();\n      return;\n    }\n    var leftBounds = incomingLayer.leftBounds || defaultLeftBounds;\n    var rightBounds = incomingLayer.rightBounds || defaultRightBounds;\n    if (wasPresenting) {\n      var layer = self.layer_;\n      if (layer.source !== incomingLayer.source) {\n        layer.source = incomingLayer.source;\n      }\n      for (var i = 0; i < 4; i++) {\n        layer.leftBounds[i] = leftBounds[i];\n        layer.rightBounds[i] = rightBounds[i];\n      }\n      self.wrapForFullscreen(self.layer_.source);\n      self.updatePresent_();\n      resolve();\n      return;\n    }\n    self.layer_ = {\n      predistorted: incomingLayer.predistorted,\n      source: incomingLayer.source,\n      leftBounds: leftBounds.slice(0),\n      rightBounds: rightBounds.slice(0)\n    };\n    self.waitingForPresent_ = false;\n    if (self.layer_ && self.layer_.source) {\n      var fullscreenElement = self.wrapForFullscreen(self.layer_.source);\n      var onFullscreenChange = function onFullscreenChange() {\n        var actualFullscreenElement = getFullscreenElement();\n        self.isPresenting = fullscreenElement === actualFullscreenElement;\n        if (self.isPresenting) {\n          if (screen.orientation && screen.orientation.lock) {\n            screen.orientation.lock('landscape-primary').catch(function (error) {\n              console.error('screen.orientation.lock() failed due to', error.message);\n            });\n          }\n          self.waitingForPresent_ = false;\n          self.beginPresent_();\n          resolve();\n        } else {\n          if (screen.orientation && screen.orientation.unlock) {\n            screen.orientation.unlock();\n          }\n          self.removeFullscreenWrapper();\n          self.disableWakeLock();\n          self.endPresent_();\n          self.removeFullscreenListeners_();\n        }\n        self.fireVRDisplayPresentChange_();\n      };\n      var onFullscreenError = function onFullscreenError() {\n        if (!self.waitingForPresent_) {\n          return;\n        }\n        self.removeFullscreenWrapper();\n        self.removeFullscreenListeners_();\n        self.disableWakeLock();\n        self.waitingForPresent_ = false;\n        self.isPresenting = false;\n        reject(new Error('Unable to present.'));\n      };\n      self.addFullscreenListeners_(fullscreenElement, onFullscreenChange, onFullscreenError);\n      if (requestFullscreen(fullscreenElement)) {\n        self.enableWakeLock();\n        self.waitingForPresent_ = true;\n      } else if (isIOS() || isWebViewAndroid()) {\n        self.enableWakeLock();\n        self.isPresenting = true;\n        self.beginPresent_();\n        self.fireVRDisplayPresentChange_();\n        resolve();\n      }\n    }\n    if (!self.waitingForPresent_ && !isIOS()) {\n      exitFullscreen();\n      reject(new Error('Unable to present.'));\n    }\n  });\n};\nVRDisplay.prototype.exitPresent = function () {\n  var wasPresenting = this.isPresenting;\n  var self = this;\n  this.isPresenting = false;\n  this.layer_ = null;\n  this.disableWakeLock();\n  return new Promise(function (resolve, reject) {\n    if (wasPresenting) {\n      if (!exitFullscreen() && isIOS()) {\n        self.endPresent_();\n        self.fireVRDisplayPresentChange_();\n      }\n      if (isWebViewAndroid()) {\n        self.removeFullscreenWrapper();\n        self.removeFullscreenListeners_();\n        self.endPresent_();\n        self.fireVRDisplayPresentChange_();\n      }\n      resolve();\n    } else {\n      reject(new Error('Was not presenting to VRDisplay.'));\n    }\n  });\n};\nVRDisplay.prototype.getLayers = function () {\n  if (this.layer_) {\n    return [this.layer_];\n  }\n  return [];\n};\nVRDisplay.prototype.fireVRDisplayPresentChange_ = function () {\n  var event = new CustomEvent('vrdisplaypresentchange', { detail: { display: this } });\n  window.dispatchEvent(event);\n};\nVRDisplay.prototype.fireVRDisplayConnect_ = function () {\n  var event = new CustomEvent('vrdisplayconnect', { detail: { display: this } });\n  window.dispatchEvent(event);\n};\nVRDisplay.prototype.addFullscreenListeners_ = function (element, changeHandler, errorHandler) {\n  this.removeFullscreenListeners_();\n  this.fullscreenEventTarget_ = element;\n  this.fullscreenChangeHandler_ = changeHandler;\n  this.fullscreenErrorHandler_ = errorHandler;\n  if (changeHandler) {\n    if (document.fullscreenEnabled) {\n      element.addEventListener('fullscreenchange', changeHandler, false);\n    } else if (document.webkitFullscreenEnabled) {\n      element.addEventListener('webkitfullscreenchange', changeHandler, false);\n    } else if (document.mozFullScreenEnabled) {\n      document.addEventListener('mozfullscreenchange', changeHandler, false);\n    } else if (document.msFullscreenEnabled) {\n      element.addEventListener('msfullscreenchange', changeHandler, false);\n    }\n  }\n  if (errorHandler) {\n    if (document.fullscreenEnabled) {\n      element.addEventListener('fullscreenerror', errorHandler, false);\n    } else if (document.webkitFullscreenEnabled) {\n      element.addEventListener('webkitfullscreenerror', errorHandler, false);\n    } else if (document.mozFullScreenEnabled) {\n      document.addEventListener('mozfullscreenerror', errorHandler, false);\n    } else if (document.msFullscreenEnabled) {\n      element.addEventListener('msfullscreenerror', errorHandler, false);\n    }\n  }\n};\nVRDisplay.prototype.removeFullscreenListeners_ = function () {\n  if (!this.fullscreenEventTarget_) return;\n  var element = this.fullscreenEventTarget_;\n  if (this.fullscreenChangeHandler_) {\n    var changeHandler = this.fullscreenChangeHandler_;\n    element.removeEventListener('fullscreenchange', changeHandler, false);\n    element.removeEventListener('webkitfullscreenchange', changeHandler, false);\n    document.removeEventListener('mozfullscreenchange', changeHandler, false);\n    element.removeEventListener('msfullscreenchange', changeHandler, false);\n  }\n  if (this.fullscreenErrorHandler_) {\n    var errorHandler = this.fullscreenErrorHandler_;\n    element.removeEventListener('fullscreenerror', errorHandler, false);\n    element.removeEventListener('webkitfullscreenerror', errorHandler, false);\n    document.removeEventListener('mozfullscreenerror', errorHandler, false);\n    element.removeEventListener('msfullscreenerror', errorHandler, false);\n  }\n  this.fullscreenEventTarget_ = null;\n  this.fullscreenChangeHandler_ = null;\n  this.fullscreenErrorHandler_ = null;\n};\nVRDisplay.prototype.enableWakeLock = function () {\n  if (this.wakelock_) {\n    this.wakelock_.enable();\n  }\n};\nVRDisplay.prototype.disableWakeLock = function () {\n  if (this.wakelock_) {\n    this.wakelock_.disable();\n  }\n};\nVRDisplay.prototype.beginPresent_ = function () {\n};\nVRDisplay.prototype.endPresent_ = function () {\n};\nVRDisplay.prototype.submitFrame = function (pose) {\n};\nVRDisplay.prototype.getEyeParameters = function (whichEye) {\n  return null;\n};\nvar config = {\n  ADDITIONAL_VIEWERS: [],\n  DEFAULT_VIEWER: '',\n  MOBILE_WAKE_LOCK: true,\n  DEBUG: false,\n  DPDB_URL: 'https://dpdb.webvr.rocks/dpdb.json',\n  K_FILTER: 0.98,\n  PREDICTION_TIME_S: 0.040,\n  CARDBOARD_UI_DISABLED: false,\n  ROTATE_INSTRUCTIONS_DISABLED: false,\n  YAW_ONLY: false,\n  BUFFER_SCALE: 0.5,\n  DIRTY_SUBMIT_FRAME_BINDINGS: false\n};\nvar Eye = {\n  LEFT: 'left',\n  RIGHT: 'right'\n};\nfunction CardboardVRDisplay(config$$1) {\n  var defaults = extend({}, config);\n  config$$1 = extend(defaults, config$$1 || {});\n  VRDisplay.call(this, {\n    wakelock: config$$1.MOBILE_WAKE_LOCK\n  });\n  this.config = config$$1;\n  this.displayName = 'Cardboard VRDisplay';\n  this.capabilities = new VRDisplayCapabilities({\n    hasPosition: false,\n    hasOrientation: true,\n    hasExternalDisplay: false,\n    canPresent: true,\n    maxLayers: 1\n  });\n  this.stageParameters = null;\n  this.bufferScale_ = this.config.BUFFER_SCALE;\n  this.poseSensor_ = new PoseSensor(this.config);\n  this.distorter_ = null;\n  this.cardboardUI_ = null;\n  this.dpdb_ = new Dpdb(this.config.DPDB_URL, this.onDeviceParamsUpdated_.bind(this));\n  this.deviceInfo_ = new DeviceInfo(this.dpdb_.getDeviceParams(), config$$1.ADDITIONAL_VIEWERS);\n  this.viewerSelector_ = new ViewerSelector(config$$1.DEFAULT_VIEWER);\n  this.viewerSelector_.onChange(this.onViewerChanged_.bind(this));\n  this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer());\n  if (!this.config.ROTATE_INSTRUCTIONS_DISABLED) {\n    this.rotateInstructions_ = new RotateInstructions();\n  }\n  if (isIOS()) {\n    window.addEventListener('resize', this.onResize_.bind(this));\n  }\n}\nCardboardVRDisplay.prototype = Object.create(VRDisplay.prototype);\nCardboardVRDisplay.prototype._getPose = function () {\n  return {\n    position: null,\n    orientation: this.poseSensor_.getOrientation(),\n    linearVelocity: null,\n    linearAcceleration: null,\n    angularVelocity: null,\n    angularAcceleration: null\n  };\n};\nCardboardVRDisplay.prototype._resetPose = function () {\n  if (this.poseSensor_.resetPose) {\n    this.poseSensor_.resetPose();\n  }\n};\nCardboardVRDisplay.prototype._getFieldOfView = function (whichEye) {\n  var fieldOfView;\n  if (whichEye == Eye.LEFT) {\n    fieldOfView = this.deviceInfo_.getFieldOfViewLeftEye();\n  } else if (whichEye == Eye.RIGHT) {\n    fieldOfView = this.deviceInfo_.getFieldOfViewRightEye();\n  } else {\n    console.error('Invalid eye provided: %s', whichEye);\n    return null;\n  }\n  return fieldOfView;\n};\nCardboardVRDisplay.prototype._getEyeOffset = function (whichEye) {\n  var offset;\n  if (whichEye == Eye.LEFT) {\n    offset = [-this.deviceInfo_.viewer.interLensDistance * 0.5, 0.0, 0.0];\n  } else if (whichEye == Eye.RIGHT) {\n    offset = [this.deviceInfo_.viewer.interLensDistance * 0.5, 0.0, 0.0];\n  } else {\n    console.error('Invalid eye provided: %s', whichEye);\n    return null;\n  }\n  return offset;\n};\nCardboardVRDisplay.prototype.getEyeParameters = function (whichEye) {\n  var offset = this._getEyeOffset(whichEye);\n  var fieldOfView = this._getFieldOfView(whichEye);\n  var eyeParams = {\n    offset: offset,\n    renderWidth: this.deviceInfo_.device.width * 0.5 * this.bufferScale_,\n    renderHeight: this.deviceInfo_.device.height * this.bufferScale_\n  };\n  Object.defineProperty(eyeParams, 'fieldOfView', {\n    enumerable: true,\n    get: function get() {\n      deprecateWarning('VRFieldOfView', 'VRFrameData\\'s projection matrices');\n      return fieldOfView;\n    }\n  });\n  return eyeParams;\n};\nCardboardVRDisplay.prototype.onDeviceParamsUpdated_ = function (newParams) {\n  if (this.config.DEBUG) {\n    console.log('DPDB reported that device params were updated.');\n  }\n  this.deviceInfo_.updateDeviceParams(newParams);\n  if (this.distorter_) {\n    this.distorter_.updateDeviceInfo(this.deviceInfo_);\n  }\n};\nCardboardVRDisplay.prototype.updateBounds_ = function () {\n  if (this.layer_ && this.distorter_ && (this.layer_.leftBounds || this.layer_.rightBounds)) {\n    this.distorter_.setTextureBounds(this.layer_.leftBounds, this.layer_.rightBounds);\n  }\n};\nCardboardVRDisplay.prototype.beginPresent_ = function () {\n  var gl = this.layer_.source.getContext('webgl');\n  if (!gl) gl = this.layer_.source.getContext('experimental-webgl');\n  if (!gl) gl = this.layer_.source.getContext('webgl2');\n  if (!gl) return;\n  if (this.layer_.predistorted) {\n    if (!this.config.CARDBOARD_UI_DISABLED) {\n      gl.canvas.width = getScreenWidth() * this.bufferScale_;\n      gl.canvas.height = getScreenHeight() * this.bufferScale_;\n      this.cardboardUI_ = new CardboardUI(gl);\n    }\n  } else {\n    if (!this.config.CARDBOARD_UI_DISABLED) {\n      this.cardboardUI_ = new CardboardUI(gl);\n    }\n    this.distorter_ = new CardboardDistorter(gl, this.cardboardUI_, this.config.BUFFER_SCALE, this.config.DIRTY_SUBMIT_FRAME_BINDINGS);\n    this.distorter_.updateDeviceInfo(this.deviceInfo_);\n  }\n  if (this.cardboardUI_) {\n    this.cardboardUI_.listen(function (e) {\n      this.viewerSelector_.show(this.layer_.source.parentElement);\n      e.stopPropagation();\n      e.preventDefault();\n    }.bind(this), function (e) {\n      this.exitPresent();\n      e.stopPropagation();\n      e.preventDefault();\n    }.bind(this));\n  }\n  if (this.rotateInstructions_) {\n    if (isLandscapeMode() && isMobile()) {\n      this.rotateInstructions_.showTemporarily(3000, this.layer_.source.parentElement);\n    } else {\n      this.rotateInstructions_.update();\n    }\n  }\n  this.orientationHandler = this.onOrientationChange_.bind(this);\n  window.addEventListener('orientationchange', this.orientationHandler);\n  this.vrdisplaypresentchangeHandler = this.updateBounds_.bind(this);\n  window.addEventListener('vrdisplaypresentchange', this.vrdisplaypresentchangeHandler);\n  this.fireVRDisplayDeviceParamsChange_();\n};\nCardboardVRDisplay.prototype.endPresent_ = function () {\n  if (this.distorter_) {\n    this.distorter_.destroy();\n    this.distorter_ = null;\n  }\n  if (this.cardboardUI_) {\n    this.cardboardUI_.destroy();\n    this.cardboardUI_ = null;\n  }\n  if (this.rotateInstructions_) {\n    this.rotateInstructions_.hide();\n  }\n  this.viewerSelector_.hide();\n  window.removeEventListener('orientationchange', this.orientationHandler);\n  window.removeEventListener('vrdisplaypresentchange', this.vrdisplaypresentchangeHandler);\n};\nCardboardVRDisplay.prototype.updatePresent_ = function () {\n  this.endPresent_();\n  this.beginPresent_();\n};\nCardboardVRDisplay.prototype.submitFrame = function (pose) {\n  if (this.distorter_) {\n    this.updateBounds_();\n    this.distorter_.submitFrame();\n  } else if (this.cardboardUI_ && this.layer_) {\n    var canvas = this.layer_.source.getContext('webgl').canvas;\n    if (canvas.width != this.lastWidth || canvas.height != this.lastHeight) {\n      this.cardboardUI_.onResize();\n    }\n    this.lastWidth = canvas.width;\n    this.lastHeight = canvas.height;\n    this.cardboardUI_.render();\n  }\n};\nCardboardVRDisplay.prototype.onOrientationChange_ = function (e) {\n  this.viewerSelector_.hide();\n  if (this.rotateInstructions_) {\n    this.rotateInstructions_.update();\n  }\n  this.onResize_();\n};\nCardboardVRDisplay.prototype.onResize_ = function (e) {\n  if (this.layer_) {\n    var gl = this.layer_.source.getContext('webgl');\n    var cssProperties = ['position: absolute', 'top: 0', 'left: 0',\n    'width: 100vw', 'height: 100vh', 'border: 0', 'margin: 0',\n    'padding: 0px', 'box-sizing: content-box'];\n    gl.canvas.setAttribute('style', cssProperties.join('; ') + ';');\n    safariCssSizeWorkaround(gl.canvas);\n  }\n};\nCardboardVRDisplay.prototype.onViewerChanged_ = function (viewer) {\n  this.deviceInfo_.setViewer(viewer);\n  if (this.distorter_) {\n    this.distorter_.updateDeviceInfo(this.deviceInfo_);\n  }\n  this.fireVRDisplayDeviceParamsChange_();\n};\nCardboardVRDisplay.prototype.fireVRDisplayDeviceParamsChange_ = function () {\n  var event = new CustomEvent('vrdisplaydeviceparamschange', {\n    detail: {\n      vrdisplay: this,\n      deviceInfo: this.deviceInfo_\n    }\n  });\n  window.dispatchEvent(event);\n};\nCardboardVRDisplay.VRFrameData = VRFrameData;\nCardboardVRDisplay.VRDisplay = VRDisplay;\nreturn CardboardVRDisplay;\n})));\n});\nvar CardboardVRDisplay = unwrapExports(cardboardVrDisplay);\n\nclass XRDevice extends EventTarget {\n  constructor(global) {\n    super();\n    this.global = global;\n    this.onWindowResize = this.onWindowResize.bind(this);\n    this.global.window.addEventListener('resize', this.onWindowResize);\n    this.environmentBlendMode = 'opaque';\n  }\n  get depthNear() { throw new Error('Not implemented'); }\n  set depthNear(val) { throw new Error('Not implemented'); }\n  get depthFar() { throw new Error('Not implemented'); }\n  set depthFar(val) { throw new Error('Not implemented'); }\n  onBaseLayerSet(sessionId, layer) { throw new Error('Not implemented'); }\n  onInlineVerticalFieldOfViewSet(sessionId, value) { throw new Error('Not implemented'); }\n  supportsSession(mode) { throw new Error('Not implemented'); }\n  async requestSession(mode) { throw new Error('Not implemented'); }\n  requestAnimationFrame(callback) { throw new Error('Not implemented'); }\n  onFrameStart(sessionId) { throw new Error('Not implemented'); }\n  onFrameEnd(sessionId) { throw new Error('Not implemented'); }\n  requestStageBounds() { throw new Error('Not implemented'); }\n  async requestFrameOfReferenceTransform(type, options) {\n    return undefined;\n  }\n  cancelAnimationFrame(handle) { throw new Error('Not implemented'); }\n  endSession(sessionId) { throw new Error('Not implemented'); }\n  getViewport(sessionId, eye, layer, target) { throw new Error('Not implemented'); }\n  getProjectionMatrix(eye) { throw new Error('Not implemented'); }\n  getBasePoseMatrix() { throw new Error('Not implemented'); }\n  getBaseViewMatrix(eye) { throw new Error('Not implemented'); }\n  getInputSources() { throw new Error('Not implemented'); }\n  getInputPose(inputSource, coordinateSystem, poseType) { throw new Error('Not implemented'); }\n  onWindowResize() {\n    this.onWindowResize();\n  }\n}\n\nlet oculusGo = {\n  mapping: 'xr-standard',\n  profiles: ['oculus-go', 'touchpad-controller'],\n  buttons: {\n    length: 3,\n    0: 1,\n    1: null,\n    2: 0\n  },\n  gripTransform: {\n    orientation: [Math.PI * 0.11, 0, 0, 1]\n  }\n};\nlet oculusTouch = {\n  mapping: 'xr-standard',\n  displayProfiles: {\n    'Oculus Quest': ['oculus-quest', 'oculus-touch', 'thumbstick-controller']\n  },\n  profiles: ['oculus-touch', 'thumbstick-controller'],\n  axes: {\n    length: 4,\n    0: null,\n    1: null,\n    2: 0,\n    3: 1\n  },\n  buttons: {\n    length: 6,\n    0: 1,\n    1: 2,\n    2: null,\n    3: 0,\n    4: 3,\n    5: 4\n  },\n  gripTransform: {\n    position: [0, -0.02, 0.04, 1],\n    orientation: [Math.PI * 0.11, 0, 0, 1]\n  }\n};\nlet openVr = {\n  mapping: 'xr-standard',\n  profiles: ['openvr-controller', 'touchpad-controller'],\n  displayProfiles: {\n    'HTC Vive': ['htc-vive', 'touchpad-controller'],\n    'HTC Vive DVT': ['htc-vive', 'touchpad-controller']\n  },\n  buttons: {\n    length: 3,\n    0: 1,\n    1: 2,\n    2: 0\n  },\n  gripTransform: {\n    position: [0, 0, 0.05, 1],\n  },\n  targetRayTransform: {\n    orientation: [Math.PI * -0.08, 0, 0, 1]\n  }\n};\nlet windowsMixedReality = {\n  mapping: 'xr-standard',\n  profiles: ['windows-mixed-reality', 'touchpad-thumbstick-controller'],\n  buttons: {\n    length: 4,\n    0: 1,\n    1: 0,\n    2: 2,\n    3: 4,\n  },\n  gripTransform: {\n    position: [0, -0.02, 0.04, 1],\n    orientation: [Math.PI * 0.11, 0, 0, 1]\n  }\n};\nlet GamepadMappings = {\n  'Oculus Go Controller': oculusGo,\n  'Oculus Touch (Right)': oculusTouch,\n  'Oculus Touch (Left)': oculusTouch,\n  'OpenVR Gamepad': openVr,\n  'Windows Mixed Reality (Right)': windowsMixedReality,\n  'Windows Mixed Reality (Left)': windowsMixedReality,\n};\n\nconst HEAD_ELBOW_OFFSET_RIGHTHANDED = fromValues$1(0.155, -0.465, -0.15);\nconst HEAD_ELBOW_OFFSET_LEFTHANDED = fromValues$1(-0.155, -0.465, -0.15);\nconst ELBOW_WRIST_OFFSET = fromValues$1(0, 0, -0.25);\nconst WRIST_CONTROLLER_OFFSET = fromValues$1(0, 0, 0.05);\nconst ARM_EXTENSION_OFFSET = fromValues$1(-0.08, 0.14, 0.08);\nconst ELBOW_BEND_RATIO = 0.4;\nconst EXTENSION_RATIO_WEIGHT = 0.4;\nconst MIN_ANGULAR_SPEED = 0.61;\nconst MIN_ANGLE_DELTA = 0.175;\nconst MIN_EXTENSION_COS = 0.12;\nconst MAX_EXTENSION_COS = 0.87;\nconst RAD_TO_DEG = 180 / Math.PI;\nfunction eulerFromQuaternion(out, q, order) {\n  function clamp(value, min$$1, max$$1) {\n    return (value < min$$1 ? min$$1 : (value > max$$1 ? max$$1 : value));\n  }\n  var sqx = q[0] * q[0];\n  var sqy = q[1] * q[1];\n  var sqz = q[2] * q[2];\n  var sqw = q[3] * q[3];\n  if ( order === 'XYZ' ) {\n    out[0] = Math.atan2( 2 * ( q[0] * q[3] - q[1] * q[2] ), ( sqw - sqx - sqy + sqz ) );\n    out[1] = Math.asin(  clamp( 2 * ( q[0] * q[2] + q[1] * q[3] ), -1, 1 ) );\n    out[2] = Math.atan2( 2 * ( q[2] * q[3] - q[0] * q[1] ), ( sqw + sqx - sqy - sqz ) );\n  } else if ( order ===  'YXZ' ) {\n    out[0] = Math.asin(  clamp( 2 * ( q[0] * q[3] - q[1] * q[2] ), -1, 1 ) );\n    out[1] = Math.atan2( 2 * ( q[0] * q[2] + q[1] * q[3] ), ( sqw - sqx - sqy + sqz ) );\n    out[2] = Math.atan2( 2 * ( q[0] * q[1] + q[2] * q[3] ), ( sqw - sqx + sqy - sqz ) );\n  } else if ( order === 'ZXY' ) {\n    out[0] = Math.asin(  clamp( 2 * ( q[0] * q[3] + q[1] * q[2] ), -1, 1 ) );\n    out[1] = Math.atan2( 2 * ( q[1] * q[3] - q[2] * q[0] ), ( sqw - sqx - sqy + sqz ) );\n    out[2] = Math.atan2( 2 * ( q[2] * q[3] - q[0] * q[1] ), ( sqw - sqx + sqy - sqz ) );\n  } else if ( order === 'ZYX' ) {\n    out[0] = Math.atan2( 2 * ( q[0] * q[3] + q[2] * q[1] ), ( sqw - sqx - sqy + sqz ) );\n    out[1] = Math.asin(  clamp( 2 * ( q[1] * q[3] - q[0] * q[2] ), -1, 1 ) );\n    out[2] = Math.atan2( 2 * ( q[0] * q[1] + q[2] * q[3] ), ( sqw + sqx - sqy - sqz ) );\n  } else if ( order === 'YZX' ) {\n    out[0] = Math.atan2( 2 * ( q[0] * q[3] - q[2] * q[1] ), ( sqw - sqx + sqy - sqz ) );\n    out[1] = Math.atan2( 2 * ( q[1] * q[3] - q[0] * q[2] ), ( sqw + sqx - sqy - sqz ) );\n    out[2] = Math.asin(  clamp( 2 * ( q[0] * q[1] + q[2] * q[3] ), -1, 1 ) );\n  } else if ( order === 'XZY' ) {\n    out[0] = Math.atan2( 2 * ( q[0] * q[3] + q[1] * q[2] ), ( sqw - sqx + sqy - sqz ) );\n    out[1] = Math.atan2( 2 * ( q[0] * q[2] + q[1] * q[3] ), ( sqw + sqx - sqy - sqz ) );\n    out[2] = Math.asin(  clamp( 2 * ( q[2] * q[3] - q[0] * q[1] ), -1, 1 ) );\n  } else {\n    console.log('No order given for quaternion to euler conversion.');\n    return;\n  }\n}\nclass OrientationArmModel {\n  constructor() {\n    this.hand = 'right';\n    this.headElbowOffset = HEAD_ELBOW_OFFSET_RIGHTHANDED;\n    this.controllerQ = create$4();\n    this.lastControllerQ = create$4();\n    this.headQ = create$4();\n    this.headPos = create$1();\n    this.elbowPos = create$1();\n    this.wristPos = create$1();\n    this.time = null;\n    this.lastTime = null;\n    this.rootQ = create$4();\n    this.position = create$1();\n  }\n  setHandedness(hand) {\n    if (this.hand != hand) {\n      this.hand = hand;\n      if (this.hand == 'left') {\n        this.headElbowOffset = HEAD_ELBOW_OFFSET_LEFTHANDED;\n      } else {\n        this.headElbowOffset = HEAD_ELBOW_OFFSET_RIGHTHANDED;\n      }\n    }\n  }\n  update(controllerOrientation, headPoseMatrix) {\n    this.time = now$1();\n    if (controllerOrientation) {\n      copy$4(this.lastControllerQ, this.controllerQ);\n      copy$4(this.controllerQ, controllerOrientation);\n    }\n    if (headPoseMatrix) {\n      getTranslation(this.headPos, headPoseMatrix);\n      getRotation(this.headQ, headPoseMatrix);\n    }\n    let headYawQ = this.getHeadYawOrientation_();\n    let angleDelta = this.quatAngle_(this.lastControllerQ, this.controllerQ);\n    let timeDelta = (this.time - this.lastTime) / 1000;\n    let controllerAngularSpeed = angleDelta / timeDelta;\n    if (controllerAngularSpeed > MIN_ANGULAR_SPEED) {\n      slerp(this.rootQ, this.rootQ, headYawQ,\n                 Math.min(angleDelta / MIN_ANGLE_DELTA, 1.0));\n    } else {\n      copy$4(this.rootQ, headYawQ);\n    }\n    let controllerForward = fromValues$1(0, 0, -1.0);\n    transformQuat(controllerForward, controllerForward, this.controllerQ);\n    let controllerDotY = dot(controllerForward, [0, 1, 0]);\n    let extensionRatio = this.clamp_(\n        (controllerDotY - MIN_EXTENSION_COS) / MAX_EXTENSION_COS, 0.0, 1.0);\n    let controllerCameraQ = clone$4(this.rootQ);\n    invert$2(controllerCameraQ, controllerCameraQ);\n    multiply$4(controllerCameraQ, controllerCameraQ, this.controllerQ);\n    let elbowPos = this.elbowPos;\n    copy$1(elbowPos, this.headPos);\n    add$1(elbowPos, elbowPos, this.headElbowOffset);\n    let elbowOffset = clone$1(ARM_EXTENSION_OFFSET);\n    scale$1(elbowOffset, elbowOffset, extensionRatio);\n    add$1(elbowPos, elbowPos, elbowOffset);\n    let totalAngle = this.quatAngle_(controllerCameraQ, create$4());\n    let totalAngleDeg = totalAngle * RAD_TO_DEG;\n    let lerpSuppression = 1 - Math.pow(totalAngleDeg / 180, 4);let elbowRatio = ELBOW_BEND_RATIO;\n    let wristRatio = 1 - ELBOW_BEND_RATIO;\n    let lerpValue = lerpSuppression *\n        (elbowRatio + wristRatio * extensionRatio * EXTENSION_RATIO_WEIGHT);\n    let wristQ = create$4();\n    slerp(wristQ, wristQ, controllerCameraQ, lerpValue);\n    let invWristQ = invert$2(create$4(), wristQ);\n    let elbowQ = clone$4(controllerCameraQ);\n    multiply$4(elbowQ, elbowQ, invWristQ);\n    let wristPos = this.wristPos;\n    copy$1(wristPos, WRIST_CONTROLLER_OFFSET);\n    transformQuat(wristPos, wristPos, wristQ);\n    add$1(wristPos, wristPos, ELBOW_WRIST_OFFSET);\n    transformQuat(wristPos, wristPos, elbowQ);\n    add$1(wristPos, wristPos, elbowPos);\n    let offset = clone$1(ARM_EXTENSION_OFFSET);\n    scale$1(offset, offset, extensionRatio);\n    add$1(this.position, this.wristPos, offset);\n    transformQuat(this.position, this.position, this.rootQ);\n    this.lastTime = this.time;\n  }\n  getPosition() {\n    return this.position;\n  }\n  getHeadYawOrientation_() {\n    let headEuler = create$1();\n    eulerFromQuaternion(headEuler, this.headQ, 'YXZ');\n    let destinationQ = fromEuler(create$4(), 0, headEuler[1] * RAD_TO_DEG, 0);\n    return destinationQ;\n  }\n  clamp_(value, min$$1, max$$1) {\n    return Math.min(Math.max(value, min$$1), max$$1);\n  }\n  quatAngle_(q1, q2) {\n    let vec1 = [0, 0, -1];\n    let vec2 = [0, 0, -1];\n    transformQuat(vec1, vec1, q1);\n    transformQuat(vec2, vec2, q2);\n    return angle(vec1, vec2);\n  }\n}\n\nconst PRIVATE$14 = Symbol('@@webxr-polyfill/XRRemappedGamepad');\nconst PLACEHOLDER_BUTTON = { pressed: false, touched: false, value: 0.0 };\nObject.freeze(PLACEHOLDER_BUTTON);\nclass XRRemappedGamepad {\n  constructor(gamepad, display, map) {\n    if (!map) {\n      map = {};\n    }\n    let axes = new Array(map.axes && map.axes.length ? map.axes.length : gamepad.axes.length);\n    let buttons = new Array(map.buttons && map.buttons.length ? map.buttons.length : gamepad.buttons.length);\n    let gripTransform = null;\n    if (map.gripTransform) {\n      let orientation = map.gripTransform.orientation || [0, 0, 0, 1];\n      gripTransform = create();\n      fromRotationTranslation(\n        gripTransform,\n        normalize$2(orientation, orientation),\n        map.gripTransform.position || [0, 0, 0]\n      );\n    }\n    let targetRayTransform = null;\n    if (map.targetRayTransform) {\n      let orientation =  map.targetRayTransform.orientation || [0, 0, 0, 1];\n      targetRayTransform = create();\n      fromRotationTranslation(\n        targetRayTransform,\n        normalize$2(orientation, orientation),\n        map.targetRayTransform.position || [0, 0, 0]\n      );\n    }\n    let profiles = map.profiles;\n    if (map.displayProfiles) {\n      if (display.displayName in map.displayProfiles) {\n        profiles = map.displayProfiles[display.displayName];\n      }\n    }\n    this[PRIVATE$14] = {\n      gamepad,\n      map,\n      profiles: profiles || [gamepad.id],\n      mapping: map.mapping || gamepad.mapping,\n      axes,\n      buttons,\n      gripTransform,\n      targetRayTransform,\n    };\n    this._update();\n  }\n  _update() {\n    let gamepad = this[PRIVATE$14].gamepad;\n    let map = this[PRIVATE$14].map;\n    let axes = this[PRIVATE$14].axes;\n    for (let i = 0; i < axes.length; ++i) {\n      if (map.axes && i in map.axes) {\n        if (map.axes[i] === null) {\n          axes[i] = 0;\n        } else {\n          axes[i] = gamepad.axes[map.axes[i]];\n        }\n      } else {\n        axes[i] = gamepad.axes[i];\n      }\n    }\n    if (map.axes && map.axes.invert) {\n      for (let axis of map.axes.invert) {\n        axes[axis] *= -1;\n      }\n    }\n    let buttons = this[PRIVATE$14].buttons;\n    for (let i = 0; i < buttons.length; ++i) {\n      if (map.buttons && i in map.buttons) {\n        if (map.buttons[i] === null) {\n          buttons[i] = PLACEHOLDER_BUTTON;\n        } else {\n          buttons[i] = gamepad.buttons[map.buttons[i]];\n        }\n      } else {\n        buttons[i] = gamepad.buttons[i];\n      }\n    }\n  }\n  get id() {\n    return '';\n  }\n  get _profiles() {\n    return this[PRIVATE$14].profiles;\n  }\n  get index() {\n    return -1;\n  }\n  get connected() {\n    return this[PRIVATE$14].gamepad.connected;\n  }\n  get timestamp() {\n    return this[PRIVATE$14].gamepad.timestamp;\n  }\n  get mapping() {\n    return this[PRIVATE$14].mapping;\n  }\n  get axes() {\n    return this[PRIVATE$14].axes;\n  }\n  get buttons() {\n    return this[PRIVATE$14].buttons;\n  }\n}\nclass GamepadXRInputSource {\n  constructor(polyfill, display, primaryButtonIndex = 0) {\n    this.polyfill = polyfill;\n    this.display = display;\n    this.nativeGamepad = null;\n    this.gamepad = null;\n    this.inputSource = new XRInputSource(this);\n    this.lastPosition = create$1();\n    this.emulatedPosition = false;\n    this.basePoseMatrix = create();\n    this.outputMatrix = create();\n    this.primaryButtonIndex = primaryButtonIndex;\n    this.primaryActionPressed = false;\n    this.handedness = '';\n    this.targetRayMode = 'gaze';\n    this.armModel = null;\n  }\n  get profiles() {\n    return this.gamepad ? this.gamepad._profiles : [];\n  }\n  updateFromGamepad(gamepad) {\n    if (this.nativeGamepad !== gamepad) {\n      this.nativeGamepad = gamepad;\n      if (gamepad) {\n        this.gamepad = new XRRemappedGamepad(gamepad, this.display, GamepadMappings[gamepad.id]);\n      } else {\n        this.gamepad = null;\n      }\n    }\n    this.handedness = gamepad.hand;\n    if (this.gamepad) {\n      this.gamepad._update();\n    }\n    if (gamepad.pose) {\n      this.targetRayMode = 'tracked-pointer';\n      this.emulatedPosition = !gamepad.pose.hasPosition;\n    } else if (gamepad.hand === '') {\n      this.targetRayMode = 'gaze';\n      this.emulatedPosition = false;\n    }\n  }\n  updateBasePoseMatrix() {\n    if (this.nativeGamepad && this.nativeGamepad.pose) {\n      let pose = this.nativeGamepad.pose;\n      let position = pose.position;\n      let orientation = pose.orientation;\n      if (!position && !orientation) {\n        return;\n      }\n      if (!position) {\n        if (!pose.hasPosition) {\n          if (!this.armModel) {\n            this.armModel = new OrientationArmModel();\n          }\n          this.armModel.setHandedness(this.nativeGamepad.hand);\n          this.armModel.update(orientation, this.polyfill.getBasePoseMatrix());\n          position = this.armModel.getPosition();\n        } else {\n          position = this.lastPosition;\n        }\n      } else {\n        this.lastPosition[0] = position[0];\n        this.lastPosition[1] = position[1];\n        this.lastPosition[2] = position[2];\n      }\n      fromRotationTranslation(this.basePoseMatrix, orientation, position);\n    } else {\n      copy(this.basePoseMatrix, this.polyfill.getBasePoseMatrix());\n    }\n    return this.basePoseMatrix;\n  }\n  getXRPose(coordinateSystem, poseType) {\n    this.updateBasePoseMatrix();\n    switch(poseType) {\n      case \"target-ray\":\n        coordinateSystem._transformBasePoseMatrix(this.outputMatrix, this.basePoseMatrix);\n        if (this.gamepad && this.gamepad[PRIVATE$14].targetRayTransform) {\n          multiply(this.outputMatrix, this.outputMatrix, this.gamepad[PRIVATE$14].targetRayTransform);\n        }\n        break;\n      case \"grip\":\n        if (!this.nativeGamepad || !this.nativeGamepad.pose) {\n          return null;\n        }\n        coordinateSystem._transformBasePoseMatrix(this.outputMatrix, this.basePoseMatrix);\n        if (this.gamepad && this.gamepad[PRIVATE$14].gripTransform) {\n          multiply(this.outputMatrix, this.outputMatrix, this.gamepad[PRIVATE$14].gripTransform);\n        }\n        break;\n      default:\n        return null;\n    }\n    coordinateSystem._adjustForOriginOffset(this.outputMatrix);\n    return new XRPose(new XRRigidTransform(this.outputMatrix), this.emulatedPosition);\n  }\n}\n\nconst TEST_ENV = \"production\" === 'test';\nconst EXTRA_PRESENTATION_ATTRIBUTES = {\n  highRefreshRate: true,\n};\nconst PRIMARY_BUTTON_MAP = {\n  oculus: 1,\n  openvr: 1,\n  'spatial controller (spatial interaction source)': 1\n};\nlet SESSION_ID = 0;\nclass Session {\n  constructor(mode, polyfillOptions={}) {\n    this.mode = mode;\n    this.outputContext = null;\n    this.immersive = mode == 'immersive-vr' || mode == 'immersive-ar';\n    this.ended = null;\n    this.baseLayer = null;\n    this.inlineVerticalFieldOfView = Math.PI * 0.5;\n    this.id = ++SESSION_ID;\n    this.modifiedCanvasLayer = false;\n    if (this.outputContext && !TEST_ENV) {\n      const renderContextType = polyfillOptions.renderContextType || '2d';\n      this.renderContext = this.outputContext.canvas.getContext(renderContextType);\n    }\n  }\n}\nclass WebVRDevice extends XRDevice {\n  constructor(global, display) {\n    const { canPresent } = display.capabilities;\n    super(global);\n    this.display = display;\n    this.frame = new global.VRFrameData();\n    this.sessions = new Map();\n    this.immersiveSession = null;\n    this.canPresent = canPresent;\n    this.baseModelMatrix = create();\n    this.gamepadInputSources = {};\n    this.tempVec3 = new Float32Array(3);\n    this.onVRDisplayPresentChange = this.onVRDisplayPresentChange.bind(this);\n    global.window.addEventListener('vrdisplaypresentchange', this.onVRDisplayPresentChange);\n    this.CAN_USE_GAMEPAD = global.navigator && ('getGamepads' in global.navigator);\n    this.HAS_BITMAP_SUPPORT = isImageBitmapSupported(global);\n  }\n  get depthNear() { return this.display.depthNear; }\n  set depthNear(val) { this.display.depthNear = val; }\n  get depthFar() { return this.display.depthFar; }\n  set depthFar(val) { this.display.depthFar = val; }\n  onBaseLayerSet(sessionId, layer) {\n    const session = this.sessions.get(sessionId);\n    const canvas = layer.context.canvas;\n    if (session.immersive) {\n      const left = this.display.getEyeParameters('left');\n      const right = this.display.getEyeParameters('right');\n      canvas.width = Math.max(left.renderWidth, right.renderWidth) * 2;\n      canvas.height = Math.max(left.renderHeight, right.renderHeight);\n      this.display.requestPresent([{\n          source: canvas, attributes: EXTRA_PRESENTATION_ATTRIBUTES\n        }]).then(() => {\n        if (!TEST_ENV && !this.global.document.body.contains(canvas)) {\n          session.modifiedCanvasLayer = true;\n          this.global.document.body.appendChild(canvas);\n          applyCanvasStylesForMinimalRendering(canvas);\n        }\n        session.baseLayer = layer;\n      });\n    }\n    else {\n      session.baseLayer = layer;\n    }\n  }\n  onInlineVerticalFieldOfViewSet(sessionId, value) {\n    const session = this.sessions.get(sessionId);\n    session.inlineVerticalFieldOfView = value;\n  }\n  supportsSession(mode) {\n    if (XRSessionModes.indexOf(mode) == -1) {\n      throw new TypeError(\n          `The provided value '${mode}' is not a valid enum value of type XRSessionMode`);\n    }\n    if (mode == 'immersive-ar') {\n      return false;\n    }\n    if (mode == 'immersive-vr' && this.canPresent === false) {\n      return false;\n    }\n    return true;\n  }\n  async requestSession(mode) {\n    if (!this.supportsSession(mode)) {\n      return Promise.reject();\n    }\n    let immersive = mode == 'immersive-vr';\n    if (immersive) {\n      const canvas = this.global.document.createElement('canvas');\n      if (!TEST_ENV) {\n        const ctx = canvas.getContext('webgl');\n      }\n      await this.display.requestPresent([{\n          source: canvas, attributes: EXTRA_PRESENTATION_ATTRIBUTES }]);\n    }\n    const session = new Session(mode, {\n      renderContextType: this.HAS_BITMAP_SUPPORT ? 'bitmaprenderer' : '2d'\n    });\n    this.sessions.set(session.id, session);\n    if (immersive) {\n      this.immersiveSession = session;\n      this.dispatchEvent('@@webxr-polyfill/vr-present-start', session.id);\n    }\n    return Promise.resolve(session.id);\n  }\n  requestAnimationFrame(callback) {\n    return this.display.requestAnimationFrame(callback);\n  }\n  getPrimaryButtonIndex(gamepad) {\n    let primaryButton = 0;\n    let name = gamepad.id.toLowerCase();\n    for (let key in PRIMARY_BUTTON_MAP) {\n      if (name.includes(key)) {\n        primaryButton = PRIMARY_BUTTON_MAP[key];\n        break;\n      }\n    }\n    return Math.min(primaryButton, gamepad.buttons.length - 1);\n  }\n  onFrameStart(sessionId) {\n    this.display.getFrameData(this.frame);\n    const session = this.sessions.get(sessionId);\n    if (session.immersive && this.CAN_USE_GAMEPAD) {\n      let prevInputSources = this.gamepadInputSources;\n      this.gamepadInputSources = {};\n      let gamepads = this.global.navigator.getGamepads();\n      for (let i = 0; i < gamepads.length; ++i) {\n        let gamepad = gamepads[i];\n        if (gamepad && gamepad.displayId > 0) {\n          let inputSourceImpl = prevInputSources[i];\n          if (!inputSourceImpl) {\n            inputSourceImpl = new GamepadXRInputSource(this, this.display, this.getPrimaryButtonIndex(gamepad));\n          }\n          inputSourceImpl.updateFromGamepad(gamepad);\n          this.gamepadInputSources[i] = inputSourceImpl;\n          if (inputSourceImpl.primaryButtonIndex != -1) {\n            let primaryActionPressed = gamepad.buttons[inputSourceImpl.primaryButtonIndex].pressed;\n            if (primaryActionPressed && !inputSourceImpl.primaryActionPressed) {\n              this.dispatchEvent('@@webxr-polyfill/input-select-start', { sessionId: session.id, inputSource: inputSourceImpl.inputSource });\n            } else if (!primaryActionPressed && inputSourceImpl.primaryActionPressed) {\n              this.dispatchEvent('@@webxr-polyfill/input-select-end', { sessionId: session.id, inputSource: inputSourceImpl.inputSource });\n            }\n            inputSourceImpl.primaryActionPressed = primaryActionPressed;\n          }\n        }\n      }\n    }\n    if (TEST_ENV) {\n      return;\n    }\n    if (!session.immersive && session.baseLayer) {\n      const canvas = session.baseLayer.context.canvas;\n      perspective(this.frame.leftProjectionMatrix, session.inlineVerticalFieldOfView,\n          canvas.width/canvas.height, this.depthNear, this.depthFar);\n    }\n  }\n  onFrameEnd(sessionId) {\n    const session = this.sessions.get(sessionId);\n    if (session.ended || !session.baseLayer) {\n      return;\n    }\n    if (session.outputContext &&\n        !(session.immersive && !this.display.capabilities.hasExternalDisplay)) {\n      const mirroring =\n        session.immersive && this.display.capabilities.hasExternalDisplay;\n      const iCanvas = session.baseLayer.context.canvas;\n      const iWidth = mirroring ? iCanvas.width / 2 : iCanvas.width;\n      const iHeight = iCanvas.height;\n      if (!TEST_ENV) {\n        const oCanvas = session.outputContext.canvas;\n        const oWidth = oCanvas.width;\n        const oHeight = oCanvas.height;\n        const renderContext = session.renderContext;\n        if (this.HAS_BITMAP_SUPPORT) {\n          if (iCanvas.transferToImageBitmap) {\n            renderContext.transferFromImageBitmap(iCanvas.transferToImageBitmap());\n          }\n          else {\n            this.global.createImageBitmap(iCanvas, 0, 0, iWidth, iHeight, {\n              resizeWidth: oWidth,\n              resizeHeight: oHeight,\n            }).then(bitmap => renderContext.transferFromImageBitmap(bitmap));\n          }\n        } else {\n          renderContext.drawImage(iCanvas, 0, 0, iWidth, iHeight,\n                                           0, 0, oWidth, oHeight);\n        }\n      }\n    }\n    if (session.immersive && session.baseLayer) {\n      this.display.submitFrame();\n    }\n  }\n  cancelAnimationFrame(handle) {\n    this.display.cancelAnimationFrame(handle);\n  }\n  async endSession(sessionId) {\n    const session = this.sessions.get(sessionId);\n    if (session.ended) {\n      return;\n    }\n    if (session.immersive) {\n      return this.display.exitPresent();\n    } else {\n      session.ended = true;\n    }\n  }\n  requestStageBounds() {\n    if (this.display.stageParameters) {\n      const width = this.display.stageParameters.sizeX;\n      const depth = this.display.stageParameters.sizeZ;\n      const data = [];\n      data.push(-width / 2);\n      data.push(-depth / 2);\n      data.push(width / 2);\n      data.push(-depth / 2);\n      data.push(width / 2);\n      data.push(depth / 2);\n      data.push(-width / 2);\n      data.push(depth / 2);\n      return data;\n    }\n    return null;\n  }\n  async requestFrameOfReferenceTransform(type, options) {\n    if ((type === 'local-floor' || type === 'bounded-floor') &&\n        this.display.stageParameters &&\n        this.display.stageParameters.sittingToStandingTransform) {\n      return this.display.stageParameters.sittingToStandingTransform;\n    }\n    return null;\n  }\n  getProjectionMatrix(eye) {\n    if (eye === 'left') {\n      return this.frame.leftProjectionMatrix;\n    } else if (eye === 'right') {\n      return this.frame.rightProjectionMatrix;\n    } else if (eye === 'none') {\n      return this.frame.leftProjectionMatrix;\n    } else {\n      throw new Error(`eye must be of type 'left' or 'right'`);\n    }\n  }\n  getViewport(sessionId, eye, layer, target) {\n    const session = this.sessions.get(sessionId);\n    const { width, height } = layer.context.canvas;\n    if (!session.immersive) {\n      target.x = target.y = 0;\n      target.width = width;\n      target.height = height;\n      return true;\n    }\n    if (eye === 'left') {\n      target.x = 0;\n    } else if (eye === 'right') {\n      target.x = width / 2;\n    } else {\n      return false;\n    }\n    target.y = 0;\n    target.width = width / 2;\n    target.height = height;\n    return true;\n  }\n  getBasePoseMatrix() {\n    let { position, orientation } = this.frame.pose;\n    if (!position && !orientation) {\n      return this.baseModelMatrix;\n    }\n    if (!position) {\n      position = this.tempVec3;\n      position[0] = position[1] = position[2] = 0;\n    }\n    fromRotationTranslation(this.baseModelMatrix, orientation, position);\n    return this.baseModelMatrix;\n  }\n  getBaseViewMatrix(eye) {\n    if (eye === 'left') {\n      return this.frame.leftViewMatrix;\n    } else if (eye === 'right') {\n      return this.frame.rightViewMatrix;\n    } else {\n      throw new Error(`eye must be of type 'left' or 'right'`);\n    }\n  }\n  getInputSources() {\n    let inputSources = [];\n    for (let i in this.gamepadInputSources) {\n      inputSources.push(this.gamepadInputSources[i].inputSource);\n    }\n    return inputSources;\n  }\n  getInputPose(inputSource, coordinateSystem, poseType) {\n    if (!coordinateSystem) {\n      return null;\n    }\n    for (let i in this.gamepadInputSources) {\n      let inputSourceImpl = this.gamepadInputSources[i];\n      if (inputSourceImpl.inputSource === inputSource) {\n        return inputSourceImpl.getXRPose(coordinateSystem, poseType);\n      }\n    }\n    return null;\n  }\n  onWindowResize() {\n  }\n  onVRDisplayPresentChange(e) {\n    if (!this.display.isPresenting) {\n      this.sessions.forEach(session => {\n        if (session.immersive && !session.ended) {\n          if (session.modifiedCanvasLayer) {\n            const canvas = session.baseLayer.context.canvas;\n            document.body.removeChild(canvas);\n            canvas.setAttribute('style', '');\n          }\n          if (this.immersiveSession === session) {\n            this.immersiveSession = null;\n          }\n          this.dispatchEvent('@@webxr-polyfill/vr-present-end', session.id);\n        }\n      });\n    }\n  }\n}\n\nclass CardboardXRDevice extends WebVRDevice {\n  constructor(global, cardboardConfig) {\n    const display = new CardboardVRDisplay(cardboardConfig || {});\n    super(global, display);\n    this.display = display;\n    this.frame = {\n      rightViewMatrix: new Float32Array(16),\n      leftViewMatrix: new Float32Array(16),\n      rightProjectionMatrix: new Float32Array(16),\n      leftProjectionMatrix: new Float32Array(16),\n      pose: null,\n      timestamp: null,\n    };\n  }\n}\n\nconst getWebVRDevice = async function (global) {\n  let device = null;\n  if ('getVRDisplays' in global.navigator) {\n    try {\n      const displays = await global.navigator.getVRDisplays();\n      if (displays && displays.length) {\n        device = new WebVRDevice(global, displays[0]);\n      }\n    } catch (e) {}\n  }\n  return device;\n};\nconst requestXRDevice = async function (global, config) {\n  if (config.webvr) {\n    let xr = await getWebVRDevice(global);\n    if (xr) {\n      return xr;\n    }\n  }\n  if (!global.VRFrameData) {\n    global.VRFrameData = function () {\n      this.rightViewMatrix = new Float32Array(16);\n      this.leftViewMatrix = new Float32Array(16);\n      this.rightProjectionMatrix = new Float32Array(16);\n      this.leftProjectionMatrix = new Float32Array(16);\n      this.pose = null;\n    };\n  }\n  return new CardboardXRDevice(global, config.cardboardConfig);\n};\n\nconst CONFIG_DEFAULTS = {\n  global: _global,\n  webvr: true,\n  cardboard: true,\n  cardboardConfig: null,\n  allowCardboardOnDesktop: false,\n};\nconst partials = ['navigator', 'HTMLCanvasElement', 'WebGLRenderingContext'];\nclass WebXRPolyfill {\n  constructor(config={}) {\n    this.config = Object.freeze(Object.assign({}, CONFIG_DEFAULTS, config));\n    this.global = this.config.global;\n    this.nativeWebXR = 'xr' in this.global.navigator;\n    this.injected = false;\n    if (!this.nativeWebXR) {\n      this._injectPolyfill(this.global);\n    } else {\n      this._injectCompatibilityShims(this.global);\n    }\n  }\n  _injectPolyfill(global) {\n    if (!partials.every(iface => !!global[iface])) {\n      throw new Error(`Global must have the following attributes : ${partials}`);\n    }\n    for (const className of Object.keys(API)) {\n      if (global[className] !== undefined) {\n        console.warn(`${className} already defined on global.`);\n      } else {\n        global[className] = API[className];\n      }\n    }\n    {\n      const polyfilledCtx = polyfillMakeXRCompatible(global.WebGLRenderingContext);\n      if (polyfilledCtx) {\n        polyfillGetContext(global.HTMLCanvasElement);\n        if (global.OffscreenCanvas) {\n          polyfillGetContext(global.OffscreenCanvas);\n        }\n        if (global.WebGL2RenderingContext){\n          polyfillMakeXRCompatible(global.WebGL2RenderingContext);\n        }\n      }\n    }\n    this.injected = true;\n    this._patchNavigatorXR();\n  }\n  _patchNavigatorXR() {\n    let devicePromise = requestXRDevice(this.global, this.config);\n    this.xr = new XR(devicePromise);\n    Object.defineProperty(this.global.navigator, 'xr', {\n      value: this.xr,\n      configurable: true,\n    });\n  }\n  _injectCompatibilityShims(global) {\n    if (!partials.every(iface => !!global[iface])) {\n      throw new Error(`Global must have the following attributes : ${partials}`);\n    }\n    if (global.XRWebGLLayer) {\n      let originalRequestSession = global.navigator.xr.requestSession;\n      global.navigator.xr.requestSession = function(mode, options) {\n        return originalRequestSession.call(this, mode, options).then((session) => {\n          session._session_mode = mode;\n          return session;\n        });\n      };\n      var originalXRLayer = global.XRWebGLLayer;\n      global.XRWebGLLayer = function(session, gl, options) {\n        if (!options) {\n          options = {};\n        }\n        options.compositionDisabled = (session._session_mode === \"inline\");\n        return new originalXRLayer(session, gl, options);\n      };\n    }\n  }\n}\n\nnew WebXRPolyfill();\n\n}\n"]},"metadata":{},"sourceType":"module"}